<?xml version="1.0" encoding="utf-8"?>
<FDL version="2.1">
  <Form id="M_HS_8390" width="1442" height="940" titletext="개인소득공제신고" onload="fn_FormOnload" onclose="fn_FormClose">
    <Layouts>
      <Layout height="940" width="1442">
        <Div id="div_Search" taborder="0" left="14" top="12" height="66" cssclass="div_WF_Search" formscrollbartype="none none" right="14" text="">
          <Layouts>
            <Layout>
              <Static id="sta_JstaYear" taborder="1" text="귀속년도" left="16" top="6" width="80" height="24" cssclass="sta_WF_SLabel" DomainID="S00002"/>
              <Static id="sta_EmpmCd" taborder="2" text="사번" left="16" top="31" width="80" height="24" cssclass="sta_WF_SLabel" DomainID="S00003"/>
              <Edit id="edt_EmpmCd" taborder="0" left="96" top="31" width="90" height="24" maxlength="10" onchanged="div_Search_edt_EmpmCd_onchanged"/>
              <Button id="btn_SystId" taborder="4" left="320" top="31" width="24" height="24" cssclass="btn_WF_SmallSearch" tabstop="false" onclick="div_Search_btn_SystId_onclick" cursor="pointer"/>
              <Edit id="edt_EmpmNm" taborder="3" left="188" top="31" width="130" height="24" enable="true" maxlength="50" onchanged="div_Search_edt_EmpmNm_onchanged"/>
              <Edit id="edt_SystId" taborder="5" left="345" top="31" width="10" height="24" maxlength="10" visible="false"/>
              <Button id="btn_LoadPdf" taborder="6" text="PDF 가져오기" width="100" height="24" cssclass="bt_WF_PopupBlue" top="31" right="16" cursor="pointer" onclick="div_Search_btn_LoadPdf_onclick"/>
              <Spin id="spn_JstaYear" taborder="7" left="96" top="6" width="90" height="24" max="2099" min="1950" value="" onchanged="div_Search_spn_JstaYear_onchanged"/>
              <Button id="Button00" taborder="8" text="Button00" left="309" top="9" width="52" height="20" onclick="div_Search_Button00_onclick" visible="false"/>
              <Static id="sta_BuyaYear" taborder="9" text="계산방식" left="386" top="16" width="80" height="24" cssclass="sta_WF_SLabel" DomainID="S00002" visible="false"/>
              <Radio id="rdo_Gube" taborder="10" innerdataset="innerdataset" codecolumn="codecolumn" datacolumn="datacolumn" position="absolute" value="1" left="456" width="88" top="4" height="53" index="0" text="자동" onitemchanged="div_Search_rdo_Gube_onitemchanged" visible="false">
                <Dataset id="innerdataset">
                  <ColumnInfo>
                    <Column id="codecolumn" size="256"/>
                    <Column id="datacolumn" size="256"/>
                  </ColumnInfo>
                  <Rows>
                    <Row>
                      <Col id="codecolumn">1</Col>
                      <Col id="datacolumn">자동</Col>
                    </Row>
                    <Row>
                      <Col id="datacolumn">수동</Col>
                      <Col id="codecolumn">0</Col>
                    </Row>
                  </Rows>
                </Dataset>
              </Radio>
              <Static id="sta_Text1" taborder="11" text="자동계산은 표준세액공제 적용과 미적용된 2가지 방식으로 연말정산 계산하여 결정세액이 더 작은 값을 보여줍니다." left="546" top="3" width="699" height="26" visible="false"/>
              <Static id="sta_Text2" taborder="12" text="※표준세액공제 적용계산이란? (A)특별공제, (B)특별세액공제(정치기부금 제외), &#10;(C)월세공제액을 신청하지 않고, (D)표준세액공제액(13만원) 을 적용하여 계산합니다." left="716" top="25" width="473" height="37" visible="false"/>
              <Static id="sta_BohuYn" taborder="13" text="표준세액공제 적용" left="546" top="31" width="113" height="24" cssclass="sta_WF_SLabel" DomainID="S00003" visible="false"/>
              <CheckBox id="chk_BohuYn" taborder="14" left="669" top="31" width="37" height="24" text="" falsevalue="0" truevalue="1" enable="false" visible="false"/>
              <Button id="btn_Htax" taborder="15" text="홈택스" width="100" height="24" cssclass="bt_WF_PopupBlue" top="31" right="118" cursor="pointer" onclick="div_Search_btn_Htax_onclick"/>
            </Layout>
          </Layouts>
        </Div>
        <Div id="div_MasterView" taborder="1" left="14" top="90" right="14" bottom="5">
          <Layouts>
            <Layout>
              <Tab id="tab_Master" taborder="0" tabindex="0" left="0" top="0" cssclass="tab_WF_MasterList" right="0" bottom="0" onchanged="div_MasterView_tab_Master_onchanged" canchange="div_MasterView_tab_Master_canchange" cursor="pointer">
                <Tabpages>
                  <Tabpage id="tpg_01" text="부양가족" enable="true">
                    <Layouts>
                      <Layout>
                        <Div id="div_Buya" taborder="0" left="0" top="2" right="0" url="hr::M_HS_8390_01_2022.xfdl" async="false" text="" bottom="0"/>
                      </Layout>
                    </Layouts>
                  </Tabpage>
                  <Tabpage id="tpg_02" text="보험료">
                    <Layouts>
                      <Layout>
                        <Div id="div_Bohm" taborder="0" left="0" top="2" right="0" url="hr::M_HS_8390_02_2022.xfdl" async="false" text="" bottom="0"/>
                      </Layout>
                    </Layouts>
                  </Tabpage>
                  <Tabpage id="tpg_03" text="교육비">
                    <Layouts>
                      <Layout>
                        <Div id="div_Educ" taborder="0" left="0" top="2" right="0" url="hr::M_HS_8390_03_2022.xfdl" async="false" text="" bottom="0"/>
                      </Layout>
                    </Layouts>
                  </Tabpage>
                  <Tabpage id="tpg_04" text="신용카드">
                    <Layouts>
                      <Layout>
                        <Div id="div_Card" taborder="0" left="0" top="2" right="0" url="hr::M_HS_8390_04_2022.xfdl" async="false" text="" bottom="0"/>
                      </Layout>
                    </Layouts>
                  </Tabpage>
                  <Tabpage id="tpg_05" text="의료비">
                    <Layouts>
                      <Layout>
                        <Div id="div_Hspt" taborder="0" left="0" top="2" right="0" url="hr::M_HS_8390_05_2022.xfdl" async="false" text="" bottom="0"/>
                      </Layout>
                    </Layouts>
                  </Tabpage>
                  <Tabpage id="tpg_06" text="기부금">
                    <Layouts>
                      <Layout>
                        <Div id="div_Gibu" taborder="0" left="0" top="2" right="0" url="hr::M_HS_8390_06_2022.xfdl" async="false" text="" bottom="0"/>
                      </Layout>
                    </Layouts>
                  </Tabpage>
                  <Tabpage id="tpg_07" text="주택자금">
                    <Layouts>
                      <Layout>
                        <Div id="div_Hous" taborder="0" left="0" top="2" right="0" url="hr::M_HS_8390_07_2022.xfdl" async="false" text="" bottom="0"/>
                      </Layout>
                    </Layouts>
                  </Tabpage>
                  <Tabpage id="tpg_08" text="연금/저축">
                    <Layouts>
                      <Layout>
                        <Div id="div_Save" taborder="0" left="0" top="2" right="0" url="hr::M_HS_8390_08_2022.xfdl" async="false" text="" bottom="0"/>
                      </Layout>
                    </Layouts>
                  </Tabpage>
                  <Tabpage id="tpg_09" text="월세/거주자간주택임차">
                    <Layouts>
                      <Layout>
                        <Div id="div_Joo" taborder="0" left="0" top="2" right="0" url="hr::M_HS_8390_09_2022.xfdl" async="false" text="" bottom="0"/>
                      </Layout>
                    </Layouts>
                  </Tabpage>
                  <Tabpage id="tpg_10" text="종전근무지">
                    <Layouts>
                      <Layout>
                        <Div id="div_Jsjo" taborder="0" left="0" top="2" right="0" url="hr::M_HS_8390_10_2022.xfdl" async="false" text="" bottom="0"/>
                      </Layout>
                    </Layouts>
                  </Tabpage>
                  <Tabpage id="tpg_11" text="기타">
                    <Layouts>
                      <Layout>
                        <Div id="div_etc" taborder="0" left="0" top="2" right="0" url="hr::M_HS_8390_11_2022.xfdl" async="false" text="" bottom="0"/>
                      </Layout>
                    </Layouts>
                  </Tabpage>
                  <Tabpage id="tpg_12" text="연말정산">
                    <Layouts>
                      <Layout>
                        <Div id="div_Calc" taborder="0" left="0" top="2" right="0" url="hr::M_HS_8390_12_2022.xfdl" async="false" text="" bottom="0"/>
                      </Layout>
                    </Layouts>
                  </Tabpage>
                </Tabpages>
              </Tab>
              <Div id="div_ComGrdBtn" taborder="1" top="5" height="20" url="cmm::cmmGridButton.xfdl" async="false" right="0" width="312" text=""/>
              <Button id="btn_CorhM2" taborder="2" text="제출" top="1" width="100" height="24" right="0" cssclass="btn_WF_Search" cursor="pointer" onclick="div_MasterInput_btn_CorhM2_onclick" enable="true" visible="false"/>
              <Button id="btn_JstmM1" taborder="3" text="계산" top="1" width="100" height="24" right="102" cssclass="btn_WF_Search" cursor="pointer" enable="true" onclick="div_MasterInput_btn_JstmM1_onclick" visible="false"/>
            </Layout>
          </Layouts>
        </Div>
        <Button id="btn_DivMoveMi" taborder="2" top="78" height="10" width="40" visible="true" onclick="btn_DivMoveMi_onclick" cssclass="bt_TF_FoldA" left="700" cursor="pointer"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_Input">
        <ColumnInfo>
          <Column id="BUYA_YEAR" type="STRING" size="256" description="조회시작일자"/>
          <Column id="SESU_ID" type="STRING" size="256" description="시스템사용자ID"/>
          <Column id="EMPM_CD" type="STRING" size="256"/>
          <Column id="GUBN" type="STRING" size="256"/>
          <Column id="BOHUMYN" type="STRING" size="256"/>
          <Column id="AUTOYN" type="STRING" size="256"/>
          <Column id="MGAS_MM" type="STRING" size="256"/>
          <Column id="SRCH_YEAR" type="STRING" size="256"/>
          <Column id="JSJU_GUBN" type="STRING" size="256"/>
          <Column id="DEPM_CD" type="STRING" size="256"/>
          <Column id="PROC_GUBN" type="STRING" size="256"/>
          <Column id="dType" type="STRING" size="256"/>
          <Column id="SYST_ID" type="STRING" size="256"/>
          <Column id="RENT_YEAR" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <FileDialog id="fdl_File" onclose="fdl_File_onclose"/>
      <FileUpTransfer id="fut_File" onerror="fut_File_onerror" onprogress="fut_File_onprogress" onsuccess="fut_File_onsuccess"/>
      <Dataset id="ds_UploadFile">
        <ColumnInfo>
          <Column id="PATH_NM" type="STRING" size="256"/>
          <Column id="FILE_ID" type="STRING" size="256"/>
          <Column id="FILE_NM" type="STRING" size="256"/>
          <Column id="uploadYn" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_PdfToXml">
        <ColumnInfo>
          <Column id="PROC_ST" type="STRING" size="256"/>
          <Column id="DATA_RT" type="STRING" size="256"/>
          <Column id="ERR_MSG" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_Master10" onrowposchanged="ds_Master10_onrowposchanged">
        <ColumnInfo>
          <Column id="COMM_CD" type="STRING" size="256"/>
          <Column id="TEMH_NO" type="STRING" size="256"/>
          <Column id="TEMB_SE" type="STRING" size="256"/>
          <Column id="TEMH_DT" type="STRING" size="256"/>
          <Column id="CNTH_NO" type="STRING" size="256"/>
          <Column id="CNTH_NM" type="STRING" size="256"/>
          <Column id="CUSM_CD" type="STRING" size="256"/>
          <Column id="CUSM_NM" type="STRING" size="256"/>
          <Column id="CSPM_CD" type="STRING" size="256"/>
          <Column id="CSPM_NM" type="STRING" size="256"/>
          <Column id="PJTH_NO" type="STRING" size="256"/>
          <Column id="PJTH_NM" type="STRING" size="256"/>
          <Column id="WORH_NO" type="STRING" size="256"/>
          <Column id="ITEM_CD" type="STRING" size="256"/>
          <Column id="ITEM_NM" type="STRING" size="256"/>
          <Column id="CT01_CD" type="STRING" size="256"/>
          <Column id="CT02_CD" type="STRING" size="256"/>
          <Column id="CT03_CD" type="STRING" size="256"/>
          <Column id="CT04_CD" type="STRING" size="256"/>
          <Column id="REMK_NM" type="STRING" size="256"/>
          <Column id="FILB_CT" type="STRING" size="256"/>
          <Column id="REGI_ID" type="STRING" size="256"/>
          <Column id="REGI_NM" type="STRING" size="256"/>
          <Column id="REGI_DT" type="STRING" size="256"/>
          <Column id="MODI_ID" type="STRING" size="256"/>
          <Column id="MODI_NM" type="STRING" size="256"/>
          <Column id="MODI_DT" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_GrdBuyaBo" oncolumnchanged="ds_GrdBuyaBo_oncolumnchanged">
        <ColumnInfo>
          <Column id="COMP_CODE" type="STRING" size="256"/>
          <Column id="BUYA_YEAR" type="STRING" size="256"/>
          <Column id="SYST_ID" type="STRING" size="256"/>
          <Column id="BUYA_JUMI" type="STRING" size="256"/>
          <Column id="BUYA_BOH4" type="BIGDECIMAL" size="256"/>
          <Column id="BUYA_BOH5" type="BIGDECIMAL" size="256"/>
          <Column id="s_chk" type="STRING" size="256"/>
          <Column id="crudType" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_GrdBuyaCa" oncolumnchanged="dataSet_oncolumnchanged">
        <ColumnInfo>
          <Column id="COMP_CODE" size="5" type="STRING"/>
          <Column id="BUYA_YEAR" size="4" type="STRING"/>
          <Column id="SYST_ID" size="7" type="STRING"/>
          <Column id="BUYA_JUMI" size="13" type="STRING"/>
          <Column id="BUYA_CRD1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_DIR1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CSH1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_MARK" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_PUBL" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_DSEO" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_XCR1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_XCR2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_XCR3" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_XCR4" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_XCR5" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_XCR6" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_XCR7" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_XCR8" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_XCR9" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_RELA" size="1" type="STRING"/>
          <Column id="BUYA_SCIB" size="256" type="STRING"/>
          <Column id="BUYA_SCJT" size="256" type="STRING"/>
          <Column id="BUYA_SCDJ" size="256" type="STRING"/>
          <Column id="BUYA_HCIB" size="256" type="STRING"/>
          <Column id="BUYA_HCJT" size="256" type="STRING"/>
          <Column id="BUYA_HCDJ" size="256" type="STRING"/>
          <Column id="BUYA_SJIB" size="256" type="STRING"/>
          <Column id="BUYA_SJJT" size="256" type="STRING"/>
          <Column id="BUYA_SJDJ" size="256" type="STRING"/>
          <Column id="BUYA_HJIB" size="256" type="STRING"/>
          <Column id="BUYA_HJJT" size="256" type="STRING"/>
          <Column id="BUYA_HJDJ" size="256" type="STRING"/>
          <Column id="BUYA_SHIB" size="256" type="STRING"/>
          <Column id="BUYA_SHJT" size="256" type="STRING"/>
          <Column id="BUYA_SHDJ" size="256" type="STRING"/>
          <Column id="BUYA_HHIB" size="256" type="STRING"/>
          <Column id="BUYA_HHJT" size="256" type="STRING"/>
          <Column id="BUYA_HHDJ" size="256" type="STRING"/>
          <Column id="BUYA_YCR1" size="256" type="STRING"/>
          <Column id="BUYA_YCR2" size="256" type="STRING"/>
          <Column id="BUYA_YCR3" size="256" type="STRING"/>
          <Column id="BUYA_YCR4" size="256" type="STRING"/>
          <Column id="BUYA_YCR5" size="256" type="STRING"/>
          <Column id="BUYA_YCR6" size="256" type="STRING"/>
          <Column id="BUYA_YCR7" size="256" type="STRING"/>
          <Column id="BUYA_YCR8" size="256" type="STRING"/>
          <Column id="BUYA_YCR9" size="256" type="STRING"/>
          <Column id="BUYA_CAIB" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CAJT" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CADJ" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CADS" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_JKIB" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_JKJT" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_JKDJ" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_JKDS" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CHIB" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CHJT" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CHDJ" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CHDS" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_SCCA" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_SCJK" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_SCCH" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_XCAD" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_XJKB" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_XCAH" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_ZEIB" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_ZEJT" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_ZEDJ" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_ZEDS" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CRD1_G1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CRD1_G2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CRD1_G3" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_DIR1_G1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_DIR1_G2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_DIR1_G3" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CSH1_G1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CSH1_G2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CSH1_G3" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_MARK_G1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_MARK_G2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_MARK_G3" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_PUBL_G1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_PUBL_G2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_PUBL_G3" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_DSEO_G1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_DSEO_G2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_DSEO_G3" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_ZEIB_G1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_ZEIB_G2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_ZEIB_G3" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CAIB_G1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CAIB_G2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CAIB_G3" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CAJT_G1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CAJT_G2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CAJT_G3" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CADJ_G1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CADJ_G2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CADJ_G3" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CADS_G1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CADS_G2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CADS_G3" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_JKIB_G1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_JKIB_G2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_JKIB_G3" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_JKJT_G1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_JKJT_G2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_JKJT_G3" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_JKDJ_G1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_JKDJ_G2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_JKDJ_G3" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_JKDS_G1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_JKDS_G2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_JKDS_G3" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CHIB_G1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CHIB_G2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CHIB_G3" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CHJT_G1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CHJT_G2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CHJT_G3" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CHDJ_G1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CHDJ_G2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CHDJ_G3" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CHDS_G1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CHDS_G2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CHDS_G3" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_ZEJT_G1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_ZEJT_G2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_ZEJT_G3" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_ZEDJ_G1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_ZEDJ_G2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_ZEDJ_G3" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_ZEDS_G1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_ZEDS_G2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_ZEDS_G3" size="11" type="BIGDECIMAL"/>
          <Column id="s_chk" type="STRING" size="256"/>
          <Column id="crudType" type="STRING" size="256"/>
          <Column id="BUYA_AD20" type="BIGDECIMAL" size="256"/>
          <Column id="BUYA_AD21" type="BIGDECIMAL" size="256"/>
          <Column id="BUYA_CRD1_2020" type="BIGDECIMAL" size="256"/>
          <Column id="BUYA_DIR1_2020" type="BIGDECIMAL" size="256"/>
          <Column id="BUYA_CSH1_2020" type="BIGDECIMAL" size="256"/>
          <Column id="BUYA_ZERO_2020" type="BIGDECIMAL" size="256"/>
          <Column id="BUYA_SZDJ" type="BIGDECIMAL" size="11"/>
          <Column id="BUYA_HZDJ" type="BIGDECIMAL" size="11"/>
          <Column id="BUYA_XTRA" type="BIGDECIMAL" size="256"/>
          <Column id="BUYA_NTRA" type="BIGDECIMAL" size="256"/>
          <Column id="BUYA_ZEH1" type="BIGDECIMAL" size="256"/>
          <Column id="BUYA_SZIB" type="BIGDECIMAL" size="256"/>
          <Column id="BUYA_HZIB" type="BIGDECIMAL" size="256"/>
          <Column id="BUYA_SZJT" type="BIGDECIMAL" size="256"/>
          <Column id="BUYA_HZJT" type="BIGDECIMAL" size="256"/>
          <Column id="BUYA_SZDS" type="BIGDECIMAL" size="256"/>
          <Column id="BUYA_HZDS" type="BIGDECIMAL" size="256"/>
          <Column id="BUYA_SCDS" type="BIGDECIMAL" size="256"/>
          <Column id="BUYA_HCDS" type="BIGDECIMAL" size="256"/>
          <Column id="BUYA_SJDS" type="BIGDECIMAL" size="256"/>
          <Column id="BUYA_HJDS" type="BIGDECIMAL" size="256"/>
          <Column id="BUYA_SHDS" type="BIGDECIMAL" size="256"/>
          <Column id="BUYA_HHDS" type="BIGDECIMAL" size="256"/>
          <Column id="BUYA_XHTR" type="BIGDECIMAL" size="256"/>
          <Column id="BUYA_NHTR" type="BIGDECIMAL" size="256"/>
          <Column id="BUYA_XJTR" type="BIGDECIMAL" size="256"/>
          <Column id="BUYA_NJTR" type="BIGDECIMAL" size="256"/>
          <Column id="BUYA_XZTR" type="BIGDECIMAL" size="256"/>
          <Column id="BUYA_NZTR" type="BIGDECIMAL" size="256"/>
          <Column id="JUN_JTHAP" type="STRING" size="256"/>
          <Column id="DANG_JTHAP" type="STRING" size="256"/>
          <Column id="SANG_DJHAP" type="STRING" size="256"/>
          <Column id="HABA_DJHAP" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_GrdHspt" oncolumnchanged="dataSet_oncolumnchanged" cancolumnchange="ds_GrdHspt_cancolumnchange">
        <ColumnInfo>
          <Column id="COMM_CD" size="5" type="STRING"/>
          <Column id="HSPT_YEAR" size="4" type="STRING"/>
          <Column id="SYST_ID" size="7" type="STRING"/>
          <Column id="HSPT_SERL" size="3" type="STRING"/>
          <Column id="HSPT_COMP" size="20" type="STRING"/>
          <Column id="HSPT_COMM" size="60" type="STRING"/>
          <Column id="HSPT_GUNS" size="5" type="BIGDECIMAL"/>
          <Column id="HSPT_GAMT" size="11" type="BIGDECIMAL"/>
          <Column id="HSPT_RELA" size="1" type="STRING"/>
          <Column id="HSPT_JUMI" size="13" type="STRING"/>
          <Column id="HSPT_JANG" size="1" type="STRING"/>
          <Column id="HSPT_CONT" size="200" type="STRING"/>
          <Column id="HSPT_INOT" size="1" type="STRING"/>
          <Column id="HSPT_GUN2" size="5" type="BIGDECIMAL"/>
          <Column id="HSPT_GAM2" size="11" type="BIGDECIMAL"/>
          <Column id="HSPT_CODE" size="1" type="STRING"/>
          <Column id="HSPT_GIGA" size="1" type="STRING"/>
          <Column id="HSPT_NAME" size="40" type="STRING"/>
          <Column id="BUYA_YN" size="1" type="STRING"/>
          <Column id="HSPT_NANI" size="1" type="STRING"/>
          <Column id="HSPT_SANJ" size="1" type="STRING"/>
          <Column id="HSPT_TYPE" size="256" type="STRING"/>
          <Column id="HSPT_SAMT" size="256" type="STRING"/>
          <Column id="HSPT_PREM" type="STRING" size="256"/>
          <Column id="HSPT_HPSE" type="STRING" size="256"/>
          <Column id="REGI_ID" type="STRING" size="256"/>
          <Column id="s_chk" type="STRING" size="256"/>
          <Column id="crudType" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_GrdSave" oncolumnchanged="ds_GrdSave_oncolumnchanged">
        <ColumnInfo>
          <Column id="COMP_CODE" size="5" type="STRING"/>
          <Column id="SAVE_YEAR" size="4" type="STRING"/>
          <Column id="SYST_ID" size="10" type="STRING"/>
          <Column id="SAVE_SEQN" size="2" type="STRING"/>
          <Column id="SAVE_GUBN" size="2" type="STRING"/>
          <Column id="SAVE_BKCD" size="3" type="STRING"/>
          <Column id="SAVE_BKNM" size="60" type="STRING"/>
          <Column id="SAVE_BKAC" size="40" type="STRING"/>
          <Column id="SAVE_PAYY" size="2" type="STRING"/>
          <Column id="SAVE_BAMT" size="10" type="BIGDECIMAL"/>
          <Column id="SAVE_GAMT" size="10" type="BIGDECIMAL"/>
          <Column id="SAVE_GRUP" size="2" type="STRING"/>
          <Column id="REGI_ID" type="STRING" size="256"/>
          <Column id="SAVE_TUGB" type="STRING" size="256"/>
          <Column id="SAVE_ENDT" type="STRING" size="256"/>
          <Column id="SAVE_PERI" type="STRING" size="256"/>
          <Column id="s_chk" type="STRING" size="256"/>
          <Column id="crudType" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_GrdRent" oncolumnchanged="ds_GrdRent_oncolumnchanged">
        <ColumnInfo>
          <Column id="COMP_CODE" size="5" type="STRING"/>
          <Column id="RENT_YEAR" size="4" type="STRING"/>
          <Column id="SYST_ID" size="10" type="STRING"/>
          <Column id="RENT_SERL" size="3" type="STRING"/>
          <Column id="RENT_NAME" size="60" type="STRING"/>
          <Column id="RENT_JUMI" size="13" type="STRING"/>
          <Column id="RENT_ADDR" size="100" type="STRING"/>
          <Column id="RENT_FDAY" size="8" type="STRING"/>
          <Column id="RENT_TDAY" size="8" type="STRING"/>
          <Column id="RENT_AMOT" size="11" type="BIGDECIMAL"/>
          <Column id="RENT_NAME1" size="20" type="STRING"/>
          <Column id="RENT_JUMI1" size="13" type="STRING"/>
          <Column id="RENT_FDAY1" size="8" type="STRING"/>
          <Column id="RENT_TDAY1" size="8" type="STRING"/>
          <Column id="RENT_RATE" size="5" type="BIGDECIMAL"/>
          <Column id="RENT_WONA" size="11" type="BIGDECIMAL"/>
          <Column id="RENT_IISA" size="11" type="BIGDECIMAL"/>
          <Column id="REGI_EMST" size="256" type="STRING"/>
          <Column id="REGI_DATE" size="256" type="DATE"/>
          <Column id="UPDT_EMST" size="256" type="STRING"/>
          <Column id="UPDT_DATE" size="256" type="DATE"/>
          <Column id="RENT_JSBO" size="11" type="BIGDECIMAL"/>
          <Column id="RENT_NAME2" size="20" type="STRING"/>
          <Column id="RENT_JUMI2" size="13" type="STRING"/>
          <Column id="RENT_ADDR1" size="100" type="STRING"/>
          <Column id="RENT_FDAY2" size="8" type="STRING"/>
          <Column id="RENT_TDAY2" size="8" type="STRING"/>
          <Column id="RENT_WTYP" size="1" type="STRING"/>
          <Column id="RENT_WARE" size="11" type="BIGDECIMAL"/>
          <Column id="RENT_ITYP" size="1" type="STRING"/>
          <Column id="RENT_IARE" size="11" type="BIGDECIMAL"/>
          <Column id="REGI_ID" type="STRING" size="256"/>
          <Column id="s_chk" type="STRING" size="256"/>
          <Column id="crudType" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_GrdGibu" cancolumnchange="ds_GrdGibu_cancolumnchange" oncolumnchanged="ds_GrdGibu_oncolumnchanged">
        <ColumnInfo>
          <Column id="COMP_CODE" size="5" type="STRING"/>
          <Column id="GIBU_YEAR" size="4" type="STRING"/>
          <Column id="SYST_ID" size="10" type="STRING"/>
          <Column id="GIBU_SERL" size="2" type="STRING"/>
          <Column id="GIBU_COMP" size="20" type="STRING"/>
          <Column id="GIBU_COMM" size="60" type="STRING"/>
          <Column id="GIBU_GUNS" size="5" type="BIGDECIMAL"/>
          <Column id="GIBU_GAMT" size="11" type="BIGDECIMAL"/>
          <Column id="GIBU_CODE" size="10" type="STRING"/>
          <Column id="GIBU_NUMB" size="30" type="STRING"/>
          <Column id="GIBU_RELA" size="1" type="STRING"/>
          <Column id="GIBU_JUMI" size="13" type="STRING"/>
          <Column id="GIBU_GIGA" size="1" type="STRING"/>
          <Column id="GIBU_GAM2" size="11" type="BIGDECIMAL"/>
          <Column id="GIBU_NOTE" size="20" type="STRING"/>
          <Column id="GIBU_INOT" size="1" type="STRING"/>
          <Column id="GIBU_NAME" size="40" type="STRING"/>
          <Column id="BUYA_NAME" size="40" type="STRING"/>
          <Column id="BUYA_YN" size="1" type="STRING"/>
          <Column id="REGI_EMST" size="256" type="STRING"/>
          <Column id="REGI_ID" type="STRING" size="256"/>
          <Column id="s_chk" type="STRING" size="256"/>
          <Column id="crudType" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_GrdGbch">
        <ColumnInfo>
          <Column id="COMM_CD" type="STRING" size="256"/>
          <Column id="GBCH_YEAR" type="STRING" size="256"/>
          <Column id="SYST_ID" type="STRING" size="256"/>
          <Column id="GBCH_CODE" type="STRING" size="256"/>
          <Column id="GBCH_GBYY" type="STRING" size="256"/>
          <Column id="GBCH_GAMT" type="STRING" size="256"/>
          <Column id="GBCH_NUMB" type="STRING" size="256"/>
          <Column id="GBCH_PRAM" type="STRING" size="256"/>
          <Column id="GBCH_GDAM" type="STRING" size="256"/>
          <Column id="GBCH_GJAM" type="STRING" size="256"/>
          <Column id="GBCH_SOAM" type="STRING" size="256"/>
          <Column id="GBCH_IWAM" type="STRING" size="256"/>
          <Column id="GBCH_SEYN" type="STRING" size="256"/>
          <Column id="REGI_ID" type="STRING" size="256"/>
          <Column id="s_chk" type="STRING" size="256"/>
          <Column id="crudType" type="STRING" size="256"/>
        </ColumnInfo>
        <Contents>
          <Column id="COMP_CODE" size="5" type="STRING"/>
          <Column id="GBCH_YEAR" size="4" type="STRING"/>
          <Column id="EMST_CODE" size="7" type="STRING"/>
          <Column id="GBCH_CODE" size="10" type="STRING"/>
          <Column id="GBCH_GBYY" size="4" type="STRING"/>
          <Column id="GBCH_GAMT" size="11" type="DECIMAL"/>
          <Column id="GBCH_NUMB" size="20" type="STRING"/>
          <Column id="GBCH_PRAM" size="11" type="DECIMAL"/>
          <Column id="GBCH_GDAM" size="11" type="DECIMAL"/>
          <Column id="GBCH_GJAM" size="11" type="DECIMAL"/>
          <Column id="GBCH_SOAM" size="11" type="DECIMAL"/>
          <Column id="GBCH_IWAM" size="11" type="DECIMAL"/>
        </Contents>
      </Dataset>
      <Dataset id="ds_GrdJsjo" oncolumnchanged="ds_GrdJsjo_oncolumnchanged" cancolumnchange="ds_GrdJsjo_cancolumnchange">
        <Contents>
          <Column id="COMP_CODE" size="5" type="STRING"/>
          <Column id="JSJO_GUBN" size="10" type="STRING"/>
          <Column id="JSJO_YEAR" size="4" type="STRING"/>
          <Column id="EMST_CODE" size="7" type="STRING"/>
          <Column id="JSJO_SERL" size="2" type="STRING"/>
          <Column id="JSJO_COMP" size="10" type="STRING"/>
          <Column id="JSJO_COMM" size="40" type="STRING"/>
          <Column id="JSJO_IDAY" size="8" type="STRING"/>
          <Column id="JSJO_ODAY" size="8" type="STRING"/>
          <Column id="JSJO_GR01" size="10" type="DECIMAL"/>
          <Column id="JSJO_GR02" size="10" type="DECIMAL"/>
          <Column id="JSJO_GR03" size="10" type="DECIMAL"/>
          <Column id="JSJO_BG01" size="10" type="DECIMAL"/>
          <Column id="JSJO_BG02" size="10" type="DECIMAL"/>
          <Column id="JSJO_BG03" size="10" type="DECIMAL"/>
          <Column id="JSJO_OUAM" size="10" type="DECIMAL"/>
          <Column id="JSJO_SG01" size="10" type="DECIMAL"/>
          <Column id="JSJO_TG01" size="10" type="DECIMAL"/>
          <Column id="JSJO_TG02" size="10" type="DECIMAL"/>
          <Column id="JSJO_GN01" size="10" type="DECIMAL"/>
          <Column id="JSJO_GN02" size="10" type="DECIMAL"/>
          <Column id="JSJO_GN03" size="10" type="DECIMAL"/>
          <Column id="JSJO_BG04" size="10" type="DECIMAL"/>
          <Column id="JSJO_BG05" size="10" type="DECIMAL"/>
          <Column id="JSJO_TG03" size="10" type="DECIMAL"/>
          <Column id="JSJO_TG04" size="10" type="DECIMAL"/>
          <Column id="JSJO_SG02" size="10" type="DECIMAL"/>
          <Column id="JSJO_SG03" size="10" type="DECIMAL"/>
          <Column id="JSJO_CODE" size="1" type="STRING"/>
          <Column id="JSJO_NSGB" size="1" type="STRING"/>
          <Column id="JSJO_BG06" size="10" type="DECIMAL"/>
          <Column id="JSJO_BG07" size="10" type="DECIMAL"/>
          <Column id="JSJO_BG08" size="10" type="DECIMAL"/>
          <Column id="JSJO_BG09" size="10" type="DECIMAL"/>
          <Column id="JSJO_SG13" size="10" type="DECIMAL"/>
          <Column id="JSJO_RATE" size="256" type="STRING"/>
        </Contents>
      </Dataset>
      <Dataset id="ds_GrdJsmt">
        <ColumnInfo>
          <Column id="COMM_CD" type="STRING" size="256"/>
          <Column id="JSMT_YEAR" type="STRING" size="256"/>
          <Column id="SYST_ID" type="STRING" size="256"/>
          <Column id="JSMT_GUBN" type="STRING" size="256"/>
          <Column id="JSMT_GR01" type="STRING" size="256"/>
          <Column id="JSMT_GR02" type="STRING" size="256"/>
          <Column id="JSMT_GR03" type="STRING" size="256"/>
          <Column id="JSMT_GR28" type="STRING" size="256"/>
          <Column id="JSMT_GR29" type="STRING" size="256"/>
          <Column id="JSMT_GR04" type="STRING" size="256"/>
          <Column id="JSMT_GR05" type="STRING" size="256"/>
          <Column id="JSMT_GR06" type="STRING" size="256"/>
          <Column id="JSMT_GR07" type="STRING" size="256"/>
          <Column id="JSMT_GR08" type="STRING" size="256"/>
          <Column id="JSMT_GR09" type="STRING" size="256"/>
          <Column id="JSMT_GR10" type="STRING" size="256"/>
          <Column id="JSMT_GR11" type="STRING" size="256"/>
          <Column id="JSMT_GR12" type="STRING" size="256"/>
          <Column id="JSMT_GR13" type="STRING" size="256"/>
          <Column id="JSMT_GR14" type="STRING" size="256"/>
          <Column id="JSMT_BG01" type="STRING" size="256"/>
          <Column id="JSMT_BG02" type="STRING" size="256"/>
          <Column id="JSMT_BG03" type="STRING" size="256"/>
          <Column id="JSMT_BG04" type="STRING" size="256"/>
          <Column id="JSMT_WOLJ" type="STRING" size="256"/>
          <Column id="JSMT_GRGJ" type="STRING" size="256"/>
          <Column id="JSMT_GRAM" type="STRING" size="256"/>
          <Column id="JSMT_IG01" type="STRING" size="256"/>
          <Column id="JSMT_IG02" type="STRING" size="256"/>
          <Column id="JSMT_IG03" type="STRING" size="256"/>
          <Column id="JSMT_IG04" type="STRING" size="256"/>
          <Column id="JSMT_IG05" type="STRING" size="256"/>
          <Column id="JSMT_IG06" type="STRING" size="256"/>
          <Column id="JSMT_IG07" type="STRING" size="256"/>
          <Column id="JSMT_IG08" type="STRING" size="256"/>
          <Column id="JSMT_IG09" type="STRING" size="256"/>
          <Column id="JSMT_TG01" type="STRING" size="256"/>
          <Column id="JSMT_TG02" type="STRING" size="256"/>
          <Column id="JSMT_TG03" type="STRING" size="256"/>
          <Column id="JSMT_TG04" type="STRING" size="256"/>
          <Column id="JSMT_TG05" type="STRING" size="256"/>
          <Column id="JSMT_TG06" type="STRING" size="256"/>
          <Column id="JSMT_GG01" type="STRING" size="256"/>
          <Column id="JSMT_GG02" type="STRING" size="256"/>
          <Column id="JSMT_GG03" type="STRING" size="256"/>
          <Column id="JSMT_GG04" type="STRING" size="256"/>
          <Column id="JSMT_GG05" type="STRING" size="256"/>
          <Column id="JSMT_GG06" type="STRING" size="256"/>
          <Column id="JSMT_STAX" type="STRING" size="256"/>
          <Column id="JSMT_TAXR" type="STRING" size="256"/>
          <Column id="JSMT_NGON" type="STRING" size="256"/>
          <Column id="JSMT_TAXA" type="STRING" size="256"/>
          <Column id="JSMT_SG01" type="STRING" size="256"/>
          <Column id="JSMT_SG02" type="STRING" size="256"/>
          <Column id="JSMT_SG03" type="STRING" size="256"/>
          <Column id="JSMT_SG04" type="STRING" size="256"/>
          <Column id="JSMT_SG05" type="STRING" size="256"/>
          <Column id="JSMT_SG06" type="STRING" size="256"/>
          <Column id="JSMT_SG07" type="STRING" size="256"/>
          <Column id="JSMT_SG08" type="STRING" size="256"/>
          <Column id="JSMT_SG09" type="STRING" size="256"/>
          <Column id="JSMT_SG10" type="STRING" size="256"/>
          <Column id="JSMT_SG11" type="STRING" size="256"/>
          <Column id="JSMT_SG16" type="STRING" size="256"/>
          <Column id="JSMT_SG18" type="STRING" size="256"/>
          <Column id="JSMT_SG19" type="STRING" size="256"/>
          <Column id="JSMT_SG20" type="STRING" size="256"/>
          <Column id="JSMT_SG21" type="STRING" size="256"/>
          <Column id="JSMT_SG22" type="STRING" size="256"/>
          <Column id="JSMT_SG23" type="STRING" size="256"/>
          <Column id="JSMT_SG24" type="STRING" size="256"/>
          <Column id="JSMT_SG25" type="STRING" size="256"/>
          <Column id="JSMT_SG26" type="STRING" size="256"/>
          <Column id="JSMT_SG27" type="STRING" size="256"/>
          <Column id="JSMT_SG28" type="STRING" size="256"/>
          <Column id="JSMT_SG29" type="STRING" size="256"/>
          <Column id="JSMT_SG30" type="STRING" size="256"/>
          <Column id="JSMT_SG31" type="STRING" size="256"/>
          <Column id="JSMT_SG32" type="STRING" size="256"/>
          <Column id="JSMT_SG33" type="STRING" size="256"/>
          <Column id="JSMT_SG34" type="STRING" size="256"/>
          <Column id="JSMT_SG35" type="STRING" size="256"/>
          <Column id="JSMT_SG36" type="STRING" size="256"/>
          <Column id="JSMT_SG37" type="STRING" size="256"/>
          <Column id="JSMT_SG38" type="STRING" size="256"/>
          <Column id="JSMT_GJ01" type="STRING" size="256"/>
          <Column id="JSMT_GJ02" type="STRING" size="256"/>
          <Column id="JSMT_GJ03" type="STRING" size="256"/>
          <Column id="JSMT_GN01" type="STRING" size="256"/>
          <Column id="JSMT_GN02" type="STRING" size="256"/>
          <Column id="JSMT_GN03" type="STRING" size="256"/>
          <Column id="JSMT_GN04" type="STRING" size="256"/>
          <Column id="JSMT_GN05" type="STRING" size="256"/>
          <Column id="JSMT_GN06" type="STRING" size="256"/>
          <Column id="JSMT_CG01" type="STRING" size="256"/>
          <Column id="JSMT_CG02" type="STRING" size="256"/>
          <Column id="JSMT_CG03" type="STRING" size="256"/>
          <Column id="JSMT_GG07" type="STRING" size="256"/>
          <Column id="JSMT_SG12" type="STRING" size="256"/>
          <Column id="JSMT_SG13" type="STRING" size="256"/>
          <Column id="JSMT_GG08" type="STRING" size="256"/>
          <Column id="JSMT_IG10" type="STRING" size="256"/>
          <Column id="JSMT_TG07" type="STRING" size="256"/>
          <Column id="JSMT_SG14" type="STRING" size="256"/>
          <Column id="JSMT_IG11" type="STRING" size="256"/>
          <Column id="JSMT_GG09" type="STRING" size="256"/>
          <Column id="JSMT_GG10" type="STRING" size="256"/>
          <Column id="JSMT_TG08" type="STRING" size="256"/>
          <Column id="JSMT_TG09" type="STRING" size="256"/>
          <Column id="JSMT_IG12" type="STRING" size="256"/>
          <Column id="JSMT_GR15" type="STRING" size="256"/>
          <Column id="JSMT_GR16" type="STRING" size="256"/>
          <Column id="JSMT_GR17" type="STRING" size="256"/>
          <Column id="JSMT_GR18" type="STRING" size="256"/>
          <Column id="JSMT_GR19" type="STRING" size="256"/>
          <Column id="JSMT_GR20" type="STRING" size="256"/>
          <Column id="JSMT_BG05" type="STRING" size="256"/>
          <Column id="JSMT_GN07" type="STRING" size="256"/>
          <Column id="JSMT_GN08" type="STRING" size="256"/>
          <Column id="JSMT_GN09" type="STRING" size="256"/>
          <Column id="JSMT_BG06" type="STRING" size="256"/>
          <Column id="JSMT_IG13" type="STRING" size="256"/>
          <Column id="JSMT_IG14" type="STRING" size="256"/>
          <Column id="JSMT_IG15" type="STRING" size="256"/>
          <Column id="JSMT_IG16" type="STRING" size="256"/>
          <Column id="JSMT_IG17" type="STRING" size="256"/>
          <Column id="JSMT_IG18" type="STRING" size="256"/>
          <Column id="JSMT_IG19" type="STRING" size="256"/>
          <Column id="JSMT_TG10" type="STRING" size="256"/>
          <Column id="JSMT_GG11" type="STRING" size="256"/>
          <Column id="JSMT_GG12" type="STRING" size="256"/>
          <Column id="JSMT_GG13" type="STRING" size="256"/>
          <Column id="JSMT_GG14" type="STRING" size="256"/>
          <Column id="JSMT_GG15" type="STRING" size="256"/>
          <Column id="JSMT_GG16" type="STRING" size="256"/>
          <Column id="JSMT_GG17" type="STRING" size="256"/>
          <Column id="JSMT_GG18" type="STRING" size="256"/>
          <Column id="JSMT_GG19" type="STRING" size="256"/>
          <Column id="JSMT_GG20" type="STRING" size="256"/>
          <Column id="JSMT_GG21" type="STRING" size="256"/>
          <Column id="JSMT_BG07" type="STRING" size="256"/>
          <Column id="JSMT_BG08" type="STRING" size="256"/>
          <Column id="JSMT_TG11" type="STRING" size="256"/>
          <Column id="JSMT_TG12" type="STRING" size="256"/>
          <Column id="JSMT_TG13" type="STRING" size="256"/>
          <Column id="JSMT_TG14" type="STRING" size="256"/>
          <Column id="JSMT_TG15" type="STRING" size="256"/>
          <Column id="JSMT_TG26" type="STRING" size="256"/>
          <Column id="GUBN_NAME" type="STRING" size="256"/>
          <Column id="COLM_TEMP" type="STRING" size="256"/>
          <Column id="SPEC_SEAC" type="STRING" size="256"/>
          <Column id="JSMT_SGTS" type="STRING" size="256"/>
          <Column id="JSMT_BOYN" type="STRING" size="256"/>
          <Column id="JSMT_HALB" type="STRING" size="256"/>
          <Column id="JSMT_SG39" type="STRING" size="256"/>
          <Column id="JSMT_SG40" type="STRING" size="256"/>
          <Column id="JSMT_TG27" type="STRING" size="256"/>
          <Column id="JSMT_TG28" type="STRING" size="256"/>
          <Column id="JSMT_TG29" type="STRING" size="256"/>
          <Column id="JSMT_TG30" type="STRING" size="256"/>
          <Column id="JSMT_SG41" type="STRING" size="256"/>
          <Column id="JSMT_SG42" type="STRING" size="256"/>
          <Column id="JSMT_SG43" type="STRING" size="256"/>
          <Column id="JSMT_SG44" type="STRING" size="256"/>
          <Column id="JSMT_SG45" type="STRING" size="256"/>
          <Column id="JSMT_SG46" type="STRING" size="256"/>
          <Column id="JSMT_SG15" type="STRING" size="256"/>
          <Column id="JSMT_GJ04" type="STRING" size="256"/>
          <Column id="JSMT_SG47" type="STRING" size="256"/>
          <Column id="JSMT_SG48" type="STRING" size="256"/>
        </ColumnInfo>
        <Contents>
          <Column id="COMP_CODE" size="5" type="STRING"/>
          <Column id="JSMT_YEAR" size="4" type="STRING"/>
          <Column id="EMST_CODE" size="7" type="STRING"/>
          <Column id="JSMT_GUBN" size="1" type="STRING"/>
          <Column id="JSMT_GR01" size="10" type="DECIMAL"/>
          <Column id="JSMT_GR02" size="10" type="DECIMAL"/>
          <Column id="JSMT_GR03" size="10" type="DECIMAL"/>
          <Column id="JSMT_GR04" size="40" type="STRING"/>
          <Column id="JSMT_GR05" size="10" type="STRING"/>
          <Column id="JSMT_GR06" size="10" type="DECIMAL"/>
          <Column id="JSMT_GR07" size="10" type="DECIMAL"/>
          <Column id="JSMT_GR08" size="10" type="DECIMAL"/>
          <Column id="JSMT_GR09" size="40" type="STRING"/>
          <Column id="JSMT_GR10" size="10" type="STRING"/>
          <Column id="JSMT_GR11" size="10" type="DECIMAL"/>
          <Column id="JSMT_GR12" size="10" type="DECIMAL"/>
          <Column id="JSMT_GR13" size="10" type="DECIMAL"/>
          <Column id="JSMT_GR14" size="10" type="DECIMAL"/>
          <Column id="JSMT_BG01" size="10" type="DECIMAL"/>
          <Column id="JSMT_BG02" size="10" type="DECIMAL"/>
          <Column id="JSMT_BG03" size="10" type="DECIMAL"/>
          <Column id="JSMT_BG04" size="10" type="DECIMAL"/>
          <Column id="JSMT_WOLJ" size="10" type="DECIMAL"/>
          <Column id="JSMT_GRGJ" size="10" type="DECIMAL"/>
          <Column id="JSMT_GRAM" size="10" type="DECIMAL"/>
          <Column id="JSMT_IG01" size="10" type="DECIMAL"/>
          <Column id="JSMT_IG02" size="10" type="DECIMAL"/>
          <Column id="JSMT_IG03" size="10" type="DECIMAL"/>
          <Column id="JSMT_IG04" size="10" type="DECIMAL"/>
          <Column id="JSMT_IG05" size="10" type="DECIMAL"/>
          <Column id="JSMT_IG06" size="10" type="DECIMAL"/>
          <Column id="JSMT_IG07" size="10" type="DECIMAL"/>
          <Column id="JSMT_IG08" size="10" type="DECIMAL"/>
          <Column id="JSMT_IG09" size="10" type="DECIMAL"/>
          <Column id="JSMT_TG01" size="10" type="DECIMAL"/>
          <Column id="JSMT_TG02" size="10" type="DECIMAL"/>
          <Column id="JSMT_TG03" size="10" type="DECIMAL"/>
          <Column id="JSMT_TG04" size="10" type="DECIMAL"/>
          <Column id="JSMT_TG05" size="10" type="DECIMAL"/>
          <Column id="JSMT_TG06" size="10" type="DECIMAL"/>
          <Column id="JSMT_GG01" size="10" type="DECIMAL"/>
          <Column id="JSMT_GG02" size="10" type="DECIMAL"/>
          <Column id="JSMT_GG03" size="10" type="DECIMAL"/>
          <Column id="JSMT_GG04" size="10" type="DECIMAL"/>
          <Column id="JSMT_GG05" size="10" type="DECIMAL"/>
          <Column id="JSMT_GG06" size="10" type="DECIMAL"/>
          <Column id="JSMT_STAX" size="10" type="DECIMAL"/>
          <Column id="JSMT_TAXR" size="5" type="DECIMAL"/>
          <Column id="JSMT_NGON" size="10" type="DECIMAL"/>
          <Column id="JSMT_TAXA" size="10" type="DECIMAL"/>
          <Column id="JSMT_SG01" size="10" type="DECIMAL"/>
          <Column id="JSMT_SG02" size="10" type="DECIMAL"/>
          <Column id="JSMT_SG03" size="10" type="DECIMAL"/>
          <Column id="JSMT_SG04" size="10" type="DECIMAL"/>
          <Column id="JSMT_SG05" size="10" type="DECIMAL"/>
          <Column id="JSMT_SG06" size="10" type="DECIMAL"/>
          <Column id="JSMT_SG07" size="10" type="DECIMAL"/>
          <Column id="JSMT_SG08" size="10" type="DECIMAL"/>
          <Column id="JSMT_SG09" size="10" type="DECIMAL"/>
          <Column id="JSMT_SG10" size="10" type="DECIMAL"/>
          <Column id="JSMT_SG11" size="10" type="DECIMAL"/>
          <Column id="JSMT_GJ01" size="10" type="DECIMAL"/>
          <Column id="JSMT_GJ02" size="10" type="DECIMAL"/>
          <Column id="JSMT_GJ03" size="10" type="DECIMAL"/>
          <Column id="JSMT_GN01" size="10" type="DECIMAL"/>
          <Column id="JSMT_GN02" size="10" type="DECIMAL"/>
          <Column id="JSMT_GN03" size="10" type="DECIMAL"/>
          <Column id="JSMT_GN04" size="255" type="DECIMAL"/>
          <Column id="JSMT_GN05" size="255" type="DECIMAL"/>
          <Column id="JSMT_GN06" size="255" type="DECIMAL"/>
          <Column id="JSMT_CG01" size="10" type="DECIMAL"/>
          <Column id="JSMT_CG02" size="10" type="DECIMAL"/>
          <Column id="JSMT_CG03" size="10" type="DECIMAL"/>
          <Column id="JSMT_GG07" size="10" type="DECIMAL"/>
          <Column id="JSMT_SG12" size="10" type="DECIMAL"/>
          <Column id="JSMT_SG13" size="10" type="DECIMAL"/>
          <Column id="JSMT_GG08" size="10" type="DECIMAL"/>
          <Column id="JSMT_IG10" size="10" type="DECIMAL"/>
          <Column id="JSMT_TG07" size="10" type="DECIMAL"/>
          <Column id="JSMT_SG14" size="10" type="DECIMAL"/>
          <Column id="JSMT_IG11" size="10" type="DECIMAL"/>
          <Column id="JSMT_GG09" size="10" type="DECIMAL"/>
          <Column id="JSMT_GG10" size="10" type="DECIMAL"/>
          <Column id="JSMT_TG08" size="10" type="DECIMAL"/>
          <Column id="JSMT_TG09" size="10" type="DECIMAL"/>
          <Column id="JSMT_IG12" size="10" type="DECIMAL"/>
          <Column id="JSMT_GR15" size="8" type="STRING"/>
          <Column id="JSMT_GR16" size="8" type="STRING"/>
          <Column id="JSMT_GR17" size="8" type="STRING"/>
          <Column id="JSMT_GR18" size="8" type="STRING"/>
          <Column id="JSMT_GR19" size="8" type="STRING"/>
          <Column id="JSMT_GR20" size="8" type="STRING"/>
          <Column id="JSMT_BG05" size="10" type="DECIMAL"/>
          <Column id="JSMT_GN07" size="10" type="DECIMAL"/>
          <Column id="JSMT_GN08" size="10" type="DECIMAL"/>
          <Column id="JSMT_GN09" size="10" type="DECIMAL"/>
          <Column id="JSMT_BG06" size="10" type="DECIMAL"/>
          <Column id="JSMT_IG13" size="3" type="DECIMAL"/>
          <Column id="JSMT_IG14" size="3" type="DECIMAL"/>
          <Column id="JSMT_IG15" size="3" type="DECIMAL"/>
          <Column id="JSMT_IG16" size="3" type="DECIMAL"/>
          <Column id="JSMT_IG17" size="3" type="DECIMAL"/>
          <Column id="JSMT_IG18" size="3" type="DECIMAL"/>
          <Column id="JSMT_TG10" size="10" type="DECIMAL"/>
          <Column id="JSMT_GG11" size="10" type="DECIMAL"/>
          <Column id="JSMT_GG12" size="10" type="DECIMAL"/>
          <Column id="JSMT_GG13" size="10" type="DECIMAL"/>
          <Column id="JSMT_GG14" size="10" type="DECIMAL"/>
          <Column id="JSMT_GG15" size="10" type="DECIMAL"/>
          <Column id="JSMT_GG16" size="10" type="DECIMAL"/>
          <Column id="JSMT_GG17" size="10" type="DECIMAL"/>
          <Column id="JSMT_GG18" size="10" type="DECIMAL"/>
          <Column id="GUBN_NAME" size="4" type="STRING"/>
          <Column id="JSMT_BG07" size="10" type="DECIMAL"/>
          <Column id="JSMT_BG08" size="10" type="DECIMAL"/>
          <Column id="JSMT_TG11" size="10" type="DECIMAL"/>
          <Column id="JSMT_TG12" size="10" type="DECIMAL"/>
          <Column id="JSMT_TG13" size="10" type="DECIMAL"/>
          <Column id="JSMT_TG14" size="10" type="DECIMAL"/>
          <Column id="JSMT_TG15" size="10" type="DECIMAL"/>
          <Column id="JSMT_IG19" size="256" type="STRING"/>
          <Column id="JSMT_GG19" size="256" type="STRING"/>
          <Column id="JSMT_TG26" size="256" type="STRING"/>
          <Column id="JSMT_SG18" size="256" type="STRING"/>
          <Column id="JSMT_SG19" size="256" type="STRING"/>
          <Column id="JSMT_SG20" size="256" type="STRING"/>
          <Column id="JSMT_SG21" size="256" type="STRING"/>
          <Column id="JSMT_SG22" size="256" type="STRING"/>
          <Column id="JSMT_SG23" size="256" type="STRING"/>
          <Column id="JSMT_SG24" size="256" type="STRING"/>
          <Column id="JSMT_SG25" size="256" type="STRING"/>
          <Column id="JSMT_SG26" size="256" type="STRING"/>
          <Column id="JSMT_SG27" size="256" type="STRING"/>
          <Column id="JSMT_SG28" size="256" type="STRING"/>
          <Column id="JSMT_SG29" size="256" type="STRING"/>
          <Column id="JSMT_SG30" size="256" type="STRING"/>
          <Column id="JSMT_SG31" size="256" type="STRING"/>
          <Column id="JSMT_SG32" size="256" type="STRING"/>
          <Column id="JSMT_SG33" size="256" type="STRING"/>
          <Column id="JSMT_SG34" size="256" type="STRING"/>
          <Column id="JSMT_SG35" size="256" type="STRING"/>
          <Column id="JSMT_GG20" size="256" type="STRING"/>
          <Column id="JSMT_SG16" size="256" type="STRING"/>
          <Column id="JSMT_HALB" size="256" type="STRING"/>
          <Column id="JSMT_SG41" size="256" type="STRING"/>
          <Column id="JSMT_SG42" size="256" type="STRING"/>
          <Column id="JSMT_SG43" size="256" type="STRING"/>
          <Column id="JSMT_SG44" size="256" type="STRING"/>
          <Column id="JSMT_SG45" size="256" type="STRING"/>
          <Column id="JSMT_SG46" size="256" type="STRING"/>
          <Column id="JSMT_SG15" size="256" type="STRING"/>
          <Column id="JSMT_GJ04" size="256" type="STRING"/>
        </Contents>
      </Dataset>
      <Dataset id="ds_JstaInfo"/>
      <Dataset id="ds_Pr028">
        <ColumnInfo>
          <Column id="COMM_CD" type="STRING" size="256"/>
          <Column id="GRCM_CD" type="STRING" size="256"/>
          <Column id="CODM_CD" type="STRING" size="256"/>
          <Column id="CODM_NM" type="STRING" size="256"/>
          <Column id="OP01_NM" type="STRING" size="256"/>
          <Column id="OP02_NM" type="STRING" size="256"/>
          <Column id="OP03_NM" type="STRING" size="256"/>
          <Column id="OP04_NM" type="STRING" size="256"/>
          <Column id="OP05_NM" type="STRING" size="256"/>
          <Column id="OP06_NM" type="STRING" size="256"/>
          <Column id="OP07_NM" type="STRING" size="256"/>
          <Column id="OP08_NM" type="STRING" size="256"/>
          <Column id="OP09_NM" type="STRING" size="256"/>
          <Column id="OP10_NM" type="STRING" size="256"/>
          <Column id="SORT_NO" type="STRING" size="256"/>
          <Column id="USED_YN" type="STRING" size="256"/>
          <Column id="REMK_NM" type="STRING" size="256"/>
          <Column id="EXPT_YN" type="STRING" size="256"/>
          <Column id="EXPT_RE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_Pr039">
        <ColumnInfo>
          <Column id="COMM_CD" type="STRING" size="256"/>
          <Column id="GRCM_CD" type="STRING" size="256"/>
          <Column id="CODM_CD" type="STRING" size="256"/>
          <Column id="CODM_NM" type="STRING" size="256"/>
          <Column id="OP01_NM" type="STRING" size="256"/>
          <Column id="OP02_NM" type="STRING" size="256"/>
          <Column id="OP03_NM" type="STRING" size="256"/>
          <Column id="OP04_NM" type="STRING" size="256"/>
          <Column id="OP05_NM" type="STRING" size="256"/>
          <Column id="OP06_NM" type="STRING" size="256"/>
          <Column id="OP07_NM" type="STRING" size="256"/>
          <Column id="OP08_NM" type="STRING" size="256"/>
          <Column id="OP09_NM" type="STRING" size="256"/>
          <Column id="OP10_NM" type="STRING" size="256"/>
          <Column id="SORT_NO" type="STRING" size="256"/>
          <Column id="USED_YN" type="STRING" size="256"/>
          <Column id="REMK_NM" type="STRING" size="256"/>
          <Column id="EXPT_YN" type="STRING" size="256"/>
          <Column id="EXPT_RE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_Pr124">
        <ColumnInfo>
          <Column id="COMM_CD" type="STRING" size="256"/>
          <Column id="GRCM_CD" type="STRING" size="256"/>
          <Column id="CODM_CD" type="STRING" size="256"/>
          <Column id="CODM_NM" type="STRING" size="256"/>
          <Column id="OP01_NM" type="STRING" size="256"/>
          <Column id="OP02_NM" type="STRING" size="256"/>
          <Column id="OP03_NM" type="STRING" size="256"/>
          <Column id="OP04_NM" type="STRING" size="256"/>
          <Column id="OP05_NM" type="STRING" size="256"/>
          <Column id="OP06_NM" type="STRING" size="256"/>
          <Column id="OP07_NM" type="STRING" size="256"/>
          <Column id="OP08_NM" type="STRING" size="256"/>
          <Column id="OP09_NM" type="STRING" size="256"/>
          <Column id="OP10_NM" type="STRING" size="256"/>
          <Column id="SORT_NO" type="STRING" size="256"/>
          <Column id="USED_YN" type="STRING" size="256"/>
          <Column id="REMK_NM" type="STRING" size="256"/>
          <Column id="EXPT_YN" type="STRING" size="256"/>
          <Column id="EXPT_RE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_Pr125">
        <ColumnInfo>
          <Column id="COMM_CD" type="STRING" size="256"/>
          <Column id="GRCM_CD" type="STRING" size="256"/>
          <Column id="CODM_CD" type="STRING" size="256"/>
          <Column id="CODM_NM" type="STRING" size="256"/>
          <Column id="OP01_NM" type="STRING" size="256"/>
          <Column id="OP02_NM" type="STRING" size="256"/>
          <Column id="OP03_NM" type="STRING" size="256"/>
          <Column id="OP04_NM" type="STRING" size="256"/>
          <Column id="OP05_NM" type="STRING" size="256"/>
          <Column id="OP06_NM" type="STRING" size="256"/>
          <Column id="OP07_NM" type="STRING" size="256"/>
          <Column id="OP08_NM" type="STRING" size="256"/>
          <Column id="OP09_NM" type="STRING" size="256"/>
          <Column id="OP10_NM" type="STRING" size="256"/>
          <Column id="SORT_NO" type="STRING" size="256"/>
          <Column id="USED_YN" type="STRING" size="256"/>
          <Column id="REMK_NM" type="STRING" size="256"/>
          <Column id="EXPT_YN" type="STRING" size="256"/>
          <Column id="EXPT_RE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_Pr126">
        <ColumnInfo>
          <Column id="COMM_CD" type="STRING" size="256"/>
          <Column id="GRCM_CD" type="STRING" size="256"/>
          <Column id="CODM_CD" type="STRING" size="256"/>
          <Column id="CODM_NM" type="STRING" size="256"/>
          <Column id="OP01_NM" type="STRING" size="256"/>
          <Column id="OP02_NM" type="STRING" size="256"/>
          <Column id="OP03_NM" type="STRING" size="256"/>
          <Column id="OP04_NM" type="STRING" size="256"/>
          <Column id="OP05_NM" type="STRING" size="256"/>
          <Column id="OP06_NM" type="STRING" size="256"/>
          <Column id="OP07_NM" type="STRING" size="256"/>
          <Column id="OP08_NM" type="STRING" size="256"/>
          <Column id="OP09_NM" type="STRING" size="256"/>
          <Column id="OP10_NM" type="STRING" size="256"/>
          <Column id="SORT_NO" type="STRING" size="256"/>
          <Column id="USED_YN" type="STRING" size="256"/>
          <Column id="REMK_NM" type="STRING" size="256"/>
          <Column id="EXPT_YN" type="STRING" size="256"/>
          <Column id="EXPT_RE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_Pr127">
        <ColumnInfo>
          <Column id="COMM_CD" type="STRING" size="256"/>
          <Column id="GRCM_CD" type="STRING" size="256"/>
          <Column id="CODM_CD" type="STRING" size="256"/>
          <Column id="CODM_NM" type="STRING" size="256"/>
          <Column id="OP01_NM" type="STRING" size="256"/>
          <Column id="OP02_NM" type="STRING" size="256"/>
          <Column id="OP03_NM" type="STRING" size="256"/>
          <Column id="OP04_NM" type="STRING" size="256"/>
          <Column id="OP05_NM" type="STRING" size="256"/>
          <Column id="OP06_NM" type="STRING" size="256"/>
          <Column id="OP07_NM" type="STRING" size="256"/>
          <Column id="OP08_NM" type="STRING" size="256"/>
          <Column id="OP09_NM" type="STRING" size="256"/>
          <Column id="OP10_NM" type="STRING" size="256"/>
          <Column id="SORT_NO" type="STRING" size="256"/>
          <Column id="USED_YN" type="STRING" size="256"/>
          <Column id="REMK_NM" type="STRING" size="256"/>
          <Column id="EXPT_YN" type="STRING" size="256"/>
          <Column id="EXPT_RE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_Pr128">
        <ColumnInfo>
          <Column id="COMM_CD" type="STRING" size="256"/>
          <Column id="GRCM_CD" type="STRING" size="256"/>
          <Column id="CODM_CD" type="STRING" size="256"/>
          <Column id="CODM_NM" type="STRING" size="256"/>
          <Column id="OP01_NM" type="STRING" size="256"/>
          <Column id="OP02_NM" type="STRING" size="256"/>
          <Column id="OP03_NM" type="STRING" size="256"/>
          <Column id="OP04_NM" type="STRING" size="256"/>
          <Column id="OP05_NM" type="STRING" size="256"/>
          <Column id="OP06_NM" type="STRING" size="256"/>
          <Column id="OP07_NM" type="STRING" size="256"/>
          <Column id="OP08_NM" type="STRING" size="256"/>
          <Column id="OP09_NM" type="STRING" size="256"/>
          <Column id="OP10_NM" type="STRING" size="256"/>
          <Column id="SORT_NO" type="STRING" size="256"/>
          <Column id="USED_YN" type="STRING" size="256"/>
          <Column id="REMK_NM" type="STRING" size="256"/>
          <Column id="EXPT_YN" type="STRING" size="256"/>
          <Column id="EXPT_RE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_Pr129">
        <ColumnInfo>
          <Column id="COMM_CD" type="STRING" size="256"/>
          <Column id="GRCM_CD" type="STRING" size="256"/>
          <Column id="CODM_CD" type="STRING" size="256"/>
          <Column id="CODM_NM" type="STRING" size="256"/>
          <Column id="OP01_NM" type="STRING" size="256"/>
          <Column id="OP02_NM" type="STRING" size="256"/>
          <Column id="OP03_NM" type="STRING" size="256"/>
          <Column id="OP04_NM" type="STRING" size="256"/>
          <Column id="OP05_NM" type="STRING" size="256"/>
          <Column id="OP06_NM" type="STRING" size="256"/>
          <Column id="OP07_NM" type="STRING" size="256"/>
          <Column id="OP08_NM" type="STRING" size="256"/>
          <Column id="OP09_NM" type="STRING" size="256"/>
          <Column id="OP10_NM" type="STRING" size="256"/>
          <Column id="SORT_NO" type="STRING" size="256"/>
          <Column id="USED_YN" type="STRING" size="256"/>
          <Column id="REMK_NM" type="STRING" size="256"/>
          <Column id="EXPT_YN" type="STRING" size="256"/>
          <Column id="EXPT_RE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_Pr130">
        <ColumnInfo>
          <Column id="COMM_CD" type="STRING" size="256"/>
          <Column id="GRCM_CD" type="STRING" size="256"/>
          <Column id="CODM_CD" type="STRING" size="256"/>
          <Column id="CODM_NM" type="STRING" size="256"/>
          <Column id="OP01_NM" type="STRING" size="256"/>
          <Column id="OP02_NM" type="STRING" size="256"/>
          <Column id="OP03_NM" type="STRING" size="256"/>
          <Column id="OP04_NM" type="STRING" size="256"/>
          <Column id="OP05_NM" type="STRING" size="256"/>
          <Column id="OP06_NM" type="STRING" size="256"/>
          <Column id="OP07_NM" type="STRING" size="256"/>
          <Column id="OP08_NM" type="STRING" size="256"/>
          <Column id="OP09_NM" type="STRING" size="256"/>
          <Column id="OP10_NM" type="STRING" size="256"/>
          <Column id="SORT_NO" type="STRING" size="256"/>
          <Column id="USED_YN" type="STRING" size="256"/>
          <Column id="REMK_NM" type="STRING" size="256"/>
          <Column id="EXPT_YN" type="STRING" size="256"/>
          <Column id="EXPT_RE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_Pr131">
        <ColumnInfo>
          <Column id="COMM_CD" type="STRING" size="256"/>
          <Column id="GRCM_CD" type="STRING" size="256"/>
          <Column id="CODM_CD" type="STRING" size="256"/>
          <Column id="CODM_NM" type="STRING" size="256"/>
          <Column id="OP01_NM" type="STRING" size="256"/>
          <Column id="OP02_NM" type="STRING" size="256"/>
          <Column id="OP03_NM" type="STRING" size="256"/>
          <Column id="OP04_NM" type="STRING" size="256"/>
          <Column id="OP05_NM" type="STRING" size="256"/>
          <Column id="OP06_NM" type="STRING" size="256"/>
          <Column id="OP07_NM" type="STRING" size="256"/>
          <Column id="OP08_NM" type="STRING" size="256"/>
          <Column id="OP09_NM" type="STRING" size="256"/>
          <Column id="OP10_NM" type="STRING" size="256"/>
          <Column id="SORT_NO" type="STRING" size="256"/>
          <Column id="USED_YN" type="STRING" size="256"/>
          <Column id="REMK_NM" type="STRING" size="256"/>
          <Column id="EXPT_YN" type="STRING" size="256"/>
          <Column id="EXPT_RE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_Pr135">
        <ColumnInfo>
          <Column id="COMM_CD" type="STRING" size="256"/>
          <Column id="GRCM_CD" type="STRING" size="256"/>
          <Column id="CODM_CD" type="STRING" size="256"/>
          <Column id="CODM_NM" type="STRING" size="256"/>
          <Column id="OP01_NM" type="STRING" size="256"/>
          <Column id="OP02_NM" type="STRING" size="256"/>
          <Column id="OP03_NM" type="STRING" size="256"/>
          <Column id="OP04_NM" type="STRING" size="256"/>
          <Column id="OP05_NM" type="STRING" size="256"/>
          <Column id="OP06_NM" type="STRING" size="256"/>
          <Column id="OP07_NM" type="STRING" size="256"/>
          <Column id="OP08_NM" type="STRING" size="256"/>
          <Column id="OP09_NM" type="STRING" size="256"/>
          <Column id="OP10_NM" type="STRING" size="256"/>
          <Column id="SORT_NO" type="STRING" size="256"/>
          <Column id="USED_YN" type="STRING" size="256"/>
          <Column id="REMK_NM" type="STRING" size="256"/>
          <Column id="EXPT_YN" type="STRING" size="256"/>
          <Column id="EXPT_RE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_Pr136">
        <ColumnInfo>
          <Column id="COMM_CD" type="STRING" size="256"/>
          <Column id="GRCM_CD" type="STRING" size="256"/>
          <Column id="CODM_CD" type="STRING" size="256"/>
          <Column id="CODM_NM" type="STRING" size="256"/>
          <Column id="OP01_NM" type="STRING" size="256"/>
          <Column id="OP02_NM" type="STRING" size="256"/>
          <Column id="OP03_NM" type="STRING" size="256"/>
          <Column id="OP04_NM" type="STRING" size="256"/>
          <Column id="OP05_NM" type="STRING" size="256"/>
          <Column id="OP06_NM" type="STRING" size="256"/>
          <Column id="OP07_NM" type="STRING" size="256"/>
          <Column id="OP08_NM" type="STRING" size="256"/>
          <Column id="OP09_NM" type="STRING" size="256"/>
          <Column id="OP10_NM" type="STRING" size="256"/>
          <Column id="SORT_NO" type="STRING" size="256"/>
          <Column id="USED_YN" type="STRING" size="256"/>
          <Column id="REMK_NM" type="STRING" size="256"/>
          <Column id="EXPT_YN" type="STRING" size="256"/>
          <Column id="EXPT_RE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_Pr137">
        <ColumnInfo>
          <Column id="COMM_CD" type="STRING" size="256"/>
          <Column id="GRCM_CD" type="STRING" size="256"/>
          <Column id="CODM_CD" type="STRING" size="256"/>
          <Column id="CODM_NM" type="STRING" size="256"/>
          <Column id="OP01_NM" type="STRING" size="256"/>
          <Column id="OP02_NM" type="STRING" size="256"/>
          <Column id="OP03_NM" type="STRING" size="256"/>
          <Column id="OP04_NM" type="STRING" size="256"/>
          <Column id="OP05_NM" type="STRING" size="256"/>
          <Column id="OP06_NM" type="STRING" size="256"/>
          <Column id="OP07_NM" type="STRING" size="256"/>
          <Column id="OP08_NM" type="STRING" size="256"/>
          <Column id="OP09_NM" type="STRING" size="256"/>
          <Column id="OP10_NM" type="STRING" size="256"/>
          <Column id="SORT_NO" type="STRING" size="256"/>
          <Column id="USED_YN" type="STRING" size="256"/>
          <Column id="REMK_NM" type="STRING" size="256"/>
          <Column id="EXPT_YN" type="STRING" size="256"/>
          <Column id="EXPT_RE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_Pr139">
        <ColumnInfo>
          <Column id="COMM_CD" type="STRING" size="256"/>
          <Column id="GRCM_CD" type="STRING" size="256"/>
          <Column id="CODM_CD" type="STRING" size="256"/>
          <Column id="CODM_NM" type="STRING" size="256"/>
          <Column id="OP01_NM" type="STRING" size="256"/>
          <Column id="OP02_NM" type="STRING" size="256"/>
          <Column id="OP03_NM" type="STRING" size="256"/>
          <Column id="OP04_NM" type="STRING" size="256"/>
          <Column id="OP05_NM" type="STRING" size="256"/>
          <Column id="OP06_NM" type="STRING" size="256"/>
          <Column id="OP07_NM" type="STRING" size="256"/>
          <Column id="OP08_NM" type="STRING" size="256"/>
          <Column id="OP09_NM" type="STRING" size="256"/>
          <Column id="OP10_NM" type="STRING" size="256"/>
          <Column id="SORT_NO" type="STRING" size="256"/>
          <Column id="USED_YN" type="STRING" size="256"/>
          <Column id="REMK_NM" type="STRING" size="256"/>
          <Column id="EXPT_YN" type="STRING" size="256"/>
          <Column id="EXPT_RE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_Pr143">
        <ColumnInfo>
          <Column id="COMM_CD" type="STRING" size="256"/>
          <Column id="GRCM_CD" type="STRING" size="256"/>
          <Column id="CODM_CD" type="STRING" size="256"/>
          <Column id="CODM_NM" type="STRING" size="256"/>
          <Column id="OP01_NM" type="STRING" size="256"/>
          <Column id="OP02_NM" type="STRING" size="256"/>
          <Column id="OP03_NM" type="STRING" size="256"/>
          <Column id="OP04_NM" type="STRING" size="256"/>
          <Column id="OP05_NM" type="STRING" size="256"/>
          <Column id="OP06_NM" type="STRING" size="256"/>
          <Column id="OP07_NM" type="STRING" size="256"/>
          <Column id="OP08_NM" type="STRING" size="256"/>
          <Column id="OP09_NM" type="STRING" size="256"/>
          <Column id="OP10_NM" type="STRING" size="256"/>
          <Column id="SORT_NO" type="STRING" size="256"/>
          <Column id="USED_YN" type="STRING" size="256"/>
          <Column id="REMK_NM" type="STRING" size="256"/>
          <Column id="EXPT_YN" type="STRING" size="256"/>
          <Column id="EXPT_RE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_Pr144">
        <ColumnInfo>
          <Column id="COMM_CD" type="STRING" size="256"/>
          <Column id="GRCM_CD" type="STRING" size="256"/>
          <Column id="CODM_CD" type="STRING" size="256"/>
          <Column id="CODM_NM" type="STRING" size="256"/>
          <Column id="OP01_NM" type="STRING" size="256"/>
          <Column id="OP02_NM" type="STRING" size="256"/>
          <Column id="OP03_NM" type="STRING" size="256"/>
          <Column id="OP04_NM" type="STRING" size="256"/>
          <Column id="OP05_NM" type="STRING" size="256"/>
          <Column id="OP06_NM" type="STRING" size="256"/>
          <Column id="OP07_NM" type="STRING" size="256"/>
          <Column id="OP08_NM" type="STRING" size="256"/>
          <Column id="OP09_NM" type="STRING" size="256"/>
          <Column id="OP10_NM" type="STRING" size="256"/>
          <Column id="SORT_NO" type="STRING" size="256"/>
          <Column id="USED_YN" type="STRING" size="256"/>
          <Column id="REMK_NM" type="STRING" size="256"/>
          <Column id="EXPT_YN" type="STRING" size="256"/>
          <Column id="EXPT_RE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_Pr14">
        <ColumnInfo>
          <Column id="COMM_CD" type="STRING" size="256"/>
          <Column id="GRCM_CD" type="STRING" size="256"/>
          <Column id="CODM_CD" type="STRING" size="256"/>
          <Column id="CODM_NM" type="STRING" size="256"/>
          <Column id="OP01_NM" type="STRING" size="256"/>
          <Column id="OP02_NM" type="STRING" size="256"/>
          <Column id="OP03_NM" type="STRING" size="256"/>
          <Column id="OP04_NM" type="STRING" size="256"/>
          <Column id="OP05_NM" type="STRING" size="256"/>
          <Column id="OP06_NM" type="STRING" size="256"/>
          <Column id="OP07_NM" type="STRING" size="256"/>
          <Column id="OP08_NM" type="STRING" size="256"/>
          <Column id="OP09_NM" type="STRING" size="256"/>
          <Column id="OP10_NM" type="STRING" size="256"/>
          <Column id="SORT_NO" type="STRING" size="256"/>
          <Column id="USED_YN" type="STRING" size="256"/>
          <Column id="REMK_NM" type="STRING" size="256"/>
          <Column id="EXPT_YN" type="STRING" size="256"/>
          <Column id="EXPT_RE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_Dryn"/>
      <Dataset id="ds_UserInfo">
        <ColumnInfo>
          <Column id="COMM_CD" type="STRING" size="256"/>
          <Column id="SYST_ID" type="STRING" size="256"/>
          <Column id="EMPM_CD" type="STRING" size="256"/>
          <Column id="EMPM_NM" type="STRING" size="256"/>
          <Column id="DEPM_CD" type="STRING" size="256"/>
          <Column id="DEPM_NM" type="STRING" size="256"/>
          <Column id="PALM_CD" type="STRING" size="256"/>
          <Column id="PALM_NM" type="STRING" size="256"/>
          <Column id="POSI_CD" type="STRING" size="256"/>
          <Column id="POSI_NM" type="STRING" size="256"/>
          <Column id="DUTY_CD" type="STRING" size="256"/>
          <Column id="DUTY_NM" type="STRING" size="256"/>
          <Column id="ENTR_DD" type="STRING" size="256"/>
          <Column id="ENTR_YY" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_Rst">
        <ColumnInfo>
          <Column id="O_RTN_CODE" type="STRING" size="256"/>
          <Column id="O_RTN_CMSG" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_HealthType">
        <ColumnInfo>
          <Column id="CODM_CD" type="STRING" size="256"/>
          <Column id="CODM_NM" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CODM_CD">G0003</Col>
            <Col id="CODM_NM">의료비</Col>
          </Row>
          <Row>
            <Col id="CODM_CD">G0025</Col>
            <Col id="CODM_NM">의료기기구입</Col>
          </Row>
          <Row>
            <Col id="CODM_CD">G0026</Col>
            <Col id="CODM_NM">안경·렌즈</Col>
          </Row>
          <Row>
            <Col id="CODM_CD">G0027</Col>
            <Col id="CODM_NM">보청기,장애인보장구구입</Col>
          </Row>
          <Row>
            <Col id="CODM_CD">G0034</Col>
            <Col id="CODM_NM">산후조리원</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_Mgas">
        <ColumnInfo>
          <Column id="MGAS_MM" type="STRING" size="256"/>
          <Column id="CONF_YN" type="STRING" size="256"/>
          <Column id="ACCO_YN" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_aaaaaaa">
        <ColumnInfo>
          <Column id="COMM_CD" type="STRING" size="256"/>
          <Column id="BUYA_YEAR" type="STRING" size="256"/>
          <Column id="SYST_ID" type="STRING" size="256"/>
          <Column id="BUYA_JUMI" type="STRING" size="256"/>
          <Column id="BUYA_NAME" type="STRING" size="256"/>
          <Column id="BUYA_RELA" type="STRING" size="256"/>
          <Column id="BUYA_GIBO" type="STRING" size="256"/>
          <Column id="BUYA_JANG" type="STRING" size="256"/>
          <Column id="BUYA_YANG" type="STRING" size="256"/>
          <Column id="BUYA_MCHD" type="STRING" size="256"/>
          <Column id="BUYA_CHIP" type="STRING" size="256"/>
          <Column id="BUYA_BUIN" type="STRING" size="256"/>
          <Column id="BUYA_SEID" type="STRING" size="256"/>
          <Column id="BUYA_AG20" type="STRING" size="256"/>
          <Column id="BUYA_AG60" type="STRING" size="256"/>
          <Column id="BUYA_WIFE" type="STRING" size="256"/>
          <Column id="BUYA_NOIN" type="STRING" size="256"/>
          <Column id="BUYA_BOHE" type="STRING" size="256"/>
          <Column id="BUYA_HSPT" type="STRING" size="256"/>
          <Column id="BUYA_EDUC" type="STRING" size="256"/>
          <Column id="BUYA_CRED" type="STRING" size="256"/>
          <Column id="BUYA_INOT" type="STRING" size="256"/>
          <Column id="BUYA_MARK" type="STRING" size="256"/>
          <Column id="BUYA_BOH1" type="STRING" size="256"/>
          <Column id="BUYA_HSP1" type="STRING" size="256"/>
          <Column id="BUYA_EDU1" type="STRING" size="256"/>
          <Column id="BUYA_CRD1" type="STRING" size="256"/>
          <Column id="BUYA_CSH1" type="STRING" size="256"/>
          <Column id="BUYA_GIB1" type="STRING" size="256"/>
          <Column id="BUYA_BOH3" type="STRING" size="256"/>
          <Column id="BUYA_DIR1" type="STRING" size="256"/>
          <Column id="BUYA_BOH4" type="STRING" size="256"/>
          <Column id="BUYA_CRD3" type="STRING" size="256"/>
          <Column id="BUYA_BOH5" type="STRING" size="256"/>
          <Column id="BUYA_BOH2" type="STRING" size="256"/>
          <Column id="BUYA_HSP2" type="STRING" size="256"/>
          <Column id="BUYA_EDU2" type="STRING" size="256"/>
          <Column id="BUYA_CRD2" type="STRING" size="256"/>
          <Column id="BUYA_GIB2" type="STRING" size="256"/>
          <Column id="BUYA_BOGB" type="STRING" size="256"/>
          <Column id="BUYA_EDGB" type="STRING" size="256"/>
          <Column id="BUYA_BOH6" type="STRING" size="256"/>
          <Column id="BUYA_BOH7" type="STRING" size="256"/>
          <Column id="BUYA_HANB" type="STRING" size="256"/>
          <Column id="BUYA_PUBL" type="STRING" size="256"/>
          <Column id="BUYA_XCR1" type="STRING" size="256"/>
          <Column id="BUYA_XCR2" type="STRING" size="256"/>
          <Column id="BUYA_XCR3" type="STRING" size="256"/>
          <Column id="BUYA_XCR4" type="STRING" size="256"/>
          <Column id="BUYA_XCR5" type="STRING" size="256"/>
          <Column id="BUYA_XCR6" type="STRING" size="256"/>
          <Column id="BUYA_XCR7" type="STRING" size="256"/>
          <Column id="BUYA_XCR8" type="STRING" size="256"/>
          <Column id="BUYA_XCR9" type="STRING" size="256"/>
          <Column id="BUYA_SCIB" type="STRING" size="256"/>
          <Column id="BUYA_SCJT" type="STRING" size="256"/>
          <Column id="BUYA_SCDJ" type="STRING" size="256"/>
          <Column id="BUYA_HCIB" type="STRING" size="256"/>
          <Column id="BUYA_HCJT" type="STRING" size="256"/>
          <Column id="BUYA_HCDJ" type="STRING" size="256"/>
          <Column id="BUYA_SJIB" type="STRING" size="256"/>
          <Column id="BUYA_SJJT" type="STRING" size="256"/>
          <Column id="BUYA_SJDJ" type="STRING" size="256"/>
          <Column id="BUYA_HJIB" type="STRING" size="256"/>
          <Column id="BUYA_HJJT" type="STRING" size="256"/>
          <Column id="BUYA_HJDJ" type="STRING" size="256"/>
          <Column id="BUYA_SHIB" type="STRING" size="256"/>
          <Column id="BUYA_SHJT" type="STRING" size="256"/>
          <Column id="BUYA_SHDJ" type="STRING" size="256"/>
          <Column id="BUYA_HHIB" type="STRING" size="256"/>
          <Column id="BUYA_HHJT" type="STRING" size="256"/>
          <Column id="BUYA_HHDJ" type="STRING" size="256"/>
          <Column id="BUYA_PSUM" type="STRING" size="256"/>
          <Column id="BUYA_NSUM" type="STRING" size="256"/>
          <Column id="BUYA_PDAE" type="STRING" size="256"/>
          <Column id="BUYA_NDAE" type="STRING" size="256"/>
          <Column id="BUYA_CDAE" type="STRING" size="256"/>
          <Column id="BUYA_YCR1" type="STRING" size="256"/>
          <Column id="BUYA_YCR2" type="STRING" size="256"/>
          <Column id="BUYA_YCR3" type="STRING" size="256"/>
          <Column id="BUYA_YCR4" type="STRING" size="256"/>
          <Column id="BUYA_YCR5" type="STRING" size="256"/>
          <Column id="BUYA_YCR6" type="STRING" size="256"/>
          <Column id="BUYA_YCR7" type="STRING" size="256"/>
          <Column id="BUYA_YCR8" type="STRING" size="256"/>
          <Column id="BUYA_YCR9" type="STRING" size="256"/>
          <Column id="BUYA_CAIB" type="STRING" size="256"/>
          <Column id="BUYA_CAJT" type="STRING" size="256"/>
          <Column id="BUYA_CADJ" type="STRING" size="256"/>
          <Column id="BUYA_JKIB" type="STRING" size="256"/>
          <Column id="BUYA_JKJT" type="STRING" size="256"/>
          <Column id="BUYA_JKDJ" type="STRING" size="256"/>
          <Column id="BUYA_CHIB" type="STRING" size="256"/>
          <Column id="BUYA_CHJT" type="STRING" size="256"/>
          <Column id="BUYA_CHDJ" type="STRING" size="256"/>
          <Column id="BUYA_SCCA" type="STRING" size="256"/>
          <Column id="BUYA_SCJK" type="STRING" size="256"/>
          <Column id="BUYA_SCCH" type="STRING" size="256"/>
          <Column id="BUYA_XCAD" type="STRING" size="256"/>
          <Column id="BUYA_XJKB" type="STRING" size="256"/>
          <Column id="BUYA_XCAH" type="STRING" size="256"/>
          <Column id="BUYA_EDU3" type="STRING" size="256"/>
          <Column id="BUYA_EDU4" type="STRING" size="256"/>
          <Column id="BUYA_CADS" type="STRING" size="256"/>
          <Column id="BUYA_JKDS" type="STRING" size="256"/>
          <Column id="BUYA_CHDS" type="STRING" size="256"/>
          <Column id="BUYA_DSEO" type="STRING" size="256"/>
          <Column id="BUYA_SCHL" type="STRING" size="256"/>
          <Column id="BUYA_ZEIB" type="STRING" size="256"/>
          <Column id="BUYA_ZEJT" type="STRING" size="256"/>
          <Column id="BUYA_ZEDJ" type="STRING" size="256"/>
          <Column id="BUYA_ZEDS" type="STRING" size="256"/>
          <Column id="BUYA_HP1A" type="STRING" size="256"/>
          <Column id="BUYA_HP1B" type="STRING" size="256"/>
          <Column id="BUYA_HP1C" type="STRING" size="256"/>
          <Column id="BUYA_HP1D" type="STRING" size="256"/>
          <Column id="BUYA_HP2A" type="STRING" size="256"/>
          <Column id="BUYA_HP2B" type="STRING" size="256"/>
          <Column id="BUYA_HP2C" type="STRING" size="256"/>
          <Column id="BUYA_HP2D" type="STRING" size="256"/>
          <Column id="BUYA_CRD1_G1" type="STRING" size="256"/>
          <Column id="BUYA_CRD1_G2" type="STRING" size="256"/>
          <Column id="BUYA_CRD1_G3" type="STRING" size="256"/>
          <Column id="BUYA_DIR1_G1" type="STRING" size="256"/>
          <Column id="BUYA_DIR1_G2" type="STRING" size="256"/>
          <Column id="BUYA_DIR1_G3" type="STRING" size="256"/>
          <Column id="BUYA_CSH1_G1" type="STRING" size="256"/>
          <Column id="BUYA_CSH1_G2" type="STRING" size="256"/>
          <Column id="BUYA_CSH1_G3" type="STRING" size="256"/>
          <Column id="BUYA_MARK_G1" type="STRING" size="256"/>
          <Column id="BUYA_MARK_G2" type="STRING" size="256"/>
          <Column id="BUYA_MARK_G3" type="STRING" size="256"/>
          <Column id="BUYA_PUBL_G1" type="STRING" size="256"/>
          <Column id="BUYA_PUBL_G2" type="STRING" size="256"/>
          <Column id="BUYA_PUBL_G3" type="STRING" size="256"/>
          <Column id="BUYA_DSEO_G1" type="STRING" size="256"/>
          <Column id="BUYA_DSEO_G2" type="STRING" size="256"/>
          <Column id="BUYA_DSEO_G3" type="STRING" size="256"/>
          <Column id="BUYA_CAIB_G1" type="STRING" size="256"/>
          <Column id="BUYA_CAIB_G2" type="STRING" size="256"/>
          <Column id="BUYA_CAIB_G3" type="STRING" size="256"/>
          <Column id="BUYA_CAJT_G1" type="STRING" size="256"/>
          <Column id="BUYA_CAJT_G2" type="STRING" size="256"/>
          <Column id="BUYA_CAJT_G3" type="STRING" size="256"/>
          <Column id="BUYA_CADJ_G1" type="STRING" size="256"/>
          <Column id="BUYA_CADJ_G2" type="STRING" size="256"/>
          <Column id="BUYA_CADJ_G3" type="STRING" size="256"/>
          <Column id="BUYA_CADS_G1" type="STRING" size="256"/>
          <Column id="BUYA_CADS_G2" type="STRING" size="256"/>
          <Column id="BUYA_CADS_G3" type="STRING" size="256"/>
          <Column id="BUYA_JKIB_G1" type="STRING" size="256"/>
          <Column id="BUYA_JKIB_G2" type="STRING" size="256"/>
          <Column id="BUYA_JKIB_G3" type="STRING" size="256"/>
          <Column id="BUYA_JKJT_G1" type="STRING" size="256"/>
          <Column id="BUYA_JKJT_G2" type="STRING" size="256"/>
          <Column id="BUYA_JKJT_G3" type="STRING" size="256"/>
          <Column id="BUYA_JKDJ_G1" type="STRING" size="256"/>
          <Column id="BUYA_JKDJ_G2" type="STRING" size="256"/>
          <Column id="BUYA_JKDJ_G3" type="STRING" size="256"/>
          <Column id="BUYA_JKDS_G1" type="STRING" size="256"/>
          <Column id="BUYA_JKDS_G2" type="STRING" size="256"/>
          <Column id="BUYA_JKDS_G3" type="STRING" size="256"/>
          <Column id="BUYA_CHIB_G1" type="STRING" size="256"/>
          <Column id="BUYA_CHIB_G2" type="STRING" size="256"/>
          <Column id="BUYA_CHIB_G3" type="STRING" size="256"/>
          <Column id="BUYA_CHJT_G1" type="STRING" size="256"/>
          <Column id="BUYA_CHJT_G2" type="STRING" size="256"/>
          <Column id="BUYA_CHJT_G3" type="STRING" size="256"/>
          <Column id="BUYA_CHDJ_G1" type="STRING" size="256"/>
          <Column id="BUYA_CHDJ_G2" type="STRING" size="256"/>
          <Column id="BUYA_CHDJ_G3" type="STRING" size="256"/>
          <Column id="BUYA_CHDS_G1" type="STRING" size="256"/>
          <Column id="BUYA_CHDS_G2" type="STRING" size="256"/>
          <Column id="BUYA_CHDS_G3" type="STRING" size="256"/>
          <Column id="BUYA_ZEIB_G1" type="STRING" size="256"/>
          <Column id="BUYA_ZEIB_G2" type="STRING" size="256"/>
          <Column id="BUYA_ZEIB_G3" type="STRING" size="256"/>
          <Column id="BUYA_ZEJT_G1" type="STRING" size="256"/>
          <Column id="BUYA_ZEJT_G2" type="STRING" size="256"/>
          <Column id="BUYA_ZEJT_G3" type="STRING" size="256"/>
          <Column id="BUYA_ZEDJ_G1" type="STRING" size="256"/>
          <Column id="BUYA_ZEDJ_G2" type="STRING" size="256"/>
          <Column id="BUYA_ZEDJ_G3" type="STRING" size="256"/>
          <Column id="BUYA_ZEDS_G1" type="STRING" size="256"/>
          <Column id="BUYA_ZEDS_G2" type="STRING" size="256"/>
          <Column id="BUYA_ZEDS_G3" type="STRING" size="256"/>
          <Column id="BUYA_AD20" type="STRING" size="256"/>
          <Column id="BUYA_AD21" type="STRING" size="256"/>
          <Column id="BUYA_CRD1_2020" type="STRING" size="256"/>
          <Column id="BUYA_DIR1_2020" type="STRING" size="256"/>
          <Column id="BUYA_CSH1_2020" type="STRING" size="256"/>
          <Column id="BUYA_ZERO_2020" type="STRING" size="256"/>
          <Column id="REGI_ID" type="STRING" size="256"/>
          <Column id="REGI_NM" type="STRING" size="256"/>
          <Column id="REGI_DT" type="STRING" size="256"/>
          <Column id="MODI_ID" type="STRING" size="256"/>
          <Column id="MODI_NM" type="STRING" size="256"/>
          <Column id="MODI_DT" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_GrdGibuGrup">
        <ColumnInfo>
          <Column id="COMP_CODE" size="5" type="STRING"/>
          <Column id="GIBU_YEAR" size="4" type="STRING"/>
          <Column id="SYST_ID" size="7" type="STRING"/>
          <Column id="GIBU_SERL" size="2" type="STRING"/>
          <Column id="GIBU_COMP" size="20" type="STRING"/>
          <Column id="GIBU_COMM" size="60" type="STRING"/>
          <Column id="GIBU_GUNS" size="5" type="BIGDECIMAL"/>
          <Column id="GIBU_GAMT" size="11" type="BIGDECIMAL"/>
          <Column id="GIBU_CODE" size="10" type="STRING"/>
          <Column id="GIBU_NUMB" size="30" type="STRING"/>
          <Column id="GIBU_RELA" size="1" type="STRING"/>
          <Column id="GIBU_JUMI" size="13" type="STRING"/>
          <Column id="GIBU_GIGA" size="1" type="STRING"/>
          <Column id="GIBU_GAM2" size="11" type="BIGDECIMAL"/>
          <Column id="GIBU_NOTE" size="20" type="STRING"/>
          <Column id="GIBU_INOT" size="1" type="STRING"/>
          <Column id="GIBU_NAME" size="40" type="STRING"/>
          <Column id="BUYA_NAME" size="40" type="STRING"/>
          <Column id="BUYA_YN" size="1" type="STRING"/>
          <Column id="REGI_EMST" size="256" type="STRING"/>
          <Column id="REGI_ID" type="STRING" size="256"/>
          <Column id="s_chk" type="STRING" size="256"/>
          <Column id="crudType" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_GrdBuya" cancolumnchange="ds_GrdBuya_cancolumnchange" oncolumnchanged="ds_GrdBuya_oncolumnchanged">
        <ColumnInfo>
          <Column id="COMM_CD" size="5" type="STRING"/>
          <Column id="BUYA_YEAR" size="4" type="STRING"/>
          <Column id="SYST_ID" size="7" type="STRING"/>
          <Column id="BUYA_JUMI" size="13" type="STRING"/>
          <Column id="BUYA_NAME" size="20" type="STRING"/>
          <Column id="BUYA_RELA" size="1" type="STRING"/>
          <Column id="BUYA_GIBO" size="1" type="STRING"/>
          <Column id="BUYA_JANG" size="1" type="STRING"/>
          <Column id="BUYA_YANG" size="1" type="STRING"/>
          <Column id="BUYA_BOHE" size="1" type="STRING"/>
          <Column id="BUYA_HSPT" size="1" type="STRING"/>
          <Column id="BUYA_EDUC" size="1" type="STRING"/>
          <Column id="BUYA_CRED" size="1" type="STRING"/>
          <Column id="BUYA_INOT" size="1" type="STRING"/>
          <Column id="BUYA_NOIN" size="1" type="STRING"/>
          <Column id="BUYA_BOH1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_HSP1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_EDU1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CRD1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CSH1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_GIB1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_DIR1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_BOH2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_HSP2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_EDU2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CRD2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_GIB2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CRD3" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_MCHD" size="1" type="STRING"/>
          <Column id="BUYA_SCHL" size="1" type="STRING"/>
          <Column id="BUYA_CHIP" size="1" type="STRING"/>
          <Column id="BUYA_BUIN" size="1" type="STRING"/>
          <Column id="BUYA_BOGB" size="4" type="STRING"/>
          <Column id="BUYA_BOH3" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_EDGB" size="4" type="STRING"/>
          <Column id="BUYA_SEID" size="1" type="STRING"/>
          <Column id="BUYA_AG20" size="1" type="STRING"/>
          <Column id="BUYA_AG60" size="1" type="STRING"/>
          <Column id="BUYA_WIFE" size="1" type="STRING"/>
          <Column id="BUYA_AG65" size="1" type="STRING"/>
          <Column id="BUYA_BOH4" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_BOH5" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_BOH6" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_BOH7" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_AG6" size="1" type="STRING"/>
          <Column id="BUYA_MARK" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_HANB" size="1" type="STRING"/>
          <Column id="BUYA_PUBL" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_DSEO" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CAIB" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CAJT" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CADJ" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CADS" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_JKIB" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_JKJT" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_JKDJ" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_JKDS" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CHIB" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CHJT" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CHDJ" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CHDS" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_SCCA" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_SCJK" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_SCCH" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_XCAD" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_XJKB" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_XCAH" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_EDU3" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_EDU4" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_EDU5" type="BIGDECIMAL" size="11"/>
          <Column id="BUYA_ZEIB" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_ZEJT" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_ZEDJ" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_ZEDS" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CRD1_G1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CRD1_G2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CRD1_G3" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_DIR1_G1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_DIR1_G2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_DIR1_G3" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CSH1_G1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CSH1_G2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CSH1_G3" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_MARK_G1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_MARK_G2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_MARK_G3" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_PUBL_G1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_PUBL_G2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_PUBL_G3" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_DSEO_G1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_DSEO_G2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_DSEO_G3" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_ZEIB_G1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_ZEIB_G2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_ZEIB_G3" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CAIB_G1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CAIB_G2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CAIB_G3" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CAJT_G1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CAJT_G2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CAJT_G3" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CADJ_G1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CADJ_G2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CADJ_G3" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CADS_G1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CADS_G2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CADS_G3" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_JKIB_G1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_JKIB_G2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_JKIB_G3" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_JKJT_G1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_JKJT_G2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_JKJT_G3" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_JKDJ_G1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_JKDJ_G2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_JKDJ_G3" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_JKDS_G1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_JKDS_G2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_JKDS_G3" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CHIB_G1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CHIB_G2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CHIB_G3" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CHJT_G1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CHJT_G2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CHJT_G3" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CHDJ_G1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CHDJ_G2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CHDJ_G3" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CHDS_G1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CHDS_G2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CHDS_G3" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_ZEJT_G1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_ZEJT_G2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_ZEJT_G3" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_ZEDJ_G1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_ZEDJ_G2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_ZEDJ_G3" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_ZEDS_G1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_ZEDS_G2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_ZEDS_G3" size="11" type="BIGDECIMAL"/>
          <Column id="s_chk" type="STRING" size="256"/>
          <Column id="crudType" type="STRING" size="256"/>
          <Column id="BUYA_CADJ_G4" type="BIGDECIMAL" size="11"/>
          <Column id="BUYA_CADJ_G5" type="BIGDECIMAL" size="11"/>
          <Column id="BUYA_JKDJ_G4" type="BIGDECIMAL" size="11"/>
          <Column id="BUYA_JKDJ_G5" type="BIGDECIMAL" size="11"/>
          <Column id="BUYA_CHDJ_G4" type="BIGDECIMAL" size="11"/>
          <Column id="BUYA_CHDJ_G5" type="BIGDECIMAL" size="11"/>
          <Column id="BUYA_ZEDJ_G4" type="BIGDECIMAL" size="11"/>
          <Column id="BUYA_ZEDJ_G5" type="BIGDECIMAL" size="11"/>
          <Column id="BUYA_CADJ4" type="BIGDECIMAL" size="11"/>
          <Column id="BUYA_CADJ5" type="BIGDECIMAL" size="11"/>
          <Column id="BUYA_JKDJ4" type="BIGDECIMAL" size="11"/>
          <Column id="BUYA_JKDJ5" type="BIGDECIMAL" size="11"/>
          <Column id="BUYA_CHDJ4" type="BIGDECIMAL" size="11"/>
          <Column id="BUYA_CHDJ5" type="BIGDECIMAL" size="11"/>
          <Column id="BUYA_ZEDJ4" type="BIGDECIMAL" size="11"/>
          <Column id="BUYA_ZEDJ5" type="BIGDECIMAL" size="11"/>
          <Column id="BUYA_ZEH1" type="BIGDECIMAL" size="256"/>
          <Column id="BUYA_SZDJ" type="BIGDECIMAL" size="256"/>
          <Column id="BUYA_HZDJ" type="BIGDECIMAL" size="256"/>
          <Column id="BUYA_XTRA" type="BIGDECIMAL" size="256"/>
          <Column id="BUYA_NTRA" type="BIGDECIMAL" size="256"/>
          <Column id="BUYA_SZIB" type="BIGDECIMAL" size="256"/>
          <Column id="BUYA_HZIB" type="BIGDECIMAL" size="256"/>
          <Column id="BUYA_SZJT" type="BIGDECIMAL" size="256"/>
          <Column id="BUYA_HZJT" type="BIGDECIMAL" size="256"/>
          <Column id="BUYA_SZDS" type="BIGDECIMAL" size="256"/>
          <Column id="BUYA_HZDS" type="BIGDECIMAL" size="256"/>
          <Column id="BUYA_SCDS" type="BIGDECIMAL" size="256"/>
          <Column id="BUYA_HCDS" type="BIGDECIMAL" size="256"/>
          <Column id="BUYA_SJDS" type="BIGDECIMAL" size="256"/>
          <Column id="BUYA_HJDS" type="BIGDECIMAL" size="256"/>
          <Column id="BUYA_SHDS" type="BIGDECIMAL" size="256"/>
          <Column id="BUYA_HHDS" type="BIGDECIMAL" size="256"/>
          <Column id="BUYA_AD20" type="BIGDECIMAL" size="256"/>
          <Column id="BUYA_AD21" type="BIGDECIMAL" size="256"/>
          <Column id="BUYA_CRD1_2020" type="BIGDECIMAL" size="256"/>
          <Column id="BUYA_DIR1_2020" type="BIGDECIMAL" size="256"/>
          <Column id="BUYA_CSH1_2020" type="BIGDECIMAL" size="256"/>
          <Column id="BUYA_ZERO_2020" type="BIGDECIMAL" size="256"/>
          <Column id="BUYA_XHTR" type="BIGDECIMAL" size="256"/>
          <Column id="BUYA_NHTR" type="BIGDECIMAL" size="256"/>
          <Column id="BUYA_XJTR" type="BIGDECIMAL" size="256"/>
          <Column id="BUYA_NJTR" type="BIGDECIMAL" size="256"/>
          <Column id="BUYA_XZTR" type="BIGDECIMAL" size="256"/>
          <Column id="BUYA_NZTR" type="BIGDECIMAL" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_SaveBuya" oncolumnchanged="dataSet_oncolumnchanged">
        <ColumnInfo>
          <Column id="COMM_CD" type="STRING" size="256"/>
          <Column id="BUYA_YEAR" type="STRING" size="256"/>
          <Column id="SYST_ID" type="STRING" size="256"/>
          <Column id="BUYA_JUMI" type="STRING" size="256"/>
          <Column id="BUYA_NAME" type="STRING" size="256"/>
          <Column id="BUYA_RELA" type="STRING" size="256"/>
          <Column id="BUYA_GIBO" type="STRING" size="256"/>
          <Column id="BUYA_JANG" type="STRING" size="256"/>
          <Column id="BUYA_YANG" type="STRING" size="256"/>
          <Column id="BUYA_MCHD" type="STRING" size="256"/>
          <Column id="BUYA_CHIP" type="STRING" size="256"/>
          <Column id="BUYA_BUIN" type="STRING" size="256"/>
          <Column id="BUYA_SEID" type="STRING" size="256"/>
          <Column id="BUYA_AG20" type="STRING" size="256"/>
          <Column id="BUYA_AG60" type="STRING" size="256"/>
          <Column id="BUYA_WIFE" type="STRING" size="256"/>
          <Column id="BUYA_NOIN" type="STRING" size="256"/>
          <Column id="BUYA_BOHE" type="STRING" size="256"/>
          <Column id="BUYA_HSPT" type="STRING" size="256"/>
          <Column id="BUYA_EDUC" type="STRING" size="256"/>
          <Column id="BUYA_CRED" type="STRING" size="256"/>
          <Column id="BUYA_INOT" type="STRING" size="256"/>
          <Column id="BUYA_MARK" type="STRING" size="256"/>
          <Column id="BUYA_BOH1" type="STRING" size="256"/>
          <Column id="BUYA_HSP1" type="STRING" size="256"/>
          <Column id="BUYA_EDU1" type="STRING" size="256"/>
          <Column id="BUYA_CRD1" type="STRING" size="256"/>
          <Column id="BUYA_CSH1" type="STRING" size="256"/>
          <Column id="BUYA_GIB1" type="STRING" size="256"/>
          <Column id="BUYA_BOH3" type="STRING" size="256"/>
          <Column id="BUYA_DIR1" type="STRING" size="256"/>
          <Column id="BUYA_BOH4" type="STRING" size="256"/>
          <Column id="BUYA_CRD3" type="STRING" size="256"/>
          <Column id="BUYA_BOH5" type="STRING" size="256"/>
          <Column id="BUYA_BOH2" type="STRING" size="256"/>
          <Column id="BUYA_HSP2" type="STRING" size="256"/>
          <Column id="BUYA_EDU2" type="STRING" size="256"/>
          <Column id="BUYA_CRD2" type="STRING" size="256"/>
          <Column id="BUYA_GIB2" type="STRING" size="256"/>
          <Column id="BUYA_BOGB" type="STRING" size="256"/>
          <Column id="BUYA_EDGB" type="STRING" size="256"/>
          <Column id="BUYA_BOH6" type="STRING" size="256"/>
          <Column id="BUYA_BOH7" type="STRING" size="256"/>
          <Column id="BUYA_HANB" type="STRING" size="256"/>
          <Column id="BUYA_PUBL" type="STRING" size="256"/>
          <Column id="BUYA_XCR1" type="STRING" size="256"/>
          <Column id="BUYA_XCR2" type="STRING" size="256"/>
          <Column id="BUYA_XCR3" type="STRING" size="256"/>
          <Column id="BUYA_XCR4" type="STRING" size="256"/>
          <Column id="BUYA_XCR5" type="STRING" size="256"/>
          <Column id="BUYA_XCR6" type="STRING" size="256"/>
          <Column id="BUYA_XCR7" type="STRING" size="256"/>
          <Column id="BUYA_XCR8" type="STRING" size="256"/>
          <Column id="BUYA_XCR9" type="STRING" size="256"/>
          <Column id="BUYA_SCIB" type="STRING" size="256"/>
          <Column id="BUYA_SCJT" type="STRING" size="256"/>
          <Column id="BUYA_SCDJ" type="STRING" size="256"/>
          <Column id="BUYA_HCIB" type="STRING" size="256"/>
          <Column id="BUYA_HCJT" type="STRING" size="256"/>
          <Column id="BUYA_HCDJ" type="STRING" size="256"/>
          <Column id="BUYA_SJIB" type="STRING" size="256"/>
          <Column id="BUYA_SJJT" type="STRING" size="256"/>
          <Column id="BUYA_SJDJ" type="STRING" size="256"/>
          <Column id="BUYA_HJIB" type="STRING" size="256"/>
          <Column id="BUYA_HJJT" type="STRING" size="256"/>
          <Column id="BUYA_HJDJ" type="STRING" size="256"/>
          <Column id="BUYA_SHIB" type="STRING" size="256"/>
          <Column id="BUYA_SHJT" type="STRING" size="256"/>
          <Column id="BUYA_SHDJ" type="STRING" size="256"/>
          <Column id="BUYA_HHIB" type="STRING" size="256"/>
          <Column id="BUYA_HHJT" type="STRING" size="256"/>
          <Column id="BUYA_HHDJ" type="STRING" size="256"/>
          <Column id="BUYA_PSUM" type="STRING" size="256"/>
          <Column id="BUYA_NSUM" type="STRING" size="256"/>
          <Column id="BUYA_PDAE" type="STRING" size="256"/>
          <Column id="BUYA_NDAE" type="STRING" size="256"/>
          <Column id="BUYA_CDAE" type="STRING" size="256"/>
          <Column id="BUYA_YCR1" type="STRING" size="256"/>
          <Column id="BUYA_YCR2" type="STRING" size="256"/>
          <Column id="BUYA_YCR3" type="STRING" size="256"/>
          <Column id="BUYA_YCR4" type="STRING" size="256"/>
          <Column id="BUYA_YCR5" type="STRING" size="256"/>
          <Column id="BUYA_YCR6" type="STRING" size="256"/>
          <Column id="BUYA_YCR7" type="STRING" size="256"/>
          <Column id="BUYA_YCR8" type="STRING" size="256"/>
          <Column id="BUYA_YCR9" type="STRING" size="256"/>
          <Column id="BUYA_CAIB" type="STRING" size="256"/>
          <Column id="BUYA_CAJT" type="STRING" size="256"/>
          <Column id="BUYA_CADJ" type="STRING" size="256"/>
          <Column id="BUYA_JKIB" type="STRING" size="256"/>
          <Column id="BUYA_JKJT" type="STRING" size="256"/>
          <Column id="BUYA_JKDJ" type="STRING" size="256"/>
          <Column id="BUYA_CHIB" type="STRING" size="256"/>
          <Column id="BUYA_CHJT" type="STRING" size="256"/>
          <Column id="BUYA_CHDJ" type="STRING" size="256"/>
          <Column id="BUYA_SCCA" type="STRING" size="256"/>
          <Column id="BUYA_SCJK" type="STRING" size="256"/>
          <Column id="BUYA_SCCH" type="STRING" size="256"/>
          <Column id="BUYA_XCAD" type="STRING" size="256"/>
          <Column id="BUYA_XJKB" type="STRING" size="256"/>
          <Column id="BUYA_XCAH" type="STRING" size="256"/>
          <Column id="BUYA_EDU3" type="STRING" size="256"/>
          <Column id="BUYA_EDU4" type="STRING" size="256"/>
          <Column id="BUYA_CADS" type="STRING" size="256"/>
          <Column id="BUYA_EDU5" type="STRING" size="256"/>
          <Column id="BUYA_JKDS" type="STRING" size="256"/>
          <Column id="BUYA_CHDS" type="STRING" size="256"/>
          <Column id="BUYA_DSEO" type="STRING" size="256"/>
          <Column id="BUYA_SCHL" type="STRING" size="256"/>
          <Column id="BUYA_ZEIB" type="STRING" size="256"/>
          <Column id="BUYA_ZEJT" type="STRING" size="256"/>
          <Column id="BUYA_ZEDJ" type="STRING" size="256"/>
          <Column id="BUYA_ZEDS" type="STRING" size="256"/>
          <Column id="BUYA_HP1A" type="STRING" size="256"/>
          <Column id="BUYA_HP1B" type="STRING" size="256"/>
          <Column id="BUYA_HP1C" type="STRING" size="256"/>
          <Column id="BUYA_HP1D" type="STRING" size="256"/>
          <Column id="BUYA_HP1E" type="STRING" size="256"/>
          <Column id="BUYA_HP2A" type="STRING" size="256"/>
          <Column id="BUYA_HP2B" type="STRING" size="256"/>
          <Column id="BUYA_HP2C" type="STRING" size="256"/>
          <Column id="BUYA_HP2D" type="STRING" size="256"/>
          <Column id="BUYA_HP2E" type="STRING" size="256"/>
          <Column id="BUYA_CRD1_G1" type="STRING" size="256"/>
          <Column id="BUYA_CRD1_G2" type="STRING" size="256"/>
          <Column id="BUYA_CRD1_G3" type="STRING" size="256"/>
          <Column id="BUYA_DIR1_G1" type="STRING" size="256"/>
          <Column id="BUYA_DIR1_G2" type="STRING" size="256"/>
          <Column id="BUYA_DIR1_G3" type="STRING" size="256"/>
          <Column id="BUYA_CSH1_G1" type="STRING" size="256"/>
          <Column id="BUYA_CSH1_G2" type="STRING" size="256"/>
          <Column id="BUYA_CSH1_G3" type="STRING" size="256"/>
          <Column id="BUYA_MARK_G1" type="STRING" size="256"/>
          <Column id="BUYA_MARK_G2" type="STRING" size="256"/>
          <Column id="BUYA_MARK_G3" type="STRING" size="256"/>
          <Column id="BUYA_PUBL_G1" type="STRING" size="256"/>
          <Column id="BUYA_PUBL_G2" type="STRING" size="256"/>
          <Column id="BUYA_PUBL_G3" type="STRING" size="256"/>
          <Column id="BUYA_DSEO_G1" type="STRING" size="256"/>
          <Column id="BUYA_DSEO_G2" type="STRING" size="256"/>
          <Column id="BUYA_DSEO_G3" type="STRING" size="256"/>
          <Column id="BUYA_CAIB_G1" type="STRING" size="256"/>
          <Column id="BUYA_CAIB_G2" type="STRING" size="256"/>
          <Column id="BUYA_CAIB_G3" type="STRING" size="256"/>
          <Column id="BUYA_CAJT_G1" type="STRING" size="256"/>
          <Column id="BUYA_CAJT_G2" type="STRING" size="256"/>
          <Column id="BUYA_CAJT_G3" type="STRING" size="256"/>
          <Column id="BUYA_CADJ_G1" type="STRING" size="256"/>
          <Column id="BUYA_CADJ_G2" type="STRING" size="256"/>
          <Column id="BUYA_CADJ_G3" type="STRING" size="256"/>
          <Column id="BUYA_CADS_G1" type="STRING" size="256"/>
          <Column id="BUYA_CADS_G2" type="STRING" size="256"/>
          <Column id="BUYA_CADS_G3" type="STRING" size="256"/>
          <Column id="BUYA_JKIB_G1" type="STRING" size="256"/>
          <Column id="BUYA_JKIB_G2" type="STRING" size="256"/>
          <Column id="BUYA_JKIB_G3" type="STRING" size="256"/>
          <Column id="BUYA_JKJT_G1" type="STRING" size="256"/>
          <Column id="BUYA_JKJT_G2" type="STRING" size="256"/>
          <Column id="BUYA_JKJT_G3" type="STRING" size="256"/>
          <Column id="BUYA_JKDJ_G1" type="STRING" size="256"/>
          <Column id="BUYA_JKDJ_G2" type="STRING" size="256"/>
          <Column id="BUYA_JKDJ_G3" type="STRING" size="256"/>
          <Column id="BUYA_JKDS_G1" type="STRING" size="256"/>
          <Column id="BUYA_JKDS_G2" type="STRING" size="256"/>
          <Column id="BUYA_JKDS_G3" type="STRING" size="256"/>
          <Column id="BUYA_CHIB_G1" type="STRING" size="256"/>
          <Column id="BUYA_CHIB_G2" type="STRING" size="256"/>
          <Column id="BUYA_CHIB_G3" type="STRING" size="256"/>
          <Column id="BUYA_CHJT_G1" type="STRING" size="256"/>
          <Column id="BUYA_CHJT_G2" type="STRING" size="256"/>
          <Column id="BUYA_CHJT_G3" type="STRING" size="256"/>
          <Column id="BUYA_CHDJ_G1" type="STRING" size="256"/>
          <Column id="BUYA_CHDJ_G2" type="STRING" size="256"/>
          <Column id="BUYA_CHDJ_G3" type="STRING" size="256"/>
          <Column id="BUYA_CHDS_G1" type="STRING" size="256"/>
          <Column id="BUYA_CHDS_G2" type="STRING" size="256"/>
          <Column id="BUYA_CHDS_G3" type="STRING" size="256"/>
          <Column id="BUYA_ZEIB_G1" type="STRING" size="256"/>
          <Column id="BUYA_ZEIB_G2" type="STRING" size="256"/>
          <Column id="BUYA_ZEIB_G3" type="STRING" size="256"/>
          <Column id="BUYA_ZEJT_G1" type="STRING" size="256"/>
          <Column id="BUYA_ZEJT_G2" type="STRING" size="256"/>
          <Column id="BUYA_ZEJT_G3" type="STRING" size="256"/>
          <Column id="BUYA_ZEDJ_G1" type="STRING" size="256"/>
          <Column id="BUYA_ZEDJ_G2" type="STRING" size="256"/>
          <Column id="BUYA_ZEDJ_G3" type="STRING" size="256"/>
          <Column id="BUYA_ZEDS_G1" type="STRING" size="256"/>
          <Column id="BUYA_ZEDS_G2" type="STRING" size="256"/>
          <Column id="BUYA_ZEDS_G3" type="STRING" size="256"/>
          <Column id="BUYA_AD20" type="STRING" size="256"/>
          <Column id="BUYA_AD21" type="STRING" size="256"/>
          <Column id="BUYA_CRD1_2020" type="STRING" size="256"/>
          <Column id="BUYA_DIR1_2020" type="STRING" size="256"/>
          <Column id="BUYA_CSH1_2020" type="STRING" size="256"/>
          <Column id="BUYA_ZERO_2020" type="STRING" size="256"/>
          <Column id="REGI_ID" type="STRING" size="256"/>
          <Column id="REGI_NM" type="STRING" size="256"/>
          <Column id="REGI_DT" type="STRING" size="256"/>
          <Column id="MODI_ID" type="STRING" size="256"/>
          <Column id="MODI_NM" type="STRING" size="256"/>
          <Column id="MODI_DT" type="STRING" size="256"/>
          <Column id="crudType" type="STRING" size="256"/>
          <Column id="BUYA_CADJ_01" type="STRING" size="256"/>
          <Column id="BUYA_JKDJ_01" type="STRING" size="256"/>
          <Column id="BUYA_CHJT_01" type="STRING" size="256"/>
          <Column id="BUYA_ZEDJ_01" type="STRING" size="256"/>
        </ColumnInfo>
        <Contents>
          <Column id="COMP_CODE" size="5" type="STRING"/>
          <Column id="BUYA_YEAR" size="4" type="STRING"/>
          <Column id="EMST_CODE" size="7" type="STRING"/>
          <Column id="BUYA_JUMI" size="13" type="STRING"/>
          <Column id="BUYA_NAME" size="20" type="STRING"/>
          <Column id="BUYA_RELA" size="1" type="STRING"/>
          <Column id="BUYA_GIBO" size="1" type="STRING"/>
          <Column id="BUYA_JANG" size="1" type="STRING"/>
          <Column id="BUYA_YANG" size="1" type="STRING"/>
          <Column id="BUYA_BOHE" size="1" type="STRING"/>
          <Column id="BUYA_HSPT" size="1" type="STRING"/>
          <Column id="BUYA_EDUC" size="1" type="STRING"/>
          <Column id="BUYA_CRED" size="1" type="STRING"/>
          <Column id="BUYA_INOT" size="1" type="STRING"/>
          <Column id="BUYA_NOIN" size="1" type="STRING"/>
          <Column id="BUYA_BOH1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_HSP1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_EDU1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CRD1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CSH1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_GIB1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_DIR1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_BOH2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_HSP2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_EDU2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CRD2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_GIB2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CRD3" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_MCHD" size="1" type="STRING"/>
          <Column id="BUYA_CHIP" size="1" type="STRING"/>
          <Column id="BUYA_BUIN" size="1" type="STRING"/>
          <Column id="BUYA_BOGB" size="4" type="STRING"/>
          <Column id="BUYA_BOH3" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_EDGB" size="4" type="STRING"/>
          <Column id="BUYA_SEID" size="1" type="STRING"/>
          <Column id="BUYA_AG20" size="1" type="STRING"/>
          <Column id="BUYA_AG60" size="1" type="STRING"/>
          <Column id="BUYA_WIFE" size="1" type="STRING"/>
          <Column id="BUYA_AG65" size="1" type="STRING"/>
          <Column id="BUYA_BOH4" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_BOH5" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_BOH6" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_BOH7" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_AG6" size="1" type="STRING"/>
          <Column id="BUYA_MARK" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_HANB" size="1" type="STRING"/>
          <Column id="BUYA_PUBL" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_DSEO" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_XCR1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_XCR2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_XCR3" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_XCR4" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_XCR5" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_XCR6" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_XCR7" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_XCR8" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_XCR9" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_YCR1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_YCR2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_YCR3" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_YCR4" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_YCR5" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_YCR6" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_YCR7" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_YCR8" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_YCR9" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CAIB" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CAJT" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CADJ" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CADS" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_JKIB" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_JKJT" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_JKDJ" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_JKDS" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CHIB" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CHJT" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CHDJ" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CHDS" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_SCCA" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_SCJK" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_SCCH" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_XCAD" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_XJKB" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_XCAH" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_EDU3" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_EDU4" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_ZEIB" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_ZEJT" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_ZEDJ" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_ZEDS" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_HP1A" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_HP1B" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_HP1C" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_HP1D" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_HP2A" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_HP2B" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_HP2C" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_HP2D" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CRD1_G1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CRD1_G2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CRD1_G3" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_DIR1_G1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_DIR1_G2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_DIR1_G3" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CSH1_G1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CSH1_G2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CSH1_G3" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_MARK_G1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_MARK_G2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_MARK_G3" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_PUBL_G1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_PUBL_G2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_PUBL_G3" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_DSEO_G1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_DSEO_G2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_DSEO_G3" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_ZEIB_G1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_ZEIB_G2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_ZEIB_G3" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CAIB_G1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CAIB_G2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CAIB_G3" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CAJT_G1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CAJT_G2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CAJT_G3" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CADJ_G1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CADJ_G2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CADJ_G3" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CADS_G1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CADS_G2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CADS_G3" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_JKIB_G1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_JKIB_G2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_JKIB_G3" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_JKJT_G1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_JKJT_G2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_JKJT_G3" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_JKDJ_G1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_JKDJ_G2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_JKDJ_G3" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_JKDS_G1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_JKDS_G2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_JKDS_G3" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CHIB_G1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CHIB_G2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CHIB_G3" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CHJT_G1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CHJT_G2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CHJT_G3" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CHDJ_G1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CHDJ_G2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CHDJ_G3" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CHDS_G1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CHDS_G2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_CHDS_G3" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_ZEJT_G1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_ZEJT_G2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_ZEJT_G3" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_ZEDJ_G1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_ZEDJ_G2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_ZEDJ_G3" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_ZEDS_G1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_ZEDS_G2" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_ZEDS_G3" size="11" type="BIGDECIMAL"/>
        </Contents>
      </Dataset>
      <Dataset id="ds_GrdJsba" oncolumnchanged="ds_GrdJsba_oncolumnchanged">
        <ColumnInfo>
          <Column id="COMP_CODE" size="5" type="STRING"/>
          <Column id="JSBA_GUBN" size="10" type="STRING"/>
          <Column id="JSBA_YEAR" size="4" type="STRING"/>
          <Column id="EMST_CODE" size="7" type="STRING"/>
          <Column id="JSBA_IG01" size="1" type="STRING"/>
          <Column id="JSBA_IG02" size="3" type="BIGDECIMAL"/>
          <Column id="JSBA_IG03" size="3" type="BIGDECIMAL"/>
          <Column id="JSBA_IG04" size="3" type="BIGDECIMAL"/>
          <Column id="JSBA_IG05" size="3" type="BIGDECIMAL"/>
          <Column id="JSBA_IG06" size="3" type="BIGDECIMAL"/>
          <Column id="JSBA_IG07" size="1" type="STRING"/>
          <Column id="JSBA_IG08" size="3" type="BIGDECIMAL"/>
          <Column id="JSBA_TG01" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_TG02" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_TG03" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_TG04" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_TG05" size="1" type="STRING"/>
          <Column id="JSBA_TG06" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_TG07" size="1" type="STRING"/>
          <Column id="JSBA_TG08" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_TG09" size="1" type="STRING"/>
          <Column id="JSBA_TG10" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_TG11" size="1" type="STRING"/>
          <Column id="JSBA_TG12" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_TG13" size="1" type="STRING"/>
          <Column id="JSBA_TG14" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_TG15" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_TG16" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_TG17" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_TG18" size="8" type="STRING"/>
          <Column id="JSBA_TG19" size="8" type="STRING"/>
          <Column id="JSBA_TG20" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_TG21" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_GG01" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_GG02" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_GG03" size="1" type="STRING"/>
          <Column id="JSBA_GG04" size="3" type="BIGDECIMAL"/>
          <Column id="JSBA_GG05" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_GG06" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_GG07" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_SG01" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_SG02" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_SG03" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_SG04" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_SG05" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_GT01" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_GT02" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_TG22" size="20" type="STRING"/>
          <Column id="JSBA_TG23" size="8" type="STRING"/>
          <Column id="JSBA_GG08" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_GG09" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_SG06" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_SG07" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_TG24" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_TG25" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_GG10" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_GG11" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_GG12" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_GG13" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_TG26" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_TG27" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_TG28" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_TG29" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_IG09" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_IG10" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_TG30" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_TG31" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_TG32" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_TG33" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_SG08" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_IG11" size="3" type="BIGDECIMAL"/>
          <Column id="JSBA_TG34" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_TG35" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_IG12" size="3" type="BIGDECIMAL"/>
          <Column id="JSBA_TG36" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_GG14" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_GG15" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_GG16" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_GG17" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_GG18" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_GG19" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_GG20" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_TG37" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_TG38" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_TG39" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_SG09" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_SG10" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_GG21" size="3" type="BIGDECIMAL"/>
          <Column id="JSBA_GG22" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_TG40" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_TG41" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_TG42" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_TG43" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_TG44" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_TG45" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_TG46" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_TG47" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_TG48" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_TG49" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_TG50" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_TG51" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_TG52" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_GG23" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_SG11" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_SG12" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_SG13" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_GG25" size="256" type="STRING"/>
          <Column id="JSBA_GG26" size="256" type="STRING"/>
          <Column id="JSBA_GG27" size="256" type="STRING"/>
          <Column id="JSBA_GG28" size="256" type="STRING"/>
          <Column id="JSBA_GG29" size="11" type="BIGDECIMAL"/>
          <Column id="JSBA_GG30" size="11" type="BIGDECIMAL"/>
          <Column id="JSBA_GG31" size="11" type="BIGDECIMAL"/>
          <Column id="JSBA_GG32" size="11" type="BIGDECIMAL"/>
          <Column id="JSBA_GG36" size="11" type="BIGDECIMAL"/>
          <Column id="JSBA_GG37" size="11" type="BIGDECIMAL"/>
          <Column id="JSBA_GG38" size="11" type="BIGDECIMAL"/>
          <Column id="JSBA_GG39" size="11" type="BIGDECIMAL"/>
          <Column id="JSBA_GG40" size="11" type="BIGDECIMAL"/>
          <Column id="JSBA_GG33" size="256" type="STRING"/>
          <Column id="JSBA_GG34" size="256" type="STRING"/>
          <Column id="JSBA_GG35" size="256" type="STRING"/>
          <Column id="JSBA_GG42" size="256" type="STRING"/>
          <Column id="JSBA_TG54" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_TG55" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_TG60" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_TG61" type="BIGDECIMAL" size="10"/>
          <Column id="JSBA_GG49" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_SG16" size="10" type="BIGDECIMAL"/>
          <Column id="JSBA_GG50" size="11" type="BIGDECIMAL"/>
          <Column id="JSBA_GG07_G1" size="11" type="BIGDECIMAL"/>
          <Column id="JSBA_GG07_G2" size="11" type="BIGDECIMAL"/>
          <Column id="JSBA_GG07_G3" size="11" type="BIGDECIMAL"/>
          <Column id="JSBA_GG22_G1" size="11" type="BIGDECIMAL"/>
          <Column id="JSBA_GG22_G2" size="11" type="BIGDECIMAL"/>
          <Column id="JSBA_GG22_G3" size="11" type="BIGDECIMAL"/>
          <Column id="JSBA_GG13_G1" size="11" type="BIGDECIMAL"/>
          <Column id="JSBA_GG13_G2" size="11" type="BIGDECIMAL"/>
          <Column id="JSBA_GG13_G3" size="11" type="BIGDECIMAL"/>
          <Column id="JSBA_GG23_G1" size="11" type="BIGDECIMAL"/>
          <Column id="JSBA_GG23_G2" size="11" type="BIGDECIMAL"/>
          <Column id="JSBA_GG23_G3" size="11" type="BIGDECIMAL"/>
          <Column id="JSBA_GG24_G1" size="11" type="BIGDECIMAL"/>
          <Column id="JSBA_GG24_G2" size="11" type="BIGDECIMAL"/>
          <Column id="JSBA_GG24_G3" size="11" type="BIGDECIMAL"/>
          <Column id="JSBA_GG49_G1" size="11" type="BIGDECIMAL"/>
          <Column id="JSBA_GG49_G2" size="11" type="BIGDECIMAL"/>
          <Column id="JSBA_GG49_G3" size="11" type="BIGDECIMAL"/>
          <Column id="JSBA_GG50_G1" size="11" type="BIGDECIMAL"/>
          <Column id="JSBA_GG50_G2" size="11" type="BIGDECIMAL"/>
          <Column id="JSBA_GG50_G3" size="11" type="BIGDECIMAL"/>
          <Column id="s_chk" type="STRING" size="256"/>
          <Column id="crudType" type="STRING" size="256"/>
          <Column id="JSBA_GG53" type="BIGDECIMAL" size="256"/>
          <Column id="JSBA_GG54" type="BIGDECIMAL" size="256"/>
          <Column id="JSBA_GG55" type="BIGDECIMAL" size="256"/>
          <Column id="JSBA_GG51" type="BIGDECIMAL" size="256"/>
          <Column id="JSBA_GG52" type="BIGDECIMAL" size="256"/>
          <Column id="JSBA_CHNG" type="BIGDECIMAL" size="256"/>
          <Column id="JSBA_TG62" type="BIGDECIMAL" size="256"/>
          <Column id="JSBA_GG56" type="STRING" size="256"/>
          <Column id="JSBA_GG57" type="STRING" size="256"/>
          <Column id="JSBA_GG58" type="STRING" size="256"/>
          <Column id="JSBA_GG59" type="STRING" size="256"/>
          <Column id="JSBA_GG60" type="STRING" size="256"/>
          <Column id="JSBA_GG61" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_GrdBuyaEd" oncolumnchanged="ds_GrdBuyaEd_oncolumnchanged" cancolumnchange="ds_GrdBuyaEd_cancolumnchange">
        <ColumnInfo>
          <Column id="COMP_CODE" size="5" type="STRING"/>
          <Column id="BUYA_YEAR" size="4" type="STRING"/>
          <Column id="SYST_ID" size="7" type="STRING"/>
          <Column id="BUYA_JUMI" size="13" type="STRING"/>
          <Column id="BUYA_EDGB" size="4" type="STRING"/>
          <Column id="BUYA_EDU1" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_EDU3" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_EDU4" size="11" type="BIGDECIMAL"/>
          <Column id="BUYA_EDU5" type="BIGDECIMAL" size="11"/>
          <Column id="s_chk" type="STRING" size="256"/>
          <Column id="crudType" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_Detail10">
        <ColumnInfo>
          <Column id="SORT_GU" type="STRING" size="256" description="조회시작일자"/>
          <Column id="COMM_CD" type="STRING" size="256" description="시스템사용자ID"/>
          <Column id="SYST_ID" type="STRING" size="256"/>
          <Column id="EMFA_SE" type="STRING" size="256"/>
          <Column id="EMPM_NM" type="STRING" size="256"/>
          <Column id="RELA_CD" type="STRING" size="256"/>
          <Column id="NATM_CD" type="STRING" size="256"/>
          <Column id="JUMN_NO" type="STRING" size="256"/>
          <Column id="BIRT_DD" type="STRING" size="256"/>
          <Column id="TOGE_YN" type="STRING" size="256"/>
          <Column id="DEPE_YN" type="STRING" size="256"/>
          <Column id="DISA_YN" type="STRING" size="256"/>
          <Column id="HOSM_YN" type="STRING" size="256"/>
          <Column id="WIFE_YN" type="STRING" size="256"/>
          <Column id="AG20_YN" type="STRING" size="256"/>
          <Column id="AG60_YN" type="STRING" size="256"/>
          <Column id="NOIN_YN" type="STRING" size="256"/>
          <Column id="MCHD_YN" type="STRING" size="256"/>
          <Column id="CHIP_YN" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Script type="xscript5.1"><![CDATA[/**
*  @화면ID   : M_HS_8390
*  @화면설명 : 개인소득공제신고
*  @시스템명 : (HR) 인사관리
*  @작성자   : 안병호
*  @작성일   : 2021.08.23
*  @Desction    
******************* 소스 수정 이력 ************************************************************
*  일자          		수정자                비고
*************************************************************************************************
*  2021.08.23     	    안병호 	           최초 생성 
*  2022.12.12     	    김순삼	           2022년 기준으로 수정
*************************************************************************************************
*/

/***********************************************************************************************
 * 0. 폼로드
 ***********************************************************************************************/
/***********************************************************************************************
 * 00.01. Form Include 선언
 ***********************************************************************************************/


/***********************************************************************************************
 * 00.02. Form 변수 선언
 ***********************************************************************************************/
this.fvComPrgmId = "";//[필수]프로그램ID-화면로드시 메뉴정보 기준으로 재설정됨.
this.fvFilePath = "temp";//파일경로(업무별)
this._vFiles_idx = 0;
this._vFiles = [];

this.fvCompCode = "";//회사코드

this.fvJsmtYear = "";	//귀속년도

this.fvConfirm = false;	//팝업확인 여부
this.strFlag   = false;
this.sSYSTID;

/***********************************************************************************************
 * 00.03. Form Onload 이벤트
 ***********************************************************************************************/
this.fn_FormOnload = function (obj:Form, e:LoadEventInfo)
{
	this.fn_FormComInit();//[공통] 화면로드시 초기 설정 함수
	this.fn_FormBizInit();//[업무] 화면로드시 초기 설정 함수 
}

/***********************************************************************************************
 * 00.04. Form [공통] 초기설정 함수 - 필수
 ***********************************************************************************************/
this.fn_FormComInit = function() 
{
	this.gfn_CommFormOnLoad(this);//[공통] 화면로드시 처리 함수(다국어등)
	this.fvComPrgmId = this.gfn_CommLoadFormPrgmId(this);//[필수]프로그램ID-메인화면기준, 팝업일경우 해당 메인화면의 프로그램ID

	//this.gfn_SetGrid(this.div_MasterView.form.tab_Master.tpg_01.form.grd_Master10);//[공통]그리드 이벤트 설정 - 출력목록
	
	
	//권한체크 할 컴포넌트 : 컴포넌트 Full Path
	var objCompCheckList = [
							   "this.div_MasterView.form.div_ComGrdBtn"
							  ,"this.div_MasterView.form.tab_Master.tpg_06.form.div_Gibu.form.div_ComGrdBtn"
							];		
	
	if (this.gfn_CommCompAuthCheck(this, objCompCheckList))
	{
		this.fvFormComBtnAuthYn = true;//그리드 공통버튼 권한 유무
	}
	
	this.fn_SetGridInputButton();//[공통] 그리드 입력 버튼 설정
	//trace(nApp.gds_UserInfo.saveXML());
	
	
	/*
	
	
	*/
}

/***********************************************************************************************
 * 00.05. Form [업무] 초기설정 함수
 ***********************************************************************************************/
this.fn_FormBizInit = function() 
{ 
	//[공통] 년도정보 설정	
	var sNowYear = this.gfn_GetCommDate("nowYear");//금년	
	//this.div_Search.form.spn_JstaYear.set_value(sNowYear-1);
	this.div_Search.form.spn_JstaYear.set_value(sNowYear);
	
	//[공통] 사원정보 설정
	var arrComp = [
					"this.div_Search.form.edt_EmpmCd^this.div_Search.form.edt_EmpmNm^this.div_Search.form.edt_SystId"
                  ];
	this.gfn_SetCommEmpmCd(this.fvComPrgmId, arrComp);
	
	//[공통] 공통코드 설정 : 공통코드|데이터셋명|초기항목추가여부(Y/N)|추가항목
	var objCondList = [
						   "PR028|ds_Pr028"			// 기부금유형
						 , "PR039|ds_Pr039"			// 연말정산 증빙구분
						 , "PR125|ds_Pr125"			// 관계
						 , "PR124|ds_Pr124"			// 교육비구분
						 , "PR126|ds_Pr126"			// 내외구분
						 //, "PR127|ds_Pr127|Y|"			// 의료증빙구분
						 , "PR127|ds_Pr127"				// 의료증빙구분
						 , "PR128|ds_Pr128|Y|"			// 소득공제구분(연금저축)
						 
						 , "PR129|ds_Pr129|Y|"			// 발령처리구분
						 , "PR130|ds_Pr130|Y|"			// 연금및저축구분(연금저축)
						 , "PR131|ds_Pr131|Y|"			// 퇴직사유
						 , "PR135|ds_Pr135"			// 기부내용
						 , "PR136|ds_Pr136|Y|"			// 기부자관계
						 
						 , "PR137|ds_Pr137|Y|"			// 연금저축납입년차
						 , "PR139|ds_Pr139|Y|"			// 장애인구분
						 , "PR143|ds_Pr143|Y|"			// 월세,거주자임차 주택유형
						 , "PR144|ds_Pr144|Y|"			// 연말정산 할부기간
					  ];
					  
	//[공통] 공통코드 설정 : 필터				  
	var objFilterList = [
						   "NA"		// 관계
						 , "NA"     // 내외구분
						 , "NA"     // 의료증빙구분
						 , "NA"     // 기부금유형
						 , "NA"     // 소득공제구분(연금저축)
						 
						 , "NA"     // 발령처리구분
						 , "NA"     // 연금및저축구분(연금저축)
						 , "NA"     // 퇴직사유
						 , "NA"     // 기부내용
						 , "NA"     // 기부자관계
						 
						 , "NA"     // 연금저축납입년차
						 , "NA"     // 장애인구분
						 , "NA"     // 월세,거주자임차 주택유형
						 , "NA"     // 연말정산 할부기간
						 , "NA"     // 연말정산 증빙구분
						 
					   ];	
					   
	//공통코드 설정함수 호출				   
	this.gfn_GetCommCode(this, objCondList, objFilterList);
	
	this.sSYSTID = this.gfn_GetSessionValue("SYST_ID");
	
	//[업무] 일반콤보조회
	this.fn_ComboSearch();
	
	this.fn_ComBtnSearch();
}

/***********************************************************************************************
 * 00.06. Form [업무] 일반콤보 조회 함수
 ***********************************************************************************************/
this.fn_ComboSearch = function() 
{

}

/***********************************************************************************************
 * 00.07. Form OnClose 이벤트
 ***********************************************************************************************/
this.fn_FormClose = function(obj:nexacro.Form,e:nexacro.CloseEventInfo)
{
	return true;
};

/***********************************************************************************************
 * 1. 조회 영역
 ***********************************************************************************************/
/***********************************************************************************************
 * 01.01. [공통버튼] 조회 버튼 클릭 이벤트
 ***********************************************************************************************/
this.fn_ComBtnSearch = function()
{ 
	this.strFlag   = false;
	//조회전 유효성 체크
	if (!this.fn_VaildSearch()) return;	
	
	this.fvJsmtYear = this.div_Search.form.spn_JstaYear.value+"";
	
	//해당년도 url을 불러온다.
	
	
	this.div_MasterView.form.tab_Master.tpg_01.form.div_Buya.set_url("hr::M_HS_8390_01_"+ this.fvJsmtYear +".xfdl");	//부양가족	
	this.div_MasterView.form.tab_Master.tpg_02.form.div_Bohm.set_url("hr::M_HS_8390_02_"+ this.fvJsmtYear +".xfdl");	//보험료
	this.div_MasterView.form.tab_Master.tpg_03.form.div_Educ.set_url("hr::M_HS_8390_03_"+ this.fvJsmtYear +".xfdl");	//교육비
	this.div_MasterView.form.tab_Master.tpg_04.form.div_Card.set_url("hr::M_HS_8390_04_"+ this.fvJsmtYear +".xfdl");	//신용카드
	this.div_MasterView.form.tab_Master.tpg_05.form.div_Hspt.set_url("hr::M_HS_8390_05_"+ this.fvJsmtYear +".xfdl");	//의료비
	this.div_MasterView.form.tab_Master.tpg_06.form.div_Gibu.set_url("hr::M_HS_8390_06_"+ this.fvJsmtYear +".xfdl");	//기부금
	this.div_MasterView.form.tab_Master.tpg_07.form.div_Hous.set_url("hr::M_HS_8390_07_"+ this.fvJsmtYear +".xfdl");	//주택자금
	
	this.div_MasterView.form.tab_Master.tpg_08.form.div_Save.set_url("hr::M_HS_8390_08_"+ this.fvJsmtYear +".xfdl");	//연금저축
	this.div_MasterView.form.tab_Master.tpg_09.form.div_Joo.set_url("hr::M_HS_8390_09_" + this.fvJsmtYear +".xfdl");		//월세/거주자간주택임차
	this.div_MasterView.form.tab_Master.tpg_10.form.div_Jsjo.set_url("hr::M_HS_8390_10_"+ this.fvJsmtYear +".xfdl");	//종전근무지
	this.div_MasterView.form.tab_Master.tpg_11.form.div_etc.set_url("hr::M_HS_8390_11_" + this.fvJsmtYear +".xfdl");		//기타
	this.div_MasterView.form.tab_Master.tpg_12.form.div_Calc.set_url("hr::M_HS_8390_12_"+ this.fvJsmtYear +".xfdl");	//연말정산	  
	
	//[업무] 데이터셋 설정 - 데이터셋 초기화, 조회조건 설정
	this.ds_Input.clearData();
	
	//[업무] 조회조건 입력
	this.ds_Input.addRow();
	this.ds_Input.setColumn(0, "BUYA_YEAR", this.div_Search.form.spn_JstaYear.value);
	this.ds_Input.setColumn(0, "SESU_ID", this.div_Search.form.edt_SystId.value);
	this.ds_Input.setColumn(0, "SYST_ID", this.div_Search.form.edt_SystId.value);

	//[공통]서비스정보 초기화
	this.gfn_InitComService(this);
	
	//[공통]서비스정보 추가
	var svcAddObj = new Object();//[공통] 서비스 추가 파라메타 정보 Object
	svcAddObj.sSelectSql = "hr:M_HS_8390_M_SL01";
	this.gfn_AddComSearchService(this, svcAddObj);
	
	//[공통]서비스 호출 변수
	var svcCallObj = new Object();//[공통] 서비스 파라메타 정보 Object
	svcCallObj.sTrid = "SRCH_LIST3";//Transaction ID 등 callback에서 넘겨 받을 String을 지정
	svcCallObj.sActionName = this.G_SV_HR;//서버에서 호출할 Action - 모듈별로 호출되는 기본 Actio이 다름 : 공통 서비스 Action 업무구분  변수 참조
	svcCallObj.sInputDaset = "ds_Input=ds_Input" //입력 데이터셋
	svcCallObj.sOutDatset = "ds_Dryn=ds_Dryn";//출력 데이터셋
	svcCallObj.sOtherArg = "";//서버로 전송할 기타 Argument 정보 문자열, 예) key=value key2=value2
	svcCallObj.sCallBackFnc = "fn_Callback";//서버에서 처리가 완료된 후 Callback 받을 Function 명
	svcCallObj.sComBtnDst = "SEARCH";//공통버튼구분-조회버튼
	svcCallObj.sPrgmId = this.fvComPrgmId;//프로그램ID

	//[공통]서비스 호출
	this.gfn_CallComService(this, svcCallObj);	
}

/***********************************************************************************************
 * 01.01.01 기초자료 조회
 ***********************************************************************************************/
this.fn_ComSearch = function()
{
	
	this.ds_Input.clearData();
	
	//[업무] 조회조건 입력
	this.ds_Input.addRow();
	this.ds_Input.setColumn(0, "BUYA_YEAR", this.div_Search.form.spn_JstaYear.value);
	this.ds_Input.setColumn(0, "SESU_ID", this.div_Search.form.edt_SystId.value);
			
	//[공통]서비스정보 초기화
	this.gfn_InitComService(this);
	
	//[공통]서비스정보 추가
	//기초자료
	var svcAddObj = new Object();//[공통] 서비스 추가 파라메타 정보 Object
	svcAddObj.sSelectSql = "hr:M_HS_8390_M_SL00";
	this.gfn_AddComSearchService(this, svcAddObj);
	
	//[공통]서비스 호출 변수 -  
	var svcCallObj = new Object();//[공통] 서비스 파라메타 정보 Object
	svcCallObj.sTrid = "SRCH_LIST1";//Transaction ID 등 callback에서 넘겨 받을 String을 지정
	svcCallObj.sActionName = this.G_SV_HR;//서버에서 호출할 Action - 모듈별로 호출되는 기본 Actio이 다름 : 공통 서비스 Action 업무구분  변수 참조
	svcCallObj.sInputDaset = "ds_Input=ds_Input" //입력 데이터셋
	svcCallObj.sOutDatset = "ds_GrdJsba=ds_GrdJsba";//출력 데이터셋
	svcCallObj.sOtherArg = "";//서버로 전송할 기타 Argument 정보 문자열, 예) key=value key2=value2
	svcCallObj.sCallBackFnc = "fn_Callback";//서버에서 처리가 완료된 후 Callback 받을 Function 명

	//[공통]서비스 호출
	this.gfn_CallComService(this, svcCallObj);		
}

/***********************************************************************************************
 * 01.01.02 연말정산자료 조회
 ***********************************************************************************************/
this.fn_Search = function()
{
	//[업무] 데이터셋 설정 - 데이터셋 초기화, 조회조건 설정
	this.ds_GrdBuya.clearData(); 	// 부양가족
	this.ds_GrdBuyaBo.clearData(); 	// 부양가족(보험료)
	this.ds_GrdBuyaEd.clearData(); 	// 부양가족(교육비)
	this.ds_GrdBuyaCa.clearData(); 	// 부양가족(신용카드)
	this.ds_GrdHspt.clearData(); 	// 의료비
	this.ds_GrdGibu.clearData(); 	// 기부금
	this.ds_GrdGbch.clearData(); 	// 기부금조정
	this.ds_GrdSave.clearData(); 	// 연금저축
	this.ds_GrdJsjo.clearData(); 	// 종근무지소득
	this.ds_GrdJsmt.clearData(); 	// 연말정산
	this.ds_GrdRent.clearData(); 	// 월세.임차
	
	/* 컴포넌트 활성/비활성 함수
	//fn_enableComponent(false);		
	*/
	
	this.ds_Input.clearData();
	
	//[업무] 조회조건 입력
	this.ds_Input.addRow();
	this.ds_Input.setColumn(0, "BUYA_YEAR", this.div_Search.form.spn_JstaYear.value);
	this.ds_Input.setColumn(0, "SESU_ID", this.div_Search.form.edt_SystId.value);
	this.ds_Input.setColumn(0, "SYST_ID", this.div_Search.form.edt_SystId.value);
	this.ds_Input.setColumn(0, "EMPM_CD", this.div_Search.form.edt_EmpmCd.value);
			
	//[공통]서비스정보 초기화
	this.gfn_InitComService(this);
	var sInputDaset = "ds_Input=ds_Input gds_Input=ds_Input" //입력 데이터셋
	var sOutDatset = "";//출력 데이터셋
	
	
	var svcAddObj = new Object();//[공통] 서비스 추가 파라메타 정보 Object
	
	//검색 사용자 정보
	svcAddObj.sSelectSql = "hr:M_HR_EMPM_M_SL13";
	sOutDatset = "ds_UserInfo=gds_Empm"
	this.gfn_AddComSearchService(this, svcAddObj);
	
	//부양가족
	svcAddObj.sSelectSql = "hr:M_HS_8390_M_SL10";
	sOutDatset = sOutDatset + " ds_GrdBuya=ds_GrdBuya" //입력 데이터셋
	this.gfn_AddComSearchService(this, svcAddObj);
	
	
	//보험료
	svcAddObj.sSelectSql = "hr:M_HS_8390_M_SL11";
	sOutDatset = sOutDatset + " ds_GrdBuyaBo=ds_GrdBuyaBo" //입력 데이터셋
	this.gfn_AddComSearchService(this, svcAddObj);
	
	//교육비
	svcAddObj.sSelectSql = "hr:M_HS_8390_M_SL12";
	sOutDatset = sOutDatset + " ds_GrdBuyaEd=ds_GrdBuyaEd" //입력 데이터셋
	this.gfn_AddComSearchService(this, svcAddObj);
	
	//신용카드
	svcAddObj.sSelectSql = "hr:M_HS_8390_M_SL13";
	sOutDatset = sOutDatset + " ds_GrdBuyaCa=ds_GrdBuyaCa" //입력 데이터셋
	this.gfn_AddComSearchService(this, svcAddObj);
	
	//의료비
	svcAddObj.sSelectSql = "hr:M_HS_8390_M_SL20";
	sOutDatset = sOutDatset + " ds_GrdHspt=ds_GrdHspt" //입력 데이터셋
	this.gfn_AddComSearchService(this, svcAddObj);
	
	//기부금
	svcAddObj.sSelectSql = "hr:M_HS_8390_M_SL30";
	sOutDatset = sOutDatset + " ds_GrdGibu=ds_GrdGibu" //입력 데이터셋
	this.gfn_AddComSearchService(this, svcAddObj);
	
	//기부금조정
	svcAddObj.sSelectSql = "hr:M_HS_8390_M_SL40";
	sOutDatset = sOutDatset + " ds_GrdGbch=ds_GrdGbch" //입력 데이터셋
	this.gfn_AddComSearchService(this, svcAddObj);
	
	//연금/저축 
	svcAddObj.sSelectSql = "hr:M_HS_8390_M_SL50";
	sOutDatset = sOutDatset + " ds_GrdSave=ds_GrdSave" //입력 데이터셋
	this.gfn_AddComSearchService(this, svcAddObj);
	
	//종전근무지
	svcAddObj.sSelectSql = "hr:M_HS_8390_M_SL60";
	sOutDatset = sOutDatset + " ds_GrdJsjo=ds_GrdJsjo" //입력 데이터셋
	this.gfn_AddComSearchService(this, svcAddObj);
	
	//연말정산
	svcAddObj.sSelectSql = "hr:M_HS_8390_M_SL70";
	sOutDatset = sOutDatset + " ds_GrdJsmt=ds_GrdJsmt" //입력 데이터셋
	this.gfn_AddComSearchService(this, svcAddObj);
	
	//윌세주택임대차
	svcAddObj.sSelectSql = "hr:M_HS_8390_M_SL80";
	sOutDatset = sOutDatset + " ds_GrdRent=ds_GrdRent" //입력 데이터셋
	this.gfn_AddComSearchService(this, svcAddObj);
	/*
	//연말정산
	svcAddObj.sSelectSql = "hr:M_HS_8390_M_SL90";
	sOutDatset = sOutDatset + " ds_GrdJsmt=ds_GrdJsmt" //입력 데이터셋
	this.gfn_AddComSearchService(this, svcAddObj);
	*/
	//[공통]서비스 호출 변수
	var svcCallObj = new Object();//[공통] 서비스 파라메타 정보 Object
	svcCallObj.sTrid = "MST_SEARCH";//Transaction ID 등 callback에서 넘겨 받을 String을 지정
	svcCallObj.sActionName = this.G_SV_HR;//서버에서 호출할 Action - 모듈별로 호출되는 기본 Actio이 다름 : 공통 서비스 Action 업무구분  변수 참조
	svcCallObj.sInputDaset = sInputDaset; //입력 데이터셋
	svcCallObj.sOutDatset = sOutDatset; //출력 데이터셋
	svcCallObj.sOtherArg = "";//서버로 전송할 기타 Argument 정보 문자열, 예) key=value key2=value2
	svcCallObj.sCallBackFnc = "fn_Callback";//서버에서 처리가 완료된 후 Callback 받을 Function 명

	//[공통]서비스 호출
	this.gfn_CallComService(this, svcCallObj);		
}

/***********************************************************************************************
 * 01.02. [Vaildation] 조회 필수값 체크
 ***********************************************************************************************/
this.fn_VaildSearch = function()
{
	//조회조건 필수입력값 있으면 체크
	var arrArgs = [
					  "this.div_Search.form.spn_JstaYear^"+ this.div_Search.form.sta_JstaYear.text +"|NULL"
					, "this.div_Search.form.edt_SystId^"+ this.div_Search.form.sta_EmpmCd.text +"|NULL"
				  ]; 
				  
	var sCheckGroupTitle = "검색조건";//체크그룹 타이틀

	//컴포넌트 Vaild 체크
	if (!this.gfn_CheckFormCompValid(this, arrArgs, sCheckGroupTitle)) {
		return false;
	}
	
	return true;
}

/***********************************************************************************************
 * 01.03. [공통] 조회조건 클릭/변경 이벤트
 ***********************************************************************************************/
/***********************************************************************************************
 *    01. [부서]
 ***********************************************************************************************/
/*---------------------------------------------------------------------------------------------
 *    [조회영역-Button] 부서 버튼 클릭 이벤트
  ---------------------------------------------------------------------------------------------*/

/*---------------------------------------------------------------------------------------------
 *    [조회영역-Edit] 부서코드 변경 이벤트
  ---------------------------------------------------------------------------------------------*/

/*---------------------------------------------------------------------------------------------
 *    [조회영역-Edit] 부서명 변경 이벤트
  ---------------------------------------------------------------------------------------------*/


/***********************************************************************************************
 *    02. [사용자]
 ***********************************************************************************************/
/*---------------------------------------------------------------------------------------------
 *    [조회영역-Button] 사용자 버튼 클릭 이벤트
  ---------------------------------------------------------------------------------------------*/
this.div_Search_btn_SystId_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	var sPopupId = "S_SYST_ID_01";//팝업ID - 사용자정보
	var oArg = {PrgmId:this.fvComPrgmId, AuthYn:"Y", EmpmNm:this.div_Search.form.edt_EmpmNm.value};//Argument처리
	this.gfn_UserPop(sPopupId, oArg);		
};

/*---------------------------------------------------------------------------------------------
 *    [조회영역-Edit] 사원코드 변경 이벤트
  ---------------------------------------------------------------------------------------------*/
this.div_Search_edt_EmpmCd_onchanged = function(obj:nexacro.Edit,e:nexacro.ChangeEventInfo)
{
	var sPopupId = "S_SYST_ID_01";//팝업ID - 사원코드
	this.gfn_GetCommAuRetiEmpm(this.fvComPrgmId,"C", this.div_Search.form.edt_EmpmCd, this.div_Search.form.edt_EmpmNm, this.div_Search.form.edt_SystId, sPopupId, "", "", false);//코드로 검색-권한체크용
	
	
	this.fn_ComBtnSearch();
};

/*---------------------------------------------------------------------------------------------
 *    [조회영역-Edit] 사원명 변경 이벤트
  ---------------------------------------------------------------------------------------------*/
this.div_Search_edt_EmpmNm_onchanged = function(obj:nexacro.Edit,e:nexacro.ChangeEventInfo)
{
	var sPopupId = "S_SYST_ID_01";//팝업ID - 사원코드
	this.gfn_GetCommAuRetiEmpm(this.fvComPrgmId,"N", this.div_Search.form.edt_EmpmCd, this.div_Search.form.edt_EmpmNm, this.div_Search.form.edt_SystId, sPopupId);//코드명으로 검색		
	this.fn_ComBtnSearch();
};


/***********************************************************************************************
 *    03. [PDF 가져오기]
 ***********************************************************************************************/
this.div_Search_btn_LoadPdf_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	//첨부파일 정보 초기화
	this.ds_UploadFile.clearData();//첨부파일용 임시데이터셋
	this.ds_PdfToXml.clearData();//PDF를 XML형식으로 변환된 데이터셋
	this._vFiles_idx = 0;
	this._vFiles = [];	
	this.fdl_File.open("PDF파일열기", FileDialog.LOAD,"%MYDOCUMENT%");
};

/***********************************************************************************************
 *    04. [계산방식] 계산방식 변경 이벤트
 ***********************************************************************************************/
this.div_Search_rdo_Gube_onitemchanged = function(obj:nexacro.Radio,e:nexacro.ItemChangeEventInfo)
{
	//계산방식이 수동이면 표준세액공제 활성
	if(e.postvalue ==0){
		this.div_Search.form.chk_BohuYn.set_enable(true);
	}else{
		this.div_Search.form.chk_BohuYn.set_enable(false);
	}
};


/***********************************************************************************************
 * 2. 입력
 ***********************************************************************************************/
/***********************************************************************************************
 * 02.01. [공통버튼] 입력 버튼 클릭 이벤트
 ***********************************************************************************************/ 
this.fn_ComBtnAdd = function()
{
	var iTabIndex = this.div_MasterView.form.tab_Master.tabindex ;
	
	if(iTabIndex==0){
		this.fn_Buya_Add();
	}
}

/***********************************************************************************************
 * 02.MF0.01. [Master Freeform 공통] 입력항목 클릭/변경 이벤트
 ***********************************************************************************************/

 /***********************************************************************************************
 * 02.MF0.02. [Master Freeform 일반] 입력항목 클릭/변경 이벤트
 ***********************************************************************************************/
 
 /***********************************************************************************************
 * 02.MF0.03. [Master 데이터셋] 변경 이벤트
 ***********************************************************************************************/
 /*---------------------------------------------------------------------------------------------
 *    01. [데이터셋-ds_Master10] 데이터 Row 변경 이벤트
  ---------------------------------------------------------------------------------------------*/
this.ds_Master10_onrowposchanged = function(obj:nexacro.NormalDataset,e:nexacro.DSRowPosChangeEventInfo)
{
	if (e.newrow > -1) {
		
		//[마감] 마감상태에 따른 컴포넌트 제어
		//this.fn_SetWfCompEnable();		
	}		
}
/***********************************************************************************************
 * 02.MG0.01. [Master그리드-버튼] 복사 클릭 이벤트
 ***********************************************************************************************/
this.fn_MasterGrd01Copy = function()
{
};

/***********************************************************************************************
 * 02.MG0.02. [Master그리드-버튼] 행추가 클릭 이벤트
 ***********************************************************************************************/
this.fn_MasterGrd01AddRow = function()
{
	//연말정산 마감체크
	//if(this.fn_Jstg01_compute(this.div_Search.form.spn_JstaYear.value, true, false)){ 사용자 마감 체크안함
	if(this.fn_Jstg01_compute(this.div_Search.form.spn_JstaYear.value, true, true)){ 
		return false;
	}
	
	
	//제출 완료 체크
	if(this.ds_GrdJsba.getColumn(0,"JSBA_FINS")	 =="1"){
		this.gfn_Alert("HR101", "");	// 제출이 완료되었으므로 수정 및 계산작업을 할 수 없습니다.
		return false;
	}
	
	var sDs;
	var iTabIndex = this.div_MasterView.form.tab_Master.tabindex ;
	
	//trace("탭인덱스"+iTabIndex);

	
	var iAddRow = 0;
	var iAddRow2 = 0;
	var sBuyaYear = this.div_Search.form.spn_JstaYear.value;
	var sSystId =  this.ds_GrdJsba.getColumn(0, "SYST_ID");
	if(iTabIndex == 0){//부양가족
	
		if(this.ds_GrdBuya.rowcount < 1){
			this.fn_Buya_Add();
		}else{		
			iAddRow = this.gfn_GridInsertProcess(this, this.ds_GrdBuya );//crud_flag 변경-입력(I)
			this.ds_GrdBuya.setColumn(iAddRow, "BUYA_YEAR", sBuyaYear);
			this.ds_GrdBuya.setColumn(iAddRow, "SYST_ID", sSystId);
			this.ds_GrdBuya.setColumn(iAddRow, "BUYA_INOT", "1"); // 내외국인(PR126,1내국 9외국)
			
			this.ds_GrdBuya.setColumn(iAddRow, "BUYA_AG20", "0");
			this.ds_GrdBuya.setColumn(iAddRow, "BUYA_AG60", "0");
			this.ds_GrdBuya.setColumn(iAddRow, "BUYA_NOIN", "0");
			this.ds_GrdBuya.setColumn(iAddRow, "BUYA_JANG", "0");
			this.ds_GrdBuya.setColumn(iAddRow, "BUYA_WIFE", "0");
			this.ds_GrdBuya.setColumn(iAddRow, "BUYA_MCHD", "0");
			this.ds_GrdBuya.setColumn(iAddRow, "BUYA_CHIP", "0");	
		}

	}else if(iTabIndex == 1){//보험료
		iAddRow = this.gfn_GridInsertProcess(this, this.ds_GrdBuyaBo );//crud_flag 변경-입력(I)
		
	}else if(iTabIndex == 2){//교육비
		iAddRow = this.gfn_GridInsertProcess(this, this.ds_GrdBuyaEd );//crud_flag 변경-입력(I)
		
	}else if(iTabIndex == 3){//신용카드
		iAddRow = this.gfn_GridInsertProcess(this, this.ds_GrdBuyaCa );//crud_flag 변경-입력(I)
		
	}else if(iTabIndex == 4){//의료비
		iAddRow = this.gfn_GridInsertProcess(this, this.ds_GrdHspt );//crud_flag 변경-입력(I)
		this.ds_GrdHspt.setColumn(iAddRow, "HSPT_YEAR", sBuyaYear);
		this.ds_GrdHspt.setColumn(iAddRow, "SYST_ID", sSystId);
		this.ds_GrdHspt.setColumn(iAddRow, "HSPT_GIGA", "1"); // 제출대상기간코드(1연간합산)
		this.ds_GrdHspt.setColumn(iAddRow, "HSPT_GUNS", 1);
		this.ds_GrdHspt.setColumn(iAddRow, "HSPT_CODE", "5");
		this.ds_GrdHspt.setColumn(iAddRow, "HSPT_TYPE", "G0026");
		this.ds_GrdHspt.setColumn(iAddRow, "HSPT_GAMT", 0);
		this.ds_GrdHspt.setColumn(iAddRow, "HSPT_SAMT", 0);
		
		this.ds_GrdHspt.setColumn(iAddRow, "HSPT_NANI", "0");
		this.ds_GrdHspt.setColumn(iAddRow, "HSPT_SANJ", "0");
		this.ds_GrdHspt.setColumn(iAddRow, "HSPT_PREM", "0");		
		
		this.ds_GrdHspt.setColumn(iAddRow, "REGI_ID", this.sSYSTID);
		
		
	}else if(iTabIndex == 5){//기부금
		iAddRow = this.gfn_GridInsertProcess(this, this.ds_GrdGibu );//crud_flag 변경-입력(I)
		this.ds_GrdGibu.setColumn(iAddRow, "GIBU_YEAR", sBuyaYear);
		this.ds_GrdGibu.setColumn(iAddRow, "SYST_ID", sSystId);		
		this.ds_GrdGibu.setColumn(iAddRow, "GIBU_GUBN", "1");	//기부 증빙구분
		this.ds_GrdGibu.setColumn(iAddRow, "GIBU_NOTE", "1");
		this.ds_GrdGibu.setColumn(iAddRow, "GIBU_GUNS", 1 );	
		this.ds_GrdGibu.setColumn(iAddRow, "REGI_ID", this.sSYSTID);
		
		//iAddRow2 = this.gfn_GridInsertProcess(this, this.ds_GrdGbch );//crud_flag 변경-입력(I)
	}else if(iTabIndex == 6){//주택자금
		//iAddRow = this.gfn_GridInsertProcess(this, this.ds_GrdJsba );//crud_flag 변경-입력(I)
	}else if(iTabIndex == 7){//연금저축
		iAddRow = this.gfn_GridInsertProcess(this, this.ds_GrdSave );//crud_flag 변경-입력(I)
		//this.ds_GrdSave.setColumn(iAddRow, "GIBU_YEAR", sBuyaYear);
		this.ds_GrdSave.setColumn(iAddRow, "SAVE_YEAR", sBuyaYear);
		this.ds_GrdSave.setColumn(iAddRow, "SYST_ID", sSystId);
		this.ds_GrdSave.setColumn(iAddRow, "REGI_ID", this.sSYSTID);
		
	}else if(iTabIndex == 8){//월세/거주자간주택임대차
		iAddRow = this.gfn_GridInsertProcess(this, this.ds_GrdRent );//crud_flag 변경-입력(I)
		this.ds_GrdRent.setColumn(iAddRow, "RENT_YEAR", sBuyaYear);
		this.ds_GrdRent.setColumn(iAddRow, "SYST_ID", sSystId);
		this.ds_GrdRent.setColumn(iAddRow, "REGI_ID", this.sSYSTID);
		
	}else if(iTabIndex == 9){//종전근무지. 
		iAddRow = this.gfn_GridInsertProcess(this, this.ds_GrdJsjo );//crud_flag 변경-입력(I)
		this.ds_GrdJsjo.setColumn(iAddRow, "JSJO_GUBN", "1");	// 내역구분(1기초_2계산) 
		this.ds_GrdJsjo.setColumn(iAddRow, "JSJO_YEAR", sBuyaYear);
		this.ds_GrdJsjo.setColumn(iAddRow, "SYST_ID", sSystId);
		this.ds_GrdJsjo.setColumn(iAddRow, "JSJO_CODE", "6");
		this.ds_GrdJsjo.setColumn(iAddRow, "REGI_ID", this.sSYSTID);
		
	}else if(iTabIndex == 10){//기타
	
	}else if(iTabIndex == 11){//연말정산
		//iAddRow = this.gfn_GridInsertProcess(this, this.ds_GrdJsmt );//crud_flag 변경-입력(I)
	}

	//this.div_MasterInput.form.tab_Master.tpg_01.form.grd_Master.setCellPos(3);
	//this.div_MasterInput.form.tab_Master.tpg_01.form.grd_Master.showEditor(true);
};

/***********************************************************************************************
 * 02.MG0.03. [Master그리드-버튼] 행삽입 클릭 이벤트
 ***********************************************************************************************/
this.fn_MasterGrd01InsertRow = function()
{
};

/***********************************************************************************************
 * 02.MG0.04. [Master그리드-버튼] 행삭제 클릭 이벤트
 ***********************************************************************************************/
this.fn_MasterGrd01DeleteRow = function()
{
	//연말정산 마감체크
	//if(this.fn_Jstg01_compute(this.div_Search.form.spn_JstaYear.value, true, false)){ 사용자 마감 체크안함
	if(this.fn_Jstg01_compute(this.div_Search.form.spn_JstaYear.value, true, true)){ 
		return false;
	}
	
	//제출 완료 체크
	if(this.ds_GrdJsba.getColumn(0,"JSBA_FINS")	 =="1"){
		this.gfn_Alert("HR101", "");	// 제출이 완료되었으므로 수정 및 계산작업을 할 수 없습니다.
		return false;
	}
	
	var iTabIndex = this.div_MasterView.form.tab_Master.tabindex ;
	if(iTabIndex == 0){//부양가족
		this.gfn_GridDelProcess(this, this.ds_GrdBuya);//crud_flag 변경-삭제(D)	
	}else if(iTabIndex == 1){//보험료
		this.gfn_GridDelProcess(this, this.ds_GrdBuyaBo);//crud_flag 변경-삭제(D)	
	}else if(iTabIndex == 2){//교육비
		this.gfn_GridDelProcess(this, this.ds_GrdBuyaEd);//crud_flag 변경-삭제(D)	
	}else if(iTabIndex == 3){//신용카드
		this.gfn_GridDelProcess(this, this.ds_GrdBuyaCa);//crud_flag 변경-삭제(D)	
	}else if(iTabIndex == 4){//의료비
		this.gfn_GridDelProcess(this, this.ds_GrdHspt);//crud_flag 변경-삭제(D)	
	}else if(iTabIndex == 5){//기부금
		this.gfn_GridDelProcess(this, this.ds_GrdGibu);//crud_flag 변경-삭제(D)	
	}else if(iTabIndex == 6){//주택자금
		//this.gfn_GridDelProcess(this, this.ds_GrdJsba);//crud_flag 변경-삭제(D)	
	}else if(iTabIndex == 7){//연금저축
	this.gfn_GridDelProcess(this, this.ds_GrdSave);//crud_flag 변경-삭제(D)	
	}else if(iTabIndex == 8){//월세/거주자간주택임대차
		this.gfn_GridDelProcess(this, this.ds_GrdRent);//crud_flag 변경-삭제(D)	
	}else if(iTabIndex == 9){//종전근무지. 
		this.gfn_GridDelProcess(this, this.ds_GrdJsjo);//crud_flag 변경-삭제(D)	
	}else if(iTabIndex == 10){//기타
	
	}else if(iTabIndex == 11){//연말정산
	
	}
	
};

/***********************************************************************************************
 * 02.MG0.05. [Master그리드-버튼] 취소 클릭 이벤트
 ***********************************************************************************************/
this.fn_MasterGrd01Cancel = function()
{
	//연말정산 마감체크
	//if(this.fn_Jstg01_compute(this.div_Search.form.spn_JstaYear.value, true, false)){ 사용자 마감 체크안함
	if(this.fn_Jstg01_compute(this.div_Search.form.spn_JstaYear.value, true, true)){ 
		return false;
	}
	
	//제출 완료 체크
	if(this.ds_GrdJsba.getColumn(0,"JSBA_FINS")	 =="1"){
		this.gfn_Alert("HR101", "");	// 제출이 완료되었으므로 수정 및 계산작업을 할 수 없습니다.
		return false;
	}
	
	var iTabIndex = this.div_MasterView.form.tab_Master.tabindex ;
	if(iTabIndex == 0){//부양가족
		this.gfn_UndoColumn(this.div_MasterView.form.tab_Master.tpg_01.form.div_Buya.form.grd_Buya);
	}else if(iTabIndex == 1){//보험료
		this.gfn_UndoColumn(this.div_MasterView.form.tab_Master.tpg_02.form.div_Bohm.form.grd_BuyaBo);
	}else if(iTabIndex == 2){//교육비
		this.gfn_UndoColumn(this.div_MasterView.form.tab_Master.tpg_03.form.div_Educ.form.grd_BuyaEd);
	}else if(iTabIndex == 3){//신용카드
		this.gfn_UndoColumn(this.div_MasterView.form.tab_Master.tpg_04.form.div_Card.form.ged_BuyaCa);
	}else if(iTabIndex == 4){//의료비
		this.gfn_UndoColumn(this.div_MasterView.form.tab_Master.tpg_05.form.div_Hspt.form.grd_Hspt);
	}else if(iTabIndex == 5){//기부금
		this.gfn_UndoColumn(this.div_MasterView.form.tab_Master.tpg_06.form.div_Gibu.form.grd_Gibu);
	}else if(iTabIndex == 6){//주택자금
		//this.gfn_UndoColumn(this.div_MasterView.form.tab_Master.tpg_07.form.div_Hous.form.);
	}else if(iTabIndex == 7){//연금저축
		this.gfn_UndoColumn(this.div_MasterView.form.tab_Master.tpg_08.form.div_Save.form.grd_Save);
	}else if(iTabIndex == 8){//월세/거주자간주택임대차
		this.gfn_UndoColumn(this.div_MasterView.form.tab_Master.tpg_09.form.div_Joo.form.grd_GrdRent);
	}else if(iTabIndex == 9){//종전근무지. 
		this.gfn_UndoColumn(this.div_MasterView.form.tab_Master.tpg_10.form.div_Jsjo.form.grd_Jsjo);
	}else if(iTabIndex == 10){//기타
	
	}else if(iTabIndex == 11){//연말정산
	
	}
	


};
 
/***********************************************************************************************
 * 02.MG0.06. [Master그리드] 셀 클릭 이벤트
 ***********************************************************************************************/ 
 
/***********************************************************************************************
 * 02.MG0.07. [Master 데이터셋] 변경 이벤트
 ***********************************************************************************************/
 
 /***********************************************************************************************
 * 02.MG0.08. [Master Tab] 변경 이벤트
 ***********************************************************************************************/
this.div_MasterView_tab_Master_onchanged = function(obj:nexacro.Tab,e:nexacro.TabIndexChangeEventInfo)
{
	var iTabIndex = e.postindex;
	
	this.div_MasterView.form.div_ComGrdBtn.set_enable(true);
	this.div_MasterView.form.div_ComGrdBtn.set_url("");
	//trace(iTabIndex);
	
	//trace(iTabIndex);

	
	var iAddRow = 0;
	var iAddRow2 = 0;
	var sBuyaYear = this.div_Search.form.spn_JstaYear.value;
	if(iTabIndex == 0){//부양가족
		this.fn_SetGridInputButton();//[공통] 그리드 입력 버튼 설정
	}else if(iTabIndex == 1){//보험료
												this.fn_SetGridInputButton();//[공통] 그리드 입력 버튼 설정
	}else if(iTabIndex == 2){//교육비
												this.fn_SetGridInputButton();//[공통] 그리드 입력 버튼 설정
	}else if(iTabIndex == 3){//신용카드
												this.fn_SetGridInputButton();//[공통] 그리드 입력 버튼 설정
	}else if(iTabIndex == 4){//의료비
		this.fn_SetGridInputButton();//[공통] 그리드 입력 버튼 설정
	}else if(iTabIndex == 5){//기부금
		this.fn_SetGridInputButton();//[공통] 그리드 입력 버튼 설정
	}else if(iTabIndex == 6){//주택자금
	}else if(iTabIndex == 7){//연금저축
		this.fn_SetGridInputButton();//[공통] 그리드 입력 버튼 설정
	}else if(iTabIndex == 8){//월세/거주자간주택임대차
		this.fn_SetGridInputButton();//[공통] 그리드 입력 버튼 설정
	}else if(iTabIndex == 9){//종전근무지. 
		this.fn_SetGridInputButton();//[공통] 그리드 입력 버튼 설정
	}else if(iTabIndex == 10){//기타
	}else if(iTabIndex == 11){//연말정산
	}
	
	//연말정산에서면 표시
	if(iTabIndex == 11){//연말정산
		this.div_Search.form.sta_BuyaYear.set_visible(true);	//계산방식 타이틀
		this.div_Search.form.rdo_Gube.set_visible(true);		//계산방식 
		this.div_Search.form.sta_BohuYn.set_visible(true);		//표준세액공제 타이틀
		this.div_Search.form.chk_BohuYn.set_visible(true);		//표준세액공제 체크박스
		this.div_Search.form.sta_Text1.set_visible(true);		//안내text
		this.div_Search.form.sta_Text2.set_visible(true);		//안내text
		this.div_MasterView.form.btn_JstmM1.set_visible(true);	//계산버튼
		this.div_MasterView.form.btn_CorhM2.set_visible(true);	//제출버튼
	}else{
		this.div_Search.form.sta_BuyaYear.set_visible(false);	//계산방식 타이틀
		this.div_Search.form.rdo_Gube.set_visible(false);		//계산방식 
		this.div_Search.form.sta_BohuYn.set_visible(false);		//표준세액공제 타이틀
		this.div_Search.form.chk_BohuYn.set_visible(false);		//표준세액공제 체크박스
		this.div_Search.form.sta_Text1.set_visible(false);		//안내text
		this.div_Search.form.sta_Text2.set_visible(false);		//안내text
		this.div_MasterView.form.btn_JstmM1.set_visible(false);	//계산버튼
		this.div_MasterView.form.btn_CorhM2.set_visible(false);	//제출버튼
	}
	
};

 /***********************************************************************************************
 * 02.MG0.09. [Master Tab] 변경전 이벤트
 ***********************************************************************************************/
this.div_MasterView_tab_Master_canchange = function(obj:nexacro.Tab,e:nexacro.TabIndexChangeEventInfo)
{
		//변경여부 체크
	if (   !this.gfn_DsIsUpdated(this.ds_GrdBuya) 
		&& !this.gfn_DsIsUpdated(this.ds_GrdBuyaBo) 
		&& !this.gfn_DsIsUpdated(this.ds_GrdBuyaEd) 
		&& !this.gfn_DsIsUpdated(this.ds_GrdBuyaCa) 
		&& !this.gfn_DsIsUpdated(this.ds_GrdHspt) 
		&& !this.gfn_DsIsUpdated(this.ds_GrdGibu) 
		&& !this.gfn_DsIsUpdated(this.ds_GrdGbch) 
		&& !this.gfn_DsIsUpdated(this.ds_GrdSave) 
		&& !this.gfn_DsIsUpdated(this.ds_GrdJsjo) 
		&& !this.gfn_DsIsUpdated(this.ds_GrdJsmt) 
		&& !this.gfn_DsIsUpdated(this.ds_GrdRent) 
		&& !this.gfn_DsIsUpdated(this.ds_GrdJsba) 
	) {

	} else {
		this.gfn_Alert("SM002", "");//변경된 내용이 있습니다.\n저장 후 작업하시기 바랍니다.
		return false;
	}
};
/***********************************************************************************************
 * 02.DG0.01. [Detail그리드-버튼] 복사 클릭 이벤트
 ***********************************************************************************************/
this.fn_DetailGrd01Copy = function()
{
};

/***********************************************************************************************
 * 02.DG0.02. [Detail그리드-버튼] 행추가 클릭 이벤트
 ***********************************************************************************************/
this.fn_DetailGrd01AddRow = function()
{
	//연말정산 마감체크
	//if(this.fn_Jstg01_compute(this.div_Search.form.spn_JstaYear.value, true, false)){ 사용자 마감 체크안함
	if(this.fn_Jstg01_compute(this.div_Search.form.spn_JstaYear.value, true, true)){ 
		return false;
	}
	
	
	var sDs;
	var iTabIndex = this.div_MasterView.form.tab_Master.tabindex ;
	//trace("탭인덱스"+iTabIndex);

	
	var iAddRow = 0;
	var sBuyaYear = this.div_Search.form.spn_JstaYear.value;
	var sSystId =  this.ds_GrdJsba.getColumn(0, "SYST_ID");
	if(iTabIndex == 5){//기부금이월 내역
		iAddRow = this.gfn_GridInsertProcess(this, this.ds_GrdGbch );//crud_flag 변경-입력(I)
		this.ds_GrdGbch.setColumn(iAddRow, "GBCH_YEAR", sBuyaYear);
		this.ds_GrdGbch.setColumn(iAddRow, "SYST_ID", sSystId);
	}
};

/***********************************************************************************************
 * 02.DG0.03. [Detail그리드-버튼] 행삽입 클릭 이벤트
 ***********************************************************************************************/
this.fn_DetailGrd01InsertRow = function()
{
	this.gfn_GridInsertionProcess(this, this.ds_GrdGbch);//crud_flag 변경-입력(I)	
};


/***********************************************************************************************
 * 02.DG0.04. [Detail그리드-버튼] 행삭제 클릭 이벤트
 ***********************************************************************************************/
this.fn_DetailGrd01DeleteRow = function()
{
	
	//연말정산 마감체크
	//if(this.fn_Jstg01_compute(this.div_Search.form.spn_JstaYear.value, true, false)){ 사용자 마감 체크안함
	if(this.fn_Jstg01_compute(this.div_Search.form.spn_JstaYear.value, true, true)){ 
		return false;
	}
	
	var iTabIndex = this.div_MasterView.form.tab_Master.tabindex ;
	if(iTabIndex == 5){//기부금
		this.gfn_GridDelProcess(this, this.ds_GrdGbch);//crud_flag 변경-삭제(D)	
	}
	
};


/***********************************************************************************************
 * 02.DG0.05. [Detail그리드-버튼] 취소 클릭 이벤트
 ***********************************************************************************************/
this.fn_DetailGrd01Cancel = function()
{
	//연말정산 마감체크
	//if(this.fn_Jstg01_compute(this.div_Search.form.spn_JstaYear.value, true, false)){ 사용자 마감 체크안함
	if(this.fn_Jstg01_compute(this.div_Search.form.spn_JstaYear.value, true, true)){ 
		return false;
	}
	//var iTabIndex = div_MasterView.form.tab_Master.tpg_06.form.div_Gibu.form.tab_Gibu.tabindex ;
	var iTabIndex = this.div_MasterView.form.tab_Master.tabindex ;
	if(iTabIndex == 5){//기부금
		this.gfn_UndoColumn(this.div_MasterView.form.tab_Master.tpg_06.form.div_Gibu.form.tab_Gibu.form.grd_Gibu);
	}
};



 
/***********************************************************************************************
 * 3. 복사
 ***********************************************************************************************/
/***********************************************************************************************
 * 03.01. [공통버튼] 복사 버튼 클릭 이벤트
 ***********************************************************************************************/ 
this.fn_ComBtnCopy = function()
{ 
}

/***********************************************************************************************
 * 4. 취소
 ***********************************************************************************************/
/***********************************************************************************************
 * 04.01. [공통버튼] 취소 버튼 클릭 이벤트
 ***********************************************************************************************/ 
this.fn_ComBtnCancel = function()
{ 
}

/***********************************************************************************************
 * 5. 저장
 ***********************************************************************************************/
/***********************************************************************************************
 * 05.01. [공통버튼] 저장 버튼 클릭 이벤트
 ***********************************************************************************************/ 
this.fn_ComBtnSave = function(strFlag, nIndex)
{ 
	//데이터 변경여부 체크
	if (!this.fn_DsIsUpdated()) {
		this.gfn_Alert("SM036");//변경된 내용이 없습니다.
		return false;
	}
	
	//연말정산 마감체크
	//if(this.fn_Jstg01_compute(this.div_Search.form.spn_JstaYear.value, true, false)){ 사용자 마감 체크안함
	if(this.fn_Jstg01_compute(this.div_Search.form.spn_JstaYear.value, true, true)){ 
		return false;
	}
	
	
	trace("제출여부" + this.ds_GrdJsba.getColumn(0,"JSBA_FINS"));
	//제출 완료 체크
	if(this.ds_GrdJsba.getColumn(0,"JSBA_FINS")	 =="1"){
		this.gfn_Alert("HR101", "");	// 제출이 완료되었으므로 수정 및 계산작업을 할 수 없습니다.
		return false;
	}
	
	var sSystId  = this.div_Search.form.edt_SystId.value;
	this.fvJsmtYear = this.div_Search.form.spn_JstaYear.value+"";
	
	//저장전 유효성 체크
	//Master 데이터 유효성 체크
	//if (this.gfn_DsIsUpdated(this.ds_Master10)) {
		if (!this.fn_VaildMasterSave()) return;
	//}
		
	var sJumi = "";
	var sCrudType;
	
	this.ds_SaveBuya.assign(this.ds_GrdBuya);	//데이터 전체 복사
	
	
	for (var i=0; i < this.ds_SaveBuya.rowcount; i++)	//연말정산공제명세서 
	{
		sCrudType = this.ds_SaveBuya.getColumn(i, "crudType");
		
		//-- 삭제된 컬럼은 Pass
		if(sCrudType!="D"){	
			sJumi = this.ds_SaveBuya.getColumn(i,"BUYA_JUMI");   //주민등록번호
			trace("주민번호"+sJumi);
			// 보험료
			this.ds_SaveBuya.setColumn(i, "BUYA_BOH4", this.ds_GrdBuyaBo.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_BOH4"));   //국세청_보험료_일반보장성
			this.ds_SaveBuya.setColumn(i, "BUYA_BOH5", this.ds_GrdBuyaBo.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_BOH5"));   //국세청_보험료_장애인전용 
			
			// 교육비
			this.ds_SaveBuya.setColumn(i, "BUYA_EDGB", this.ds_GrdBuyaEd.getColumn(this.ds_GrdBuyaEd.findRow("BUYA_JUMI",sJumi), "BUYA_EDGB"));   //교육비_구분(PR124,0본인_1취학전_2초중고_3대학생)
			this.ds_SaveBuya.setColumn(i, "BUYA_EDU1", this.ds_GrdBuyaEd.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_EDU1"));   //국세청_교육비
			this.ds_SaveBuya.setColumn(i, "BUYA_EDU3", this.ds_GrdBuyaEd.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_EDU3"));
			this.ds_SaveBuya.setColumn(i, "BUYA_EDU4", this.ds_GrdBuyaEd.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_EDU4"));
			this.ds_SaveBuya.setColumn(i, "BUYA_EDU5", this.ds_GrdBuyaEd.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_EDU5"));
			
			
			this.ds_SaveBuya.setColumn(i, "BUYA_CRD1", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_CAIB") + this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_CAJT") + this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_CADJ") + this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_CADS"));   //국세청_신용카드등
			this.ds_SaveBuya.setColumn(i, "BUYA_DIR1", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_JKIB") + this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_JKJT") + this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_JKDJ") + this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_JKDS"));   //국세청_직불카드
			this.ds_SaveBuya.setColumn(i, "BUYA_CSH1", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_CHIB") + this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_CHJT") + this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_CHDJ") + this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_CHDS"));  //국세청_현금영수증
			this.ds_SaveBuya.setColumn(i, "BUYA_ZEH1", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_ZEIB") + this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_ZEJT") + this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_ZEDJ") + this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_ZEDS"));  //국세청_현금영수증		
			this.ds_SaveBuya.setColumn(i, "BUYA_CRD3", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_CRD3"));   //국세청_신용카드등_학원비지로
			
			this.ds_SaveBuya.setColumn(i, "BUYA_MARK", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_CAJT")+ this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_JKJT")+ this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_CHJT")+ this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_ZEJT"));   //w전통
			this.ds_SaveBuya.setColumn(i, "BUYA_PUBL", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_CADJ")+ this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_JKDJ")+ this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_CHDJ")+ this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_ZEDJ"));   //대중		
			this.ds_SaveBuya.setColumn(i, "BUYA_DSEO", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_CADS")+ this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_JKDS")+ this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_CHDS")+ this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_ZEDS"));   //도서공연비(2018추가)		
			
			this.ds_SaveBuya.setColumn(i, "BUYA_SCIB", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_SCIB"));   //상반기_신용카드_일반
			this.ds_SaveBuya.setColumn(i, "BUYA_SCJT", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_SCJT"));   //상반기_신용카드_전통
			this.ds_SaveBuya.setColumn(i, "BUYA_SCDJ", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_SCDJ"));   //상반기_신용카드_대중
			
			this.ds_SaveBuya.setColumn(i, "BUYA_HCIB", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_HCIB"));   //하반기_신용카드_일반
			this.ds_SaveBuya.setColumn(i, "BUYA_HCJT", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_HCJT"));   //하반기_신용카드_전통
			this.ds_SaveBuya.setColumn(i, "BUYA_HCDJ", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_HCDJ"));   //하반기_신용카드_대중
			
			this.ds_SaveBuya.setColumn(i, "BUYA_SJIB", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_SJIB"));   //상반기_직불카드_일반
			this.ds_SaveBuya.setColumn(i, "BUYA_SJJT", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_SJJT"));   //상반기_직불카드_전통
			this.ds_SaveBuya.setColumn(i, "BUYA_SJDJ", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_SJDJ"));   //상반기_직불카드_대중
			
			this.ds_SaveBuya.setColumn(i, "BUYA_HJIB", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_HJIB"));   //하반기_직불카드_일반
			this.ds_SaveBuya.setColumn(i, "BUYA_HJJT", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_HJJT"));   //하반기_직불카드_전통
			this.ds_SaveBuya.setColumn(i, "BUYA_HJDJ", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_HJDJ"));   //하반기_직불카드_대중
			
			this.ds_SaveBuya.setColumn(i, "BUYA_SHIB", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_SHIB"));   //상반기_현금영수증_일반
			this.ds_SaveBuya.setColumn(i, "BUYA_SHJT", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_SHJT"));   //상반기_현금영수증_전통
			this.ds_SaveBuya.setColumn(i, "BUYA_SHDJ", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_SHDJ"));   //상반기_현금영수증_대중
			
			this.ds_SaveBuya.setColumn(i, "BUYA_HHIB", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_HHIB"));   //하반기_현금영수증_일반
			this.ds_SaveBuya.setColumn(i, "BUYA_HHJT", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_HHJT"));   //하반기_현금영수증_전통
			this.ds_SaveBuya.setColumn(i, "BUYA_HHDJ", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_HHDJ"));   //하반기_현금영수증_대중

			this.ds_SaveBuya.setColumn(i, "BUYA_XCR1", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_XCR1"));   //국세청_전년도_신용카드_일반
			this.ds_SaveBuya.setColumn(i, "BUYA_XCR2", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_XCR2"));   //국세청_전년도_신용카드_전통
			this.ds_SaveBuya.setColumn(i, "BUYA_XCR3", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_XCR3"));   //국세청_전년도_신용카드_대중
			this.ds_SaveBuya.setColumn(i, "BUYA_XCR4", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_XCR4"));   //국세청_전년도_직불카드_일반
			this.ds_SaveBuya.setColumn(i, "BUYA_XCR5", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_XCR5"));   //국세청_전년도_직불카드_전통
			this.ds_SaveBuya.setColumn(i, "BUYA_XCR6", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_XCR6"));   //국세청_전년도_직불카드_대중
			this.ds_SaveBuya.setColumn(i, "BUYA_XCR7", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_XCR7"));   //국세청_전년도_현금영수증_일반
			this.ds_SaveBuya.setColumn(i, "BUYA_XCR8", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_XCR8"));   //국세청_전년도_현금영수증_전통
			this.ds_SaveBuya.setColumn(i, "BUYA_XCR9", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_XCR9"));   //국세청_전년도_현금영수증_대중	
					
			this.ds_SaveBuya.setColumn(i, "BUYA_YCR1", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_YCR1"));   //국세청_전전년도_신용카드_일반
			this.ds_SaveBuya.setColumn(i, "BUYA_YCR2", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_YCR2"));   //국세청_전전년도_신용카드_전통
			this.ds_SaveBuya.setColumn(i, "BUYA_YCR3", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_YCR3"));   //국세청_전전년도_신용카드_대중
			this.ds_SaveBuya.setColumn(i, "BUYA_YCR4", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_YCR4"));   //국세청_전전년도_직불카드_일반
			this.ds_SaveBuya.setColumn(i, "BUYA_YCR5", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_YCR5"));   //국세청_전전년도_직불카드_전통
			this.ds_SaveBuya.setColumn(i, "BUYA_YCR6", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_YCR6"));   //국세청_전전년도_직불카드_대중
			this.ds_SaveBuya.setColumn(i, "BUYA_YCR7", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_YCR7"));   //국세청_전전년도_현금영수증_일반
			this.ds_SaveBuya.setColumn(i, "BUYA_YCR8", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_YCR8"));   //국세청_전전년도_현금영수증_전통
			this.ds_SaveBuya.setColumn(i, "BUYA_YCR9", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_YCR9"));   //국세청_전전년도_현금영수증_대중
			
			//2016년 귀속분 추가
			this.ds_SaveBuya.setColumn(i, "BUYA_CAIB", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_CAIB"));   // 신용카드_일반(2016년 사용)
			this.ds_SaveBuya.setColumn(i, "BUYA_CAJT", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_CAJT"));   // 신용카드_전통(2016년 사용)
			this.ds_SaveBuya.setColumn(i, "BUYA_CADJ", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_CADJ"));   // 신용카드_대중(2016년 사용)		
			this.ds_SaveBuya.setColumn(i, "BUYA_JKIB", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_JKIB"));   // 직불카드_일반(2016년 사용)
			this.ds_SaveBuya.setColumn(i, "BUYA_JKJT", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_JKJT"));   // 직불카드_전통(2016년 사용)
			this.ds_SaveBuya.setColumn(i, "BUYA_JKDJ", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_JKDJ"));   // 직불카드_대중(2016년 사용)		
			this.ds_SaveBuya.setColumn(i, "BUYA_CHIB", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_CHIB"));   // 현금_일반
			this.ds_SaveBuya.setColumn(i, "BUYA_CHJT", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_CHJT"));   // 현금_전통(2016년 사용)
			this.ds_SaveBuya.setColumn(i, "BUYA_CHDJ", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_CHDJ"));   // 현금_대중(2016년 사용)		
			this.ds_SaveBuya.setColumn(i, "BUYA_SCCA", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_SCCA"));   // 상반기_신용카드 추가공제 사용분(2016년 사용)
			this.ds_SaveBuya.setColumn(i, "BUYA_SCJK", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_SCJK"));   // 상반기_직불카드 추가공제 사용분(2016년 사용)
			this.ds_SaveBuya.setColumn(i, "BUYA_SCCH", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_SCCH"));   // 상반기_현금 추가공제 사용분(2016년 사용)
			this.ds_SaveBuya.setColumn(i, "BUYA_XCAD", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_XCAD"));   // 전년도_신용카드(2016년 사용)
			this.ds_SaveBuya.setColumn(i, "BUYA_XJKB", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_XJKB"));   // 전년도_직불카드(2016년 사용)
			this.ds_SaveBuya.setColumn(i, "BUYA_XCAH", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_XCAH"));   // 전년도_현금(2016년 사용)
			
			//2018년 귀속분 추가
			this.ds_SaveBuya.setColumn(i, "BUYA_CADS", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_CADS"));   // 신용카드_도서공연(2018년 사용)
			this.ds_SaveBuya.setColumn(i, "BUYA_JKDS", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_JKDS"));   // 직불카드_도서공연(2018년 사용)
			this.ds_SaveBuya.setColumn(i, "BUYA_CHDS", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_CHDS"));   // 현금_도서공연(2018년 사용)		
			
			//2019년 귀속분 추가_제로페이 2019.12.31
			this.ds_SaveBuya.setColumn(i, "BUYA_ZEIB", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_ZEIB"));   // 제로페이_일반(2019년 사용)
			this.ds_SaveBuya.setColumn(i, "BUYA_ZEJT", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_ZEJT"));   // 제로페이_전통시장(2019년 사용)
			this.ds_SaveBuya.setColumn(i, "BUYA_ZEDJ", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_ZEDJ"));   // 제로페이_대중교통(2019년 사용)		
			this.ds_SaveBuya.setColumn(i, "BUYA_ZEDS", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_ZEDS"));   // 제로페이_도서공연(2019년 사용)		
			
			//2022년 귀속분 추가_대중교통(상반기, 하반기구분) 2022.12.31	//add
			//상반기는 기존의 BUYA_SCDJ, BUYA_SJDJ, BUYA_SHDJ, BUYA_SZDJ 칼럼을 상반기로 적용
			this.ds_SaveBuya.setColumn(i, "BUYA_SCDJ", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_SCDJ"));   // 신용카드_대중교통_상반기(2022년 사용)
			this.ds_SaveBuya.setColumn(i, "BUYA_HCDJ", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_HCDJ"));   // 신용카드_대중교통_하반기(2022년 사용)		
			this.ds_SaveBuya.setColumn(i, "BUYA_SJDJ", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_SJDJ"));   // 직불카드_대중교통_상반기(2022년 사용)
			this.ds_SaveBuya.setColumn(i, "BUYA_HJDJ", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_HJDJ"));   // 직불카드_대중교통_하반기(2022년 사용)		
			this.ds_SaveBuya.setColumn(i, "BUYA_SHDJ", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_SHDJ"));   // 현금_대중교통_상반기(2022년 사용)
			this.ds_SaveBuya.setColumn(i, "BUYA_HHDJ", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_HHDJ"));   // 현금_대중교통_하반기(2022년 사용)
			this.ds_SaveBuya.setColumn(i, "BUYA_SZDJ", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_SZDJ"));   // 제로페이_대중교통_상반기(2022년 사용)
			this.ds_SaveBuya.setColumn(i, "BUYA_HZDJ", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_HZDJ"));   // 제로페이_대중교통_하반기(2022년 사용)
			
			this.ds_SaveBuya.setColumn(i, "BUYA_XTRA", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_XTRA"));   // 전년도 전통시장_카드 사용분(2022년 사용)
			this.ds_SaveBuya.setColumn(i, "BUYA_NTRA", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_NTRA"));   // 당해년 전통시장_카드 사용분(2022년 사용)		
			this.ds_SaveBuya.setColumn(i, "BUYA_XHTR", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_XHTR"));   // 전년도 전통시장_현금 사용분(2022년 사용)
			this.ds_SaveBuya.setColumn(i, "BUYA_NHTR", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_NHTR"));   // 당해년 전통시장_현금 사용분(2022년 사용)
			this.ds_SaveBuya.setColumn(i, "BUYA_XJTR", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_XJTR"));   // 전년도 전통시장_직불 사용분(2022년 사용)
			this.ds_SaveBuya.setColumn(i, "BUYA_NJTR", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_NJTR"));   // 당해년 전통시장_직불 사용분(2022년 사용)
			this.ds_SaveBuya.setColumn(i, "BUYA_XZTR", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_XZTR"));   // 전년도 전통시장_제로 사용분(2022년 사용)
			this.ds_SaveBuya.setColumn(i, "BUYA_NZTR", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_NZTR"));   // 당해년 전통시장_제로 사용분(2022년 사용)
			
			trace(this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_CRD1_2020"));
			
			this.ds_SaveBuya.setColumn(i, "BUYA_CRD1_2020", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_CRD1_2020"));   	// 국세청_신용카드_2021년 전체 사용분		
			this.ds_SaveBuya.setColumn(i, "BUYA_DIR1_2020", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_DIR1_2020"));   	// 국세청_직불카드_2021년 전체 사용분	
			this.ds_SaveBuya.setColumn(i, "BUYA_CSH1_2020", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_CSH1_2020"));   	// 국세청_현금영수증_2021년 전체 사용분		
			this.ds_SaveBuya.setColumn(i, "BUYA_ZERO_2020", this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_ZERO_2020"));   	// 국세청_제로페이_2021년 전체 사용분	
			this.ds_SaveBuya.setColumn(i, "BUYA_AD20", 		this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_CRD1_2020") +
															this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_DIR1_2020") +
															this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_CSH1_2020") +
															this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_ZERO_2020"));   	// 국세청_신용카드_소비증가분_2021년 전체 사용분
			this.ds_SaveBuya.setColumn(i, "BUYA_AD21", 		this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_CAIB") +  		// 국세청_신용카드등
															this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_JKIB") +  		// 국세청_직불카드
															this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_CHIB") +  		// 국세청_현금영수증
															this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_ZEIB") + 
															this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_CAJT") + this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_JKJT")+ this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_CHJT")+ this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_ZEJT") +  //전통
															this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_CADJ") + this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_JKDJ")+ this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_CHDJ")+ this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_ZEDJ") +  //대중
															this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_CADS") + this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_JKDS")+ this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_CHDS")+ this.ds_GrdBuyaCa.getCaseSum("crudType != 'D' && BUYA_JUMI=='"+ sJumi + "'", "BUYA_ZEDS")    //도서공연비(2018추가)
								  );   // 국세청_신용카드_소비증가분_2022년 전체 사용분	
			
			// 의료비
			this.ds_SaveBuya.setColumn(i, "BUYA_HSP1", this.ds_GrdHspt.getCaseSum("crudType != 'D' && HSPT_JUMI=='"+ sJumi + "'"+" && HSPT_CODE=='1'", "HSPT_GAMT"));
			this.ds_SaveBuya.setColumn(i, "BUYA_HSP2", this.ds_GrdHspt.getCaseSum("crudType != 'D' && HSPT_JUMI=='"+ sJumi + "'"+" && HSPT_CODE!='1'", "HSPT_GAMT"));		

			// 기부금
			//this.ds_SaveBuya.setColumn(i, "BUYA_GIB1", this.ds_GrdGibu.getCaseSum("crudType != 'D' && GIBU_JUMI=='"+ sJumi + "'"+" && GIBU_CODE!='50'", "GIBU_GAMT")); // 50 기타
			this.ds_SaveBuya.setColumn(i, "BUYA_GIB1", this.ds_GrdGibu.getCaseSum("crudType != 'D' && GIBU_JUMI=='"+ sJumi + "'"+" && GIBU_GUBN  =='1'", "GIBU_GAMT")); // 국세청외
			this.ds_SaveBuya.setColumn(i, "BUYA_GIB2", this.ds_GrdGibu.getCaseSum("crudType != 'D' && GIBU_JUMI=='"+ sJumi + "'"+" && GIBU_GUBN  =='0'", "GIBU_GAMT")); // 국세청
		}
	}//연말정산공제명세서 종료

	// 의료비 - 관계지정 (1:본인.장애인.65세이상자,2:그 이외의 기본 공제대상자)
	this.ds_GrdHspt.set_enableevent(false);
	for (var i=0; i<this.ds_GrdHspt.getRowCount(); i++){
	
		var nRow  = this.ds_GrdBuya.findRow("BUYA_JUMI", this.ds_GrdHspt.getColumn(i,"HSPT_JUMI"));
		this.ds_GrdHspt.setColumn(i, "HSPT_RELA", this.fn_iif(this.ds_GrdBuya.getColumn(nRow,"BUYA_RELA")=="0" || 
															  this.ds_GrdBuya.getColumn(nRow,"BUYA_JANG")=="1" || 
															  this.ds_GrdBuya.getColumn(nRow,"BUYA_JANG")=="2" || 
															  this.ds_GrdBuya.getColumn(nRow,"BUYA_JANG")=="3" || 
															  this.ds_GrdBuya.getColumn(nRow,"BUYA_AG65")=="1", "1", "2"));
	}
	this.ds_GrdHspt.set_enableevent(true);
	
	// 의료비 - 장애인여부
	this.ds_GrdHspt.set_enableevent(false);
	for (var i=0; i<this.ds_GrdHspt.getRowCount(); i++)	{		
		var nRow  = this.ds_GrdBuya.findRow("BUYA_JUMI", this.ds_GrdHspt.getColumn(i,"HSPT_JUMI"));
		                                         
		this.ds_GrdHspt.setColumn(i, "HSPT_JANG", (this.ds_GrdBuya.getColumn(nRow,"BUYA_JANG")=="1" || 
												   this.ds_GrdBuya.getColumn(nRow,"BUYA_JANG")=="2" || 
		                                           this.ds_GrdBuya.getColumn(nRow,"BUYA_JANG")=="3") ? "1": "0");		
	}
	this.ds_GrdHspt.set_enableevent(true);
	//BUYA_AG65=='1'
	//의료비 추가. 2019년 귀속분부터 세분화됨
	this.ds_SaveBuya.set_enableevent(false);
	for (var i=0; i<this.ds_SaveBuya.getRowCount(); i++)
	{
		sJumi = this.ds_SaveBuya.getColumn(i,"BUYA_JUMI"); 
		this.ds_SaveBuya.setColumn(i, "BUYA_HP1A", this.ds_GrdHspt.getCaseSum("crudType != 'D' && HSPT_JUMI=='"+ sJumi +"' && HSPT_CODE=='1' &&  HSPT_RELA=='2' && HSPT_NANI!='1' &&  HSPT_SANJ!='1'  && HSPT_PREM !='1'", "HSPT_GAMT"));  	//국세청_의료비(일반)
		this.ds_SaveBuya.setColumn(i, "BUYA_HP1B", this.ds_GrdHspt.getCaseSum("crudType != 'D' && HSPT_JUMI=='"+ sJumi +"' && HSPT_CODE=='1' &&  HSPT_NANI=='1'", "HSPT_GAMT"));   															//국세청_의료비(난임)
		this.ds_SaveBuya.setColumn(i, "BUYA_HP1C", this.ds_GrdHspt.getCaseSum("crudType != 'D' && HSPT_JUMI=='"+ sJumi +"' && HSPT_CODE=='1' && (HSPT_RELA=='1' || HSPT_SANJ=='1') &&  HSPT_PREM !='1' && HSPT_NANI!='1' ", "HSPT_GAMT"));  //국세청_의료비(본인,65세이상.장애인.건강보험산정특례자)
		this.ds_SaveBuya.setColumn(i, "BUYA_HP1D", this.ds_GrdHspt.getCaseSum("crudType != 'D' && HSPT_JUMI=='"+ sJumi +"' && HSPT_CODE=='1'",  "HSPT_SAMT"));   																			//국세청_의료비(실손의료보험금)
		this.ds_SaveBuya.setColumn(i, "BUYA_HP1E", this.ds_GrdHspt.getCaseSum("crudType != 'D' && HSPT_JUMI=='"+ sJumi +"' && HSPT_CODE=='1' &&  HSPT_PREM =='1'", "HSPT_GAMT"));					   										//국세청_의료비(미숙아)
		
		this.ds_SaveBuya.setColumn(i, "BUYA_HP2A", this.ds_GrdHspt.getCaseSum("crudType != 'D' && HSPT_JUMI=='"+ sJumi +"' && HSPT_CODE!='1' &&  HSPT_RELA=='2' && HSPT_NANI!='1' && HSPT_SANJ!='1' && HSPT_PREM !='1'", "HSPT_GAMT"));   	//국세청외_의료비(일반)
		this.ds_SaveBuya.setColumn(i, "BUYA_HP2B", this.ds_GrdHspt.getCaseSum("crudType != 'D' && HSPT_JUMI=='"+ sJumi +"' && HSPT_CODE!='1' &&  HSPT_NANI=='1'", "HSPT_GAMT"));   															//국세청외_의료비(난임)
		this.ds_SaveBuya.setColumn(i, "BUYA_HP2C", this.ds_GrdHspt.getCaseSum("crudType != 'D' && HSPT_JUMI=='"+ sJumi +"' && HSPT_CODE!='1' && (HSPT_RELA=='1' || HSPT_SANJ=='1') &&  HSPT_PREM =='1' && HSPT_NANI!='1'", "HSPT_GAMT"));   //국세청외_의료비(본인,65세이상.장애인.건강보험산정특례자)
		this.ds_SaveBuya.setColumn(i, "BUYA_HP2D", this.ds_GrdHspt.getCaseSum("crudType != 'D' && HSPT_JUMI=='"+ sJumi +"' && HSPT_CODE!='1'",  "HSPT_SAMT"));   																			//국세청외_의료비(실손의료보험금)
		this.ds_SaveBuya.setColumn(i, "BUYA_HP2E", this.ds_GrdHspt.getCaseSum("crudType != 'D' && HSPT_JUMI=='"+ sJumi +"' && HSPT_CODE!='1' &&  HSPT_PREM =='1'",  "HSPT_GAMT"));   														//국세청외_의료비(미숙아)
			
	}

	this.ds_SaveBuya.set_enableevent(true);

	//------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------//
	// 															기초자료(T_PR_JSBA) 반영 START  																									  //
	//------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------//
	
	// BUYA_RELA : 0본인, 1소득자의 직계존속, 2배우자의 직계존속, 3배우자, 4직계비속(자녀.입양자), 5직계비속 그외, 6형제자매, 7수급자, 8위탁아동
	var sWhere = "BUYA_RELA!='7' && BUYA_RELA!='8'";
	this.ds_GrdJsba.setColumn(0,"JSBA_IG10", this.ds_SaveBuya.getCaseCount(sWhere + " && BUYA_NOIN=='1'")); // 부양70세이상
	this.ds_GrdJsba.setColumn(0,"JSBA_IG06", this.ds_SaveBuya.getCaseCount(sWhere + " && (BUYA_JANG=='1' || BUYA_JANG=='2' || BUYA_JANG=='3')")); // 장애인
	this.ds_GrdJsba.setColumn(0,"JSBA_IG12", this.ds_SaveBuya.getCaseCount(sWhere + " && BUYA_CHIP=='1'")); // 출생및입양
	this.ds_GrdJsba.setColumn(0,"JSBA_IG07", this.fn_iif(this.ds_SaveBuya.getCaseCount(sWhere + " && BUYA_BUIN=='1'")>0, "1", "0")); // 부녀자여부
	this.ds_GrdJsba.setColumn(0,"JSBA_IG13", this.fn_iif(this.ds_SaveBuya.getCaseCount(sWhere + " && BUYA_HANB=='1'")>0, "1", "0")); // 한부모
	
	sWhere += " && BUYA_RELA!='0' && BUYA_GIBO=='1'";
	this.ds_GrdJsba.setColumn(0,"JSBA_IG02", this.ds_SaveBuya.getCaseCount(sWhere + " && BUYA_AG20=='1' && BUYA_RELA!='6'")); // 부양20세이하(형제자매 제외)
	this.ds_GrdJsba.setColumn(0,"JSBA_IG03", this.ds_SaveBuya.getCaseCount(sWhere + " && BUYA_RELA!='3' && BUYA_AG60=='1'")); // 부양60세이상(배우자 제외)
	this.ds_GrdJsba.setColumn(0,"JSBA_IG11", this.ds_SaveBuya.getCaseCount(sWhere + " && BUYA_MCHD=='1'")); // 다자녀
	this.ds_GrdJsba.setColumn(0,"JSBA_IG09", this.ds_SaveBuya.getCaseCount(sWhere + " && BUYA_RELA=='6' && (BUYA_AG20=='1' || BUYA_AG60=='1')")); // 형제자매
	this.ds_GrdJsba.setColumn(0,"JSBA_IG01", this.fn_iif(this.ds_SaveBuya.getCaseCount(sWhere + " && BUYA_WIFE=='1'")>0, "1", "0")); // 배우자여부				
	
	this.ds_GrdJsba.setColumn(0,"JSBA_IG04", this.ds_SaveBuya.getCaseCount("BUYA_RELA=='7' && BUYA_GIBO=='1'")); // 수급자
	this.ds_GrdJsba.setColumn(0,"JSBA_GG21", this.ds_SaveBuya.getCaseCount("BUYA_RELA=='8' && BUYA_GIBO=='1'")); // 위탁아동
	
	this.ds_GrdJsba.setColumn(0,"JSBA_IG08", this.ds_SaveBuya.getCaseCount("(BUYA_RELA!='7' && BUYA_RELA!='8' && BUYA_YANG=='1') || (BUYA_GIBO=='1' && BUYA_RELA=='8' && BUYA_YANG=='1') ")); // 자녀양육

	// 카드	
	if(this.fvJsmtYear >= '2021')    //전년도 소비증가분 추가
	{
		this.ds_GrdJsba.setColumn(0,"JSBA_GG07", this.ds_SaveBuya.getCaseSum("crudType != 'D'", "BUYA_CAIB")); // 신용카드(일반)
		this.ds_GrdJsba.setColumn(0,"JSBA_GG22", this.ds_SaveBuya.getCaseSum("crudType != 'D'", "BUYA_JKIB")); // 직불카드(일반)
		this.ds_GrdJsba.setColumn(0,"JSBA_GG13", this.ds_SaveBuya.getCaseSum("crudType != 'D'", "BUYA_CHIB")); // 현금영수증(일반)
		this.ds_GrdJsba.setColumn(0,"JSBA_GG12", this.ds_SaveBuya.getCaseSum("crudType != 'D'", "BUYA_CRD3")); // 학원비지로(일반)
		
		this.ds_GrdJsba.setColumn(0,"JSBA_GG24", this.ds_SaveBuya.getCaseSum("crudType != 'D'", "BUYA_CADJ")+this.ds_SaveBuya.getCaseSum("crudType != 'D'", "BUYA_JKDJ")+this.ds_SaveBuya.getCaseSum("crudType != 'D'", "BUYA_CHDJ")+this.ds_SaveBuya.getCaseSum("crudType != 'D'", "BUYA_ZEDJ")); // 대중교통		
		this.ds_GrdJsba.setColumn(0,"JSBA_GG23", this.ds_SaveBuya.getCaseSum("crudType != 'D'", "BUYA_CAJT")+this.ds_SaveBuya.getCaseSum("crudType != 'D'", "BUYA_JKJT")+this.ds_SaveBuya.getCaseSum("crudType != 'D'", "BUYA_CHJT")+this.ds_SaveBuya.getCaseSum("crudType != 'D'", "BUYA_ZEJT")); // 전통시장
		this.ds_GrdJsba.setColumn(0,"JSBA_GG49", this.ds_SaveBuya.getCaseSum("crudType != 'D'", "BUYA_CADS")+this.ds_SaveBuya.getCaseSum("crudType != 'D'", "BUYA_JKDS")+this.ds_SaveBuya.getCaseSum("crudType != 'D'", "BUYA_CHDS")+this.ds_SaveBuya.getCaseSum("crudType != 'D'", "BUYA_ZEDS")); // 도서공연비(2018추가)
		this.ds_GrdJsba.setColumn(0,"JSBA_GG50", this.ds_SaveBuya.getCaseSum("crudType != 'D'", "BUYA_ZEIB")); // 제로페이(2019추가)
		
		this.ds_GrdJsba.setColumn(0,"JSBA_GG51", this.ds_SaveBuya.getCaseSum("crudType != 'D'", "BUYA_CRD1_2020") + this.ds_SaveBuya.getCaseSum("crudType != 'D'", "BUYA_DIR1_2020") + this.ds_SaveBuya.getCaseSum("crudType != 'D'", "BUYA_CSH1_2020") + this.ds_SaveBuya.getCaseSum("crudType != 'D'", "BUYA_ZERO_2020"));  // 기타공제_신용카드_소비증가분_2021년 전체 사용분
		this.ds_GrdJsba.setColumn(0,"JSBA_GG52", this.ds_SaveBuya.getCaseSum("crudType != 'D'", "BUYA_CAIB") + this.ds_SaveBuya.getCaseSum("crudType != 'D'", "BUYA_JKIB") + this.ds_SaveBuya.getCaseSum("crudType != 'D'", "BUYA_CHIB") + this.ds_SaveBuya.getCaseSum("crudType != 'D'", "BUYA_ZEIB") +
												 this.ds_SaveBuya.getCaseSum("crudType != 'D'", "BUYA_CADJ") + this.ds_SaveBuya.getCaseSum("crudType != 'D'", "BUYA_JKDJ") + this.ds_SaveBuya.getCaseSum("crudType != 'D'", "BUYA_CHDJ") + this.ds_SaveBuya.getCaseSum("crudType != 'D'", "BUYA_ZEDJ") +												 
												 this.ds_SaveBuya.getCaseSum("crudType != 'D'", "BUYA_CAJT") + this.ds_SaveBuya.getCaseSum("crudType != 'D'", "BUYA_JKJT") + this.ds_SaveBuya.getCaseSum("crudType != 'D'", "BUYA_CHJT") + this.ds_SaveBuya.getCaseSum("crudType != 'D'", "BUYA_ZEJT") +
												 this.ds_SaveBuya.getCaseSum("crudType != 'D'", "BUYA_CADS") + this.ds_SaveBuya.getCaseSum("crudType != 'D'", "BUYA_JKDS") + this.ds_SaveBuya.getCaseSum("crudType != 'D'", "BUYA_CHDS") + this.ds_SaveBuya.getCaseSum("crudType != 'D'", "BUYA_ZEDS")
												);  // 기타공제_신용카드_소비증가분_2022년 전체 사용분
	}

	//-- 전통시장 전년, 당해년도
	this.ds_GrdJsba.setColumn(0,"JSBA_GG58", this.ds_SaveBuya.getCaseSum("crudType != 'D'", "BUYA_XTRA") +  this.ds_SaveBuya.getCaseSum("crudType != 'D'", "BUYA_XHTR") +  this.ds_SaveBuya.getCaseSum("crudType != 'D'", "BUYA_XJTR") +  this.ds_SaveBuya.getCaseSum("crudType != 'D'", "BUYA_XZTR")); //전년
	this.ds_GrdJsba.setColumn(0,"JSBA_GG59", this.ds_SaveBuya.getCaseSum("crudType != 'D'", "BUYA_NTRA") +  this.ds_SaveBuya.getCaseSum("crudType != 'D'", "BUYA_NHTR") +  this.ds_SaveBuya.getCaseSum("crudType != 'D'", "BUYA_NJTR") +  this.ds_SaveBuya.getCaseSum("crudType != 'D'", "BUYA_NZTR")); //당해년
	
	//-- 대중교통, 상반기, 하반기
	this.ds_GrdJsba.setColumn(0,"JSBA_GG60", this.ds_SaveBuya.getCaseSum("crudType != 'D'", "BUYA_SCDJ") +  this.ds_SaveBuya.getCaseSum("crudType != 'D'", "BUYA_SJDJ") +  this.ds_SaveBuya.getCaseSum("crudType != 'D'", "BUYA_SHDJ") +  this.ds_SaveBuya.getCaseSum("crudType != 'D'", "BUYA_SZDJ")); //상반기
	this.ds_GrdJsba.setColumn(0,"JSBA_GG61", this.ds_SaveBuya.getCaseSum("crudType != 'D'", "BUYA_HCDJ") +  this.ds_SaveBuya.getCaseSum("crudType != 'D'", "BUYA_HJDJ") +  this.ds_SaveBuya.getCaseSum("crudType != 'D'", "BUYA_HHDJ") +  this.ds_SaveBuya.getCaseSum("crudType != 'D'", "BUYA_HZDJ")); //하반기
	
	// 보험
	this.ds_GrdJsba.setColumn(0,"JSBA_TG01", this.ds_SaveBuya.getCaseSum("crudType != 'D'", "BUYA_BOH4")); // 일반보장성	
	this.ds_GrdJsba.setColumn(0,"JSBA_GG09", this.ds_SaveBuya.getCaseSum("crudType != 'D'", "BUYA_BOH5")); // 장애인전용
	this.ds_GrdJsba.setColumn(0,"JSBA_TG29", this.ds_SaveBuya.getCaseSum("crudType != 'D'", "BUYA_BOH3")  + this.ds_SaveBuya.getCaseSum("crudType != 'D'", "BUYA_BOH6")); // 건강보험(지역)+노인장기요양
	                                 
	this.ds_GrdJsba.setColumn(0,"JSBA_GG02", this.ds_SaveBuya.getCaseSum("crudType != 'D'","BUYA_BOH7")); // 국민연금(지역)
	
	// 교육비
	// 0:본인,1:취학전아동,2:초중고,3:대학생,4:장애인	
	var sEdgb;
	var nColChk=3;
	var nCol;
	var sCol1;
	var sCol2;	
	
	this.ds_GrdJsba.setColumn(0, "JSBA_TG04", 0); 	
	this.ds_GrdJsba.setColumn(0, "JSBA_TG05", "");
	this.ds_GrdJsba.setColumn(0, "JSBA_TG06", 0);
	this.ds_GrdJsba.setColumn(0, "JSBA_TG07", "");
	this.ds_GrdJsba.setColumn(0, "JSBA_TG08", 0);
	this.ds_GrdJsba.setColumn(0, "JSBA_TG09", "");
	this.ds_GrdJsba.setColumn(0, "JSBA_TG10", 0);
	this.ds_GrdJsba.setColumn(0, "JSBA_TG11", "");
	this.ds_GrdJsba.setColumn(0, "JSBA_TG12", 0);
	this.ds_GrdJsba.setColumn(0, "JSBA_TG13", "");
	this.ds_GrdJsba.setColumn(0, "JSBA_TG14", 0);	
	
	this.ds_GrdJsba.setColumn(0, "JSBA_TG60", 0);
	this.ds_GrdJsba.setColumn(0, "JSBA_TG25", 0);
	this.ds_GrdJsba.setColumn(0, "JSBA_TG55", 0);
	this.ds_GrdJsba.setColumn(0, "JSBA_TG61", 0);
	
	this.ds_GrdJsba.setColumn(0,"JSBA_TG04", this.ds_SaveBuya.getCaseSum("crudType != 'D' && BUYA_EDGB=='0'", "BUYA_EDU1")); // 교육비(본인)
	
	var scrudType;
	
	for(var iLoop=0; iLoop < this.ds_GrdBuyaEd.rowcount; iLoop++){
	
		scrudType = this.ds_GrdBuyaEd.getColumn(iLoop, "crudType");
		
		if(scrudType != "D"){		
			sEdgb = this.ds_GrdBuyaEd.getColumn(iLoop, "BUYA_EDGB");
			
			if(sEdgb=="1" || sEdgb=="2" || sEdgb=="3"){		 
				nColChk= nColChk + 2;
				nCol   = nColChk + 1;
				
				sCol1 = nColChk.toString().padLeft(2, "0");
				sCol2 = nCol.toString().padLeft(2, "0");						
				
				this.ds_GrdJsba.setColumn(0, "JSBA_TG" + sCol1,     this.ds_GrdBuyaEd.getColumn(iLoop, "BUYA_EDGB")); // 교육비_구분
				this.ds_GrdJsba.setColumn(0, "JSBA_TG" + sCol2, 	this.ds_GrdBuyaEd.getColumn(iLoop, "BUYA_EDU1")); // 교육비_금액		
			}
		}
	}	
	
	this.ds_GrdJsba.setColumn(0,"JSBA_TG60", this.ds_SaveBuya.getCaseSum("crudType != 'D' && BUYA_EDGB=='2'", "BUYA_EDU4")); // 교육비(초중고_체험학습비)	
	this.ds_GrdJsba.setColumn(0,"JSBA_TG25", this.ds_SaveBuya.getCaseSum("crudType != 'D' && BUYA_EDGB=='4'", "BUYA_EDU1")); // 교육비(장애인)
	this.ds_GrdJsba.setColumn(0,"JSBA_TG55", this.ds_SaveBuya.getCaseSum("crudType != 'D' && BUYA_EDGB=='2'", "BUYA_EDU3")); // 교육비(초중고_교복비)	
	this.ds_GrdJsba.setColumn(0,"JSBA_TG61", this.ds_SaveBuya.getCaseSum("crudType != 'D' && BUYA_EDGB=='0'", "BUYA_EDU5")); // 교육비(학자금대출)	
	

//	gfn_dsview(this.ds_SaveBuya);
//	return;	

    // 의료비
    //2017.12.30 오병호 추가 난임시술비 찾기
    var njSBA_TG54 = 0;   // 난임시술비
    var njSBA_TG64 = 0;   // 건강보험산정특례자
    var njSBA_TG65 = 0;   // 실손보험
    var njSBA_TG62 = 0;   // 선천성 이상아 여부//2022년//add

	njSBA_TG54 = this.ds_GrdHspt.getCaseSum("crudType != 'D' && HSPT_NANI=='1'", "HSPT_GAMT");   	//특별공제 -의료비(난임시술비)
	njSBA_TG64 = this.ds_GrdHspt.getCaseSum("crudType != 'D' && HSPT_SANJ=='1'", "HSPT_GAMT");   	//특별공제 -의료비(건강보험산정특례자)
	njSBA_TG65 = this.ds_GrdHspt.getCaseSum("crudType != 'D'", "HSPT_SAMT");   						//실손보험
	njSBA_TG62 = this.ds_GrdHspt.getCaseSum("crudType != 'D' && HSPT_PREM=='1'", "HSPT_GAMT");   	//특별공제 -의료비(미숙아&선천성이상자) //2022년//add				
		 
   	var nJSBA_TG03 = this.ds_SaveBuya.getCaseSum("crudType != 'D' && (BUYA_RELA=='0' ||  BUYA_JANG =='1' || BUYA_JANG =='2' || BUYA_JANG =='3' || BUYA_AG65=='1')", "BUYA_HSP1+BUYA_HSP2");
	var nJSBA_TG53 = this.ds_SaveBuya.getCaseSum("crudType != 'D' &&  BUYA_RELA=='0' && (BUYA_JANG !='1' && BUYA_JANG !='2' && BUYA_JANG !='3')",					"BUYA_HSP1+BUYA_HSP2");  //본인
	var nJSBA_TG42 = this.ds_SaveBuya.getCaseSum("crudType != 'D' &&  BUYA_AG65=='1' && (BUYA_RELA !='0' && BUYA_JANG !='1' && BUYA_JANG !='2' && BUYA_JANG !='3')","BUYA_HSP1+BUYA_HSP2");  //경로
	var nJSBA_TG43 = this.ds_SaveBuya.getCaseSum("crudType != 'D' && (BUYA_JANG=='1' ||  BUYA_JANG =='2' || BUYA_JANG =='3')", 										"BUYA_HSP1+BUYA_HSP2");  //장애인
	this.ds_GrdJsba.setColumn(0,"JSBA_TG03", nJSBA_TG03 + njSBA_TG64); // 본인,장애인,경로
	this.ds_GrdJsba.setColumn(0,"JSBA_TG53", nJSBA_TG53); // 본인
	this.ds_GrdJsba.setColumn(0,"JSBA_TG42", nJSBA_TG42); // 경로
	this.ds_GrdJsba.setColumn(0,"JSBA_TG43", nJSBA_TG43); // 장애인
	this.ds_GrdJsba.setColumn(0,"JSBA_TG54", njSBA_TG54); // 난임시술비
	this.ds_GrdJsba.setColumn(0,"JSBA_TG62", njSBA_TG62); // 미숙아 & 선천성 이상아 여부//2022년//add
	
	this.ds_GrdJsba.setColumn(0,"JSBA_TG02", this.ds_SaveBuya.getCaseSum("crudType != 'D'", "BUYA_HSP1")+this.ds_SaveBuya.getCaseSum("crudType != 'D'", "BUYA_HSP2") - nJSBA_TG03 - njSBA_TG54 - njSBA_TG64 - njSBA_TG62); // 그 밖의 의료비 //미숙아 포함//add	
	this.ds_GrdJsba.setColumn(0,"JSBA_TG64", njSBA_TG64); // 건강보험산정특례자
	this.ds_GrdJsba.setColumn(0,"JSBA_TG65", njSBA_TG65); // 실손보험	
	
	//gfn_dsview(this.ds_SaveBuya);
	trace('그 밖의 의료비 = '+ this.ds_SaveBuya.getCaseSum("crudType != 'D'", "BUYA_HSP1")+' + '+this.ds_SaveBuya.getCaseSum("crudType != 'D'", "BUYA_HSP2")+' - '+nJSBA_TG53);
		
	// 기부금	
	if (this.ds_GrdGibu.getRowCount() > 0){
		var nJSBA_TG30 = 0;
		var nGibuSegum = 0;
		var jcgu_amt = 0;
		var nGbchGamt = 0;
		jcgu_amt = this.ds_GrdGibu.getCaseSum("crudType != 'D' && GIBU_CODE=='20'","GIBU_GAMT" ); 

		nJSBA_TG30 += jcgu_amt;
		nGibuSegum += (nJSBA_TG30<=100000)? nJSBA_TG30: 100000;
		/*for (var i=0; i<this.ds_GrdGibu.getRowCount(); i++)
		{
			if (this.ds_GrdGibu.getColumn(i,"GIBU_CODE")=="20")
			{
	
				nJSBA_TG30 += toNumber(this.ds_GrdGibu.getColumn(i,"GIBU_GAMT"));
				nGibuSegum += this.fn_iif(nJSBA_TG30<=100000, nJSBA_TG30, 100000);
			}
		}*/
		
		this.ds_GrdJsba.setColumn(0,"JSBA_TG30", nJSBA_TG30 - nGibuSegum); // 100%:정치자금				
		this.ds_GrdJsba.setColumn(0,"JSBA_TG20", this.ds_GrdGibu.getCaseSum("crudType != 'D' && GIBU_CODE=='10'",                    "GIBU_GAMT")); // 100%:법정
		this.ds_GrdJsba.setColumn(0,"JSBA_TG21", this.ds_GrdGibu.getCaseSum("crudType != 'D' && GIBU_CODE=='31' || GIBU_CODE=='30'", "GIBU_GAMT")); // 50% :공익법인기부신탁,특례
		this.ds_GrdJsba.setColumn(0,"JSBA_TG39", this.ds_GrdGibu.getCaseSum("crudType != 'D' && GIBU_CODE=='42'",                    "GIBU_GAMT")); // 30% :우리사주
		this.ds_GrdJsba.setColumn(0,"JSBA_TG36", this.ds_GrdGibu.getCaseSum("crudType != 'D' && GIBU_CODE=='41'",                    "GIBU_GAMT")); // 10% :종교단체
		this.ds_GrdJsba.setColumn(0,"JSBA_TG38", this.ds_GrdGibu.getCaseSum("crudType != 'D' && GIBU_CODE=='40'",                    "GIBU_GAMT")); // 15% :종교단체외
		this.ds_GrdJsba.setColumn(0,"JSBA_SG08", nGibuSegum); // 세액공제:정치자금
		
		// 기부금조정상세를 삭제한다.
		for (var i=this.ds_GrdGbch.getRowCount()-1; i>=0; i--)
		{
			if (this.fvJsmtYear == this.ds_GrdGbch.getColumn(i,"GBCH_GBYY").toString().substr(0,4)){
				this.ds_GrdGbch.deleteRow(i);
			}
		}
		
		this.ds_GrdGibuGrup.copyData(this.ds_GrdGibu);
		/*
		this.ds_GrdGibuGrup.clearData();
		for (var i=0; i<this.ds_GrdGibu.getRowCount(); i++)
		{	
			var nRow = this.ds_GrdGibuGrup.addRow();
			this.ds_GrdGibuGrup.setColumn(nRow,"GIBU_CODE", this.ds_GrdGibu.getColumn(i,"GIBU_CODE"))
		}
		*/
		
// 		this.ds_GrdGibuGrup.set_keystring("G:GIBU_CODE");
// 		trace("기부그룹 수---->"+this.ds_GrdGibuGrup.getGroupRangeCount());
// 		for (var i=0; i<this.ds_GrdGibuGrup.getGroupRangeCount(); i++){
// 			trace("기부코드---->"+this.ds_GrdGibuGrup.getColumn(i,"GIBU_CODE"));
// 			nGbchGamt=0;
// 			if (this.ds_GrdGibuGrup.getColumn(i,"GIBU_CODE") == "20")
// 				nGbchGamt = this.ds_GrdJsba.getColumn(0,"JSBA_TG30");
// 			else if	(this.ds_GrdGibuGrup.getColumn(i,"GIBU_CODE") == "10")
// 				nGbchGamt = this.ds_GrdJsba.getColumn(0,"JSBA_TG20") ;
// 			else if	(this.ds_GrdGibuGrup.getColumn(i,"GIBU_CODE") == "31")
// 				nGbchGamt = this.ds_GrdGibu.getCaseSum("crudType != 'D' && GIBU_CODE=='31'", "GIBU_GAMT") ;
// 			else if	(this.ds_GrdGibuGrup.getColumn(i,"GIBU_CODE") == "30")
// 				nGbchGamt = this.ds_GrdGibu.getCaseSum("crudType != 'D' && GIBU_CODE=='30'", "GIBU_GAMT");
// 			else if	(this.ds_GrdGibuGrup.getColumn(i,"GIBU_CODE") == "42")
// 				nGbchGamt = this.ds_GrdJsba.getColumn(0,"JSBA_TG39") ;
// 			else if	(this.ds_GrdGibuGrup.getColumn(i,"GIBU_CODE") == "41")
// 				nGbchGamt = this.ds_GrdJsba.getColumn(0,"JSBA_TG36");
// 			else if	(this.ds_GrdGibuGrup.getColumn(i,"GIBU_CODE") == "40")
// 				nGbchGamt = this.ds_GrdJsba.getColumn(0,"JSBA_TG38");                                                               
// 																								  
// 			var nRow = this.ds_GrdGbch.addRow();
// 			this.ds_GrdGbch.setColumn(nRow, "COMP_CODE", this.fvCompCode);
// 			this.ds_GrdGbch.setColumn(nRow, "GBCH_YEAR", this.fvJsmtYear);
// 			this.ds_GrdGbch.setColumn(nRow, "SYST_ID", this.div_Search.form.edt_SystId.value);
// 			this.ds_GrdGbch.setColumn(nRow, "GBCH_GBYY", this.fvJsmtYear);
// 			this.ds_GrdGbch.setColumn(nRow, "GBCH_CODE", this.ds_GrdGibuGrup.getColumn(i,"GIBU_CODE"));
// 			this.ds_GrdGbch.setColumn(nRow, "GBCH_GAMT", nGbchGamt);
// 			this.ds_GrdGbch.setColumn(nRow, "GBCH_GDAM", this.ds_GrdGbch.getColumn(nRow, "GBCH_GAMT"));
// 		}

		//-- 기부금 세부내역
		this.fn_GibuSebu();
   }       
    
    trace('연금저축시작 ');
    // 연금저축
	this.ds_GrdJsba.setColumn(0,"JSBA_GG17", this.ds_GrdSave.getCaseSum("crudType != 'D' && SAVE_GUBN=='11' || SAVE_GUBN=='12'", "SAVE_BAMT")); // 기타공제_연금_퇴직연금
	this.ds_GrdJsba.setColumn(0,"JSBA_GG01", this.ds_GrdSave.getCaseSum("crudType != 'D' && SAVE_GUBN=='21'", "SAVE_BAMT")); // 기타공제_개인연금
	this.ds_GrdJsba.setColumn(0,"JSBA_GG08", this.ds_GrdSave.getCaseSum("crudType != 'D' && SAVE_GUBN=='22'", "SAVE_BAMT")); // 기타공제_연금_저축액
	this.ds_GrdJsba.setColumn(0,"JSBA_TG15", this.ds_GrdSave.getCaseSum("crudType != 'D' && SAVE_GUBN=='31'", "SAVE_BAMT")); // 특별공제_청약저축
	this.ds_GrdJsba.setColumn(0,"JSBA_TG49", this.ds_GrdSave.getCaseSum("crudType != 'D' && SAVE_GUBN=='32'", "SAVE_BAMT")); // 주택청약종합저축
	this.ds_GrdJsba.setColumn(0,"JSBA_TG48", this.ds_GrdSave.getCaseSum("crudType != 'D' && SAVE_GUBN=='33'", "SAVE_BAMT")); // 장기주택마련저축
	this.ds_GrdJsba.setColumn(0,"JSBA_TG47", this.ds_GrdSave.getCaseSum("crudType != 'D' && SAVE_GUBN=='34'", "SAVE_BAMT")); // 근로자주택마련저축
	this.ds_GrdJsba.setColumn(0,"JSBA_GG41", this.ds_GrdSave.getCaseSum("crudType != 'D' && SAVE_GUBN=='51'", "SAVE_BAMT")); // 장기집합투자증권저축
	this.ds_GrdJsba.setColumn(0,"JSBA_GG14", this.ds_GrdSave.getCaseSum("crudType != 'D' && SAVE_GUBN=='41' && SAVE_PAYY=='01'", "SAVE_BAMT")); // 기타공제_장기주식형저축1년차
	this.ds_GrdJsba.setColumn(0,"JSBA_GG15", this.ds_GrdSave.getCaseSum("crudType != 'D' && SAVE_GUBN=='41' && SAVE_PAYY=='02'", "SAVE_BAMT")); // 기타공제_장기주식형저축2년차
	this.ds_GrdJsba.setColumn(0,"JSBA_GG16", this.ds_GrdSave.getCaseSum("crudType != 'D' && SAVE_GUBN=='41' && SAVE_PAYY=='03'", "SAVE_BAMT")); // 기타공제_장기주식형저축3년차
	
	this.ds_GrdJsba.setColumn(0,"JSBA_GG56", this.ds_GrdSave.getCaseSum("crudType != 'D' && SAVE_GUBN=='71'", "SAVE_BAMT")); // ISA계좌(개인연금)
	this.ds_GrdJsba.setColumn(0,"JSBA_GG57", this.ds_GrdSave.getCaseSum("crudType != 'D' && SAVE_GUBN=='72'", "SAVE_BAMT")); // ISA계좌(퇴직연금)

    //2021년 추가. 변경 여부 체크 컬럼
	this.ds_GrdJsba.setColumn(0,"JSBA_CHNG", "Y"); // 변경 여부
	trace("기초자료(T_PR_JSBA) 반영 END");
	
	//------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------//
	// 																기초자료(T_PR_JSBA) 반영 END
	//------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------//

	var sInputDaset = "" //입력 데이터셋
	//PDF 저장일경우
	trace("PDF 여부-->" & strFlag)	
	
	//if( strFlag == 'PDF')	
		
	if(this.strFlag)
	{
		this.ds_Input.addRow();
		this.ds_Input.setColumn(0,"dType","D");		
		this.ds_Input.setColumn(0,"BUYA_YEAR",this.fvJsmtYear);
		this.ds_Input.setColumn(0,"RENT_YEAR",this.fvJsmtYear);
		this.ds_Input.setColumn(0,"SESU_ID", this.div_Search.form.edt_SystId.value);
		this.ds_Input.setColumn(0,"SYST_ID", this.div_Search.form.edt_SystId.value);
		this.ds_Input.setColumn(0,"GUBN","PDF");
		
	
		//의료비 삭제
		svcAddObj = new Object();//[공통] 서비스 추가 파라메타 정보 Object	
		svcAddObj.sDeleteSql = "hr:M_HS_8390_M_DL80";//삭제Sql
		svcAddObj.sSaveFlagColumn = "dType";//insertSql, updateSql, deleteSql이 존재하여 신규, 수정, 삭제를 처리할 경우 기본적으로 Dataset의 getRowStates()로 판단하여 처리하며
								 //이를 Flag 컬럼으로 대체하고 싶은 경우 사용하는 [컬럼명], 해당 Flag 컬럼의 값은 신규 - I , 수정 - U , 삭제 - D의 값을 가져야 한다.
		this.gfn_AddComSaveService(this, svcAddObj);		
		
		//기부금 삭제
		svcAddObj.sDeleteSql = "hr:M_HS_8390_M_DL90";//삭제Sql			
		this.gfn_AddComSaveService(this, svcAddObj);
		
  		svcAddObj.sDeleteSql = "hr:M_HS_8390_M_DL91";//삭제Sql	 		
  		this.gfn_AddComSaveService(this, svcAddObj);
		
		sInputDaset = "ds_Input=ds_Input" //입력 데이터셋
		
		
		//월세/거주자간 주택임차 삭제
		svcAddObj.sDeleteSql = "hr:M_HS_8390_M_DL70";//삭제Sql
		this.gfn_AddComSaveService(this, svcAddObj);
		if (this.gfn_IsNull(sInputDaset)) {
			sInputDaset = "ds_GrdRent=ds_Input:U" //입력 데이터셋
		} else {
			sInputDaset = sInputDaset + " ds_GrdRent=ds_Input:U" //입력 데이터셋
		}
		
		//연금/저축 삭제
		svcAddObj.sDeleteSql = "hr:M_HS_8390_M_DL50";//삭제Sql
		this.gfn_AddComSaveService(this, svcAddObj);
		if (this.gfn_IsNull(sInputDaset)) {
			sInputDaset = "ds_GrdSave=ds_Input:U" //입력 데이터셋
		} else {
			sInputDaset = sInputDaset + " ds_GrdSave=ds_Input:U" //입력 데이터셋
		}
	
		//[공통]서비스 호출 변수
		var svcCallObj = new Object();//[공통] 서비스 파라메타 정보 Object
		svcCallObj.sActionName = this.G_SV_HR;//서버에서 호출할 Action - 모듈별로 호출되는 기본 Actio이 다름 : 공통 서비스 Action 업무구분  변수 참조
		svcCallObj.sInputDaset = sInputDaset //입력 데이터셋
		svcCallObj.sOutDatset = "";//출력 데이터셋
		svcCallObj.sOtherArg = "";//서버로 전송할 기타 Argument 정보 문자열, 예) key=value key2=value2
		svcCallObj.isSync = true;//동기식으로 설정할지 여부  (동기 true, 비동기 false)	

		this.gfn_CallComService(this, svcCallObj);	
		
		
		//---- 기부금 이월내역			
		
		this.ds_Input.clearData();
		this.ds_Input.addRow();
		this.ds_Input.setColumn(0,"dType","I");		
		this.ds_Input.setColumn(0,"BUYA_YEAR",this.fvJsmtYear);
		this.ds_Input.setColumn(0,"SESU_ID", this.div_Search.form.edt_SystId.value);
		this.ds_Input.setColumn(0,"GUBN","PDF");
			
			
		//기부금상세
		svcAddObj = new Object();//[공통] 서비스 추가 파라메타 정보 Object	
		svcAddObj.sInsertSql = "hr:M_HS_8390_M_IN41";//삭제Sql
		svcAddObj.sSaveFlagColumn = "dType";//insertSql, updateSql, deleteSql이 존재하여 신규, 수정, 삭제를 처리할 경우 기본적으로 Dataset의 getRowStates()로 판단하여 처리하며
								 //이를 Flag 컬럼으로 대체하고 싶은 경우 사용하는 [컬럼명], 해당 Flag 컬럼의 값은 신규 - I , 수정 - U , 삭제 - D의 값을 가져야 한다.
		this.gfn_AddComSaveService(this, svcAddObj);		
		

		//[공통]서비스 호출 변수
		var svcCallObj = new Object();//[공통] 서비스 파라메타 정보 Object
		svcCallObj.sActionName = this.G_SV_HR;//서버에서 호출할 Action - 모듈별로 호출되는 기본 Actio이 다름 : 공통 서비스 Action 업무구분  변수 참조
		svcCallObj.sInputDaset = sInputDaset //입력 데이터셋
		svcCallObj.sOutDatset = "";//출력 데이터셋
		svcCallObj.sOtherArg = "";//서버로 전송할 기타 Argument 정보 문자열, 예) key=value key2=value2
		svcCallObj.isSync = true;//동기식으로 설정할지 여부  (동기 true, 비동기 false)	

		this.gfn_CallComService(this, svcCallObj);	
		
		//---------------------------------------------------------		
		
		sInputDaset = "" ;//초기화
		// 의료비저장
		svcAddObj = new Object();//[공통] 서비스 추가 파라메타 정보 Object				 
		svcAddObj.sInsertSql = "hr:M_HS_8390_M_IN20";//저장Sql
		svcAddObj.sUpdateSql = "hr:M_HS_8390_M_UP20";//수정Sql
		svcAddObj.sDeleteSql = "hr:M_HS_8390_M_DL20";//삭제Sql
		svcAddObj.sSaveFlagColumn = "crudType";//insertSql, updateSql, deleteSql이 존재하여 신규, 수정, 삭제를 처리할 경우 기본적으로 Dataset의 getRowStates()로 판단하여 처리하며
								 //이를 Flag 컬럼으로 대체하고 싶은 경우 사용하는 [컬럼명], 해당 Flag 컬럼의 값은 신규 - I , 수정 - U , 삭제 - D의 값을 가져야 한다.
		this.gfn_AddComSaveService(this, svcAddObj);
		
		// 의료비(국세청외 합계값 부양가족으로 넘기기)
		svcAddObj = new Object();//[공통] 서비스 추가 파라메타 정보 Object				 
		svcAddObj.sInsertSql = "hr:M_HS_8390_M_IN21";//저장Sql
		svcAddObj.sUpdateSql = "hr:M_HS_8390_M_UP21";//수정Sql
		svcAddObj.sDeleteSql = "hr:M_HS_8390_M_DL21";//삭제Sql
		svcAddObj.sSaveFlagColumn = "crudType";//insertSql, updateSql, deleteSql이 존재하여 신규, 수정, 삭제를 처리할 경우 기본적으로 Dataset의 getRowStates()로 판단하여 처리하며
								 //이를 Flag 컬럼으로 대체하고 싶은 경우 사용하는 [컬럼명], 해당 Flag 컬럼의 값은 신규 - I , 수정 - U , 삭제 - D의 값을 가져야 한다.
		this.gfn_AddComSaveService(this, svcAddObj);
		
		if (this.gfn_IsNull(sInputDaset)) {
			sInputDaset = "ds_GrdHspt=ds_GrdHspt:U" //입력 데이터셋
		} else {
			sInputDaset = sInputDaset + " ds_GrdHspt=ds_GrdHspt:U" //입력 데이터셋
		}
		
		// 기부금
		svcAddObj = new Object();//[공통] 서비스 추가 파라메타 정보 Object				 
		svcAddObj.sInsertSql = "hr:M_HS_8390_M_IN30";//저장Sql
		svcAddObj.sUpdateSql = "hr:M_HS_8390_M_UP30";//수정Sql
		svcAddObj.sDeleteSql = "hr:M_HS_8390_M_DL30";//삭제Sql
		svcAddObj.sSaveFlagColumn = "crudType";//insertSql, updateSql, deleteSql이 존재하여 신규, 수정, 삭제를 처리할 경우 기본적으로 Dataset의 getRowStates()로 판단하여 처리하며
								 //이를 Flag 컬럼으로 대체하고 싶은 경우 사용하는 [컬럼명], 해당 Flag 컬럼의 값은 신규 - I , 수정 - U , 삭제 - D의 값을 가져야 한다.
		this.gfn_AddComSaveService(this, svcAddObj);
		
		if (this.gfn_IsNull(sInputDaset)) {
			sInputDaset = "ds_GrdGibu=ds_GrdGibu:U" //입력 데이터셋
		} else {
			sInputDaset = sInputDaset + " ds_GrdGibu=ds_GrdGibu:U" //입력 데이터셋
		}
		
		// 기부금조정상세
		svcAddObj = new Object();//[공통] 서비스 추가 파라메타 정보 Object				 
		svcAddObj.sInsertSql = "hr:M_HS_8390_M_IN40";//저장Sql
		svcAddObj.sUpdateSql = "hr:M_HS_8390_M_UP40";//수정Sql
		svcAddObj.sDeleteSql = "hr:M_HS_8390_M_DL40";//삭제Sql
		svcAddObj.sSaveFlagColumn = "crudType";//insertSql, updateSql, deleteSql이 존재하여 신규, 수정, 삭제를 처리할 경우 기본적으로 Dataset의 getRowStates()로 판단하여 처리하며
								 //이를 Flag 컬럼으로 대체하고 싶은 경우 사용하는 [컬럼명], 해당 Flag 컬럼의 값은 신규 - I , 수정 - U , 삭제 - D의 값을 가져야 한다.
		this.gfn_AddComSaveService(this, svcAddObj);
		
		if (this.gfn_IsNull(sInputDaset)) {
			sInputDaset = "ds_GrdGbch=ds_GrdGbch:U" //입력 데이터셋
		} else {
			sInputDaset = sInputDaset + " ds_GrdGbch=ds_GrdGbch:U" //입력 데이터셋
		}
		
		// 월세/거주자간 주택임차
		svcAddObj = new Object();//[공통] 서비스 추가 파라메타 정보 Object				 
		svcAddObj.sInsertSql = "hr:M_HS_8390_M_IN70";//저장Sql
		svcAddObj.sUpdateSql = "hr:M_HS_8390_M_UP70";//수정Sql
		svcAddObj.sDeleteSql = "hr:M_HS_8390_M_DL70";//삭제Sql
		svcAddObj.sSaveFlagColumn = "crudType";//insertSql, updateSql, deleteSql이 존재하여 신규, 수정, 삭제를 처리할 경우 기본적으로 Dataset의 getRowStates()로 판단하여 처리하며
								 //이를 Flag 컬럼으로 대체하고 싶은 경우 사용하는 [컬럼명], 해당 Flag 컬럼의 값은 신규 - I , 수정 - U , 삭제 - D의 값을 가져야 한다.
		this.gfn_AddComSaveService(this, svcAddObj);
		
		if (this.gfn_IsNull(sInputDaset)) {
			sInputDaset = "ds_GrdRent=ds_GrdRent:U" //입력 데이터셋
		} else {
			sInputDaset = sInputDaset + " ds_GrdRent=ds_GrdRent:U" //입력 데이터셋
		}
		
		// 연금/저축
		svcAddObj = new Object();//[공통] 서비스 추가 파라메타 정보 Object				 
		svcAddObj.sInsertSql = "hr:M_HS_8390_M_IN50";//저장Sql
		svcAddObj.sUpdateSql = "hr:M_HS_8390_M_UP50";//수정Sql
		svcAddObj.sDeleteSql = "hr:M_HS_8390_M_DL50";//삭제Sql
		svcAddObj.sSaveFlagColumn = "crudType";//insertSql, updateSql, deleteSql이 존재하여 신규, 수정, 삭제를 처리할 경우 기본적으로 Dataset의 getRowStates()로 판단하여 처리하며
								 //이를 Flag 컬럼으로 대체하고 싶은 경우 사용하는 [컬럼명], 해당 Flag 컬럼의 값은 신규 - I , 수정 - U , 삭제 - D의 값을 가져야 한다.
		this.gfn_AddComSaveService(this, svcAddObj);
		
		if (this.gfn_IsNull(sInputDaset)) {
			sInputDaset = "ds_GrdSave=ds_GrdSave:U" //입력 데이터셋
		} else {
			sInputDaset = sInputDaset + " ds_GrdSave=ds_GrdSave:U" //입력 데이터셋
		}
		
		//부양가족
		svcAddObj = new Object();//[공통] 서비스 추가 파라메타 정보 Object				 
		svcAddObj.sInsertSql = "";//저장Sql
		svcAddObj.sUpdateSql = "hr:M_HS_8390_M_UP10";//수정Sql
		svcAddObj.sDeleteSql = "hr:M_HS_8390_M_DL10";//삭제Sql
		svcAddObj.sSaveFlagColumn = "crudType";//insertSql, updateSql, deleteSql이 존재하여 신규, 수정, 삭제를 처리할 경우 기본적으로 Dataset의 getRowStates()로 판단하여 처리하며
								 //이를 Flag 컬럼으로 대체하고 싶은 경우 사용하는 [컬럼명], 해당 Flag 컬럼의 값은 신규 - I , 수정 - U , 삭제 - D의 값을 가져야 한다.
		this.gfn_AddComSaveService(this, svcAddObj);
		
		if (this.gfn_IsNull(sInputDaset)) {
			sInputDaset = "ds_SaveBuya=ds_SaveBuya:U" //입력 데이터셋
		} else {
			sInputDaset = sInputDaset + " ds_SaveBuya=ds_SaveBuya:U" //입력 데이터셋
		}
		
		// 주택자금,기타, 기초자료에 부양가족, 신용카드, 교육비,보험로 업데이트
		svcAddObj = new Object();//[공통] 서비스 추가 파라메타 정보 Object				 
		svcAddObj.sInsertSql = "";//저장Sql
		svcAddObj.sUpdateSql = "hr:M_HS_8390_M_UP00";//수정Sql
		svcAddObj.sDeleteSql = "";//삭제Sql
		svcAddObj.sSaveFlagColumn = "crudType";//insertSql, updateSql, deleteSql이 존재하여 신규, 수정, 삭제를 처리할 경우 기본적으로 Dataset의 getRowStates()로 판단하여 처리하며
								 //이를 Flag 컬럼으로 대체하고 싶은 경우 사용하는 [컬럼명], 해당 Flag 컬럼의 값은 신규 - I , 수정 - U , 삭제 - D의 값을 가져야 한다.
		this.gfn_AddComSaveService(this, svcAddObj);
		
		if (this.gfn_IsNull(sInputDaset)) {
			sInputDaset = "ds_GrdJsba=ds_GrdJsba:U" //입력 데이터셋
		} else {
			sInputDaset = sInputDaset + " ds_GrdJsba=ds_GrdJsba:U" //입력 데이터셋
		}
		
		
	//일반 저장인경우	
	}else{		
	
		var iTabIndex = this.div_MasterView.form.tab_Master.tabindex;
		trace("iTabIndex-->"+ iTabIndex);
		
		this.ds_Input.clearData();
		this.ds_Input.addRow();
		this.ds_Input.setColumn(0,"dType","D");		
		this.ds_Input.setColumn(0,"BUYA_YEAR",this.fvJsmtYear);
		this.ds_Input.setColumn(0,"SESU_ID", this.div_Search.form.edt_SystId.value);		
		
		//-----------------------------------------------------------------------------------------------------------------------------------------------------
		
		//[공통]서비스정보 초기화
		this.gfn_InitComService(this);
	
		//부양가족, 보험료, 신용카드, 교육비		
		
		//[공통]서비스정보 초기화
		this.gfn_InitComService(this);
		
		if(iTabIndex == 0 || iTabIndex == 1 || iTabIndex == 2 || iTabIndex == 3 || nIndex == 0 || nIndex == 1 || nIndex == 2 || nIndex == 3){
			trace("부양가족, 보험료, 신용카드, 교육비 저장");
			// 부양가족
			svcAddObj = new Object();//[공통] 서비스 추가 파라메타 정보 Object				 
			svcAddObj.sInsertSql = "hr:M_HS_8390_M_IN10";//저장Sql
			svcAddObj.sUpdateSql = "hr:M_HS_8390_M_UP10";//수정Sql
			svcAddObj.sDeleteSql = "hr:M_HS_8390_M_DL10";//삭제Sql
			svcAddObj.sSaveFlagColumn = "crudType";//insertSql, updateSql, deleteSql이 존재하여 신규, 수정, 삭제를 처리할 경우 기본적으로 Dataset의 getRowStates()로 판단하여 처리하며
									 //이를 Flag 컬럼으로 대체하고 싶은 경우 사용하는 [컬럼명], 해당 Flag 컬럼의 값은 신규 - I , 수정 - U , 삭제 - D의 값을 가져야 한다.
			this.gfn_AddComSaveService(this, svcAddObj);
			
			if (this.gfn_IsNull(sInputDaset)) {
				sInputDaset = "ds_SaveBuya=ds_SaveBuya:U" //입력 데이터셋
			} else {
				sInputDaset = sInputDaset + " ds_SaveBuya=ds_SaveBuya:U" //입력 데이터셋
			}
					
			
			// 주택자금,기타, 기초자료에 부양가족, 신용카드, 교육비,보험로 업데이트
			svcAddObj = new Object();//[공통] 서비스 추가 파라메타 정보 Object				 
			svcAddObj.sInsertSql = "";//저장Sql
			svcAddObj.sUpdateSql = "hr:M_HS_8390_M_UP00";//수정Sql
			svcAddObj.sDeleteSql = "";//삭제Sql
			svcAddObj.sSaveFlagColumn = "crudType";//insertSql, updateSql, deleteSql이 존재하여 신규, 수정, 삭제를 처리할 경우 기본적으로 Dataset의 getRowStates()로 판단하여 처리하며
									 //이를 Flag 컬럼으로 대체하고 싶은 경우 사용하는 [컬럼명], 해당 Flag 컬럼의 값은 신규 - I , 수정 - U , 삭제 - D의 값을 가져야 한다.
			this.gfn_AddComSaveService(this, svcAddObj);
			
			if (this.gfn_IsNull(sInputDaset)) {
				sInputDaset = "ds_GrdJsba=ds_GrdJsba:U" //입력 데이터셋
			} else {
				sInputDaset = sInputDaset + " ds_GrdJsba=ds_GrdJsba:U" //입력 데이터셋
			}
			
			
		//의료비
		}else if(iTabIndex == 4 || nIndex == 4){
			// 부양가족
			svcAddObj = new Object();//[공통] 서비스 추가 파라메타 정보 Object				 
			svcAddObj.sInsertSql = "hr:M_HS_8390_M_IN10";//저장Sql
			svcAddObj.sUpdateSql = "hr:M_HS_8390_M_UP10";//수정Sql
			svcAddObj.sDeleteSql = "hr:M_HS_8390_M_DL10";//삭제Sql
			svcAddObj.sSaveFlagColumn = "crudType";//insertSql, updateSql, deleteSql이 존재하여 신규, 수정, 삭제를 처리할 경우 기본적으로 Dataset의 getRowStates()로 판단하여 처리하며
									 //이를 Flag 컬럼으로 대체하고 싶은 경우 사용하는 [컬럼명], 해당 Flag 컬럼의 값은 신규 - I , 수정 - U , 삭제 - D의 값을 가져야 한다.
			this.gfn_AddComSaveService(this, svcAddObj);
			
			if (this.gfn_IsNull(sInputDaset)) {
				sInputDaset = "ds_SaveBuya=ds_SaveBuya:U" //입력 데이터셋
			} else {
				sInputDaset = sInputDaset + " ds_SaveBuya=ds_SaveBuya:U" //입력 데이터셋
			}
			
			/// 의료비저장
			svcAddObj = new Object();//[공통] 서비스 추가 파라메타 정보 Object				 
			svcAddObj.sInsertSql = "hr:M_HS_8390_M_IN20";//저장Sql
			svcAddObj.sUpdateSql = "hr:M_HS_8390_M_UP20";//수정Sql
			svcAddObj.sDeleteSql = "hr:M_HS_8390_M_DL20";//삭제Sql
			svcAddObj.sSaveFlagColumn = "crudType";//insertSql, updateSql, deleteSql이 존재하여 신규, 수정, 삭제를 처리할 경우 기본적으로 Dataset의 getRowStates()로 판단하여 처리하며
									 //이를 Flag 컬럼으로 대체하고 싶은 경우 사용하는 [컬럼명], 해당 Flag 컬럼의 값은 신규 - I , 수정 - U , 삭제 - D의 값을 가져야 한다.
			this.gfn_AddComSaveService(this, svcAddObj);
			
			// 의료비(국세청외 합계값 부양가족으로 넘기기)
			svcAddObj = new Object();//[공통] 서비스 추가 파라메타 정보 Object				 
			svcAddObj.sInsertSql = "hr:M_HS_8390_M_IN21";//저장Sql
			svcAddObj.sUpdateSql = "hr:M_HS_8390_M_UP21";//수정Sql
			svcAddObj.sDeleteSql = "hr:M_HS_8390_M_DL21";//삭제Sql
			svcAddObj.sSaveFlagColumn = "crudType";//insertSql, updateSql, deleteSql이 존재하여 신규, 수정, 삭제를 처리할 경우 기본적으로 Dataset의 getRowStates()로 판단하여 처리하며
									 //이를 Flag 컬럼으로 대체하고 싶은 경우 사용하는 [컬럼명], 해당 Flag 컬럼의 값은 신규 - I , 수정 - U , 삭제 - D의 값을 가져야 한다.
			this.gfn_AddComSaveService(this, svcAddObj);
			
			if (this.gfn_IsNull(sInputDaset)) {
				sInputDaset = "ds_GrdHspt=ds_GrdHspt:U" //입력 데이터셋
			} else {
				sInputDaset = sInputDaset + " ds_GrdHspt=ds_GrdHspt:U" //입력 데이터셋
			}
			
			//기초자료
			svcAddObj = new Object();//[공통] 서비스 추가 파라메타 정보 Object				 
			svcAddObj.sInsertSql = "";//저장Sql
			svcAddObj.sUpdateSql = "hr:M_HS_8390_M_UP00";//수정Sql
			svcAddObj.sDeleteSql = "";//삭제Sql
			svcAddObj.sSaveFlagColumn = "crudType";//insertSql, updateSql, deleteSql이 존재하여 신규, 수정, 삭제를 처리할 경우 기본적으로 Dataset의 getRowStates()로 판단하여 처리하며
									 //이를 Flag 컬럼으로 대체하고 싶은 경우 사용하는 [컬럼명], 해당 Flag 컬럼의 값은 신규 - I , 수정 - U , 삭제 - D의 값을 가져야 한다.
			this.gfn_AddComSaveService(this, svcAddObj);
			
			if (this.gfn_IsNull(sInputDaset)) {
				sInputDaset = "ds_GrdJsba=ds_GrdJsba:U" //입력 데이터셋
			} else {
				sInputDaset = sInputDaset + " ds_GrdJsba=ds_GrdJsba:U" //입력 데이터셋
			}
		
		//기부금
		}else if(iTabIndex == 5 || nIndex == 5){
			//기부금상세 삭제-------------------------------------------------------------------------------------------------------------------------------------
			svcAddObj = new Object();//[공통] 서비스 추가 파라메타 정보 Object	
			svcAddObj.sDeleteSql = "hr:M_HS_8390_M_DL91";//삭제Sql
			svcAddObj.sSaveFlagColumn = "dType";//insertSql, updateSql, deleteSql이 존재하여 신규, 수정, 삭제를 처리할 경우 기본적으로 Dataset의 getRowStates()로 판단하여 처리하며
									 //이를 Flag 컬럼으로 대체하고 싶은 경우 사용하는 [컬럼명], 해당 Flag 컬럼의 값은 신규 - I , 수정 - U , 삭제 - D의 값을 가져야 한다.
			this.gfn_AddComSaveService(this, svcAddObj);		
			
			sInputDaset = "ds_Input=ds_Input" //입력 데이터셋		
			
			//[공통]서비스 호출 변수
			var svcCallObj = new Object();//[공통] 서비스 파라메타 정보 Object
			svcCallObj.sActionName = this.G_SV_HR;//서버에서 호출할 Action - 모듈별로 호출되는 기본 Actio이 다름 : 공통 서비스 Action 업무구분  변수 참조
			svcCallObj.sInputDaset = sInputDaset //입력 데이터셋
			svcCallObj.sOutDatset = "";//출력 데이터셋
			svcCallObj.sOtherArg = "";//서버로 전송할 기타 Argument 정보 문자열, 예) key=value key2=value2
			svcCallObj.isSync = true;//동기식으로 설정할지 여부  (동기 true, 비동기 false)	

			this.gfn_CallComService(this, svcCallObj);
			
			this.fn_GibuSebu();	
			//----------------------------------------------------------------------------------------------------------------
		
		
		
			// 부양가족
			svcAddObj = new Object();//[공통] 서비스 추가 파라메타 정보 Object				 
			svcAddObj.sInsertSql = "hr:M_HS_8390_M_IN10";//저장Sql
			svcAddObj.sUpdateSql = "hr:M_HS_8390_M_UP10";//수정Sql
			svcAddObj.sDeleteSql = "hr:M_HS_8390_M_DL10";//삭제Sql
			svcAddObj.sSaveFlagColumn = "crudType";//insertSql, updateSql, deleteSql이 존재하여 신규, 수정, 삭제를 처리할 경우 기본적으로 Dataset의 getRowStates()로 판단하여 처리하며
									 //이를 Flag 컬럼으로 대체하고 싶은 경우 사용하는 [컬럼명], 해당 Flag 컬럼의 값은 신규 - I , 수정 - U , 삭제 - D의 값을 가져야 한다.
			this.gfn_AddComSaveService(this, svcAddObj);
			
			if (this.gfn_IsNull(sInputDaset)) {
				sInputDaset = "ds_SaveBuya=ds_SaveBuya:U" //입력 데이터셋
			} else {
				sInputDaset = sInputDaset + " ds_SaveBuya=ds_SaveBuya:U" //입력 데이터셋
			}
			
			// 기부금
			svcAddObj = new Object();//[공통] 서비스 추가 파라메타 정보 Object				 
			svcAddObj.sInsertSql = "hr:M_HS_8390_M_IN30";//저장Sql
			svcAddObj.sUpdateSql = "hr:M_HS_8390_M_UP30";//수정Sql
			svcAddObj.sDeleteSql = "hr:M_HS_8390_M_DL30";//삭제Sql
			svcAddObj.sSaveFlagColumn = "crudType";//insertSql, updateSql, deleteSql이 존재하여 신규, 수정, 삭제를 처리할 경우 기본적으로 Dataset의 getRowStates()로 판단하여 처리하며
									 //이를 Flag 컬럼으로 대체하고 싶은 경우 사용하는 [컬럼명], 해당 Flag 컬럼의 값은 신규 - I , 수정 - U , 삭제 - D의 값을 가져야 한다.
			this.gfn_AddComSaveService(this, svcAddObj);
						
			if (this.gfn_IsNull(sInputDaset)) {
				sInputDaset = "ds_GrdGibu=ds_GrdGibu:U" //입력 데이터셋
			} else {
				sInputDaset = sInputDaset + " ds_GrdGibu=ds_GrdGibu:U" //입력 데이터셋
			}
			
			// 기부금조정상세
			svcAddObj = new Object();//[공통] 서비스 추가 파라메타 정보 Object				 
			svcAddObj.sInsertSql = "hr:M_HS_8390_M_IN40";//저장Sql
			svcAddObj.sUpdateSql = "hr:M_HS_8390_M_UP40";//수정Sql
			svcAddObj.sDeleteSql = "hr:M_HS_8390_M_DL40";//삭제Sql
			svcAddObj.sSaveFlagColumn = "crudType";//insertSql, updateSql, deleteSql이 존재하여 신규, 수정, 삭제를 처리할 경우 기본적으로 Dataset의 getRowStates()로 판단하여 처리하며
									 //이를 Flag 컬럼으로 대체하고 싶은 경우 사용하는 [컬럼명], 해당 Flag 컬럼의 값은 신규 - I , 수정 - U , 삭제 - D의 값을 가져야 한다.
			this.gfn_AddComSaveService(this, svcAddObj);
			
			if (this.gfn_IsNull(sInputDaset)) {
				sInputDaset = "ds_GrdGbch=ds_GrdGbch:U" //입력 데이터셋
			} else {
				sInputDaset = sInputDaset + " ds_GrdGbch=ds_GrdGbch:U" //입력 데이터셋
			}
			
			//기초자료
			svcAddObj = new Object();//[공통] 서비스 추가 파라메타 정보 Object				 
			svcAddObj.sInsertSql = "";//저장Sql
			svcAddObj.sUpdateSql = "hr:M_HS_8390_M_UP00";//수정Sql
			svcAddObj.sDeleteSql = "";//삭제Sql
			svcAddObj.sSaveFlagColumn = "crudType";//insertSql, updateSql, deleteSql이 존재하여 신규, 수정, 삭제를 처리할 경우 기본적으로 Dataset의 getRowStates()로 판단하여 처리하며
									 //이를 Flag 컬럼으로 대체하고 싶은 경우 사용하는 [컬럼명], 해당 Flag 컬럼의 값은 신규 - I , 수정 - U , 삭제 - D의 값을 가져야 한다.
			this.gfn_AddComSaveService(this, svcAddObj);
			
			if (this.gfn_IsNull(sInputDaset)) {
				sInputDaset = "ds_GrdJsba=ds_GrdJsba:U" //입력 데이터셋
			} else {
				sInputDaset = sInputDaset + " ds_GrdJsba=ds_GrdJsba:U" //입력 데이터셋
			}
		
		
		//연금저축
		}else if(iTabIndex == 7 || nIndex == 7){
			// 연금저축
			svcAddObj = new Object();//[공통] 서비스 추가 파라메타 정보 Object				 
			svcAddObj.sInsertSql = "hr:M_HS_8390_M_IN50";//저장Sql
			svcAddObj.sUpdateSql = "hr:M_HS_8390_M_UP50";//수정Sql
			svcAddObj.sDeleteSql = "hr:M_HS_8390_M_DL50";//삭제Sql
			svcAddObj.sSaveFlagColumn = "crudType";//insertSql, updateSql, deleteSql이 존재하여 신규, 수정, 삭제를 처리할 경우 기본적으로 Dataset의 getRowStates()로 판단하여 처리하며
									 //이를 Flag 컬럼으로 대체하고 싶은 경우 사용하는 [컬럼명], 해당 Flag 컬럼의 값은 신규 - I , 수정 - U , 삭제 - D의 값을 가져야 한다.
			this.gfn_AddComSaveService(this, svcAddObj);
			
			if (this.gfn_IsNull(sInputDaset)) {
				sInputDaset = "ds_GrdSave=ds_GrdSave:U" //입력 데이터셋
			} else {
				sInputDaset = sInputDaset + " ds_GrdSave=ds_GrdSave:U" //입력 데이터셋
			}
			
			//기초자료
			svcAddObj = new Object();//[공통] 서비스 추가 파라메타 정보 Object				 
			svcAddObj.sInsertSql = "";//저장Sql
			svcAddObj.sUpdateSql = "hr:M_HS_8390_M_UP00";//수정Sql
			svcAddObj.sDeleteSql = "";//삭제Sql
			svcAddObj.sSaveFlagColumn = "crudType";//insertSql, updateSql, deleteSql이 존재하여 신규, 수정, 삭제를 처리할 경우 기본적으로 Dataset의 getRowStates()로 판단하여 처리하며
									 //이를 Flag 컬럼으로 대체하고 싶은 경우 사용하는 [컬럼명], 해당 Flag 컬럼의 값은 신규 - I , 수정 - U , 삭제 - D의 값을 가져야 한다.
			this.gfn_AddComSaveService(this, svcAddObj);
			
			if (this.gfn_IsNull(sInputDaset)) {
				sInputDaset = "ds_GrdJsba=ds_GrdJsba:U" //입력 데이터셋
			} else {
				sInputDaset = sInputDaset + " ds_GrdJsba=ds_GrdJsba:U" //입력 데이터셋
			}
		
		
		// 종전근무지
		}else if(iTabIndex == 9 || nIndex == 9){
			// 종전근무지	
			svcAddObj = new Object();//[공통] 서비스 추가 파라메타 정보 Object				 
			svcAddObj.sInsertSql = "hr:M_HS_8390_M_IN60";//저장Sql
			svcAddObj.sUpdateSql = "hr:M_HS_8390_M_UP60";//수정Sql
			svcAddObj.sDeleteSql = "hr:M_HS_8390_M_DL60";//삭제Sql
			svcAddObj.sSaveFlagColumn = "crudType";//insertSql, updateSql, deleteSql이 존재하여 신규, 수정, 삭제를 처리할 경우 기본적으로 Dataset의 getRowStates()로 판단하여 처리하며
									 //이를 Flag 컬럼으로 대체하고 싶은 경우 사용하는 [컬럼명], 해당 Flag 컬럼의 값은 신규 - I , 수정 - U , 삭제 - D의 값을 가져야 한다.
			this.gfn_AddComSaveService(this, svcAddObj);
			
			if (this.gfn_IsNull(sInputDaset)) {
				sInputDaset = "ds_GrdJsjo=ds_GrdJsjo:U" //입력 데이터셋
			} else {
				sInputDaset = sInputDaset + " ds_GrdJsjo=ds_GrdJsjo:U" //입력 데이터셋
			}
			
			//기초자료
			svcAddObj = new Object();//[공통] 서비스 추가 파라메타 정보 Object				 
			svcAddObj.sInsertSql = "";//저장Sql
			svcAddObj.sUpdateSql = "hr:M_HS_8390_M_UP00";//수정Sql
			svcAddObj.sDeleteSql = "";//삭제Sql
			svcAddObj.sSaveFlagColumn = "crudType";//insertSql, updateSql, deleteSql이 존재하여 신규, 수정, 삭제를 처리할 경우 기본적으로 Dataset의 getRowStates()로 판단하여 처리하며
									 //이를 Flag 컬럼으로 대체하고 싶은 경우 사용하는 [컬럼명], 해당 Flag 컬럼의 값은 신규 - I , 수정 - U , 삭제 - D의 값을 가져야 한다.
			this.gfn_AddComSaveService(this, svcAddObj);
			
			if (this.gfn_IsNull(sInputDaset)) {
				sInputDaset = "ds_GrdJsba=ds_GrdJsba:U" //입력 데이터셋
			} else {
				sInputDaset = sInputDaset + " ds_GrdJsba=ds_GrdJsba:U" //입력 데이터셋
			}

		// 주택자금,기타
		}else if(iTabIndex == 6 || iTabIndex == 10 || nIndex == 6 || nIndex == 10){
			// 주택자금,기타
			svcAddObj = new Object();//[공통] 서비스 추가 파라메타 정보 Object				 
			svcAddObj.sInsertSql = "";//저장Sql
			svcAddObj.sUpdateSql = "hr:M_HS_8390_M_UP00";//수정Sql
			svcAddObj.sDeleteSql = "";//삭제Sql
			svcAddObj.sSaveFlagColumn = "crudType";//insertSql, updateSql, deleteSql이 존재하여 신규, 수정, 삭제를 처리할 경우 기본적으로 Dataset의 getRowStates()로 판단하여 처리하며
									 //이를 Flag 컬럼으로 대체하고 싶은 경우 사용하는 [컬럼명], 해당 Flag 컬럼의 값은 신규 - I , 수정 - U , 삭제 - D의 값을 가져야 한다.
			this.gfn_AddComSaveService(this, svcAddObj);
			
			if (this.gfn_IsNull(sInputDaset)) {
				sInputDaset = "ds_GrdJsba=ds_GrdJsba:U" //입력 데이터셋
			} else {
				sInputDaset = sInputDaset + " ds_GrdJsba=ds_GrdJsba:U" //입력 데이터셋
			}

		// 월세
		}else if(iTabIndex == 8 || nIndex == 8){
			var rent_amt =  nexacro.toNumber(this.ds_GrdRent.getCaseSum("crudType != 'D'", "RENT_AMOT"));
			this.ds_GrdJsba.setColumn(0, "JSBA_TG46", rent_amt); 
			
			
			// 월세	
			svcAddObj = new Object();//[공통] 서비스 추가 파라메타 정보 Object				 
			svcAddObj.sInsertSql = "hr:M_HS_8390_M_IN70";//저장Sql
			svcAddObj.sUpdateSql = "hr:M_HS_8390_M_UP70";//수정Sql
			svcAddObj.sDeleteSql = "hr:M_HS_8390_M_DL70";//삭제Sql
			svcAddObj.sSaveFlagColumn = "crudType";//insertSql, updateSql, deleteSql이 존재하여 신규, 수정, 삭제를 처리할 경우 기본적으로 Dataset의 getRowStates()로 판단하여 처리하며
									 //이를 Flag 컬럼으로 대체하고 싶은 경우 사용하는 [컬럼명], 해당 Flag 컬럼의 값은 신규 - I , 수정 - U , 삭제 - D의 값을 가져야 한다.
			this.gfn_AddComSaveService(this, svcAddObj);
			
			if (this.gfn_IsNull(sInputDaset)) {
				sInputDaset = "ds_GrdRent=ds_GrdRent:U" //입력 데이터셋
			} else {
				sInputDaset = sInputDaset + " ds_GrdRent=ds_GrdRent:U" //입력 데이터셋
			}
			
			//기초자료
			svcAddObj = new Object();//[공통] 서비스 추가 파라메타 정보 Object				 
			svcAddObj.sInsertSql = "";//저장Sql
			svcAddObj.sUpdateSql = "hr:M_HS_8390_M_UP00";//수정Sql
			svcAddObj.sDeleteSql = "";//삭제Sql
			svcAddObj.sSaveFlagColumn = "crudType";//insertSql, updateSql, deleteSql이 존재하여 신규, 수정, 삭제를 처리할 경우 기본적으로 Dataset의 getRowStates()로 판단하여 처리하며
									 //이를 Flag 컬럼으로 대체하고 싶은 경우 사용하는 [컬럼명], 해당 Flag 컬럼의 값은 신규 - I , 수정 - U , 삭제 - D의 값을 가져야 한다.
			this.gfn_AddComSaveService(this, svcAddObj);
			
			if (this.gfn_IsNull(sInputDaset)) {
				sInputDaset = "ds_GrdJsba=ds_GrdJsba:U" //입력 데이터셋
			} else {
				sInputDaset = sInputDaset + " ds_GrdJsba=ds_GrdJsba:U" //입력 데이터셋
			}
	
		}
	
	}	//PDF,일반 저장 끝
	
	trace(sInputDaset);
	//[공통]서비스 호출 변수
	var svcCallObj = new Object();//[공통] 서비스 파라메타 정보 Object
	svcCallObj.sTrid = "SAVE";//Transaction ID 등 callback에서 넘겨 받을 String을 지정
	svcCallObj.sActionName = this.G_SV_HR;//서버에서 호출할 Action - 모듈별로 호출되는 기본 Actio이 다름 : 공통 서비스 Action 업무구분  변수 참조
	svcCallObj.sInputDaset = sInputDaset //입력 데이터셋
	svcCallObj.sOutDatset = "";//출력 데이터셋
	svcCallObj.sOtherArg = "";//서버로 전송할 기타 Argument 정보 문자열, 예) key=value key2=value2
	svcCallObj.sCallBackFnc = "fn_Callback";//서버에서 처리가 완료된 후 Callback 받을 Function 명

	
	//[공통]서비스 호출
	this.gfn_CallComService(this, svcCallObj);	

	
}

/***********************************************************************************************
 * 05.02. [Vaildation] Master 저장 필수값 체크 - 입력항목 
 ***********************************************************************************************/ 
this.fn_VaildMasterSave = function()
{
	
	//[저장] Validation 설정
	//부양가족
	var arrArgs = ["BUYA_RELA^NULL"	// 관계
				  ,"BUYA_NAME^NULL"	// 성명
	              ,"BUYA_INOT^NULL"	// 내외구분
				  ,"BUYA_JUMI^NULL"	// 주민번호
				  ]; 
	var sCheckGroupTitle = this.div_MasterView.form.tab_Master.tpg_01.text;//체크그룹 타이틀
	//Grid Vaild 체크
	if (!this.gfn_CheckGridValid(this.div_MasterView.form.tab_Master.tpg_01.form.div_Buya.form.grd_Buya, arrArgs, sCheckGroupTitle)) {
		return false;
	}
	
	//보험
	var arrArgs = ["BUYA_JUMI^NULL"	// 주민번호
				  ]; 
	var sCheckGroupTitle = this.div_MasterView.form.tab_Master.tpg_02.text;//체크그룹 타이틀
	//Grid Vaild 체크
	if (!this.gfn_CheckGridValid(this.div_MasterView.form.tab_Master.tpg_02.form.div_Bohm.form.grd_BuyaBo, arrArgs, sCheckGroupTitle)) {
		return false;
	}
	
	//교육비
	var arrArgs = ["BUYA_JUMI^NULL"	// 주민번호
				 , "BUYA_EDGB^NULL"	// 교육비구분
				  ]; 
	var sCheckGroupTitle = this.div_MasterView.form.tab_Master.tpg_03.text;//체크그룹 타이틀
	//Grid Vaild 체크
	if (!this.gfn_CheckGridValid(this.div_MasterView.form.tab_Master.tpg_03.form.div_Educ.form.grd_BuyaEd, arrArgs, sCheckGroupTitle)) {
		return false;
	}
	
	//카드
	var arrArgs = ["BUYA_JUMI^NULL"	// 주민번호
				  ]; 
	var sCheckGroupTitle = this.div_MasterView.form.tab_Master.tpg_04.text;//체크그룹 타이틀
	//Grid Vaild 체크
	if (!this.gfn_CheckGridValid(this.div_MasterView.form.tab_Master.tpg_04.form.div_Card.form.grd_BuyaCa, arrArgs, sCheckGroupTitle)) {
		return false;
	}
	
	//의료비
	var arrArgs = ["BUYA_JUMI^NULL"	// 주민번호
				 , "HSPT_CODE^NULL"	// 의료증빙구분
				  ]; 
	var sCheckGroupTitle = this.div_MasterView.form.tab_Master.tpg_05.text;//체크그룹 타이틀
	//Grid Vaild 체크
	if (!this.gfn_CheckGridValid(this.div_MasterView.form.tab_Master.tpg_05.form.div_Hspt.form.grd_Hspt, arrArgs, sCheckGroupTitle)) {
		return false;
	}
	
	//기부
	var arrArgs = ["BUYA_JUMI^NULL"	// 주민번호
				 , "GIBU_CODE^NULL"	// 기부유형
				 , "GIBU_COMP^NULL"	// 사업자번호
				 , "GIBU_COMM^NULL"	// 상호
				 , "GIBU_GUBN^NULL"	// 기부증빙구분
				  ]; 
	var sCheckGroupTitle = this.div_MasterView.form.tab_Master.tpg_06.text;//체크그룹 타이틀
	//Grid Vaild 체크
	if (!this.gfn_CheckGridValid(this.div_MasterView.form.tab_Master.tpg_06.form.div_Gibu.form.grd_Gibu, arrArgs, sCheckGroupTitle)) {
		return false;
	}

	//연금 저축
	var arrArgs = ["SAVE_GRUP^NULL"	// 연금/저축 구분
				 , "SAVE_GUBN^NULL"	// 연금및저축구분종류
				 , "SAVE_BKCD^NULL"	// 금융기관
				 , "SAVE_BKAC^NULL"	// 계좌번호
				 , "SAVE_BAMT^NULL"	// 불입금액
				  ]; 
	var sCheckGroupTitle = this.div_MasterView.form.tab_Master.tpg_08.text;//체크그룹 타이틀
	//Grid Vaild 체크
	if (!this.gfn_CheckGridValid(this.div_MasterView.form.tab_Master.tpg_08.form.div_Save.form.grd_Save, arrArgs, sCheckGroupTitle)) {
		return false;
	}
	
	//종전근무지
	var arrArgs = ["JSJO_COMP^NULL"	// 사업자번호
				 , "JSJO_COMM^NULL"	// 법인명(상호)
				 , "JSJO_CODE^NULL"	// 퇴직사유
				 ,"JSJO_IDAY^FROM_TO=JSJO_ODAY" // 귀속시작~귀속종료
				  ]; 
	var sCheckGroupTitle = this.div_MasterView.form.tab_Master.tpg_10.text;//체크그룹 타이틀
	//Grid Vaild 체크
	if (!this.gfn_CheckGridValid(this.div_MasterView.form.tab_Master.tpg_10.form.div_Jsjo.form.grd_Jsjo, arrArgs, sCheckGroupTitle)) {
		return false;
	}
	
	//중복체크 부양가족 - 주민번호
	if(!this.gfn_VaildDupDataset(this.ds_GrdBuya, "BUYA_JUMI")) return false;
	
	//중복체크보험료 - 주민번호, 교육코드
	if(!this.gfn_VaildDupDataset(this.ds_Master10, "BUYA_JUMI,BUYA_EDGB"))return false;
	
	//중복체크교육비 - 주민번호
	if(!this.gfn_VaildDupDataset(this.ds_GrdBuyaEd, "BUYA_JUMI"))return false;
	
	//중복체크 카드 - 주민번호
	if(!this.gfn_VaildDupDataset(this.ds_GrdBuyaCa, "BUYA_JUMI"))return false;
	
	//중복체크 기부조정 - 기부유형, 기부년도
	if(!this.gfn_VaildDupDataset(this.ds_GrdGbch, "GBCH_CODE,GBCH_GBYY"))return false;
		
	for (var i=0; i<this.ds_GrdBuya.rowcount; i++)
	{
		iAge = this.fn_ageJumi(this.ds_GrdBuya.getColumn(i,"BUYA_JUMI"));
		if (this.ds_GrdBuya.getColumn(i,"BUYA_GIBO")=="1" &&  
			iAge < 60 && 
			(this.ds_GrdBuya.getColumn(i, "BUYA_JANG") != "1" && 
			 this.ds_GrdBuya.getColumn(i, "BUYA_JANG") != "2" && 
			 this.ds_GrdBuya.getColumn(i, "BUYA_JANG") != "3") && 
			 (this.ds_GrdBuya.getColumn(i,"BUYA_RELA")=="1" || this.ds_GrdBuya.getColumn(i,"BUYA_RELA")=="2")
			){
			
			this.ds_GrdBuya.setColumn(i, "BUYA_GIBO", "0");
			this.gfn_Alert("HR214", "");//직계존속의 경우 60세 이하는 기본공제 대사자가 아닙니다. 
			//return false;
		}
		
		if (this.ds_GrdBuya.getColumn(i,"BUYA_GIBO")=="1" &&  
			iAge>20 && 
			(this.ds_GrdBuya.getColumn(i, "BUYA_JANG") != "1" && 
			 this.ds_GrdBuya.getColumn(i, "BUYA_JANG") != "2" && 
			 this.ds_GrdBuya.getColumn(i, "BUYA_JANG") != "3")&& 
			 (this.ds_GrdBuya.getColumn(i,"BUYA_RELA")=="4" || this.ds_GrdBuya.getColumn(i,"BUYA_RELA")=="5")
		    )
		{
			this.ds_GrdBuya.setColumn(i, "BUYA_GIBO", "0");
			this.gfn_Alert("HR215", "");//직계존속의 경우 60세 이하는 기본공제 대사자가 아닙니다. 
			//return false;
		}

		if (this.ds_GrdBuya.getColumn(i,"BUYA_GIBO")=="1" &&  
			iAge>20 && 
			(this.ds_GrdBuya.getColumn(i, "BUYA_JANG") != "1" && 
			 this.ds_GrdBuya.getColumn(i, "BUYA_JANG") != "2" && 
			 this.ds_GrdBuya.getColumn(i, "BUYA_JANG") != "3") && 
			 this.ds_GrdBuya.getColumn(i,"BUYA_RELA")=="6")
		{
			this.ds_GrdBuya.setColumn(i, "BUYA_GIBO", "0");
			this.gfn_Alert("HR216", "");//형제자매인 경우 20세 이상은 기본공제 대상자가 아닙니다.
			//return false;
		}
		
		if (this.ds_GrdBuya.getColumn(i,"BUYA_JANG") != "0" && 
			!this.gfn_IsNull(this.ds_GrdBuya.getColumn(i,"BUYA_JANG")) && 
			this.ds_GrdBuya.getColumn(i, "BUYA_GIBO") == "0")
		{
			this.ds_GrdBuya.setColumn(i, "BUYA_GIBO", "1");
			this.gfn_Alert("HR217", "");//장애인 인적공제를 받을 경우 기본공제 대상자입니다. 자동으로 기본공제에 체크됩니다. 
			//return false;
		}
		
		if (this.ds_GrdBuya.getColumn(i,"BUYA_GIBO")!="1" && this.ds_GrdBuya.getColumn(i,"BUYA_RELA")=="0")
		{
			this.ds_GrdBuya.setColumn(i, "BUYA_GIBO", "1");
			this.gfn_Alert("HR218", "");//본인은 기본공제 대상자여야만 합니다.
			//return false;
		}
	}	
	
	for (var i=0; i < this.ds_GrdSave.rowcount; i++){
		if (this.ds_GrdSave.getColumn(i,"SAVE_GUBN") == "32" && this.gfn_IsNull(this.ds_GrdSave.getColumn(i,"SAVE_STYE")) ){
			this.gfn_Alert("HR219", "");//주택청약종합저축 입력시 가입연도를 입력하세요.
			return false;
		}
	}	
	
	if (this.ds_GrdBuya.getColumn(this.ds_GrdBuya.findRow("BUYA_RELA","0"), "BUYA_SEID") == "0" ){
		for (var i=0; i < this.ds_GrdSave.rowcount; i++){
			if (this.ds_GrdSave.getColumn(i,"SAVE_GUBN") == "31" || this.ds_GrdSave.getColumn(i,"SAVE_GUBN") == "32" || this.ds_GrdSave.getColumn(i,"SAVE_GUBN") == "34"){
				this.gfn_Alert("HR220", "");//근로자가 세대주가 아닌 경우 주택자금공제(주택임차차입금, 장기주택저당차입금이자, 주택마련저축)를 받을 수 없습니다.
				this.ds_GrdSave.deleteRow(i);
				return false;
			}
		}	
	}
	
	for (var i=0; i < this.ds_GrdBuyaEd.rowcount; i++){
		if (this.ds_GrdBuya.getColumn(this.ds_GrdBuya.findRow("BUYA_JUMI",this.ds_GrdBuyaEd.getColumn(i,"BUYA_JUMI")), "BUYA_RELA") == "1" || this.ds_GrdBuya.getColumn(this.ds_GrdBuya.findRow("BUYA_JUMI",this.ds_GrdBuyaEd.getColumn(i,"BUYA_JUMI")), "BUYA_RELA") == "2"){
			if (this.ds_GrdBuyaEd.getColumn(i,"BUYA_EDGB") != '4' ){				
				this.gfn_Alert("HR221", ""); //부양가족 직계존속의 교육비는 장애인교육비 외에는 공제가능 하지 않습니다. 
				
				this.ds_GrdBuyaEd.deleteRow(i);
				return false;
			}
		}	
	}
	
	for (var i=0; i < this.ds_GrdBuyaCa.rowcount; i++){
		if (this.ds_GrdBuyaCa.getColumn(i,"BUYA_CRD1") < 0){			
			this.ds_GrdBuyaCa.setColumn(i, "BUYA_CRD1", "0");
			this.gfn_Alert("HR222", "");//신용카드 값들 중 마이너스(-) 값은 입력할 수 없습니다. 자동으로 0 처리 됩니다.
		}
		else if (this.ds_GrdBuyaCa.getColumn(i,"BUYA_DIR1") < 0){
			this.ds_GrdBuyaCa.setColumn(i, "BUYA_DIR1", "0");
			this.gfn_Alert("HR222", "");//신용카드 값들 중 마이너스(-) 값은 입력할 수 없습니다. 자동으로 0 처리 됩니다.		
		}
		 
		else if (this.ds_GrdBuyaCa.getColumn(i,"BUYA_CSH1") < 0){
			this.ds_GrdBuyaCa.setColumn(i, "BUYA_CSH1", "0");
			this.gfn_Alert("HR222", "");//신용카드 값들 중 마이너스(-) 값은 입력할 수 없습니다. 자동으로 0 처리 됩니다.		
		}
		
		else if (this.ds_GrdBuyaCa.getColumn(i,"BUYA_PUBL") < 0 ){
			this.ds_GrdBuyaCa.setColumn(i, "BUYA_PUBL", "0");
			this.gfn_Alert("HR222", "");//신용카드 값들 중 마이너스(-) 값은 입력할 수 없습니다. 자동으로 0 처리 됩니다.			
		}
		
		else if (this.ds_GrdBuyaCa.getColumn(i,"BUYA_MARK") < 0){
			this.ds_GrdBuyaCa.setColumn(i, "BUYA_MARK", "0");
			this.gfn_Alert("HR222", "");//신용카드 값들 중 마이너스(-) 값은 입력할 수 없습니다. 자동으로 0 처리 됩니다.
		}	
		
		else if (this.ds_GrdBuyaCa.getColumn(i,"BUYA_DSEO") < 0){
			this.ds_GrdBuyaCa.setColumn(i, "BUYA_DSEO", "0");
			this.gfn_Alert("HR222", "");//신용카드 값들 중 마이너스(-) 값은 입력할 수 없습니다. 자동으로 0 처리 됩니다.
		}	
		
		
		if (this.ds_GrdBuyaCa.getColumn(i,"BUYA_XCR1") < 0){			
			this.ds_GrdBuyaCa.setColumn(i, "BUYA_XCR1", "0");
			this.gfn_Alert("HR222", "");//신용카드 값들 중 마이너스(-) 값은 입력할 수 없습니다. 자동으로 0 처리 됩니다.			
		}
		
		if (this.ds_GrdBuyaCa.getColumn(i,"BUYA_XCR2") < 0){			
			this.ds_GrdBuyaCa.setColumn(i, "BUYA_XCR2", "0");
			this.gfn_Alert("HR222", "");//신용카드 값들 중 마이너스(-) 값은 입력할 수 없습니다. 자동으로 0 처리 됩니다.		
		}
		
		if (this.ds_GrdBuyaCa.getColumn(i,"BUYA_XCR3") < 0){			
			this.ds_GrdBuyaCa.setColumn(i, "BUYA_XCR3", "0");
			this.gfn_Alert("HR222", "");//신용카드 값들 중 마이너스(-) 값은 입력할 수 없습니다. 자동으로 0 처리 됩니다.			
		}
		
		if (this.ds_GrdBuyaCa.getColumn(i,"BUYA_XCR4") < 0){			
			this.ds_GrdBuyaCa.setColumn(i, "BUYA_XCR4", "0");
			this.gfn_Alert("HR222", "");//신용카드 값들 중 마이너스(-) 값은 입력할 수 없습니다. 자동으로 0 처리 됩니다.			
		}
		
		if (this.ds_GrdBuyaCa.getColumn(i,"BUYA_XCR5") < 0){			
			this.ds_GrdBuyaCa.setColumn(i, "BUYA_XCR5", "0");
			this.gfn_Alert("HR222", "");//신용카드 값들 중 마이너스(-) 값은 입력할 수 없습니다. 자동으로 0 처리 됩니다.		
		}
		
		if (this.ds_GrdBuyaCa.getColumn(i,"BUYA_XCR6") < 0){			
			this.ds_GrdBuyaCa.setColumn(i, "BUYA_XCR6", "0");
			this.gfn_Alert("HR222", "");//신용카드 값들 중 마이너스(-) 값은 입력할 수 없습니다. 자동으로 0 처리 됩니다.		
		}
		
		if (this.ds_GrdBuyaCa.getColumn(i,"BUYA_XCR7") < 0){			
			this.ds_GrdBuyaCa.setColumn(i, "BUYA_XCR7", "0");
			this.gfn_Alert("HR222", "");//신용카드 값들 중 마이너스(-) 값은 입력할 수 없습니다. 자동으로 0 처리 됩니다.
		}
		
		if (this.ds_GrdBuyaCa.getColumn(i,"BUYA_XCR8") < 0){			
			this.ds_GrdBuyaCa.setColumn(i, "BUYA_XCR8", "0");
			this.gfn_Alert("HR222", "");//신용카드 값들 중 마이너스(-) 값은 입력할 수 없습니다. 자동으로 0 처리 됩니다.		
		}
		
		if (this.ds_GrdBuyaCa.getColumn(i,"BUYA_XCR9") < 0){			
			this.ds_GrdBuyaCa.setColumn(i, "BUYA_XCR9", "0");
			this.gfn_Alert("HR222", "");//신용카드 값들 중 마이너스(-) 값은 입력할 수 없습니다. 자동으로 0 처리 됩니다.	
		}
	}
	
	for (var i=0; i<this.ds_GrdGibu.rowcount; i++){
		if (this.ds_GrdGibu.getColumn(i,"GIBU_CODE") == "30" || this.ds_GrdGibu.getColumn(i,"GIBU_CODE") == "31"){   //특례,공익신탁기부금은 이번년도꺼만
				this.gfn_Alert("HR223", "");	// 특례기부금 또는 공인신탁기부금은 기부금 조정에 이월금액으로만 가능합니다. 			
				this.ds_GrdGibu.deleteRow(i);
				return false;
		}			
		
		if (this.ds_GrdGibu.getColumn(i,"GIBU_CODE") == "20" && this.ds_GrdGibu.getColumn(i,"GIBU_RELA") != "1" ){
				this.gfn_Alert("HR224", "");	// 정치자금기부금 또는 우리사주조합기부금은 본인이 납부한 기부금만 공제가능합니다.			
				this.ds_GrdGibu.deleteRow(i);
				return false;
		}		
		
		if (this.ds_GrdGibu.getColumn(i,"GIBU_CODE") == "42" && this.ds_GrdGibu.getColumn(i,"GIBU_RELA") != "1" ){
				this.gfn_Alert("HR224", "");	// 정치자금기부금 또는 우리사주조합기부금은 본인이 납부한 기부금만 공제가능합니다.			
				this.ds_GrdGibu.deleteRow(i);
				return false;
		}	
		
		//2020.12.22 기부금 직접 입력시 사업자 번호 체크. PDF UPLOAD인 경우, 체크 불필요
		if(this.ds_GrdGibu.getColumn(i, "REGI_ID") != "PDF" && this.gfn_IsNull(this.ds_GrdGibu.getColumn(i, "GIBU_COMP"))) 
		{
			if (this.gfn_IsBzIdNo(this.ds_GrdGibu.getColumn(i, "GIBU_COMP")) == false) 
			{
				this.gfn_Alert("SM050", ""); // 사업자등록번호가 유효하지 않습니다.
				return false;
			}
		}
	}
	
	
	for (var i=0; i<this.ds_GrdGbch.rowcount; i++){
		if (this.ds_GrdGbch.getColumn(i,"GBCH_CODE") == "30" || this.ds_GrdGbch.getColumn(i,"GBCH_CODE") == "31"){
			if (this.ds_GrdGbch.getColumn(i,"GBCH_YEAR") == this.fvJsmtYear){
				this.gfn_Alert("HR225", ""); // 특례기부금 또는 공익신탁기부금은 이월금액만 가능하므로 기부년도가 귀속년도와 일치하지 않아야합니다
				this.ds_GrdGbch.deleteRow(i);
				return false;
			}
		}	
	}
	
	for (var i=0; i<this.ds_GrdBuya.rowcount; i++){
		if ( this.ds_GrdBuya.getColumn(i,"BUYA_HANB")=="1"){
			for (var a=0; a<this.ds_GrdBuya.rowcount; a++){
				if (this.ds_GrdBuya.getColumn(a,"BUYA_BUIN")=="1" ){
					this.gfn_Alert("HR226", ""); //한부모와 부녀자 추가공제 중 하나만 선택하세요.
					return false;			
				}
			}
		}
	}
	for (var i=0; i<this.ds_GrdBuya.rowcount; i++){
		if ( this.ds_GrdBuya.getColumn(i,"BUYA_BUIN")=="1"){
			for (var a=0; a<this.ds_GrdBuya.rowcount; a++){
				if (this.ds_GrdBuya.getColumn(a,"BUYA_HANB")=="1" ){
					this.gfn_Alert("HR226", ""); //한부모와 부녀자 추가공제 중 하나만 선택하세요.	
					return false;			
				}
			}
		}
	}

	
	for (var i=0; i<this.ds_GrdBuya.rowcount; i++){
		if ( this.ds_GrdBuya.getColumn(i,"BUYA_HANB")=="1"){
			for (var a=0; a<this.ds_GrdBuya.rowcount; a++){
				if (this.ds_GrdBuya.getColumn(a,"BUYA_WIFE")=="1" ){
					this.gfn_Alert("HR227", ""); //배우자 공제를 받는 근로자는 본인이 한부모공제를 받을 수 없습니다. 					
					return false;			
				}
			}
		}
	}
	
	for (var i=0; i<this.ds_GrdBuya.rowcount; i++){
		if ( this.ds_GrdBuya.getColumn(i,"BUYA_WIFE")=="1"){
			for (var a=0; a<this.ds_GrdBuya.rowcount; a++){
				if (this.ds_GrdBuya.getColumn(a,"BUYA_HANB")=="1" ){
					this.gfn_Alert("HR227", ""); //배우자 공제를 받는 근로자는 본인이 한부모공제를 받을 수 없습니다. 				
					return false;			
				}
			}
		}	
	}
		
	if (this.ds_GrdRent.getCaseSum("crudType != 'D'", "RENT_AMOT") > 0){
		if (this.ds_GrdJsba.getColumn(0,"JSBA_TG46") == 0){
			this.gfn_Alert("HR228", ""); // 월세액소득공제를 입력하신 경우 [주택자금] 탭 - 월세액 을 입력 하셔야 합니다
			return false;
		}
	}
	
	if (this.ds_GrdRent.getCaseSum("crudType != 'D'", "RENT_WONA") > 0){
		if (this.ds_GrdJsba.getColumn(i,"JSBA_TG50") == 0){			
			this.gfn_Alert("HR229", ""); // 거주자간 주택임차차입금 이자상환액을 입력하신 경우 [주택자금] 탭 - 주택임차차입금 원리금 상환액 거주자금액을 입력 하셔야 합니다. 
			return false;
		}
	}
	
	//월세거주자간 주택임차 날짜 체크
	var arrArgs = ["RENT_FDAY^FROM_TO=RENT_TDAY" // 주택임차 날짜
				  ]; 
	var sCheckGroupTitle = this.div_MasterView.form.tab_Master.tpg_09.text;//체크그룹 타이틀
	//Grid Vaild 체크
	if (!this.gfn_CheckGridValid(this.div_MasterView.form.tab_Master.tpg_09.form.div_Joo.form.grd_GrdRent, arrArgs, sCheckGroupTitle)) { 
		return false;
	}
		
	// 의료비 건수 및 금액 체크
	for (var i=0; i<this.ds_GrdHspt.rowcount; i++)
	{
		// 국세청장이 연말정산간소화서비를 통해 제공하는 의료비 자료가 아니면...
		if (this.ds_GrdHspt.getColumn(i,"HSPT_CODE")!="1")
		{
			if (this.gfn_IsNull(this.ds_GrdHspt.getColumn(i,"HSPT_COMP")))
			{
				var arrMsgArg = ["사업자번호"];
				this.gfn_Alert("SM008", arrMsgArg);  // &ITM0은(는) 필수 입력 항목입니다. 사업자번호
				//의료비 탭으로 이동
				this.div_MasterView.form.tab_Master.set_tabindex(4);
				//셀이동
				this.div_MasterView.form.tab_Master.tpg_05.form.div_Hspt.form.grd_Hspt.setCellPos(this.div_MasterView.form.tab_Master.tpg_05.form.div_Hspt.form.grd_Hspt.getBindCellIndex("body","HSPT_COMP"),  i);					 
				this.div_MasterView.form.tab_Master.tpg_05.form.div_Hspt.form.grd_Hspt.showEditor(true);

				return false;
			}
			
			if (this.gfn_IsNull(this.ds_GrdHspt.getColumn(i,"HSPT_COMM")))
			{
				var arrMsgArg = ["상호"];
				this.gfn_Alert("SM008", arrMsgArg);   // &ITM0은(는) 필수 입력 항목입니다. 상호
				//의료비 탭으로 이동
				this.div_MasterView.form.tab_Master.set_tabindex(4);
				//셀이동
				this.div_MasterView.form.tab_Master.tpg_05.form.div_Hspt.form.grd_Hspt.setCellPos(this.div_MasterView.form.tab_Master.tpg_05.form.div_Hspt.form.grd_Hspt.getBindCellIndex("body","HSPT_COMM"),  i);					 
				this.div_MasterView.form.tab_Master.tpg_05.form.div_Hspt.form.grd_Hspt.showEditor(true);
				return false;
			}
			
			if (this.ds_GrdHspt.getColumn(i,"HSPT_GUNS")==0 || this.ds_GrdHspt.getColumn(i,"HSPT_GAMT")==0 || this.gfn_IsNull(this.ds_GrdHspt.getColumn(i,"HSPT_GAMT")) || this.gfn_IsNull(this.ds_GrdHspt.getColumn(i,"HSPT_GUNS")))
			{
				var arrMsgArg = [this.div_MasterView.form.tab_Master.tpg_05.text, i+1];
				this.gfn_Alert("HR230", arrMsgArg);   // &ITM1 항목의 &ITM2 번째 줄의 자료를 확인 바랍니다.\n\n건수 및 금액을 입력하십시오.
				//의료비 탭으로 이동
				this.div_MasterView.form.tab_Master.set_tabindex(4);
				//셀이동
				this.div_MasterView.form.tab_Master.tpg_05.form.div_Hspt.form.grd_Hspt.setCellPos(this.div_MasterView.form.tab_Master.tpg_05.form.div_Hspt.form.grd_Hspt.getBindCellIndex("body","HSPT_GUNS"),  i);					 
				this.div_MasterView.form.tab_Master.tpg_05.form.div_Hspt.form.grd_Hspt.showEditor(true);
				return false;
			}

		
			//2020.12.22 의료비 직접 입력시 사업자 번호 체크. PDF UPLOAD인 경우, 체크 불필요
			if(this.ds_GrdHspt.getColumn(i, "REGI_ID") != "PDF" && !this.gfn_IsNull(this.ds_GrdJsjo.getColumn(i, "HSPT_COMP")) ) 
			{
				if (this.gfn_IsBzIdNo(this.ds_GrdHspt.getColumn(i, "HSPT_COMP")) == false) 
				{
					this.gfn_Alert("SM050", ""); // 사업자등록번호가 유효하지 않습니다.
					this.div_MasterView.form.tab_Master.set_tabindex(4);
					//셀이동
					this.div_MasterView.form.tab_Master.tpg_05.form.div_Hspt.form.grd_Hspt.setCellPos(this.div_MasterView.form.tab_Master.tpg_05.form.div_Hspt.form.grd_Hspt.getBindCellIndex("body","HSPT_COMP"),  i);					 
					this.div_MasterView.form.tab_Master.tpg_05.form.div_Hspt.form.grd_Hspt.showEditor(true);
					return false;
				}
			}
		}
				
		// 국세청장이 연말정산간소화서비를 통해 제공하는 의료비 자료면...
		if (this.ds_GrdHspt.getColumn(i,"HSPT_CODE") == "1"){
			if ( this.ds_GrdHspt.getColumn(i,"HSPT_GAMT")==0 || this.gfn_IsNull(this.ds_GrdHspt.getColumn(i,"HSPT_GAMT")))
			{
				var arrMsgArg = [this.div_MasterView.form.tab_Master.tpg_05.text, i+1];
				this.gfn_Alert("HR230", arrMsgArg);   // &ITM1 항목의 &ITM2 번째 줄의 자료를 확인 바랍니다.\n\n건수 및 금액을 입력하십시오.
				//의료비 탭으로 이동
				this.div_MasterView.form.tab_Master.set_tabindex(4);
				//셀이동
				this.div_MasterView.form.tab_Master.tpg_05.form.div_Hspt.form.grd_Hspt.setCellPos(this.div_MasterView.form.tab_Master.tpg_05.form.div_Hspt.form.grd_Hspt.getBindCellIndex("body","HSPT_GAMT"),  i);					 
				this.div_MasterView.form.tab_Master.tpg_05.form.div_Hspt.form.grd_Hspt.showEditor(true);
				return false;
			}
		}
		
		//2019년 추가분. 실손의료비가 지급한 금액보다 클 수 없다.
		if(!this.gfn_IsNull(this.ds_GrdHspt.getColumn(i,"HSPT_SAMT")) && nexacro.toNumber(this.ds_GrdHspt.getColumn(i,"HSPT_GAMT")) < nexacro.toNumber(this.ds_GrdHspt.getColumn(i,"HSPT_SAMT")))
		{
			this.gfn_Alert("HR231", "");   // 실손의료보험료가 지급명세금액보다 클 수 없습니다. 
			
			//의료비 탭으로 이동
			this.div_MasterView.form.tab_Master.set_tabindex(4);
			//셀이동
			this.div_MasterView.form.tab_Master.tpg_05.form.div_Hspt.form.grd_Hspt.setCellPos(this.div_MasterView.form.tab_Master.tpg_05.form.div_Hspt.form.grd_Hspt.getBindCellIndex("body","HSPT_SAMT"),  i);					 
			this.div_MasterView.form.tab_Master.tpg_05.form.div_Hspt.form.grd_Hspt.showEditor(true);
			return false;
		}
		
		
		//안경값 한도금액 50만원 체크
		if(this.ds_GrdHspt.getCaseSum( "HSPT_JUMI=='" + this.ds_GrdHspt.getColumn(i,"HSPT_JUMI") + "' && HSPT_TYPE == 'G0026'", "HSPT_GAMT") > 500000)
		{
			
			this.gfn_Alert("HR232", "");   // 안경·렌즈 비용은 1인당 한도액 50만원을 초과할 수 없습니다.
			//의료비 탭으로 이동
			this.div_MasterView.form.tab_Master.set_tabindex(4);
			//셀이동
			this.div_MasterView.form.tab_Master.tpg_05.form.div_Hspt.form.grd_Hspt.setCellPos(this.div_MasterView.form.tab_Master.tpg_05.form.div_Hspt.form.grd_Hspt.getBindCellIndex("body","HSPT_GAMT"),  i);					 
			this.div_MasterView.form.tab_Master.tpg_05.form.div_Hspt.form.grd_Hspt.showEditor(true);
			return false;
		}
		
		//실손 = 의료비 이면 행 삭제
		if(nexacro.toNumber(this.ds_GrdHspt.getColumn(i,"HSPT_GAMT")) == nexacro.toNumber(this.ds_GrdHspt.getColumn(i,"HSPT_SAMT")))
		{
			this.ds_GrdHspt.deleteRow(i);			
		}
	}
	
	// 기부금명세서 건수 및 금액 체크
	for (var i=0; i<this.ds_GrdGibu.rowcount; i++)
	{
		if (this.gfn_IsNull(this.ds_GrdGibu.getColumn(i,"GIBU_NOTE")))
		{
			//기부 탭으로 이동
			this.div_MasterView.form.tab_Master.set_tabindex(5);
			var arrMsgArg = ["기부내용"];
			this.gfn_Alert("SM008", arrMsgArg);   // &ITM0은(는) 필수 입력 항목입니다. 기부내용
			return false;
		}
		else if (this.ds_GrdGibu.getColumn(i,"GIBU_GUNS")==0 || this.ds_GrdGibu.getColumn(i,"GIBU_GAMT")==0  ||	this.gfn_IsNull(this.ds_GrdGibu.getColumn(i,"GIBU_GUNS")) || this.gfn_IsNull(this.ds_GrdGibu.getColumn(i,"GIBU_GAMT")))
		{
			//기부 탭으로 이동
			this.div_MasterView.form.tab_Master.set_tabindex(5);
			var arrMsgArg = [this.div_MasterView.form.tab_Master.tpg_06.text, i+1];
			this.gfn_Alert("HR230", arrMsgArg); // &ITM0 항목의 &ITM1 번째 줄의 자료를 확인 바랍니다.\n\n건수 및 금액을 입력하십시오.
			return false;
		}
	/*	else if (this.ds_GrdGibu.getColumn(i,"GIBU_CODE")=="41" && this.gfn_IsNull(this.ds_GrdGibu.getColumn(i,"GIBU_NUMB")))
		{
			//기부 탭으로 이동
			this.div_MasterView.form.tab_Master.set_tabindex(5);
			this.gfn_Alert("HR233", ""); // 기부금 유형이 종교단체기부금의 경우 기부금영수증 일련번호를 반드시 입력하여야 합니다
			return false;
		}*/
		else if (this.ds_GrdGibu.getColumn(i,"GIBU_CODE")!="10" && this.gfn_IsNull(this.ds_GrdGibu.getColumn(i,"GIBU_COMP")))
		{
			//기부 탭으로 이동
			this.div_MasterView.form.tab_Master.set_tabindex(5);
			this.gfn_Alert("HR234", ""); // 기부금 유형이 정치자금이 아닐 경우 사업자번호를 반드시 입력하여야 합니다.
			return false;
		}
	}
	
	for (var i=0; i<this.ds_GrdSave.rowcount; i++)
	{
		// 장기주식형저축소득공제
		if (this.ds_GrdSave.getColumn(i,"SAVE_GUBN")=="41" && (this.gfn_IsNull(this.ds_GrdSave.getColumn(i,"SAVE_PAYY")) || this.ds_GrdSave.getColumn(i,"SAVE_PAYY")=="00"))
		{
			//연금/저축
			this.div_MasterView.form.tab_Master.set_tabindex(7);
			var arrMsgArg = ["납입연차"];
			this.gfn_Alert("SM040", arrMsgArg); //  &ITM0을(를) 선택하십시오. 납입연차
			return false;
		}
		
		// 장기집합투자증권저축
		if ((this.ds_GrdSave.getColumn(i,"SAVE_GUBN")=="51" ||this.ds_GrdSave.getColumn(i,"SAVE_GUBN")=="32")&& this.gfn_IsNull(this.ds_GrdSave.getColumn(i,"SAVE_STYE")))
		{
			//연금/저축
			this.div_MasterView.form.tab_Master.set_tabindex(7);
			var arrMsgArg = ["가입연도"];
			this.gfn_Alert("SM008", arrMsgArg); //  &ITM0은(는) 필수 입력 항목입니다. 가입연도
			return false;
		}
		
		// 청년형 장기집합투자증권
		if (this.ds_GrdSave.getColumn(i,"SAVE_GUBN")=="81"){
			var sSaveEndt = this.ds_GrdSave.getColumn(i,"SAVE_ENDT");		
			var sSavePeri = this.ds_GrdSave.getColumn(i,"SAVE_PERI");
		
			if (this.gfn_IsNull(sSaveEndt) || sSaveEndt==""){
				//연금/저축
				this.div_MasterView.form.tab_Master.set_tabindex(7);
				this.div_MasterView.form.tab_Master.tpg_08.form.div_Save.form.grd_Save.setCellPos(this.div_MasterView.form.tab_Master.tpg_08.form.div_Save.form.grd_Save.getBindCellIndex("body","SAVE_ENDT"),  i);
				this.div_MasterView.form.tab_Master.tpg_08.form.div_Save.form.grd_Save.showEditor(true);
				
				var arrMsgArg = ["청년형 장기집합투자증권일 경우 가입일자"];
				this.gfn_Alert("SM008", arrMsgArg); //  &ITM0은(는) 필수 입력 항목입니다. 가입연도
				return false;
			}
			
			if (this.gfn_IsNull(sSavePeri) || sSavePeri==""){
				//연금저축
				this.div_MasterView.form.tab_Master.set_tabindex(7);
				var arrMsgArg = ["청년형 장기집합투자증권일 경우 계약기간"];
				this.gfn_Alert("SM008", arrMsgArg); //  &ITM0은(는) 필수 입력 항목입니다. 가입연도
				return false;
			}
		}
	}
	
	// 전근무지의 급여총액 확인
	for (var i=0; i<this.ds_GrdJsjo.rowcount; i++)
	{
		var sJsjoIday = this.ds_GrdJsjo.getColumn(0,"JSJO_IDAY");
		var sJsjoOday = this.ds_GrdJsjo.getColumn(0,"JSJO_ODAY");
		if(!this.gfn_IsNull(sJsjoIday)){
			sJsjoIday = sJsjoIday.substr(0,4)
		}
		
		if(!this.gfn_IsNull(sJsjoOday)){
			sJsjoOday = sJsjoOday.substr(0,4)
		}
		
		if (this.fvJsmtYear != sJsjoIday)
		{	
			this.div_MasterView.form.tab_Master.set_tabindex(9);
			this.gfn_Alert("HR235", ""); //귀속시작일자는 귀속년도와 동일해야 합니다.
			return false;
		}
		if (this.fvJsmtYear != sJsjoOday)
		{	
			this.div_MasterView.form.tab_Master.set_tabindex(9);	
			this.gfn_Alert("HR236", ""); // 귀속종료일자는 귀속년도와 동일해야 합니다.
			return false;
		}
		
		if (nexacro.toNumber(this.ds_GrdJsjo.getColumn(i,"JSJO_GR01"))==0 && nexacro.toNumber(this.ds_GrdJsjo.getColumn(i,"JSJO_GR02"))==0 && nexacro.toNumber(this.ds_GrdJsjo.getColumn(i,"JSJO_GR03"))==0)
		{
			// &ITM0 항목의 &ITM1 번째 줄의 자료를 확인 바랍니다.\n\n전근무지의 급여,상여,인정상여 금액을 입력하십시오.
			var arrMsgArg = [this.div_MasterView.form.tab_Master.tpg_09.text, i+1];
			this.gfn_Alert("HR237", arrMsgArg);   
				
			//전근무지 탭으로 이동
			this.div_MasterView.form.tab_Master.set_tabindex(9);
			return false;
		}
		//감면세액이 있으면 비율도 있어야한다. 2019년 추가.
        if (nexacro.toNumber(this.ds_GrdJsjo.getColumn(i,"JSJO_SG13")) > 0 && (nexacro.toNumber(this.ds_GrdJsjo.getColumn(i,"JSJO_RATE")) == 0 || this.gfn_IsNull(this.ds_GrdJsjo.getColumn(i,"JSJO_RATE"))))
        {
			
			var arrMsgArg = ["감면률(%)"];
			this.gfn_Alert("SM008", arrMsgArg); //  &ITM0은(는) 필수 입력 항목입니다. 감면률(%)
			
			//전근무지 탭으로 이동
			this.div_MasterView.form.tab_Master.set_tabindex(9);
			return false;
        }
        if(!this.gfn_IsNull(this.ds_GrdJsjo.getColumn(i,"JSJO_RATE")) && (nexacro.toNumber(this.ds_GrdJsjo.getColumn(i,"JSJO_SG13")) == 0 || this.gfn_IsNull(this.ds_GrdJsjo.getColumn(i,"JSJO_SG13"))))
        {
			var arrMsgArg = ["중소기업청년소득세감면"];
			this.gfn_Alert("SM008", arrMsgArg); //  &ITM0은(는) 필수 입력 항목입니다. 중소기업청년소득세감면
			//전근무지 탭으로 이동
			this.div_MasterView.form.tab_Master.set_tabindex(9);
			return false;
        }
        
		//2020.12.22 종전근무지 입력시 사업자 번호 체크. PDF UPLOAD인 경우, 체크 불필요
		if(this.ds_GrdJsjo.getColumn(i, "REGI_ID") != "PDF" && !this.gfn_IsNull(this.ds_GrdJsjo.getColumn(i, "JSJO_COMP"))) 
		{
		
			if (this.gfn_IsBzIdNo(this.ds_GrdJsjo.getColumn(i, "JSJO_COMP")) == false) 
			{
			
				this.gfn_Alert("SM050", ""); // 사업자등록번호가 유효하지 않습니다.
				this.div_MasterView.form.tab_Master.set_tabindex(9);
				//셀이동
				this.div_MasterView.form.tab_Master.tpg_09.form.div_Jsjo.form.grd_Jsjo.setCellPos(this.div_MasterView.form.tab_Master.tpg_09.form.div_Jsjo.form.grd_Jsjo.getBindCellIndex("body","JSJO_COMP"),  i);					 
				this.div_MasterView.form.tab_Master.tpg_09.form.div_Jsjo.form.grd_Jsjo.showEditor(true);
				return false;
			}
		}
	}
	
	if (this.ds_GrdJsba.getColumn(0,"JSBA_TG46") > 0){   //(this.ds_GrdJsba.getColumn(i,"JSBA_TG46") > 0){
		if (this.ds_GrdRent.getCaseSum("crudType != 'D'", "RENT_AMOT") == 0){
			
			this.gfn_Alert("HR238", ""); // 주택자금 월세액 소득공제를 받는 근로자는 [월세/주택임차] 탭에 월세액 소득공제란을 입력하세요
			
			//월세 탭으로 이동
			this.div_MasterView.form.tab_Master.set_tabindex(8);
			
			return;
		}
	}
	
	if (this.ds_GrdJsba.getColumn(0,"JSBA_TG50") > 0){   //(this.ds_GrdJsba.getColumn(i,"JSBA_TG50") > 0){
		if (this.ds_GrdRent.getCaseSum("crudType != 'D'", "RENT_WONA") == 0){
			this.gfn_Alert("HR239", ""); // 거주자간 주택임차차입금 원리금상환공제를 받는 근로자는 [월세/주택임차] 탭에 거주자간 주택임차차입금 원리금상환공제란을 입력하세요
			//월세 탭으로 이동
			this.div_MasterView.form.tab_Master.set_tabindex(8);
			return;
		}
	}
	/*
	if (this.ds_GrdJsba.getColumn(0,"JSBA_TG46") > 0){
		if (this.ds_GrdJsba.getColumn(0,"JSBA_TG46") != this.ds_GrdRent.getCaseSum("crudType != 'D'", "RENT_AMOT")){
			this.gfn_Alert("HR240", ""); // 주택자금 월세액 금액과 [월세/주택임차] 탭에 월세액 합계 금액이 일치해야합니다
			//월세 탭으로 이동
			this.div_MasterView.form.tab_Master.set_tabindex(8);
			return false;
		}
	}*/
	
	// 월세
	for (var i=0; i<this.ds_GrdRent.rowcount; i++)
	{
		if (!this.gfn_IsNull(this.ds_GrdRent.getColumn(i,"RENT_NAME")))
		{
			if(this.gfn_IsNull(this.ds_GrdRent.getColumn(i,"RENT_WTYP")))
			{
				var arrMsgArg = [this.div_MasterView.form.tab_Master.tpg_09.text, i+1];
				this.gfn_Alert("HR241", arrMsgArg); //  &ITM0 항목의 &ITM1 번째 줄의 자료를 확인 바랍니다.\n\n주택유형과 계약면적은 필수 입력 항목입니다.
				
				//월세 탭으로 이동
				this.div_MasterView.form.tab_Master.set_tabindex(8);
				return false;
			}
			else if(this.gfn_IsNull(this.ds_GrdRent.getColumn(i,"RENT_WARE")))
			{
				var arrMsgArg = [this.div_MasterView.form.tab_Master.tpg_09.text, i+1];
				this.gfn_Alert("HR241", arrMsgArg); //  &ITM0 항목의 &ITM1 번째 줄의 자료를 확인 바랍니다.\n\n주택유형과 계약면적은 필수 입력 항목입니다.
				
				//월세 탭으로 이동
				this.div_MasterView.form.tab_Master.set_tabindex(8);
				return false;
			}
		}
		if (!this.gfn_IsNull(this.ds_GrdRent.getColumn(i,"RENT_NAME2")))
		{
			if(this.gfn_IsNull(this.ds_GrdRent.getColumn(i,"RENT_ITYP")))
			{
				var arrMsgArg = [this.div_MasterView.form.tab_Master.tpg_09.text, i+1];
				this.gfn_Alert("HR241", arrMsgArg); //  &ITM0 항목의 &ITM1 번째 줄의 자료를 확인 바랍니다.\n\n주택유형과 계약면적은 필수 입력 항목입니다.
				
				//월세 탭으로 이동
				this.div_MasterView.form.tab_Master.set_tabindex(8);
				return false;
			}
			else if(this.gfn_IsNull(this.ds_GrdRent.getColumn(i,"RENT_IARE")))
			{
				var arrMsgArg = [this.div_MasterView.form.tab_Master.tpg_09.text, i+1];
				this.gfn_Alert("HR241", arrMsgArg); //  &ITM0 항목의 &ITM1 번째 줄의 자료를 확인 바랍니다.\n\n주택유형과 계약면적은 필수 입력 항목입니다.
				
				//월세 탭으로 이동
				this.div_MasterView.form.tab_Master.set_tabindex(8);
				return false;
			}
		}
	}
	
	/*
	//기타_세액감면 - 중소기업?? 사용안함.
	if(fv_COMP_JUNG == '1')
	{
		if ((!this.gfn_IsNull(this.ds_GrdJsba.getColumn(0,"JSBA_SG16")) && toNumber(this.ds_GrdJsba.getColumn(0,"JSBA_SG16")) > 0) || 
			(!this.gfn_IsNull(this.ds_GrdJsba.getColumn(0,"JSBA_SG17")) && toNumber(this.ds_GrdJsba.getColumn(0,"JSBA_SG17")) > 0))
		{ //alert(this.ds_GrdJsba.getColumn(0,"JSBA_SG16") + ' *** '+ this.ds_GrdJsba.getColumn(0,"JSBA_SG17"));  		
			//감면금액
			if (this.gfn_IsNull(this.ds_GrdJsba.getColumn(0,"JSBA_SG16")) || this.ds_GrdJsba.getColumn(0,"JSBA_SG16") == 0){
				
				this.gfn_Alert("HR242", ""); // 감면대상금액을 입력해야 합니다.
				
				//기타 탭으로 이동
				this.div_MasterView.form.tab_Master.set_tabindex(10);
				//this.div_MasterView.form.tab_Master.tpg_11.form.div_Jsjo.form.div_etc.
				
				return false;
			}
			
			//감면비율
			if (this.gfn_IsNull(this.ds_GrdJsba.getColumn(0,"JSBA_SG17"))){
				tab_Master.TabIndex = gfn_getTabpgIndex(tab_Master, "tabpg_Etc");
				gfn_GetMessage("C032","&ITM1", "감면률을 입력해야 합니다.");
				tab_Master.tabpg_Etc.cb_RateGubn.SetFocus();
				return false;
			}
			
			//감면시작일자와 종료일자가 있어야함.
			if (this.gfn_IsNull(this.ds_GrdJsba.getColumn(0,"JSBA_SGfD"))){
				tab_Master.TabIndex = gfn_getTabpgIndex(tab_Master, "tabpg_Etc");
				gfn_GetMessage("C032","&ITM1", "감면시작일을 입력해야 합니다.");
				tab_Master.tabpg_Etc.Calendar0.SetFocus();
				return false;
			}
			if (this.gfn_IsNull(this.ds_GrdJsba.getColumn(0,"JSBA_SGTD"))){
				tab_Master.TabIndex = gfn_getTabpgIndex(tab_Master, "tabpg_Etc");
				gfn_GetMessage("C032","&ITM1", "감면종료일을 입력해야 합니다.");
				tab_Master.tabpg_Etc.Calendar1.SetFocus();
				return false;
			}
			
			//시작일자와 종료일자가 귀속년도 내에 존재해야함.
			//if(substr(this.ds_GrdJsba.getColumn(0,"JSBA_SGfD"), 0, 4) != substr(cal_srchYear.Value,0,4))
			var sJsbaSgfd = this.ds_GrdJsba.getColumn(0,"JSBA_SGFD");
			if(sJsbaSgfd.substr(0, 4) != this.div_Search.form.spn_JstaYear.value.substr(0,4))
			{
				tab_Master.TabIndex = gfn_getTabpgIndex(tab_Master, "tabpg_Etc");
				this.ds_GrdJsba.setColumn(0,"JSBA_SGfD", "");
				gfn_GetMessage("C032","&ITM1", "감면시작일은 해당귀속년도와 일치해야 합니다.");
				tab_Master.tabpg_Etc.Calendar0.SetFocus();
				return false;
			}
			
			var sJsbaSgtd = this.ds_GrdJsba.getColumn(0,"JSBA_SGTD");
			if(sJsbaSgtd.substr(0, 4) != this.div_Search.form.spn_JstaYear.value.substr(0,4)))
			{
				tab_Master.TabIndex = gfn_getTabpgIndex(tab_Master, "tabpg_Etc");
				this.ds_GrdJsba.setColumn(0,"JSBA_SGTD", "");
				gfn_GetMessage("C032","&ITM1", "감면종료일은 해당귀속년도와 일치해야 합니다.");
				tab_Master.tabpg_Etc.Calendar1.SetFocus();
				return false;
			}
			
			//중도입사자인 경우 시작일자 비교 필요.
			if(this.ds_GrdJsba.getColumn(0,"JSBA_SGfD") < ds_emst_s11.getColumn(0, "EMST_IDAY"))
			{
				tab_Master.TabIndex = gfn_getTabpgIndex(tab_Master, "tabpg_Etc");
				this.ds_GrdJsba.setColumn(0,"JSBA_SGfD", ds_emst_s11.getColumn(0, "EMST_IDAY"));
				gfn_GetMessage("C032","&ITM1", "감면시작일은 입사일보다 이전일 수 없습니다.");
				tab_Master.tabpg_Etc.Calendar0.SetFocus();
				return false;
			}
		
			if(!this.gfn_IsNull(this.ds_GrdJsba.getColumn(0,"JSBA_SGfD")) && !this.gfn_IsNull(this.ds_GrdJsba.getColumn(0,"JSBA_SGTD")))
			{
				if(this.ds_GrdJsba.getColumn(0,"JSBA_SGfD") > this.ds_GrdJsba.getColumn(0,"JSBA_SGTD"))
				{//ALERT(this.ds_GrdJsba.getColumn(0,"JSBA_SGfD")+" <<<>>> "+this.ds_GrdJsba.getColumn(0,"JSBA_SGTD"));
					tab_Master.TabIndex = gfn_getTabpgIndex(tab_Master, "tabpg_Etc");
					this.ds_GrdJsba.setColumn(0,"JSBA_SGfD", "");
					gfn_GetMessage("C032","&ITM1", "감면시작일이 감면종료일보다 클 수 없습니다.");
					return false;
				}
			}
			
			//감면일자와 귀속년도 비교
			if (this.fvJsmtYear != substr(this.ds_GrdJsba.getColumn(0,"JSBA_SGFD"),0,4))
			{
				gfn_GetMessage("C032","&ITM1", "감면시작일는 귀속년도와 동일해야 합니다."); 
				return false;
			}
	
			if (this.fvJsmtYear != substr(this.ds_GrdJsba.getColumn(0,"JSBA_SGTD"),0,4))
			{
				gfn_GetMessage("C032","&ITM1", "감면종료일는 귀속년도와 동일해야 합니다."); 
				return false;
			}
		}
		else    //금액과 비율이 없는데 날짜 입력된 경우 막기 위해 추가.
		{//alert('금액과 비율이 없는데..');
			if (!this.gfn_IsNull(this.ds_GrdJsba.getColumn(0,"JSBA_SGfD"))){
				tab_Master.TabIndex = gfn_getTabpgIndex(tab_Master, "tabpg_Etc");
				this.ds_GrdJsba.setColumn(0,"JSBA_SGfD", "");
				gfn_GetMessage("C032","&ITM1", "감면시작일을 입력하면 안됩니다.");
				return false;
			}
	
			if (!this.gfn_IsNull(this.ds_GrdJsba.getColumn(0,"JSBA_SGTD"))){
				tab_Master.TabIndex = gfn_getTabpgIndex(tab_Master, "tabpg_Etc");
				this.ds_GrdJsba.setColumn(0,"JSBA_SGTD", "");
				gfn_GetMessage("C032","&ITM1", "감면종료일을 입력하면 안됩니다.");
				return false;
			}
		}
	}

*/

	
	
	return true;
}
 
/***********************************************************************************************
 * 6. 삭제
 ***********************************************************************************************/
/***********************************************************************************************
 * 06.01. [공통버튼] 삭제 버튼 클릭 이벤트
 ***********************************************************************************************/  
this.fn_ComBtnDelete = function()
{ 
}

/***********************************************************************************************
 * 7. 엑셀
 ***********************************************************************************************/
/***********************************************************************************************
 * 07.01. [공통버튼] 엑셀저장 버튼 클릭 이벤트
 ***********************************************************************************************/  
this.fn_ComBtnExcel = function()
{ 
	//출력 그리드 정보 설정
	var objGridList = ["this.div_MasterView.form.tab_Master.tpg_01.form.grd_Master10|" + this.div_MasterView.form.tab_Master.tpg_01.text
	                  ];
	 
	var sFileName = "년말정산계산";//출력파일명
	this.gfn_ExcelExport(this, objGridList, sFileName);
}

/***********************************************************************************************
 * 8. 인쇄
 ***********************************************************************************************/
/***********************************************************************************************
 * 08.01. [공통버튼] 인쇄 버튼 클릭 이벤트
 ***********************************************************************************************/  
this.fn_ComBtnPrint = function()
{ 

	//데이터 변경여부 체크
	if (this.fn_DsIsUpdated()) {
		this.gfn_Alert("SM002", "");//변경된 내용이 있습니다.\n저장 후 작업하시기 바랍니다.
		return false;
	}
	
	
	var sSystId = this.ds_GrdBuya.getColumn(0, "SYST_ID");
	
	if (this.gfn_IsNull(sSystId) ) {
		var arrMsgArg = ["사용자정보"];
		this.gfn_Alert("SM028", arrMsgArg); //해당컬럼의 사용자정보가 존재하지 않습니다
		
	} else {
		//[업무] 데이터셋 설정 - 데이터셋 초기화, 조회조건 설정
		this.ds_JstaInfo.clearData();
		this.ds_Input.clearData();
		
		//[업무] 조회조건 입력
		this.ds_Input.addRow();
		this.ds_Input.setColumn(0, "SRCH_YEAR", this.div_Search.form.spn_JstaYear.value); 	//귀속연도
		this.ds_Input.setColumn(0, "JSJU_GUBN", "2"); 										//정산구분(중도정산:1, 연말정산:2)
		this.ds_Input.setColumn(0, "DEPM_CD", "");											//요청부서
		this.ds_Input.setColumn(0, "SESU_ID", this.div_Search.form.edt_SystId.value);		//요청자
		 trace(this.ds_Input.saveXML())
	
		//[공통]서비스정보 초기화
		this.gfn_InitComService(this);


		//[공통]서비스정보 추가
		var svcAddObj = new Object();//[공통] 서비스 추가 파라메타 정보 Object
		svcAddObj.sSelectSql = "hr:M_HS_8430_M_SL10";
		this.gfn_AddComSearchService(this, svcAddObj);


		//[공통]서비스 호출 변수
		var svcCallObj = new Object();//[공통] 서비스 파라메타 정보 Object
		svcCallObj.sTrid = "USER_SEARCH";//Transaction ID 등 callback에서 넘겨 받을 String을 지정
		svcCallObj.sActionName = this.G_SV_HR;//서버에서 호출할 Action - 모듈별로 호출되는 기본 Actio이 다름 : 공통 서비스 Action 업무구분  변수 참조
		svcCallObj.sInputDaset = "ds_Input=ds_Input" //입력 데이터셋
		svcCallObj.sOutDatset = "ds_JstaInfo=ds_Master10";//출력 데이터셋
		svcCallObj.sOtherArg = "";//서버로 전송할 기타 Argument 정보 문자열, 예) key=value key2=value2
		svcCallObj.sCallBackFnc = "fn_Callback";//서버에서 처리가 완료된 후 Callback 받을 Function 명
		svcCallObj.isSync = true;//동기식으로 설정할지 여부  (동기 true, 비동기 false)	

		//[공통]서비스 호출
		this.gfn_CallComService(this, svcCallObj);
		
		
		var sSrchYy = this.ds_JstaInfo.getColumn(this.ds_JstaInfo.rowposition,"JSMT_YEAR");	//귀속년도
		var sDepmNm = this.ds_JstaInfo.getColumn(this.ds_JstaInfo.rowposition,"DEPM_NM");	//부서
		var sEmpmCd = this.ds_JstaInfo.getColumn(this.ds_JstaInfo.rowposition,"EMPM_CD");	//사번
		var sEmpmNm = this.ds_JstaInfo.getColumn(this.ds_JstaInfo.rowposition,"EMPM_NM");	//성명
		var sDmpmJw = this.ds_JstaInfo.getColumn(this.ds_JstaInfo.rowposition,"EMPM_JIKW");	//직위
		var sEntrDd = this.ds_JstaInfo.getColumn(this.ds_JstaInfo.rowposition,"ENTR_DD");	//입사일자
		var sRetiDd = this.ds_JstaInfo.getColumn(this.ds_JstaInfo.rowposition,"RETI_DD");	//퇴사일자
		var sPopupId = "M_HS_8430_P1";
		var sPopupTitle = "신고서류 출력"; //Popup화면 타이틀
		var sPopupFormUrl  = "hr::M_HS_8430_P1.xfdl"; //Popup화면 URL
		var oArg = {paramTitle:sPopupTitle
					, paramPopupGu:this.fvPopupGu		//팝업대상 true
					, paramSrchYy:sSrchYy				//귀속년도
					, paramSystId:sSystId				//시스템사용자ID
					, paramDepmNm:sDepmNm				//부서
					, paramEmpmCd:sEmpmCd				//사번
					, paramEmpmNm:sEmpmNm				//성명
					, paramDmpmJw:sDmpmJw				//직위
					, paramEntrDd:sEntrDd				//입사일자
					, paramRetiDd:sRetiDd				//퇴사일자
					
					}; //Popup화면 전달 파라메터 			
		var oOption = {title:sPopupTitle, width:"670", height:"300"}; //Popup화면 옵션
		var sPopupCallBack = "fn_PopupCallback"; //Popup화면 호출후 Callback 처리 함수

		this.gfn_OpenPopup(sPopupId, sPopupFormUrl, oArg, sPopupCallBack, oOption); //Popup화면 호출 함수	
	}
}

/***********************************************************************************************
 * 9. 결재요청
 ***********************************************************************************************/
/***********************************************************************************************
 * 09.01. [공통버튼] 결재요청 버튼 클릭 이벤트
 ***********************************************************************************************/  
this.fn_ComBtnDecide = function()
{ 
}

/***********************************************************************************************
 * 10. 결재현황
 ***********************************************************************************************/
/***********************************************************************************************
 * 10.01. [공통버튼] 결재현황 버튼 클릭 이벤트
 ***********************************************************************************************/  
this.fn_ComBtnProcess = function()
{ 
}

/***********************************************************************************************
 * 11. 재기안
 ***********************************************************************************************/
/***********************************************************************************************
 * 11.01. [공통버튼] 재기안 버튼 클릭 이벤트
 ***********************************************************************************************/ 
this.fn_ComBtnRecide = function()
{ 
}

/***********************************************************************************************
 * 12. 닫기
 ***********************************************************************************************/
/***********************************************************************************************
 * 12.01. [공통버튼] 닫기 버튼 클릭 이벤트
 ***********************************************************************************************/ 
this.fn_ComBtnClose = function()
{ 
	return true;
}

/***********************************************************************************************
 * 13. [CallBack] 함수
 ***********************************************************************************************/
/***********************************************************************************************
 * 13.01. [서비스] CallBack 함수 처리
 ***********************************************************************************************/ 
this.fn_Callback = function(sSvcId, nErrorCode, sErrorMsg)
{
	if(nErrorCode != 0)
	{
		return;
	}	
	switch(sSvcId)
	{
		
		case "SRCH_LIST1": //기초자료 조회
			if (this.ds_GrdJsba.getRowCount() == 0 ){
				var arrMsgArg = [""];
				this.gfn_Alert("HR012", arrMsgArg);//기초자료가 생성되지 않았습니다.\n관리팀(인사팀)에 문의하세요.
				return;
			}
			this.ds_GrdJsba.addColumn("crudType", "string");
			
			this.fn_Search();//연말정산 조회
			
			break;
		
		case "SRCH_LIST3": //도로명 조회
			if (this.gfn_IsNull(this.ds_Dryn.getColumn(0,"EMST_DRYN"))){
				var arrMsgArg = [""];
				this.gfn_Alert("HR011", arrMsgArg);//[인사기록관리]-[개인정보관리]에서 자택주소를 입력해주세요.
				return;
			}
			this.fn_ComSearch();//기초자료 조회
			
			break;
		case "MST_SEARCH": //조회		
			this.ds_GrdBuya.addColumn("s_chk", "string");
			this.ds_GrdBuya.addColumn("crudType", "string");
			
			this.ds_GrdBuyaBo.addColumn("s_chk", "string");
			this.ds_GrdBuyaBo.addColumn("crudType", "string");
			
			this.ds_GrdBuyaEd.addColumn("s_chk", "string");
			this.ds_GrdBuyaEd.addColumn("crudType", "string");
			
			this.ds_GrdBuyaCa.addColumn("s_chk", "string");
			this.ds_GrdBuyaCa.addColumn("crudType", "string");
			
			this.ds_GrdHspt.addColumn("s_chk", "string");
			this.ds_GrdHspt.addColumn("crudType", "string");
			
			this.ds_GrdGibu.addColumn("s_chk", "string");
			this.ds_GrdGibu.addColumn("crudType", "string");
			
			this.ds_GrdGbch.addColumn("s_chk", "string");
			this.ds_GrdGbch.addColumn("crudType", "string");
			
			this.ds_GrdSave.addColumn("s_chk", "string");
			this.ds_GrdSave.addColumn("crudType", "string");
			
			this.ds_GrdJsjo.addColumn("s_chk", "string");
			this.ds_GrdJsjo.addColumn("crudType", "string");
			
			this.ds_GrdJsmt.addColumn("s_chk", "string");
			this.ds_GrdJsmt.addColumn("crudType", "string");
			
			this.ds_GrdRent.addColumn("s_chk", "string");
			this.ds_GrdRent.addColumn("crudType", "string");
		
			
			//납부세액이 10만원이 넘으면 분납가능
			if(this.ds_GrdJsmt.getColumn(0, "JSMT_CG01") >= 100000){
				//div_MasterView.form.tab_Master.tpg_01.form.grd_Master10
				this.div_MasterView.form.tab_Master.tpg_12.form.div_Calc.form.cbo_JsmtHalb.set_enable(true);
			}else{
				this.div_MasterView.form.tab_Master.tpg_12.form.div_Calc.form.cbo_JsmtHalb.set_enable(false);
			}
			
			//this.div_MasterView.form.tab_Master.tpg_01.form.div_Buya.form.fn_Binddataset(this.ds_GrdBuya);
			
			if (this.ds_Master10.getRowCount() > 0) {

				//[공통]그리드NoData Text 초기화 설정
				//this.gfn_InitGridNoDataText(this.div_MasterView.form.tab_Master.tpg_01.form.grd_Master10);
				
			} else {
				
				//[공통]그리드NoData Text설정
				//this.gfn_SetGridNoDataText(this.div_MasterView.form.tab_Master.tpg_01.form.grd_Master10);
		
			}		
			
			this.strFlag   = false;			
			
			
			break;
		case "COMBO_SEARCH": //콤보조회		
			
			break;
			
		case "SAVE": //저장
			trace("저장완료");
			this.fn_ComBtnSearch();//저장후 재조회
			this.strFlag   = false;
			break;
		case "MST_COMPUTE": //계산하기 
			this.gfn_Alert("HR242", "");//계산이 완료되었습니다.
			this.fn_Search();//연말정산 조회
			break;
		case "MST_SUBMIT": //제출하기 
			this.gfn_Alert("HR244", "");//제출 완료 되었습니다.
			this.fn_Search();//연말정산 조회
			break;
		case "GET_XML":
			this.fn_ReadXmlData();//XML데이터 읽기
			break;			
	}
};

/***********************************************************************************************
 * 13.02. [팝업] CallBack 함수 처리
          strId : 팝업호출시 지정한 팝업ID
	      rtnValue : 팝업창에서 close시 지정한 반환값
          주의 : Open(popuptype=modeless)창은 팝업콜백을 지원하지 않음
 ***********************************************************************************************/ 
this.fn_PopupCallback = function(strId, rtnValue)
{
	//[조회영역]
	if (strId == "S_SYST_ID_01") {
		if (!this.gfn_IsNull(rtnValue)) {
			var arrRtnVal = eval(rtnValue);	
			
			if (!this.gfn_IsNull(arrRtnVal.EMPM_CD)) {
				this.div_Search.form.edt_EmpmCd.set_value(arrRtnVal.EMPM_CD);
				this.div_Search.form.edt_EmpmNm.set_value(arrRtnVal.EMPM_NM);
				this.div_Search.form.edt_SystId.set_value(arrRtnVal.SYST_ID);
				
				this.fn_ComBtnSearch();
			}
		}	
		
	}

};
 
/***********************************************************************************************
 * 13.03. [메세지] CallBack 함수 처리
 ***********************************************************************************************/  
this.fn_MsgCallback = function (strId, strVal)
{

	//종전근무지 체크
	if (strId == "CONF.JSTM02") {
		if(strVal ) this.fn_Jstm02_compute();
	//정산 진행여부 체크
	} else if (strId == "CONF.JSTM03") {
		if(strVal ) this.fn_Jstm03_compute();
	//정산 제출
	} else if (strId == "CONF.JSTM04") {		
		if(strVal ) {
			//할부  
			var sHalbu = this.div_MasterView.form.tab_Master.tpg_12.form.div_Calc.form.cbo_JsmtHalb.value;
		
			//[업무] 데이터셋 설정 - 데이터셋 초기화, 조회조건 설정
			this.ds_Input.clearData();
			this.ds_Input.addRow();
			this.ds_Input.setColumn(0, "PROC_GUBN"	, "MAKE");	
			this.ds_Input.setColumn(0, "BUYA_YEAR"	, this.div_Search.form.spn_JstaYear.value);		// 귀속년도
			this.ds_Input.setColumn(0, "SESU_ID"	, this.div_Search.form.edt_SystId.value);		// 사번
			this.ds_Input.setColumn(0, "GUBN"		, "2");											// 정산구분(1중도, 2연말)
			this.ds_Input.setColumn(0, "HALB_PERI"	, sHalbu);										// 할부
			
			//[공통]서비스정보 초기화
			this.gfn_InitComService(this);
			
			//[공통]서비스정보 추가
			var svcAddObj = new Object();//[공통] 서비스 추가 파라메타 정보 Object
			svcAddObj.sSelectSql = "hr:M_HS_8390_M_IN01";
			this.gfn_AddComSearchService(this, svcAddObj);
			
			//[공통]서비스 호출 변수
			var svcCallObj = new Object();//[공통] 서비스 파라메타 정보 Object
			svcCallObj.sTrid = "MST_SUBMIT";//Transaction ID 등 callback에서 넘겨 받을 String을 지정
			svcCallObj.sActionName = this.G_SV_HR;//서버에서 호출할 Action - 모듈별로 호출되는 기본 Actio이 다름 : 공통 서비스 Action 업무구분  변수 참조
			svcCallObj.sInputDaset = "ds_Input=ds_Input" //입력 데이터셋
			svcCallObj.sOutDatset = "ds_Rst=ds_Rst";//출력 데이터셋
			svcCallObj.sOtherArg = "";//서버로 전송할 기타 Argument 정보 문자열, 예) key=value key2=value2
			svcCallObj.sCallBackFnc = "fn_Callback";//서버에서 처리가 완료된 후 Callback 받을 Function 명

			//[공통]서비스 호출
			this.gfn_CallComService(this, svcCallObj);	
			
		}
		
	//MASTER 변경사항 저장여부
	} else if (strId == "CONF.MAST_CHANGE") {
		if(strVal )
		{
			this.fn_ComBtnSave();//저장 서비스 호출
		} else {
			//데이터 변경여부 체크
			if (this.gfn_DsIsUpdated(this.ds_Master10)) {
				this.gfn_UndoColumn(this.div_MasterView.form.grd_Master10);
			}		
			
			if (this.gfn_DsIsUpdated(this.ds_Detail10)) {
				this.gfn_UndoColumn(this.div_DetailInput.form.tab_Detail.tpg_01.form.grd_Detail10);
			}				
		}
	}
	
	
}; 
 
/***********************************************************************************************
 * 14. [화면 사이즈] 조정 버튼 이벤트
 ***********************************************************************************************/
/***********************************************************************************************
 * 14.01. [조회영역-▲] 화면 사이즈조정 버튼 이벤트
 ***********************************************************************************************/ 
this.btn_DivMoveMi_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	//[공통] 버튼 변수
	var btnObj = new Object();//[공통] 버튼 변수 정보 Object
	btnObj.DivSearch = "this.div_Search";//조회영역 Div
	btnObj.DivMstLeft = "this.div_MasterView";//Master영역 Left Div : Master영역이 하나인경우에는 Left에 설정
	btnObj.DivMstRight = "";//Master영역 Right Div
	btnObj.DivDetail = "";//Detail영역 Div
	btnObj.MstLeft = 14;//Master영역 Div Left
	btnObj.MstTop = 90;//Master영역 Div Top
	btnObj.MstHeight = "";//Master영역 Div Height : Height가 없는경우 ""로 입력
	btnObj.MoveBtnDtl = "";//Detail영역 Move 버튼 : 없으면 ""로 입력
	this.gfn_MoveSeBtn(obj, btnObj);//Master영역 접고/펼치기 버튼 이벤트
};

/***********************************************************************************************
 * 15. [사용자정의 함수]
 ***********************************************************************************************/
/***********************************************************************************************
 * 15.00. [마감] 마감상태에 따른 컴포넌트 Enable 등 처리
 ***********************************************************************************************/ 
this.fn_SetWfCompEnable = function()
{
	//마감정보에 따른  컴포넌트 Enable 등 처리
	this.div_MasterView.form.div_ComGrdBtn.set_enable(true);
	//this.div_MasterView.form.div_ComGrdBtn.set_visible(true);
	//this.gfn_SetCompGroupEnable(this.div_MasterInput.form, true);//Master 입력 프리폼
		
}
/***********************************************************************************************
 * 15.01. 파일다이얼로그 VirtualFile 로드 성공 이벤트
 ***********************************************************************************************/ 
this.fn_FileDialog_VirtualFile_onsuccess = function(obj, e) {
	
	//파일다이얼로그에서 선택된 파일이 있는경우
	if (e.reason == 1) {
		var idx = this.ds_UploadFile.addRow();

		this.ds_UploadFile.setColumn(idx, "PATH_NM", this.fvFilePath);
		this.ds_UploadFile.setColumn(idx, "FILE_NM", obj.filename);
		this.ds_UploadFile.setColumn(idx, "uploadYn", "N");
		
		this.strFlag   = true;
	}
	
};

/***********************************************************************************************
 * 15.02. 파일 업로드 처리
 ***********************************************************************************************/ 
this.fn_FileUpload = function() {

	if (this._vFiles.length > 0) {
		var vfile = this._vFiles[this._vFiles_idx];
		if (vfile)
		{	
			this.fut_File.addFile("file00", vfile);	
		}

		this.fut_File.upload(nEnv.services["svcUrl"].url + "FileUploader?mode=upload&subDir=" + this.fvFilePath);
	}
	
};

/***********************************************************************************************
 * 15.03. 파일다이얼로그 Close 이벤트
 ***********************************************************************************************/ 
this.fdl_File_onclose = function(obj:nexacro.FileDialog,e:nexacro.FileDialogEventInfo)
{
	for (var i = 0, len = e.virtualfiles.length, vFile; i < len; i++) {
		vFile = e.virtualfiles[i];
		vFile.addEventHandler("onsuccess", this.fn_FileDialog_VirtualFile_onsuccess, this);
		vFile.open(null, 1);
		vFile.getFileSize();	

		this._vFiles.push(vFile);		
	}
	
	//첨부된 파일이 있으면 업로드 처리
	if (this._vFiles.length > 0) {
		this.fn_FileUpload();
	}
};

/***********************************************************************************************
 * 15.04. 파일 업로드 성공 이벤트
 ***********************************************************************************************/ 
this.fut_File_onsuccess = function(obj:nexacro.FileUpTransfer,e:nexacro.FileUpTransferEventinfo)
{	
	this.strFlag   = true;
	
	this._vFiles_idx++; 
    var vfile = this._vFiles[this._vFiles_idx];

	if (vfile) {		
		//초기화 해줘야됨
		this.fut_File.clearFileList();		
		this.fut_File.addFile("file00",vfile);
		this.fut_File.upload(nEnv.services["svcUrl"].url+"FileUploader?mode=upload&subDir=" + this.fvFilePath);

	}	

	trace("\n========FileUpTransfer00_onsuccess========");
	trace("\ne.eventid : "+e.eventid);
	trace("\ne.fromobject : "+e.fromobject);
	trace("\ne.fromreferenceobject : "+e.fromreferenceobject);
	trace("\ne.url : "+e.url);
	trace("\ne.code : "+e.code);
	trace("\ne.message : "+e.message);
	trace("\n==============================================");
	//trace(e.datasets[0].saveXML());

	//파일업로드 결과 데이셋이 있으면
	if (e.code == 0 && e.datasets[0] !=null && e.datasets[0].getRowCount() > 0) {

		var iFindRow = this.ds_UploadFile.findRowExpr("FILE_NM == '" + e.datasets[0].getColumn(0, "FILE_CNAME") + "' && uploadYn == 'N'");

		this.ds_UploadFile.setColumn(iFindRow, "FILE_ID", e.datasets[0].getColumn(0, "FILE_NAME"));
		this.ds_UploadFile.setColumn(iFindRow, "uploadYn", "Y");//파일업로드 성공여부
		this.ds_UploadFile.setColumn(iFindRow, "PATH_NM", this.fvFilePath);
	}

	//파일이 전부 업로드가 되었을경우 - PDF 파일을 XML로 변환 서비스 호출
	if (this.ds_UploadFile.getCaseCount("uploadYn=='N'") < 1) {
	
		this._vFiles_idx = 0;
		this._vFiles = [];
		this.fut_File.clearFileList();
		
		//[공통]서비스정보 초기화
		this.gfn_InitComService(this);	
		
		//[공통]서비스 호출 변수
		var svcCallObj = new Object();//[공통] 서비스 파라메타 정보 Object
		svcCallObj.sTrid = "GET_XML";//Transaction ID 등 callback에서 넘겨 받을 String을 지정
		svcCallObj.sActionName = "SmYearSettleAction";//서버에서 호출할 Action - 모듈별로 호출되는 기본 Actio이 다름 : 공통 서비스 Action 업무구분  변수 참조
		svcCallObj.sMethodName = "getXmlData";// Action 안에서 호출해야 하는 메소드 명, 기본은 execute를 호출하도록 되어있음	
		svcCallObj.sInputDaset = "ds_UploadFile=ds_UploadFile" //입력 데이터셋
		svcCallObj.sOutDatset = "ds_PdfToXml=ds_PdfToXml";//출력 데이터셋
		svcCallObj.sOtherArg = "";//서버로 전송할 기타 Argument 정보 문자열, 예) key=value key2=value2
		svcCallObj.sCallBackFnc = "fn_Callback";//서버에서 처리가 완료된 후 Callback 받을 Function 명	
		
		//[공통]서비스 호출
		this.gfn_CallComService(this, svcCallObj);				

	}
};

/***********************************************************************************************
 * 15.05. 파일 업로드 실패 이벤트
 ***********************************************************************************************/ 
this.fut_File_onerror = function(obj:nexacro.FileUpTransfer,e:nexacro.FileUpTransferErrorEventInfo)
{
	trace("======================================== fut_File_onerror ========================================");
	trace("e.errormsg : " + e.errormsg);
	trace("e.errortype : " + e.errortype);
	trace("==================================================================================================");
};

/***********************************************************************************************
 * 15.06. 파일 업로드 진행 이벤트
 ***********************************************************************************************/ 
this.fut_File_onprogress = function(obj:nexacro.FileUpTransfer,e:nexacro.FileUpTransferProgressEventInfo)
{
	//this.ds_UploadFile.setColumn(this._vFiles_idx, "LOADED", (e.loaded / e.total)*100);
};

/***********************************************************************************************
 * 15.07. XML 데이터 읽기
 ***********************************************************************************************/ 
this.fn_ReadXmlData = function() {

	this.strFlag   = true;
	
	var sRegiId;
	
	this.fvJsmtYear = this.div_Search.form.spn_JstaYear.value+"";		
	
	//-- 의료비 초기화 ---------------------------------------------
	this.ds_GrdHspt.set_enableevent(false);
	
	for(var iLoop=this.ds_GrdHspt.rowcount - 1; 0 <= iLoop; iLoop--){
		sRegiID = this.ds_GrdHspt.getColumn(iLoop, "REGI_ID");
		
		if(sRegiID=="PDF"){			
			this.ds_GrdHspt.deleteRow(iLoop);
		}			
	}
	this.ds_GrdHspt.set_enableevent(true);
	
	//-- 교육비 초기화 ---------------------------------------------
	this.ds_GrdBuyaEd.clearData();
	
	//-- 기부금 초기화 ---------------------------------------------
	this.ds_GrdGibu.set_enableevent(false);
	
	for(var iLoop=this.ds_GrdGibu.rowcount - 1; 0 <= iLoop; iLoop--){
		sRegiID = this.ds_GrdGibu.getColumn(iLoop, "REGI_ID");
		
		if(sRegiID=="PDF"){			
			this.ds_GrdGibu.deleteRow(iLoop);
		}			
	}
	this.ds_GrdGibu.set_enableevent(true);
	
	//-- 연금저축 초기화 ---------------------------------------------
	this.ds_GrdSave.clearData(); 	// 연금저축

	//-- 월세/거주자간주택임차 초기화 ---------------------------------------------
	//this.ds_GrdRent.clearData(); 	행추가 입력시 금액이 사라지기 떄문에 이렇게 하면 안됨(행추가인 항목이 있으면 금액을 합산해서 JSBA_TG46에 
	for(var iLoop=this.ds_GrdRent.rowcount - 1; 0 <= iLoop; iLoop--){
		sRegiID = this.ds_GrdRent.getColumn(iLoop, "REGI_ID");
		
		if(sRegiID=="PDF"){			
			this.ds_GrdRent.deleteRow(iLoop);			
		}			
	}
	
	//-------------------------------------------------------------
	
	trace("-----------------XML 데이터 읽기--------------------")

	//넥사크로에서 테스트시 : children => childNodes
	//웹에서 테스트시 : childNodes => children
	var sXmlData = nexacro.replaceAll(this.ds_PdfToXml.getColumn(0, "DATA_RT"), "<br/>", "");
	//trace(sXmlData);
	var parser = new nexacro.DomParser();
	var xmlDoc=parser.parseFromString(sXmlData,"text/xml");

	var nodeList = xmlDoc.getElementsByTagName('form');
	
	var sSystId  = this.div_Search.form.edt_SystId.value;
	
	trace("nodeList==" + nodeList.length);

	for ( var i = 0; i < nodeList.length; i++ ) {

		if(nodeList[i].getAttribute("form_cd") == 'A102Y') {   //보험
			trace('보험 man 길이 => '+nodeList[i].getElementsByTagName("man").length);
			for ( var j = 0; j < nodeList[i].getElementsByTagName("man").length; j++ ) {
				trace('보험data 길이 => '+nodeList[i].childNodes[j].getElementsByTagName("data").length);
				
				var nBoh4=0;
				var nBoh5=0;
				for ( var k = 0; k < nodeList[i].childNodes[j].getElementsByTagName("data").length; k++ ) {
					trace(k + "==>" + nodeList[i].childNodes[j].getAttribute("resid"));
					//부양가족으로 등록이 되어 있어야함					
					if(this.ds_GrdBuya.findRow("BUYA_JUMI", nodeList[i].childNodes[j].getAttribute("resid")) >= 0)
					{
						//동일 주민번호가 있는지 확인
						var bonRow  = this.ds_GrdBuyaBo.findRow("BUYA_JUMI", nodeList[i].childNodes[j].getAttribute("resid"));
						var gibon_yn = this.ds_GrdBuya.getColumn(this.ds_GrdBuya.findRow("BUYA_JUMI", nodeList[i].childNodes[j].getAttribute("resid")), "BUYA_GIBO");
						//trace('보험료 ===> '+ bonRow + '  기본공제대상 여부 = '+gibon_yn);
						if( bonRow < 0){  //보험료에 동일 주민번호가 없다						
							if(gibon_yn == '1'){  //기본공제대상자일 때만 등록..							
								var bRow = this.ds_GrdBuyaBo.addRow();
								
								this.ds_GrdBuyaBo.setColumn(bRow, "COMP_CODE", this.fvCompCode );
								this.ds_GrdBuyaBo.setColumn(bRow, "BUYA_YEAR", this.fvJsmtYear );
								this.ds_GrdBuyaBo.setColumn(bRow, "SYST_ID", sSystId);
								this.ds_GrdBuyaBo.setColumn(bRow, "BUYA_JUMI", nodeList[i].childNodes[j].getAttribute("resid") );
								if(nodeList[i].childNodes[j].childNodes[k].getAttribute("dat_cd") == 'G0001' ) {
									trace('보험 처음값 = '+ nodeList[i].childNodes[j].childNodes[k].childNodes[9].childNodes[0].nodeValue);
									this.ds_GrdBuyaBo.setColumn(bRow, "BUYA_BOH4", nodeList[i].childNodes[j].childNodes[k].childNodes[9].childNodes[0].nodeValue );   // 국세청_보험료_일반보장성 
								}else{
									this.ds_GrdBuyaBo.setColumn(bRow, "BUYA_BOH5", nodeList[i].childNodes[j].childNodes[k].childNodes[9].childNodes[0].nodeValue );   // 국세청_보험료_장애인전용  
								}
							}
						}else{
							if(gibon_yn == '1'){  //기본공제대상자일 때만 등록..							
								if(nodeList[i].childNodes[j].childNodes[k].getAttribute("dat_cd") == 'G0001' ) {								
									trace('보험_그 외값 = '+ nodeList[i].childNodes[j].childNodes[k].childNodes[9].childNodes[0].nodeValue);									
									//this.ds_GrdBuyaBo.setColumn(bonRow, "BUYA_BOH4", nexacro.toNumber(this.ds_GrdBuyaBo.getColumn(bonRow, "BUYA_BOH4")) + nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[9].childNodes[0].nodeValue) );
									nBoh4 = nBoh4 + nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[9].childNodes[0].nodeValue);
									this.ds_GrdBuyaBo.setColumn(bonRow, "BUYA_BOH4",nBoh4);
									
								}else{
									//this.ds_GrdBuyaBo.setColumn(bonRow, "BUYA_BOH5", nexacro.toNumber(this.ds_GrdBuyaBo.getColumn(bonRow, "BUYA_BOH5")) + nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[9].childNodes[0].nodeValue) );
									nBoh5= nBoh5 +  nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[9].childNodes[0].nodeValue) ;
									this.ds_GrdBuyaBo.setColumn(bonRow, "BUYA_BOH5",nBoh5);
								}
							}
						}
					}
				}
			}
		}
		

		//2022년 한시적으로 사용		
		if(this.div_Search.form.spn_JstaYear.value == '2022')
		{
			if(nodeList[i].getAttribute("form_cd") == 'G110Y')
			{
				trace('=== 2021 신용카드 ===');
				for ( var j = 0; j < nodeList[i].getElementsByTagName("man").length; j++ ) 
				{
					for ( var k = 0; k < nodeList[i].childNodes[j].getElementsByTagName("sum_data").length; k++ ) 
					{	
						//부양가족으로 등록이 되어 있어야함. 관계 = 본인, 배우자, 직계비속, 직계존속
						if(this.ds_GrdBuya.findRow("BUYA_JUMI", nodeList[i].childNodes[j].getAttribute("resid")) >= 0 &&
						   (this.ds_GrdBuya.getColumn(this.ds_GrdBuya.findRowExpr("BUYA_JUMI=='"+ nodeList[i].childNodes[j].getAttribute("resid") + "'"), "BUYA_RELA") == "0" ||
							this.ds_GrdBuya.getColumn(this.ds_GrdBuya.findRowExpr("BUYA_JUMI=='"+ nodeList[i].childNodes[j].getAttribute("resid") + "'"), "BUYA_RELA") == "1" ||
							this.ds_GrdBuya.getColumn(this.ds_GrdBuya.findRowExpr("BUYA_JUMI=='"+ nodeList[i].childNodes[j].getAttribute("resid") + "'"), "BUYA_RELA") == "2" ||
							this.ds_GrdBuya.getColumn(this.ds_GrdBuya.findRowExpr("BUYA_JUMI=='"+ nodeList[i].childNodes[j].getAttribute("resid") + "'"), "BUYA_RELA") == "3" ||
							this.ds_GrdBuya.getColumn(this.ds_GrdBuya.findRowExpr("BUYA_JUMI=='"+ nodeList[i].childNodes[j].getAttribute("resid") + "'"), "BUYA_RELA") == "4" ))
						{
						trace('=== 신용카드 주민번호 ==='+nodeList[i].childNodes[j].getAttribute("resid"));
							//동일 주민번호가 있는지 확인
							var bonRow  = this.ds_GrdBuyaCa.findRow("BUYA_JUMI", nodeList[i].childNodes[j].getAttribute("resid"));
							if( bonRow < 0)  //동일 주민번호가 없다
							{trace('=== 신용카드 동일 주민번호가 X ==='+nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[0].childNodes[0].nodeValue));
								var bRow = this.ds_GrdBuyaCa.addRow();
								
								this.ds_GrdBuyaCa.setColumn(bRow, "COMP_CODE", this.fvCompCode );
								this.ds_GrdBuyaCa.setColumn(bRow, "BUYA_YEAR", this.fvJsmtYear );
								this.ds_GrdBuyaCa.setColumn(bRow, "SYST_ID", sSystId );
								this.ds_GrdBuyaCa.setColumn(bRow, "BUYA_JUMI", nodeList[i].childNodes[j].getAttribute("resid") );
								
								this.ds_GrdBuyaCa.setColumn(bRow, "BUYA_CRD1_2020", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[0].childNodes[0].nodeValue));  	//2021년 사용금액 합계
								this.ds_GrdBuyaCa.setColumn(bRow, "BUYA_XTRA", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[2].childNodes[0].nodeValue));   		//2021년 전통시장 사용금액 합계
								this.ds_GrdBuyaCa.setColumn(bRow, "BUYA_NTRA", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[3].childNodes[0].nodeValue));   		//2022년 전통시장 사용금액 합계
								
								this.ds_GrdBuyaCa.setColumn(bRow, "BUYA_CAIB", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[4].childNodes[0].nodeValue));   		//일반 합계
								this.ds_GrdBuyaCa.setColumn(bRow, "BUYA_CAJT", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[5].childNodes[0].nodeValue));   		//전통시장 합계
								this.ds_GrdBuyaCa.setColumn(bRow, "BUYA_CADJ", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[6].childNodes[0].nodeValue));   		//대중교통 합계
								this.ds_GrdBuyaCa.setColumn(bRow, "BUYA_CADS", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[7].childNodes[0].nodeValue));   		//도서공연 합계 
								
								this.ds_GrdBuyaCa.setColumn(bRow, "BUYA_SCIB", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[9].childNodes[0].nodeValue));   		//일반_상반기
								this.ds_GrdBuyaCa.setColumn(bRow, "BUYA_SCJT", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[10].childNodes[0].nodeValue));   	//전통_상반기
								this.ds_GrdBuyaCa.setColumn(bRow, "BUYA_SCDJ", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[11].childNodes[0].nodeValue));   	//대중_상반기
								this.ds_GrdBuyaCa.setColumn(bRow, "BUYA_SCDS", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[12].childNodes[0].nodeValue));   	//도서_상반기
								
								this.ds_GrdBuyaCa.setColumn(bRow, "BUYA_HCIB", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[14].childNodes[0].nodeValue));   	//일반_하반기
								this.ds_GrdBuyaCa.setColumn(bRow, "BUYA_HCJT", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[15].childNodes[0].nodeValue));   	//전통_하반기
								this.ds_GrdBuyaCa.setColumn(bRow, "BUYA_HCDJ", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[16].childNodes[0].nodeValue));   	//대중_하반기
								this.ds_GrdBuyaCa.setColumn(bRow, "BUYA_HCDS", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[17].childNodes[0].nodeValue));   	//도서_하반기
							}
							else
								{trace('=== 신용카드 동일 주민번호가 O ==='+ nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].getAttribute("gnrl_sum")));
								this.ds_GrdBuyaCa.setColumn(bonRow, "BUYA_CRD1_2020", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[0].childNodes[0].nodeValue));	//2021년 사용금액 합계
								this.ds_GrdBuyaCa.setColumn(bonRow, "BUYA_XTRA", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[2].childNodes[0].nodeValue));   	//2021년 전통시장 사용금액 합계
								this.ds_GrdBuyaCa.setColumn(bonRow, "BUYA_NTRA", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[3].childNodes[0].nodeValue));   	//2022년 전통시장 사용금액 합계
								this.ds_GrdBuyaCa.setColumn(bonRow, "BUYA_CRD1_2020", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[0].childNodes[0].nodeValue));	//2021년 사용금액 합계
								this.ds_GrdBuyaCa.setColumn(bonRow, "BUYA_CAIB", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[4].childNodes[0].nodeValue));   	//일반 합계
								this.ds_GrdBuyaCa.setColumn(bonRow, "BUYA_CAJT", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[5].childNodes[0].nodeValue));   	//전통시장 합계
								this.ds_GrdBuyaCa.setColumn(bonRow, "BUYA_CADJ", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[6].childNodes[0].nodeValue));   	//대중교통 합계
								this.ds_GrdBuyaCa.setColumn(bonRow, "BUYA_CADS", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[7].childNodes[0].nodeValue));   	//도서공연 합계 
								
								this.ds_GrdBuyaCa.setColumn(bonRow, "BUYA_SCIB", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[9].childNodes[0].nodeValue));   	//일반_상반기
								this.ds_GrdBuyaCa.setColumn(bonRow, "BUYA_SCJT", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[10].childNodes[0].nodeValue));   	//전통_상반기
								this.ds_GrdBuyaCa.setColumn(bonRow, "BUYA_SCDJ", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[11].childNodes[0].nodeValue));   	//대중_상반기
								this.ds_GrdBuyaCa.setColumn(bonRow, "BUYA_SCDS", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[12].childNodes[0].nodeValue));   	//도서_상반기
								
								this.ds_GrdBuyaCa.setColumn(bonRow, "BUYA_HCIB", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[14].childNodes[0].nodeValue));   	//일반_하반기
								this.ds_GrdBuyaCa.setColumn(bonRow, "BUYA_HCJT", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[15].childNodes[0].nodeValue));   	//전통_하반기
								this.ds_GrdBuyaCa.setColumn(bonRow, "BUYA_HCDJ", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[16].childNodes[0].nodeValue));   	//대중_하반기
								this.ds_GrdBuyaCa.setColumn(bonRow, "BUYA_HCDS", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[17].childNodes[0].nodeValue));   	//도서_하반기
							}
						}   
					}
				}
			}
			
			if(nodeList[i].getAttribute("form_cd") == 'G210M')   //2021년 귀속 현금영수증
			{trace('=== 2021 현금영수증 ===');
				for ( var j = 0; j < nodeList[i].getElementsByTagName("man").length; j++ ) 
				{
					for ( var k = 0; k < nodeList[i].childNodes[j].getElementsByTagName("sum_data").length; k++ ) 
					{
						//부양가족으로 등록이 되어 있어야함. 관계 = 본인, 배우자, 직계비속, 직계존속
						if(this.ds_GrdBuya.findRow("BUYA_JUMI", nodeList[i].childNodes[j].getAttribute("resid")) >= 0 &&
						   (this.ds_GrdBuya.getColumn(this.ds_GrdBuya.findRowExpr("BUYA_JUMI=='"+ nodeList[i].childNodes[j].getAttribute("resid") + "'"), "BUYA_RELA") == "0" ||
							this.ds_GrdBuya.getColumn(this.ds_GrdBuya.findRowExpr("BUYA_JUMI=='"+ nodeList[i].childNodes[j].getAttribute("resid") + "'"), "BUYA_RELA") == "1" ||
							this.ds_GrdBuya.getColumn(this.ds_GrdBuya.findRowExpr("BUYA_JUMI=='"+ nodeList[i].childNodes[j].getAttribute("resid") + "'"), "BUYA_RELA") == "2" ||
							this.ds_GrdBuya.getColumn(this.ds_GrdBuya.findRowExpr("BUYA_JUMI=='"+ nodeList[i].childNodes[j].getAttribute("resid") + "'"), "BUYA_RELA") == "3" ||
							this.ds_GrdBuya.getColumn(this.ds_GrdBuya.findRowExpr("BUYA_JUMI=='"+ nodeList[i].childNodes[j].getAttribute("resid") + "'"), "BUYA_RELA") == "4" )
						  )
						{
							//동일 주민번호가 있는지 확인
							var bonRow  = this.ds_GrdBuyaCa.findRow("BUYA_JUMI", nodeList[i].childNodes[j].getAttribute("resid"));
							if( bonRow < 0)  //동일 주민번호가 없다
							{
								var bRow = this.ds_GrdBuyaCa.addRow();
								
								
								this.ds_GrdBuyaCa.setColumn(bRow, "COMP_CODE", this.fvCompCode );
								this.ds_GrdBuyaCa.setColumn(bRow, "BUYA_YEAR", this.fvJsmtYear );
								this.ds_GrdBuyaCa.setColumn(bRow, "SYST_ID", sSystId );
								this.ds_GrdBuyaCa.setColumn(bRow, "BUYA_JUMI", nodeList[i].childNodes[j].getAttribute("resid") );								
								
								this.ds_GrdBuyaCa.setColumn(bRow, "BUYA_CSH1_2020", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[0].childNodes[0].nodeValue));  	//2021년 사용금액 합계
								this.ds_GrdBuyaCa.setColumn(bRow, "BUYA_XHTR", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[2].childNodes[0].nodeValue));   	//2021년 전통시장 사용금액 합계
								this.ds_GrdBuyaCa.setColumn(bRow, "BUYA_NHTR", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[3].childNodes[0].nodeValue));   	//2022년 전통시장 사용금액 합계
								
								this.ds_GrdBuyaCa.setColumn(bRow, "BUYA_CHIB", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[4].childNodes[0].nodeValue));   		//일반 합계
								this.ds_GrdBuyaCa.setColumn(bRow, "BUYA_CHJT", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[5].childNodes[0].nodeValue));   		//전통시장 합계
								this.ds_GrdBuyaCa.setColumn(bRow, "BUYA_CHDJ", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[6].childNodes[0].nodeValue));   		//대중교통 합계
								this.ds_GrdBuyaCa.setColumn(bRow, "BUYA_CHDS", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[7].childNodes[0].nodeValue));   		//도서공연 합계 
								
								this.ds_GrdBuyaCa.setColumn(bRow, "BUYA_SHIB", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[9].childNodes[0].nodeValue));   		//일반_상반기
								this.ds_GrdBuyaCa.setColumn(bRow, "BUYA_SHJT", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[10].childNodes[0].nodeValue));   	//전통_상반기
								this.ds_GrdBuyaCa.setColumn(bRow, "BUYA_SHDJ", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[11].childNodes[0].nodeValue));   	//대중_상반기
								this.ds_GrdBuyaCa.setColumn(bRow, "BUYA_SHDS", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[12].childNodes[0].nodeValue));   	//도서_상반기
								
								this.ds_GrdBuyaCa.setColumn(bRow, "BUYA_HHIB", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[14].childNodes[0].nodeValue));   	//일반_하반기
								this.ds_GrdBuyaCa.setColumn(bRow, "BUYA_HHJT", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[15].childNodes[0].nodeValue));   	//전통_하반기
								this.ds_GrdBuyaCa.setColumn(bRow, "BUYA_HHDJ", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[16].childNodes[0].nodeValue));   	//대중_하반기
								this.ds_GrdBuyaCa.setColumn(bRow, "BUYA_HHDS", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[17].childNodes[0].nodeValue));   	//도서_하반기
							}
							else
							{								
								this.ds_GrdBuyaCa.setColumn(bonRow, "BUYA_CSH1_2020", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[0].childNodes[0].nodeValue)); //2021년 사용금액 합계
								this.ds_GrdBuyaCa.setColumn(bonRow, "BUYA_XHTR", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[2].childNodes[0].nodeValue));   	//2021년 전통시장 사용금액 합계
								this.ds_GrdBuyaCa.setColumn(bonRow, "BUYA_NHTR", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[3].childNodes[0].nodeValue));   	//2022년 전통시장 사용금액 합계
								this.ds_GrdBuyaCa.setColumn(bonRow, "BUYA_CHIB", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[4].childNodes[0].nodeValue));   	//일반 합계
								this.ds_GrdBuyaCa.setColumn(bonRow, "BUYA_CHJT", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[5].childNodes[0].nodeValue));   	//전통시장 합계
								this.ds_GrdBuyaCa.setColumn(bonRow, "BUYA_CHDJ", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[6].childNodes[0].nodeValue));   	//대중교통 합계
								this.ds_GrdBuyaCa.setColumn(bonRow, "BUYA_CHDS", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[7].childNodes[0].nodeValue));   	//도서공연 합계 
								
								this.ds_GrdBuyaCa.setColumn(bonRow, "BUYA_SHIB", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[9].childNodes[0].nodeValue));   	//일반_상반기
								this.ds_GrdBuyaCa.setColumn(bonRow, "BUYA_SHJT", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[10].childNodes[0].nodeValue));   	//전통_상반기
								this.ds_GrdBuyaCa.setColumn(bonRow, "BUYA_SHDJ", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[11].childNodes[0].nodeValue));   	//대중_상반기
								this.ds_GrdBuyaCa.setColumn(bonRow, "BUYA_SHDS", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[12].childNodes[0].nodeValue));   	//도서_상반기
								
								this.ds_GrdBuyaCa.setColumn(bonRow, "BUYA_HHIB", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[14].childNodes[0].nodeValue));   	//일반_하반기
								this.ds_GrdBuyaCa.setColumn(bonRow, "BUYA_HHJT", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[15].childNodes[0].nodeValue));   	//전통_하반기
								this.ds_GrdBuyaCa.setColumn(bonRow, "BUYA_HHDJ", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[16].childNodes[0].nodeValue));   	//대중_하반기
								this.ds_GrdBuyaCa.setColumn(bonRow, "BUYA_HHDS", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[17].childNodes[0].nodeValue));   	//도서_하반기						
							}
						}
					}
				}
			}
								
			if(nodeList[i].getAttribute("form_cd") == 'G310Y')   //2021년 귀속 직불카드
			{trace('=== 직불카드 ===');
				for ( var j = 0; j < nodeList[i].getElementsByTagName("man").length; j++ ) {
					for ( var k = 0; k < nodeList[i].childNodes[j].getElementsByTagName("sum_data").length; k++ ) {
						//부양가족으로 등록이 되어 있어야함. 관계 = 본인, 배우자, 직계비속, 직계존속
						if(this.ds_GrdBuya.findRow("BUYA_JUMI", nodeList[i].childNodes[j].getAttribute("resid")) >= 0 &&
						   (this.ds_GrdBuya.getColumn(this.ds_GrdBuya.findRowExpr("BUYA_JUMI=='"+ nodeList[i].childNodes[j].getAttribute("resid") + "'"), "BUYA_RELA") == "0" ||
							this.ds_GrdBuya.getColumn(this.ds_GrdBuya.findRowExpr("BUYA_JUMI=='"+ nodeList[i].childNodes[j].getAttribute("resid") + "'"), "BUYA_RELA") == "1" ||
							this.ds_GrdBuya.getColumn(this.ds_GrdBuya.findRowExpr("BUYA_JUMI=='"+ nodeList[i].childNodes[j].getAttribute("resid") + "'"), "BUYA_RELA") == "2" ||
							this.ds_GrdBuya.getColumn(this.ds_GrdBuya.findRowExpr("BUYA_JUMI=='"+ nodeList[i].childNodes[j].getAttribute("resid") + "'"), "BUYA_RELA") == "3" ||
							this.ds_GrdBuya.getColumn(this.ds_GrdBuya.findRowExpr("BUYA_JUMI=='"+ nodeList[i].childNodes[j].getAttribute("resid") + "'"), "BUYA_RELA") == "4" )
						  )
						{
							//trace(nodeList[i].childNodes[j].getElementsByTagName("sum_data")[k].childNodes[0].childNodes[0].nodeValue)
							//동일 주민번호가 있는지 확인
							var bonRow  = this.ds_GrdBuyaCa.findRow("BUYA_JUMI", nodeList[i].childNodes[j].getAttribute("resid"));
							if( bonRow < 0)  //동일 주민번호가 없다
							{
								var bRow = this.ds_GrdBuyaCa.addRow();
								
								this.ds_GrdBuyaCa.setColumn(bRow, "COMP_CODE", this.fvCompCode );
								this.ds_GrdBuyaCa.setColumn(bRow, "BUYA_YEAR", this.fvJsmtYear );
								this.ds_GrdBuyaCa.setColumn(bRow, "SYST_ID", sSystId);
								this.ds_GrdBuyaCa.setColumn(bRow, "BUYA_JUMI", nodeList[i].childNodes[j].getAttribute("resid") );														
								
								
								this.ds_GrdBuyaCa.setColumn(bRow, "BUYA_DIR1_2020", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[0].childNodes[0].nodeValue));  	//2021년 사용금액 합계
								this.ds_GrdBuyaCa.setColumn(bRow, "BUYA_XJTR", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[2].childNodes[0].nodeValue));   	//2021년 전통시장 사용금액 합계
								this.ds_GrdBuyaCa.setColumn(bRow, "BUYA_NJTR", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[3].childNodes[0].nodeValue));   	//2022년 전통시장 사용금액 합계
								
								this.ds_GrdBuyaCa.setColumn(bRow, "BUYA_JKIB", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[4].childNodes[0].nodeValue));   		//일반 합계
								this.ds_GrdBuyaCa.setColumn(bRow, "BUYA_JKJT", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[5].childNodes[0].nodeValue));   		//전통시장 합계
								this.ds_GrdBuyaCa.setColumn(bRow, "BUYA_JKDJ", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[6].childNodes[0].nodeValue));   		//대중교통 합계
								this.ds_GrdBuyaCa.setColumn(bRow, "BUYA_JKDS", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[7].childNodes[0].nodeValue));   		//도서공연 합계 
								
								this.ds_GrdBuyaCa.setColumn(bRow, "BUYA_SJIB", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[9].childNodes[0].nodeValue));   		//일반_상반기
								this.ds_GrdBuyaCa.setColumn(bRow, "BUYA_SJJT", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[10].childNodes[0].nodeValue));   	//전통_상반기
								this.ds_GrdBuyaCa.setColumn(bRow, "BUYA_SJDJ", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[11].childNodes[0].nodeValue));   	//대중_상반기
								this.ds_GrdBuyaCa.setColumn(bRow, "BUYA_SJDS", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[12].childNodes[0].nodeValue));   	//도서_상반기
								
								this.ds_GrdBuyaCa.setColumn(bRow, "BUYA_HJIB", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[14].childNodes[0].nodeValue));   	//일반_하반기
								this.ds_GrdBuyaCa.setColumn(bRow, "BUYA_HJJT", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[15].childNodes[0].nodeValue));   	//전통_하반기
								this.ds_GrdBuyaCa.setColumn(bRow, "BUYA_HJDJ", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[16].childNodes[0].nodeValue));   	//대중_하반기
								this.ds_GrdBuyaCa.setColumn(bRow, "BUYA_HJDS", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[17].childNodes[0].nodeValue));   	//도서_하반기
							}
							else
							{
								this.ds_GrdBuyaCa.setColumn(bonRow, "BUYA_DIR1_2020", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[0].childNodes[0].nodeValue));  	//2021년 사용금액 합계
								this.ds_GrdBuyaCa.setColumn(bonRow, "BUYA_XJTR", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[2].childNodes[0].nodeValue));   	//2021년 전통시장 사용금액 합계
								this.ds_GrdBuyaCa.setColumn(bonRow, "BUYA_NJTR", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[3].childNodes[0].nodeValue));   	//2022년 전통시장 사용금액 합계
								
								this.ds_GrdBuyaCa.setColumn(bonRow, "BUYA_JKIB", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[4].childNodes[0].nodeValue));   	//일반 합계
								this.ds_GrdBuyaCa.setColumn(bonRow, "BUYA_JKJT", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[5].childNodes[0].nodeValue));   	//전통시장 합계
								this.ds_GrdBuyaCa.setColumn(bonRow, "BUYA_JKDJ", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[6].childNodes[0].nodeValue));   	//대중교통 합계
								this.ds_GrdBuyaCa.setColumn(bonRow, "BUYA_JKDS", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[7].childNodes[0].nodeValue));   	//도서공연 합계 
								
								this.ds_GrdBuyaCa.setColumn(bonRow, "BUYA_SJIB", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[9].childNodes[0].nodeValue));   	//일반_상반기
								this.ds_GrdBuyaCa.setColumn(bonRow, "BUYA_SJJT", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[10].childNodes[0].nodeValue));   	//전통_상반기
								this.ds_GrdBuyaCa.setColumn(bonRow, "BUYA_SJDJ", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[11].childNodes[0].nodeValue));   	//대중_상반기
								this.ds_GrdBuyaCa.setColumn(bonRow, "BUYA_SJDS", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[12].childNodes[0].nodeValue));   	//도서_상반기
								
								this.ds_GrdBuyaCa.setColumn(bonRow, "BUYA_HJIB", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[14].childNodes[0].nodeValue));   	//일반_하반기
								this.ds_GrdBuyaCa.setColumn(bonRow, "BUYA_HJJT", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[15].childNodes[0].nodeValue));   	//전통_하반기
								this.ds_GrdBuyaCa.setColumn(bonRow, "BUYA_HJDJ", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[16].childNodes[0].nodeValue));   	//대중_하반기
								this.ds_GrdBuyaCa.setColumn(bonRow, "BUYA_HJDS", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[17].childNodes[0].nodeValue));   	//도서_하반기

							}							
						}
					}
				}
			}
							
								
			if(nodeList[i].getAttribute("form_cd") == 'G410Y')   //2021년 귀속 제로페이
			{trace('=== 제로페이 ===');
				for ( var j = 0; j < nodeList[i].getElementsByTagName("man").length; j++ ) {
					
					for ( var k = 0; k < nodeList[i].childNodes[j].getElementsByTagName("sum_data").length; k++ ) {
						//부양가족으로 등록이 되어 있어야함. 관계 = 본인, 배우자, 직계비속, 직계존속
						if(this.ds_GrdBuya.findRow("BUYA_JUMI", nodeList[i].childNodes[j].getAttribute("resid")) >= 0 &&
						   (this.ds_GrdBuya.getColumn(this.ds_GrdBuya.findRowExpr("BUYA_JUMI=='"+ nodeList[i].childNodes[j].getAttribute("resid") + "'"), "BUYA_RELA") == "0" ||
							this.ds_GrdBuya.getColumn(this.ds_GrdBuya.findRowExpr("BUYA_JUMI=='"+ nodeList[i].childNodes[j].getAttribute("resid") + "'"), "BUYA_RELA") == "1" ||
							this.ds_GrdBuya.getColumn(this.ds_GrdBuya.findRowExpr("BUYA_JUMI=='"+ nodeList[i].childNodes[j].getAttribute("resid") + "'"), "BUYA_RELA") == "2" ||
							this.ds_GrdBuya.getColumn(this.ds_GrdBuya.findRowExpr("BUYA_JUMI=='"+ nodeList[i].childNodes[j].getAttribute("resid") + "'"), "BUYA_RELA") == "3" ||
							this.ds_GrdBuya.getColumn(this.ds_GrdBuya.findRowExpr("BUYA_JUMI=='"+ nodeList[i].childNodes[j].getAttribute("resid") + "'"), "BUYA_RELA") == "4" )
						  )
						{
							//동일 주민번호가 있는지 확인
							var bonRow  = this.ds_GrdBuyaCa.findRow("BUYA_JUMI", nodeList[i].childNodes[j].getAttribute("resid"));
							if( bonRow < 0)  //동일 주민번호가 없다
							{
								var bRow = this.ds_GrdBuyaCa.addRow();
								this.ds_GrdBuyaCa.setColumn(bRow, "COMP_CODE", this.fvCompCode );
								this.ds_GrdBuyaCa.setColumn(bRow, "BUYA_YEAR", this.fvJsmtYear );
								this.ds_GrdBuyaCa.setColumn(bRow, "SYST_ID", sSystId );
								this.ds_GrdBuyaCa.setColumn(bRow, "BUYA_JUMI", nodeList[i].childNodes[j].getAttribute("resid") );
								
								this.ds_GrdBuyaCa.setColumn(bRow, "BUYA_ZERO_2020", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[0].childNodes[0].nodeValue));  	//2021년 사용금액 합계
								this.ds_GrdBuyaCa.setColumn(bRow, "BUYA_XZTR", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[2].childNodes[0].nodeValue));   		//2021년 전통시장 사용금액 합계
								this.ds_GrdBuyaCa.setColumn(bRow, "BUYA_NZTR", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[3].childNodes[0].nodeValue));   		//2022년 전통시장 사용금액 합계
								
								this.ds_GrdBuyaCa.setColumn(bRow, "BUYA_ZEIB", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[4].childNodes[0].nodeValue));   		//일반 합계
								this.ds_GrdBuyaCa.setColumn(bRow, "BUYA_ZEJT", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[5].childNodes[0].nodeValue));   		//전통시장 합계
								this.ds_GrdBuyaCa.setColumn(bRow, "BUYA_ZEDJ", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[6].childNodes[0].nodeValue));   		//대중교통 합계
								this.ds_GrdBuyaCa.setColumn(bRow, "BUYA_ZEDS", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[7].childNodes[0].nodeValue));   		//도서공연 합계 
								
								this.ds_GrdBuyaCa.setColumn(bRow, "BUYA_SZIB", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[9].childNodes[0].nodeValue));   		//일반_상반기
								this.ds_GrdBuyaCa.setColumn(bRow, "BUYA_SZJT", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[10].childNodes[0].nodeValue));   	//전통_상반기
								this.ds_GrdBuyaCa.setColumn(bRow, "BUYA_SZDJ", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[11].childNodes[0].nodeValue));   	//대중_상반기
								this.ds_GrdBuyaCa.setColumn(bRow, "BUYA_SZDS", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[12].childNodes[0].nodeValue));   	//도서_상반기
								
								this.ds_GrdBuyaCa.setColumn(bRow, "BUYA_HZIB", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[14].childNodes[0].nodeValue));   	//일반_하반기
								this.ds_GrdBuyaCa.setColumn(bRow, "BUYA_HZJT", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[15].childNodes[0].nodeValue));   	//전통_하반기
								this.ds_GrdBuyaCa.setColumn(bRow, "BUYA_HZDJ", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[16].childNodes[0].nodeValue));   	//대중_하반기
								this.ds_GrdBuyaCa.setColumn(bRow, "BUYA_HZDS", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[17].childNodes[0].nodeValue));   	//도서_하반기
							}
							else
							{
								this.ds_GrdBuyaCa.setColumn(bonRow, "BUYA_ZERO_2020", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[0].childNodes[0].nodeValue)); //2021년 사용금액 합계
								this.ds_GrdBuyaCa.setColumn(bonRow, "BUYA_XZTR", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[2].childNodes[0].nodeValue));   	//2021년 전통시장 사용금액 합계
								this.ds_GrdBuyaCa.setColumn(bonRow, "BUYA_NZTR", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[3].childNodes[0].nodeValue));   	//2022년 전통시장 사용금액 합계
								
								this.ds_GrdBuyaCa.setColumn(bonRow, "BUYA_ZEIB", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[4].childNodes[0].nodeValue));   	//일반 합계
								this.ds_GrdBuyaCa.setColumn(bonRow, "BUYA_ZEJT", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[5].childNodes[0].nodeValue));   	//전통시장 합계
								this.ds_GrdBuyaCa.setColumn(bonRow, "BUYA_ZEDJ", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[6].childNodes[0].nodeValue));   	//대중교통 합계
								this.ds_GrdBuyaCa.setColumn(bonRow, "BUYA_ZEDS", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[7].childNodes[0].nodeValue));   	//도서공연 합계 
								
								this.ds_GrdBuyaCa.setColumn(bonRow, "BUYA_SZIB", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[9].childNodes[0].nodeValue));   	//일반_상반기
								this.ds_GrdBuyaCa.setColumn(bonRow, "BUYA_SZJT", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[10].childNodes[0].nodeValue));   	//전통_상반기
								this.ds_GrdBuyaCa.setColumn(bonRow, "BUYA_SZDJ", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[11].childNodes[0].nodeValue));   	//대중_상반기
								this.ds_GrdBuyaCa.setColumn(bonRow, "BUYA_SZDS", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[12].childNodes[0].nodeValue));   	//도서_상반기
								
								this.ds_GrdBuyaCa.setColumn(bonRow, "BUYA_HZIB", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[14].childNodes[0].nodeValue));   	//일반_하반기
								this.ds_GrdBuyaCa.setColumn(bonRow, "BUYA_HZJT", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[15].childNodes[0].nodeValue));   	//전통_하반기
								this.ds_GrdBuyaCa.setColumn(bonRow, "BUYA_HZDJ", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[16].childNodes[0].nodeValue));   	//대중_하반기
								this.ds_GrdBuyaCa.setColumn(bonRow, "BUYA_HZDS", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[17].childNodes[0].nodeValue));   	//도서_하반기		
							}
						}
					}
				}
			}   //제로페이 끝
		}
		
		this.ds_GrdHspt.set_enableevent(false);
		if(nodeList[i].getAttribute("form_cd") == 'B101Y')   //의료비			
			
			{trace('의료비 man 길이 => '+ nodeList[i].getElementsByTagName("man").length);
		
		
			for ( var j = 0; j < nodeList[i].getElementsByTagName("man").length; j++ ) {
				//trace('의료비 data 길이 => '+ nodeList[i].childNodes[j].getElementsByTagName("data").length);
				var nSeqn =0;
				var nGunsu=0;
				var nHsptGamt = 0;
				var nGetAmt   = 0;
				var sResid;
				var sDataCd;		
				var nAnGyung = 0;
				var nAnGyungSum = 0;
					
				for ( var k = 0; k < nodeList[i].childNodes[j].getElementsByTagName("data").length; k++ ) {
					
					//부양가족으로 등록이 되어 있어야함
					if(this.ds_GrdBuya.findRow("BUYA_JUMI", nodeList[i].childNodes[j].getAttribute("resid")) >= 0)
					{   
						//동일 주민번호가 있는지 확인
						sResid  = nodeList[i].childNodes[j].getAttribute("resid");
						sDataCd = nodeList[i].childNodes[j].childNodes[k].getAttribute("dat_cd");
						
						var bonRow  = this.ds_GrdHspt.findRowExpr("HSPT_JUMI=='" + sResid + "' && HSPT_TYPE =='" + sDataCd + "' && REGI_ID =='PDF'");						
						
						if( bonRow < 0) { //동일 주민번호, 의료비종류가 없다						
							var bRow = this.ds_GrdHspt.addRow();
							this.ds_GrdHspt.setColumn(bRow, "crudType", "I");
							
							this.ds_GrdHspt.setColumn(bRow, "COMP_CODE", this.fvCompCode );
							this.ds_GrdHspt.setColumn(bRow, "HSPT_YEAR", this.fvJsmtYear );
							this.ds_GrdHspt.setColumn(bRow, "SYST_ID", sSystId );
							this.ds_GrdHspt.setColumn(bRow, "HSPT_JUMI", nodeList[i].childNodes[j].getAttribute("resid") );				
							
							
							this.ds_GrdHspt.setColumn(bRow, "HSPT_CODE", '1');   //의료증빙구분(pr127) : 국세청제공
							this.ds_GrdHspt.setColumn(bRow, "HSPT_GUNS", 1);  	//건수
							
							this.ds_GrdHspt.setColumn(bRow, "HSPT_NANI", "0");  	//난임시술비
							this.ds_GrdHspt.setColumn(bRow, "HSPT_SANJ", "0");  	//건강보험산정특례자
							this.ds_GrdHspt.setColumn(bRow, "HSPT_PREM", "0");  	//미숙아
							
							this.ds_GrdHspt.setColumn(bRow, "HSPT_TYPE", nodeList[i].childNodes[j].childNodes[k].getAttribute("dat_cd"));  //의료비종류
							
							if(sDataCd == 'G0026') { //안경값 =  인별 50만원 한도
								//this.ds_GrdHspt.setColumn(bRow, "HSPT_COMP",  nodeList[i].childNodes[j].childNodes[k].getAttribute("busnid"));				
								//this.ds_GrdHspt.setColumn(bRow, "HSPT_COMM",  nodeList[i].childNodes[j].childNodes[k].getAttribute("trade_nm"));
								
								if(nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[0].childNodes[0].nodeValue) > 500000){
								 //trace('처음 안경값. 한도금 넘음.');
									this.ds_GrdHspt.setColumn(bRow, "HSPT_GAMT", 500000 ); 
								}else {//trace('처음 안경값. 한도금 안넘음.');
									this.ds_GrdHspt.setColumn(bRow, "HSPT_GAMT", nodeList[i].childNodes[j].childNodes[k].childNodes[0].childNodes[0].nodeValue );
								}
							}else{
								//trace('nodeList[i].childNodes[j].childNodes[k].childNodes[0].childNodes[0].nodeValue = ' +nodeList[i].childNodes[j].childNodes[k].childNodes[0].childNodes[0].nodeValue);
								this.ds_GrdHspt.setColumn(bRow, "HSPT_GAMT", nodeList[i].childNodes[j].childNodes[k].childNodes[0].childNodes[0].nodeValue );   // 국세청_보험료_일반보장성 
							}
							
							this.ds_GrdHspt.setColumn(bRow, "REGI_ID", "PDF");							
							
						}else{
							
							nGunsu = nexacro.toNumber(this.ds_GrdHspt.getColumn(bonRow, "HSPT_GUNS")) + 1;
							this.ds_GrdHspt.setColumn(bonRow, "HSPT_GUNS", nGunsu);  //건수							
						
							// if(nodeList[i].childNodes[j].childNodes[k].getAttribute("dat_cd") == 'G0003') { //의료비							
								//trace('의료비_병원비= '+this.ds_GrdHspt.getColumn(bonRow, "HSPT_GAMT")+' + ' +nodeList[i].childNodes[j].childNodes[k].childNodes[0].childNodes[0].nodeValue);
								//this.ds_GrdHspt.setColumn(bonRow, "HSPT_TYPE", nodeList[i].childNodes[j].childNodes[k].getAttribute("dat_cd"));  //의료비종류
								this.ds_GrdHspt.setColumn(bonRow, "HSPT_TYPE", sDataCd);  //의료비종류
								
								if(sDataCd=="G0026"){
									nAnGyung 	= nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[0].childNodes[0].nodeValue);									
									nAnGyungSum =  nexacro.toNumber(this.ds_GrdHspt.getColumn(bonRow, "HSPT_GAMT"))  + nAnGyung;									
									
									if(nAnGyungSum > 500000){
										this.ds_GrdHspt.setColumn(bRow, "HSPT_GAMT", 500000 ); 
									}else {										
										this.ds_GrdHspt.setColumn(bRow, "HSPT_GAMT", nAnGyungSum );
									}								
								}else{								
 									nGetAmt =  nexacro.toNumber(this.ds_GrdHspt.getColumn(bonRow, "HSPT_GAMT"));								
 									nHsptGamt    = nGetAmt + nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[0].childNodes[0].nodeValue);
									
									this.ds_GrdHspt.setColumn(bonRow, "HSPT_GAMT", nHsptGamt );		
								}
								
								
										
							} /*------------else {
								//G0025:의료기기 구입비용
								//G0026:안경 또는 콘택트렌즈 구입비용
								//G0027:보청기 또는 장애인 보장구 구입비용
								//G0034:산후조리원 비용"
								if(nodeList[i].childNodes[j].childNodes[k].getAttribute("dat_cd") == 'G0026') { //안경값 =  인별 50만원 한도		
									sResid = nodeList[i].childNodes[j].getAttribute("resid");						
								
									//var nGlasses = this.ds_GrdHspt.getCaseSum("crudType != 'D' && HSPT_JUMI=="+nexacro.wrapQuote(nodeList[i].childNodes[j].getAttribute("resid")) + " && HSPT_TYPE == 'G0026'", "HSPT_GAMT");
									var nGlasses = this.ds_GrdHspt.getCaseSum("crudType != 'D' && HSPT_JUMI=='" + sResid + "' && HSPT_TYPE == 'G0026'", "HSPT_GAMT");								
									
									trace('nGlasses => '+nGlasses);
									if(nexacro.toNumber(nGlasses) < 500000) {																			
										//trace('의료비_그 외= '+'nodeList[i].childNodes[j].childNodes[k].getAttribute("busnid")+' *** '+nodeList[i].childNodes[j].childNodes[k].getAttribute("trade_nm"));
										var othRow = this.ds_GrdHspt.addRow();
										this.ds_GrdHspt.setColumn(othRow, "crudType", "I");
										this.ds_GrdHspt.setColumn(othRow, "COMP_CODE", this.fvCompCode );
										this.ds_GrdHspt.setColumn(othRow, "HSPT_YEAR", this.fvJsmtYear );
										this.ds_GrdHspt.setColumn(othRow, "SYST_ID", sSystId );
										this.ds_GrdHspt.setColumn(othRow, "HSPT_JUMI", nodeList[i].childNodes[j].getAttribute("resid") );
										this.ds_GrdHspt.setColumn(othRow, "HSPT_CODE", '1');   //의료증빙구분(pr127) : 국세청제공
										this.ds_GrdHspt.setColumn(othRow, "HSPT_TYPE", nodeList[i].childNodes[j].childNodes[k].getAttribute("dat_cd"));  //의료비종류
										this.ds_GrdHspt.setColumn(othRow, "HSPT_GUNS", 1);  //건수
										this.ds_GrdHspt.setColumn(othRow, "HSPT_COMP", nodeList[i].childNodes[j].childNodes[k].getAttribute("busnid"));//사업자등록번호
										this.ds_GrdHspt.setColumn(othRow, "HSPT_COMM", nodeList[i].childNodes[j].childNodes[k].getAttribute("trade_nm"));//상호
										if(500000 - nexacro.toNumber(nGlasses) < nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[0].childNodes[0].nodeValue)) {
											//trace('안경값 존재. 한도금 넘음. ==> 500000 - '+nexacro.toNumber(nGlasses) + ' *** ' + nodeList[i].childNodes[j].childNodes[k].childNodes[0].text);
											this.ds_GrdHspt.setColumn(othRow, "HSPT_GAMT", 500000 - nexacro.toNumber(nGlasses) );   // 국세청_보험료_일반보장성 
										}else{//trace('안경값 존재. 한도금 안넘음.');
											this.ds_GrdHspt.setColumn(othRow, "HSPT_GAMT", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[0].childNodes[0].nodeValue) );
										}
									}else{
										nSeqn = nSeqn + 1
									};
								}else{									
									//trace('의료비_그 외= '+'nodeList[i].childNodes[j].childNodes[k].getAttribute("busnid")+' *** '+nodeList[i].childNodes[j].childNodes[k].getAttribute("trade_nm"));
									var othRow = this.ds_GrdHspt.addRow();
									this.ds_GrdHspt.setColumn(othRow, "crudType", "I");
									this.ds_GrdHspt.setColumn(othRow, "COMP_CODE", this.fvCompCode );
									this.ds_GrdHspt.setColumn(othRow, "HSPT_YEAR", this.fvJsmtYear );
									this.ds_GrdHspt.setColumn(othRow, "SYST_ID", sSystId );
									this.ds_GrdHspt.setColumn(othRow, "HSPT_JUMI", nodeList[i].childNodes[j].getAttribute("resid") );
									this.ds_GrdHspt.setColumn(othRow, "HSPT_CODE", '1');   //의료증빙구분(pr127) : 국세청제공
									this.ds_GrdHspt.setColumn(othRow, "HSPT_TYPE", nodeList[i].childNodes[j].childNodes[k].getAttribute("dat_cd"));  //의료비종류
									this.ds_GrdHspt.setColumn(othRow, "HSPT_GUNS", 1);  //건수
									this.ds_GrdHspt.setColumn(othRow, "HSPT_COMP", nodeList[i].childNodes[j].childNodes[k].getAttribute("busnid"));//사업자등록번호
									this.ds_GrdHspt.setColumn(othRow, "HSPT_COMM", nodeList[i].childNodes[j].childNodes[k].getAttribute("trade_nm"));//상호
									this.ds_GrdHspt.setColumn(othRow, "HSPT_GAMT", nodeList[i].childNodes[j].childNodes[k].childNodes[0].childNodes[0].nodeValue );   // 국세청_보험료_일반보장성 
								}
							}
						}----------------*/
					}
				}
			}
		}
		
		//2020 귀속분부터 실손의료보험금 추가됨
		if(nodeList[i].getAttribute("form_cd") == 'B201Y')   //실손의료보험금
		{trace('=== 실손의료보험금 ===');
			var sDataCd;
			var sResid
			for ( var j = 0; j < nodeList[i].getElementsByTagName("man").length; j++ ) 
			{   //실손에 대한 개인별 의료비가 존재해야함 => 피보험자 기준으로 등록되어야함.
				sResid  =  nodeList[i].childNodes[j].getAttribute("resid");
				
				//var bonRow  = this.ds_GrdHspt.findRow("HSPT_JUMI", nodeList[i].childNodes[j].getAttribute("resid"));				
				var bonRow  = this.ds_GrdHspt.findRowExpr("HSPT_JUMI=='" + sResid + "'  && HSPT_TYPE == 'G0003' && REGI_ID =='PDF'");
				var silAMT  = 0;		
				
				
				if(bonRow > -1)	{
					for ( var k = 0; k < nodeList[i].childNodes[j].getElementsByTagName("data").length; k++ ) {
						silAMT += nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[3].childNodes[0].nodeValue);
					}
					//실손이 실제 사용한 의료비보다 크면 입력하지 않는다.
					if(nexacro.toNumber(this.ds_GrdHspt.getColumn(bonRow, "HSPT_GAMT")) >= silAMT) {
						this.ds_GrdHspt.setColumn(bonRow, "HSPT_SAMT", silAMT);
					}else{
						this.ds_GrdHspt.setColumn(bonRow, "HSPT_SAMT", nexacro.toNumber(this.ds_GrdHspt.getColumn(bonRow, "HSPT_GAMT")));
					}
				}
			}
					
			/*
			for ( var j = 0; j < nodeList[i].getElementsByTagName("man").length; j++ ) 
			{
				for ( var k = 0; k < nodeList[i].childNodes[j].getElementsByTagName("data").length; k++ ) 
				{
					//실손에 대한 개인별 의료비가 존재해야함 => 피보험자 기준으로 등록되어야함.
					if(this.ds_GrdHspt.findRow("HSPT_JUMI", nodeList[i].childNodes[j].childNodes[k].childNodes[1].text) >= 0) 
					{
						var bonRow  = this.ds_GrdHspt.findRow("HSPT_JUMI", nodeList[i].childNodes[j].childNodes[k].childNodes[1].text);
						if(this.ds_GrdHspt.getColumn(bonRow, "HSPT_TYPE") == 'G0003')
						{
							this.ds_GrdHspt.setColumn(bonRow, "HSPT_SAMT", nodeList[i].childNodes[j].childNodes[k].childNodes[3].text);
						}
					}
				}
			}
			*/
		}

		this.ds_GrdHspt.set_enableevent(true);	
		
		if(nodeList[i].getAttribute("form_cd") == 'C102Y')   //교육비
		{trace('=== 교육비 ===');
			for ( var j = 0; j < nodeList[i].getElementsByTagName("man").length; j++ ) {
				var nEdu1 = 0;
				var nEdu4 = 0;
				var sResid;
				var nRow;
				
				for ( var k = 0; k < nodeList[i].childNodes[j].getElementsByTagName("data").length; k++ ) {
					//부양가족으로 등록이 되어 있어야함
					if(this.ds_GrdBuya.findRow("BUYA_JUMI", nodeList[i].childNodes[j].getAttribute("resid")) >= 0)
					{
						//동일 주민번호가 있는지 확인
						var bonRow  = this.ds_GrdBuyaEd.findRow("BUYA_JUMI", nodeList[i].childNodes[j].getAttribute("resid"));											
						
						if( bonRow < 0){  //동일 주민번호가 없다						
							var bRow = this.ds_GrdBuyaEd.addRow();
							this.ds_GrdBuyaEd.setColumn(bRow, "COMP_CODE", this.fvCompCode );
							this.ds_GrdBuyaEd.setColumn(bRow, "BUYA_YEAR", this.fvJsmtYear );
							this.ds_GrdBuyaEd.setColumn(bRow, "SYST_ID", sSystId); //this.ds_Input.getColumn(0,"SRCH_EMST") );
							this.ds_GrdBuyaEd.setColumn(bRow, "BUYA_JUMI", nodeList[i].childNodes[j].getAttribute("resid") );
							
 							var vEDGB = '';				
														
							sResid = nodeList[i].childNodes[j].getAttribute("resid");							
							
							//if(this.ds_GrdBuya.getColumn(this.ds_GrdBuya.findRowExpr("BUYA_JUMI="+nexacro.wrapQuote(nodeList[i].childNodes[j].getAttribute("resid"))), "BUYA_RELA") == "0" ){
							if(this.ds_GrdBuya.getColumn(this.ds_GrdBuya.findRowExpr("BUYA_JUMI=='" + sResid + "'" ),"BUYA_RELA") =="0"){							
								vEDGB = 0;
							}else {   //본인은 본인으로 선택되어야함.							
							
								if(nodeList[i].childNodes[j].childNodes[k].getAttribute("edu_tp") == '1') //유치원->취학전아
									vEDGB = 1;
								else if(nodeList[i].childNodes[j].childNodes[k].getAttribute("edu_tp") == '2') //초등학교->초/중/고
									vEDGB = 2;
								else if(nodeList[i].childNodes[j].childNodes[k].getAttribute("edu_tp") == '3') //중학교->초/중/고
									vEDGB = 2;
								else if(nodeList[i].childNodes[j].childNodes[k].getAttribute("edu_tp") == '4') //고등학교->초/중/고
									vEDGB = 2;
								else if(nodeList[i].childNodes[j].childNodes[k].getAttribute("edu_tp") == '5') //전문대학->초/중/고
									vEDGB = 3;
								else if(nodeList[i].childNodes[j].childNodes[k].getAttribute("edu_tp") == '6') //대학교
									vEDGB = 3;
								else if(nodeList[i].childNodes[j].childNodes[k].getAttribute("edu_tp") == '7') //대학원
									vEDGB = 3;
								else if(nodeList[i].childNodes[j].childNodes[k].getAttribute("edu_tp") == '8') //보육시설->취학전아
									vEDGB = 1; 
								else if(nodeList[i].childNodes[j].childNodes[k].getAttribute("edu_tp") == 'L') //학점은행
									vEDGB = 3;
								else if(nodeList[i].childNodes[j].childNodes[k].getAttribute("edu_tp") == 'C') //원격대학
									vEDGB = 3;
								else if(nodeList[i].childNodes[j].childNodes[k].getAttribute("edu_tp") == 'D') //학위취득과정
									vEDGB = 3;
								else if(nodeList[i].childNodes[j].childNodes[k].getAttribute("edu_tp") == 'J') //장애인재활교육기관
									vEDGB = 4;
								else if(nodeList[i].childNodes[j].childNodes[k].getAttribute("edu_tp") == 'K') //발달재활서비스제공기관
									vEDGB = 4;									
								else
									vEDGB = '';
							}
							
							this.ds_GrdBuyaEd.setColumn(bRow, "BUYA_EDGB", vEDGB);   //교육비구분(PR124) 
							
							if(nodeList[i].childNodes[j].childNodes[k].getAttribute("edu_cl") == 'A'){ //교육비
								this.ds_GrdBuyaEd.setColumn(bRow, "BUYA_EDU1", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[0].childNodes[0].nodeValue));   // 교육비 
							}else if(nodeList[i].childNodes[j].childNodes[k].getAttribute("edu_cl") == 'B'){
								this.ds_GrdBuyaEd.setColumn(bRow, "BUYA_EDU4", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[0].childNodes[0].nodeValue));   // 현장체험학습비
							}									
						}else{	
							if(nodeList[i].childNodes[j].childNodes[k].getAttribute("edu_cl") == 'A'){ //교육비
								//this.ds_GrdBuyaEd.setColumn(bonRow, "BUYA_EDU1", nexacro.toNumber(this.ds_GrdBuyaEd.getColumn(bonRow, "BUYA_EDU1")) + nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[0].childNodes[0].nodeValue));
								
								nEdu1 = nexacro.toNumber(this.ds_GrdBuyaEd.getColumn(bonRow, "BUYA_EDU1"));								
								
								nEdu1 = nEdu1 + nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[0].childNodes[0].nodeValue);
								this.ds_GrdBuyaEd.setColumn(bonRow, "BUYA_EDU1",nEdu1);
								
							}else if(nodeList[i].childNodes[j].childNodes[k].getAttribute("edu_cl") == 'B'){
								
								nEdu4 =  this.ds_GrdBuyaEd.getColumn(bonRow, "BUYA_EDU4");									
								if(this.gfn_IsNull(nEdu4) || nEdu4 == ""){nEdu4= 0;}
								
								nEdu4 = nEdu4 + nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[0].childNodes[0].nodeValue);
								
								this.ds_GrdBuyaEd.setColumn(bonRow, "BUYA_EDU4",nEdu4); 
							}
							
						}
					}
				}
			}
		}	
				
			
		
		//2020.01.15 교복비 추가
		if(nodeList[i].getAttribute("form_cd") == 'C301Y')   //교육비_교복비
		{trace('=== 교복비 ===');
			for ( var j = 0; j < nodeList[i].getElementsByTagName("man").length; j++ ) {
			   var nEdu3 = 0
				for ( var k = 0; k < nodeList[i].childNodes[j].getElementsByTagName("data").length; k++ ) {
					//부양가족으로 등록이 되어 있어야함
					if(this.ds_GrdBuya.findRow("BUYA_JUMI", nodeList[i].childNodes[j].getAttribute("resid")) >= 0){
						//동일 주민번호가 있는지 확인
						var bonRow  = this.ds_GrdBuyaEd.findRow("BUYA_JUMI", nodeList[i].childNodes[j].getAttribute("resid"));
						
						if( bonRow < 0)  //동일 주민번호가 없다
						{
							var bRow = this.ds_GrdBuyaEd.addRow();
							this.ds_GrdBuyaEd.setColumn(bRow, "COMP_CODE", this.fvCompCode );
							this.ds_GrdBuyaEd.setColumn(bRow, "BUYA_YEAR", this.fvJsmtYear );
							this.ds_GrdBuyaEd.setColumn(bRow, "SYST_ID", sSystId); //this.ds_Input.getColumn(0,"SRCH_EMST") );
							this.ds_GrdBuyaEd.setColumn(bRow, "BUYA_JUMI", nodeList[i].childNodes[j].getAttribute("resid") );
							this.ds_GrdBuyaEd.setColumn(bRow, "BUYA_EDGB", '2');   //교육비구분(PR124)_초중고로 자동 입력
							this.ds_GrdBuyaEd.setColumn(bRow, "BUYA_EDU3", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[0].childNodes[0].nodeValue ));   // 교복비 
						}
						else
						{	
							//this.ds_GrdBuyaEd.setColumn(bonRow, "BUYA_EDU3", nexacro.toNumber(this.ds_GrdBuyaEd.getColumn(bonRow, "BUYA_EDU3")) + nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[0].childNodes[0].nodeValue));
							
							nEdu3 = this.ds_GrdBuyaEd.getColumn(bonRow, "BUYA_EDU3");
							
							if(this.gfn_IsNull(nEdu3) || nEdu3 == ""){nEdu3 = 0;}
							
							nEdu3 = nEdu3 + nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[0].childNodes[0].nodeValue);
							this.ds_GrdBuyaEd.setColumn(bonRow, "BUYA_EDU3",  nEdu3);
							
						}
					}
				}
			}
		}
		
		
		if(nodeList[i].getAttribute("form_cd") == 'C401Y')   //학자금대출
		{trace('=== 학자금대출 ===');
			for ( var j = 0; j < nodeList[i].getElementsByTagName("man").length; j++ ) {
			   var nEdu5 = 0
				for ( var k = 0; k < nodeList[i].childNodes[j].getElementsByTagName("data").length; k++ ) {
					//부양가족으로 등록이 되어 있어야함
					if(this.ds_GrdBuya.findRow("BUYA_JUMI", nodeList[i].childNodes[j].getAttribute("resid")) >= 0){
						//동일 주민번호가 있는지 확인
						var bonRow  = this.ds_GrdBuyaEd.findRow("BUYA_JUMI", nodeList[i].childNodes[j].getAttribute("resid"));					
							
							
						
						if( bonRow < 0)  //동일 주민번호가 없다
						{
							var bRow = this.ds_GrdBuyaEd.addRow();
							this.ds_GrdBuyaEd.setColumn(bRow, "COMP_CODE", this.fvCompCode );
							this.ds_GrdBuyaEd.setColumn(bRow, "BUYA_YEAR", this.fvJsmtYear );
							this.ds_GrdBuyaEd.setColumn(bRow, "SYST_ID", sSystId); //this.ds_Input.getColumn(0,"SRCH_EMST") );
							this.ds_GrdBuyaEd.setColumn(bRow, "BUYA_JUMI", nodeList[i].childNodes[j].getAttribute("resid") );
							this.ds_GrdBuyaEd.setColumn(bRow, "BUYA_EDGB", '0');   //교육비구분(PR124)_초중고로 자동 입력
							this.ds_GrdBuyaEd.setColumn(bRow, "BUYA_EDU5", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[0].childNodes[0].nodeValue ));  							
							
						}
						else
						{	
							//this.ds_GrdBuyaEd.setColumn(bonRow, "BUYA_EDU3", nexacro.toNumber(this.ds_GrdBuyaEd.getColumn(bonRow, "BUYA_EDU3")) + nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[0].childNodes[0].nodeValue));
							
							nEdu5 = this.ds_GrdBuyaEd.getColumn(bonRow, "BUYA_EDU5");
							
							if(this.gfn_IsNull(nEdu5) || nEdu5 == ""){nEdu5 = 0;}
							
							nEdu5 = nEdu5 + nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[0].childNodes[0].nodeValue);						
							
							this.ds_GrdBuyaEd.setColumn(bonRow, "BUYA_EDU5",  nEdu5);
							
						}
					}
				}
			}
		}		
		
		
		if(nodeList[i].getAttribute("form_cd") == 'E103Y')   //연금저축(2021년 isa 추가)
		{trace('=== 연금저축 ===');
			for ( var j = 0; j < nodeList[i].getElementsByTagName("man").length; j++ ) {
				for ( var k = 0; k < nodeList[i].childNodes[j].getElementsByTagName("data").length; k++ ) {
					//세대주여야만 등록 가능					
					
					if(this.ds_GrdBuya.getColumn(this.ds_GrdBuya.findRow("BUYA_JUMI", nodeList[i].childNodes[j].getAttribute("resid")), "BUYA_SEID") == '1'){					
					
						//등록이 되어 있는 계좌번호 있는지 확인
						var bonRow  = this.ds_GrdSave.findRow("SAVE_BKAC", nodeList[i].childNodes[j].childNodes[k].getAttribute("acc_no"));
						
						
						if( bonRow < 0)  //동일 계좌번호 없다
						{
							var bRow = this.ds_GrdSave.addRow();
							
							this.ds_GrdSave.setColumn(bRow, "crudType", "I");		
							
							this.ds_GrdSave.setColumn(bRow, "COMP_CODE", this.fvCompCode );
							this.ds_GrdSave.setColumn(bRow, "SAVE_YEAR", this.fvJsmtYear );
							this.ds_GrdSave.setColumn(bRow, "SYST_ID", sSystId);
							this.ds_GrdSave.setColumn(bRow, "SAVE_SEQN", bRow);   //ds_grdSave.setColumn(bRow, "SAVE_SEQN", k + 1);
							this.ds_GrdSave.setColumn(bRow, "SAVE_GRUP", '2');   //연금저축구분(PR130)
							this.ds_GrdSave.setColumn(bRow, "SAVE_GUBN", "22"); //구분종료(PR128)
							this.ds_GrdSave.setColumn(bRow, "SAVE_STYE", '');   //가입년도
							var trade_name = nexacro.replaceAll(nodeList[i].childNodes[j].childNodes[k].getAttribute("trade_nm"), '（주）', '(주)');
							this.ds_GrdSave.setColumn(bRow, "SAVE_BKCD", this.ds_Pr129.lookup("CODM_CD", nodeList[i].childNodes[j].childNodes[k].childNodes[0].childNodes[0].nodeValue, "CODM_CD"));   //금융기관
							this.ds_GrdSave.setColumn(bRow, "SAVE_BKAC", nodeList[i].childNodes[j].childNodes[k].getAttribute("acc_no"));   //계좌번호
							this.ds_GrdSave.setColumn(bRow, "SAVE_PAYY", '');   //납입연차
							
							var v_SAVE_BAMT = nodeList[i].childNodes[j].childNodes[k].childNodes[3].childNodes[0].nodeValue;   // 순납입금액(ISA  순납입금액 포함)
							var v_ISA_BAMT = nodeList[i].childNodes[j].childNodes[k].childNodes[6].childNodes[0].nodeValue;    // ISA계좌 만기전환 순납입금액
							this.ds_GrdSave.setColumn(bRow, "SAVE_BAMT", nexacro.toNumber(v_SAVE_BAMT) - nexacro.toNumber(v_ISA_BAMT));   //불입금액 => ISA  순납입금액 포함
							
							this.ds_GrdSave.setColumn(bRow, "REGI_ID", "PDF");
							
							
							if(nexacro.toNumber(v_ISA_BAMT) > 0){
								var iRow = this.ds_GrdSave.addRow();
								this.ds_GrdSave.setColumn(iRow, "crudType", "I");
								this.ds_GrdSave.setColumn(iRow, "COMP_CODE", this.fvCompCode );
								this.ds_GrdSave.setColumn(iRow, "SAVE_YEAR", this.fvJsmtYear );
								this.ds_GrdSave.setColumn(iRow, "SYST_ID", sSystId);
								this.ds_GrdSave.setColumn(iRow, "SAVE_SEQN", iRow);
								this.ds_GrdSave.setColumn(iRow, "SAVE_GRUP", '7');   //연금저축구분(PR130)
								this.ds_GrdSave.setColumn(iRow, "SAVE_GUBN", "71"); //구분종료(PR128)
								
								this.ds_GrdSave.setColumn(iRow, "REGI_ID", "PDF");
								this.ds_GrdSave.setColumn(iRow, "SAVE_STYE", '');   //가입년도
								var trade_name = nexacro.replaceAll(nodeList[i].childNodes[j].childNodes[k].getAttribute("trade_nm"), '（주）', '(주)');
								this.ds_GrdSave.setColumn(iRow, "SAVE_BKCD", this.ds_Pr129.lookup("CODM_CD", nodeList[i].childNodes[j].childNodes[k].childNodes[0].childNodes[0].nodeValue, "CODM_CD"));   //금융기관
								this.ds_GrdSave.setColumn(iRow, "SAVE_BKAC", nodeList[i].childNodes[j].childNodes[k].getAttribute("acc_no"));   //계좌번호
								this.ds_GrdSave.setColumn(iRow, "SAVE_PAYY", '');   //납입연차			
								this.ds_GrdSave.setColumn(iRow, "SAVE_BAMT", nexacro.toNumber(v_ISA_BAMT));
							}
							
							
							
							//ds_grdSave.setColumn(bRow, "SAVE_BAMT", nodeList[i].childNodes[j].childNodes[k].childNodes[3].text);   //불입금액 
						}else{
							if(this.ds_GrdSave.getColumn(bonRow, "SAVE_GRUP") == '2')
							{
								//ds_grdSave.setColumn(bonRow, "SAVE_GRUP", '2');   //연금저축구분(PR130)
								//ds_grdSave.setColumn(bRow, "SAVE_GUBN", ds_PR128.LookUp("CODE_NAME", '연금저축', "CODE_CODE")); //구분종료(PR128)
								this.ds_GrdSave.setColumn(bonRow, "SAVE_GUBN", "22"); //구분종료(PR128)
								this.ds_GrdSave.setColumn(bonRow, "SAVE_STYE", '');   //가입년도											
								var trade_name = nexacro.replaceAll(nexacro.replaceAll(nodeList[i].childNodes[j].childNodes[k].getAttribute("trade_nm"), ' ', ''), '（주）', '(주)');
								//ds_grdSave.setColumn(bonRow, "SAVE_BKCD", ds_cdPR129.LookUp("CODE_NAME", trade_name, "CODE_CODE"));   //금융기관
								this.ds_GrdSave.setColumn(bRow, "SAVE_BKCD", this.ds_Pr129.lookup("CODM_CD", nodeList[i].childNodes[j].childNodes[k].childNodes[0].childNodes[0].nodeValue, "CODM_CD"));   //금융기관
								this.ds_GrdSave.setColumn(bonRow, "SAVE_BKAC", nodeList[i].childNodes[j].childNodes[k].getAttribute("acc_no"));   //계좌번호
								this.ds_GrdSave.setColumn(bonRow, "SAVE_PAYY", '');   //납입연차
								var v_SAVE_BAMT = nodeList[i].childNodes[j].childNodes[k].childNodes[3].childNodes[0].nodeValue;   // 순납입금액(ISA  순납입금액 포함)
								var v_ISA_BAMT = nodeList[i].childNodes[j].childNodes[k].childNodes[6].childNodes[0].nodeValue;    // ISA계좌 만기전환 순납입금액
								this.ds_GrdSave.setColumn(bonRow, "SAVE_BAMT", nexacro.toNumber(this.ds_GrdSave.getColumn(bonRow, "SAVE_BAMT")) + nexacro.toNumber(v_SAVE_BAMT) - nexacro.toNumber(v_ISA_BAMT));   //불입금액
							}else if(this.ds_GrdSave.getColumn(bonRow, "SAVE_GRUP") == '7') {  // ISA계좌 개인연금							
								this.ds_GrdSave.setColumn(bonRow, "SAVE_STYE", '');   //가입년도								
								var trade_name = replace(replace(nodeList[i].childNodes[j].childNodes[k].getAttribute("trade_nm"), ' ', ''), '（주）', '(주)');
								this.ds_GrdSave.setColumn(bRow, "SAVE_BKCD", this.ds_Pr129.lookup("CODM_CD", nodeList[i].childNodes[j].childNodes[k].childNodes[0].childNodes[0].nodeValue, "CODM_CD"));   //금융기관
								this.ds_GrdSave.setColumn(bonRow, "SAVE_BKAC", nodeList[i].childNodes[j].childNodes[k].getAttribute("acc_no"));   //계좌번호
								this.ds_GrdSave.setColumn(bonRow, "SAVE_PAYY", '');   //납입연차
								var v_ISA_BAMT = nodeList[i].childNodes[j].childNodes[k].childNodes[6].childNodes[0].nodeValue;    // ISA계좌 만기전환 순납입금액
								this.ds_GrdSave.setColumn(bonRow, "SAVE_BAMT", nexacro.toNumber(this.ds_GrdSave.getColumn(bonRow, "SAVE_BAMT")) + nexacro.toNumber(v_ISA_BAMT));   //불입금액
							}
 						}
					}
				}
			}
		}		
						
		//if(nodeList[i].getAttribute("form_cd") == 'F102Y')   //퇴직연금
		if(nodeList[i].getAttribute("form_cd") == 'F103Y')   //퇴직연금(2021년 isa 추가)
			{trace('=== 퇴직연금 ===');
			for ( var j = 0; j < nodeList[i].getElementsByTagName("man").length; j++ ) {
				for ( var k = 0; k < nodeList[i].childNodes[j].getElementsByTagName("data").length; k++ ) {
					//등록이 되어 있는 계좌번호 있는지 확인
					var bonRow  = this.ds_GrdSave.findRow("SAVE_BKAC", nodeList[i].childNodes[j].getAttribute("acc_no"));
					if( bonRow < 0){  //동일 계좌번호 없다					
						var bRow = this.ds_GrdSave.addRow();
						this.ds_GrdSave.setColumn(bRow, "crudType",  "I");
						this.ds_GrdSave.setColumn(bRow, "COMP_CODE", this.fvCompCode );
						this.ds_GrdSave.setColumn(bRow, "SAVE_YEAR", this.fvJsmtYear );
						this.ds_GrdSave.setColumn(bRow, "SYST_ID", sSystId);						
						this.ds_GrdSave.setColumn(bRow, "SAVE_SEQN", bRow);   //ds_grdSave.setColumn(bRow, "SAVE_SEQN", k + 1);
						this.ds_GrdSave.setColumn(bRow, "SAVE_GRUP", '1');   //연금저축구분(PR130)
						this.ds_GrdSave.setColumn(bRow, "SAVE_GUBN", nodeList[i].childNodes[j].childNodes[k].childNodes[1].childNodes[0].nodeValue);   //구분종료(PR128)
						this.ds_GrdSave.setColumn(bRow, "SAVE_STYE", '');   //가입년도
						var trade_name = nexacro.replaceAll(nexacro.replaceAll(nodeList[i].childNodes[j].childNodes[k].getAttribute("trade_nm"), ' ', ''), '（주）', '(주)');						
						this.ds_GrdSave.setColumn(bRow, "SAVE_BKCD", this.ds_Pr129.lookup("CODM_CD", nodeList[i].childNodes[j].childNodes[k].childNodes[0].childNodes[0].nodeValue, "CODM_CD"));   //금융기관
						this.ds_GrdSave.setColumn(bRow, "SAVE_BKAC", nodeList[i].childNodes[j].childNodes[k].getAttribute("acc_no"));   //계좌번호
						this.ds_GrdSave.setColumn(bRow, "SAVE_PAYY", '');   //납입연차
						
						var v_SAVE_BAMT = nodeList[i].childNodes[j].childNodes[k].childNodes[4].childNodes[0].nodeValue;   // 순납입금액(ISA  순납입금액 포함)
						var v_ISA_BAMT = nodeList[i].childNodes[j].childNodes[k].childNodes[7].childNodes[0].nodeValue;    // ISA계좌 만기전환 순납입금액
						this.ds_GrdSave.setColumn(bRow, "SAVE_BAMT", nexacro.toNumber(v_SAVE_BAMT) - nexacro.toNumber(v_ISA_BAMT));   //불입금액
						
						this.ds_GrdSave.setColumn(bRow, "REGI_ID", "PDF");						
						
						if(nexacro.toNumber(v_ISA_BAMT) > 0){
							var iRow = this.ds_GrdSave.addRow();
							this.ds_GrdSave.setColumn(iRow, "crudType",  "I");
							this.ds_GrdSave.setColumn(iRow, "COMP_CODE", this.fvCompCode );
							this.ds_GrdSave.setColumn(iRow, "SAVE_YEAR", this.fvJsmtYear );
							this.ds_GrdSave.setColumn(iRow, "SYST_ID", sSystId );
							this.ds_GrdSave.setColumn(iRow, "SAVE_SEQN", iRow);
							this.ds_GrdSave.setColumn(iRow, "SAVE_GRUP", '7');   //연금저축구분(PR130)
							this.ds_GrdSave.setColumn(iRow, "SAVE_GUBN", "72"); //구분종료(PR128)
							this.ds_GrdSave.setColumn(iRow, "SAVE_STYE", '');   //가입년도
							var trade_name = nexacro.replaceAll(nodeList[i].childNodes[j].childNodes[k].getAttribute("trade_nm"), '（주）', '(주)');
							this.ds_GrdSave.setColumn(iRow, "SAVE_BKCD", this.ds_Pr129.lookup("CODM_CD", nodeList[i].childNodes[j].childNodes[k].childNodes[0].childNodes[0].nodeValue, "CODM_CD"));   //금융기관
							this.ds_GrdSave.setColumn(iRow, "SAVE_BKAC", nodeList[i].childNodes[j].childNodes[k].getAttribute("acc_no"));   //계좌번호
							this.ds_GrdSave.setColumn(iRow, "SAVE_PAYY", '');   //납입연차			
							this.ds_GrdSave.setColumn(iRow, "SAVE_BAMT", nexacro.toNumber(v_ISA_BAMT));
							
							this.ds_GrdSave.setColumn(iRow, "REGI_ID", "PDF");
						}
						
					}else{
					
						if(this.ds_GrdSave.getColumn(bonRow, "SAVE_GRUP") == '1'){
	
							this.ds_GrdSave.setColumn(bonRow, "SAVE_GUBN", nodeList[i].childNodes[j].childNodes[k].childNodes[1].childNodes[0].nodeValue);   //구분종료(PR128)
							this.ds_GrdSave.setColumn(bonRow, "SAVE_STYE", '');   //가입년도
							var trade_name = nexacro.replaceAll(nexacro.replaceAll(nodeList[i].childNodes[j].childNodes[k].getAttribute("trade_nm"), ' ', ''), '（주）', '(주)');
							this.ds_GrdSave.setColumn(bRow, "SAVE_BKCD", this.ds_Pr129.lookup("CODM_CD", nodeList[i].childNodes[j].childNodes[k].childNodes[0].childNodes[0].nodeValue, "CODM_CD"));   //금융기관
							this.ds_GrdSave.setColumn(bonRow, "SAVE_BKAC", nodeList[i].childNodes[j].childNodes[k].getAttribute("acc_no"));   //계좌번호
							this.ds_GrdSave.setColumn(bonRow, "SAVE_PAYY", '');   //납입연차
							var v_SAVE_BAMT = nodeList[i].childNodes[j].childNodes[k].childNodes[4].childNodes[0].nodeValue;   // 순납입금액(ISA  순납입금액 포함)
							var v_ISA_BAMT = nodeList[i].childNodes[j].childNodes[k].childNodes[7].childNodes[0].nodeValue;    // ISA계좌 만기전환 순납입금액
							this.ds_GrdSave.setColumn(bonRow, "SAVE_BAMT", nexacro.toNumber(this.ds_GrdSave.getColumn(bonRow, "SAVE_BAMT")) + nexacro.toNumber(v_SAVE_BAMT) - nexacro.toNumber(v_ISA_BAMT));   //불입금액
		
						}else if(this.ds_GrdSave.getColumn(bonRow, "SAVE_GRUP") == '7')	{
							this.ds_GrdSave.setColumn(bonRow, "SAVE_STYE", '');   //가입년도								
							var trade_name = nexacro.replaceAll(nexacro.replaceAll(nodeList[i].childNodes[j].childNodes[k].getAttribute("trade_nm"), ' ', ''), '（주）', '(주)');
							this.ds_GrdSave.setColumn(bRow, "SAVE_BKCD", this.ds_Pr129.lookup("CODM_CD", nodeList[i].childNodes[j].childNodes[k].childNodes[0].childNodes[0].nodeValue, "CODM_CD"));   //금융기관
							this.ds_GrdSave.setColumn(bonRow, "SAVE_BKAC", nodeList[i].childNodes[j].childNodes[k].getAttribute("acc_no"));   //계좌번호
							this.ds_GrdSave.setColumn(bonRow, "SAVE_PAYY", '');   //납입연차
							var v_ISA_BAMT = nodeList[i].childNodes[j].childNodes[k].childNodes[7].childNodes[0].nodeValue;    // ISA계좌 만기전환 순납입금액
							this.ds_GrdSave.setColumn(bonRow, "SAVE_BAMT", nexacro.toNumber(this.ds_GrdSave.getColumn(bonRow, "SAVE_BAMT")) + nexacro.toNumber(v_ISA_BAMT));   //불입금액							
							
						}						
					}
				}
			}
		}

		if(nodeList[i].getAttribute("form_cd") == 'J101Y')   //주택임차차입금 원리금상환액
		{trace('=== 주택임차차입금 원리금상환액 ===');
			var v_JSBA_TG16 = 0;
			for ( var j = 0; j < nodeList[i].getElementsByTagName("man").length; j++ ) {
				for ( var k = 0; k < nodeList[i].childNodes[j].getElementsByTagName("data").length; k++ ) {
					v_JSBA_TG16 += nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[2].childNodes[0].nodeValue);   //상환액계
				}
			}
			this.ds_GrdJsba.setColumn(0, "JSBA_TG16", v_JSBA_TG16);			
		}
		
		 
		
		if(nodeList[i].getAttribute("form_cd") == 'J301Y')   //주택마련저축
			{trace('=== 주택마련저축 ===');			
			
			for ( var j = 0; j < nodeList[i].getElementsByTagName("man").length; j++ ) {					
				for ( var k = 0; k < nodeList[i].childNodes[j].getElementsByTagName("data").length; k++ ) {
				
					//세대주여야만 등록 가능
					if(this.ds_GrdBuya.getColumn(this.ds_GrdBuya.findRow("BUYA_JUMI", nodeList[i].childNodes[j].getAttribute("resid")), "BUYA_SEID") == '1'){					
						//등록이 되어 있는 계좌번호 있는지 확인
						var bonRow  = this.ds_GrdSave.findRow("SAVE_BKAC", nodeList[i].childNodes[j].childNodes[k].getAttribute("acc_no"));
						
						if( bonRow < 0){  //동일 계좌번호 없다						
							var bRow = this.ds_GrdSave.addRow();
							
							this.ds_GrdSave.setColumn(bRow, "crudType", "I");
							
							this.ds_GrdSave.setColumn(bRow, "COMP_CODE", this.fvCompCode );
							this.ds_GrdSave.setColumn(bRow, "SAVE_YEAR", this.fvJsmtYear );
							this.ds_GrdSave.setColumn(bRow, "SYST_ID", sSystId);
							this.ds_GrdSave.setColumn(bRow, "SAVE_SEQN", k + 1);
							this.ds_GrdSave.setColumn(bRow, "SAVE_GRUP", '3');   //연금저축구분(PR130) 주택마련저축 									
							this.ds_GrdSave.setColumn(bRow, "SAVE_GUBN", this.ds_Pr128.lookup("CODM_NM", nodeList[i].childNodes[j].childNodes[k].childNodes[0].childNodes[0].nodeValue, "OP01_NM"));   //구분종료(PR128)-작업대상													
													
							
							if(nodeList[i].childNodes[j].childNodes[k].childNodes[1].childNodes[0].nodeValue == "2") {
								this.ds_GrdSave.setColumn(bRow, "SAVE_GUBN", "32");   //구분종료(PR128) 주택청약종합저축
								this.ds_GrdSave.setColumn(bRow, "SAVE_STYE", nodeList[i].childNodes[j].childNodes[k].childNodes[2].childNodes[0].nodeValue.substr(0, 4));   //가입년도
							}else{
								this.ds_GrdSave.setColumn(bRow, "SAVE_GUBN", "31");   //구분종료(PR128) 청약저축
								this.ds_GrdSave.setColumn(bRow, "SAVE_STYE", '');   //가입년도
							}
							var trade_name = nexacro.replaceAll(nodeList[i].childNodes[j].childNodes[k].getAttribute("trade_nm"), '（주）', '(주)');							
							this.ds_GrdSave.setColumn(bRow, "SAVE_BKCD",  this.ds_Pr129.lookup("CODM_CD", nodeList[i].childNodes[j].childNodes[k].childNodes[3].childNodes[0].nodeValue, "CODM_CD"));   //금융기관-작업대상
							
							this.ds_GrdSave.setColumn(bRow, "SAVE_BKAC", nodeList[i].childNodes[j].childNodes[k].getAttribute("acc_no"));   //계좌번호
							this.ds_GrdSave.setColumn(bRow, "SAVE_PAYY", '');   //납입연차
							this.ds_GrdSave.setColumn(bRow, "SAVE_BAMT", nodeList[i].childNodes[j].childNodes[k].childNodes[4].childNodes[0].nodeValue);   //불입금액								
							
							
							this.ds_GrdSave.setColumn(bRow, "REGI_ID", "PDF");
							
						}else{
						
							this.ds_GrdSave.setColumn(bonRow, "SAVE_GRUP", '3');   //연금저축구분(PR130)
							this.ds_GrdSave.setColumn(bonRow, "SAVE_GUBN", this.ds_Pr128.lookup("CODM_NM", nodeList[i].childNodes[j].childNodes[k].childNodes[0].childNodes[0].nodeValue, "OP01_NM"));   //구분종료(PR128)-작업대상
							
							if(nodeList[i].childNodes[j].childNodes[k].childNodes[1].childNodes[0].nodeValue == "2"){							
								this.ds_GrdSave.setColumn(bRow, "SAVE_GUBN", "32");   //구분종료(PR128) 주택청약종합저축
								this.ds_GrdSave.setColumn(bRow, "SAVE_STYE", nodeList[i].childNodes[j].childNodes[k].childNodes[2].childNodes[0].nodeValue.substr(0, 4));   //가입년도
							}else{
								this.ds_GrdSave.setColumn(bRow, "SAVE_STYE", '');   //가입년도								
							}
							var trade_name = nexacro.replaceAll(nexacro.replaceAll(nodeList[i].childNodes[j].childNodes[k].getAttribute("trade_nm"), ' ', ''), '（주）', '(주)');							
							this.ds_GrdSave.setColumn(bonRow, "SAVE_BKCD", this.ds_Pr129.lookup("CODM_CD", nodeList[i].childNodes[j].childNodes[k].childNodes[3].childNodes[0].nodeValue, "CODM_CD"));   //금융기관-작업대상
							this.ds_GrdSave.setColumn(bonRow, "SAVE_BKAC", nodeList[i].childNodes[j].childNodes[k].getAttribute("acc_no"));   //계좌번호
							this.ds_GrdSave.setColumn(bonRow, "SAVE_PAYY", '');   //납입연차
							this.ds_GrdSave.setColumn(bonRow, "SAVE_BAMT", nexacro.toNumber(this.ds_GrdSave.getColumn(bonRow, "SAVE_BAMT")) + nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[4].childNodes[0].nodeValue));   //불입금액
						}
					}
				}
			}
		}
		
		if(nodeList[i].getAttribute("form_cd") == 'J501Y')   //월세(2020년 추가)
		{trace('=== 월세액 ===');
			var rent_amt = 0;
			for ( var j = 0; j < nodeList[i].getElementsByTagName("man").length; j++ ) 
			{
				for ( var k = 0; k < nodeList[i].childNodes[j].getElementsByTagName("data").length; k++ ) 
				{
					var bRow = this.ds_GrdRent.addRow();
					
					this.ds_GrdRent.setColumn(bRow, "COMP_CODE", this.fvCompCode );
					this.ds_GrdRent.setColumn(bRow, "RENT_YEAR", this.fvJsmtYear );
					this.ds_GrdRent.setColumn(bRow, "SYST_ID", sSystId );
					
					this.ds_GrdRent.setColumn(bRow, "RENT_NAME", nodeList[i].childNodes[j].childNodes[k].getAttribute("lsor_nm"));   // 임채인성명
					this.ds_GrdRent.setColumn(bRow, "RENT_JUMI", nodeList[i].childNodes[j].childNodes[k].getAttribute("lsor_no"));   // 임대인주민등록번호
					this.ds_GrdRent.setColumn(bRow, "RENT_ADDR", nodeList[i].childNodes[j].childNodes[k].childNodes[2].childNodes[0].nodeValue);   // 임대차 주소지					
					var rent_type = "";
					if (!this.gfn_IsNull(nodeList[i].childNodes[j].childNodes[k].childNodes[4].childNodes[0].nodeValue)) {
						rent_type = nexacro.replaceAll(nodeList[i].childNodes[j].childNodes[k].childNodes[4].childNodes[0].nodeValue, '0', '');
					}					
					this.ds_GrdRent.setColumn(bRow, "RENT_WTYP", rent_type);   // 월세_주택유형(PR143)
					this.ds_GrdRent.setColumn(bRow, "RENT_WARE", nodeList[i].childNodes[j].childNodes[k].childNodes[3].childNodes[0].nodeValue);   // 월세_주택계약면적
					this.ds_GrdRent.setColumn(bRow, "RENT_FDAY", nodeList[i].childNodes[j].childNodes[k].childNodes[0].childNodes[0].nodeValue);   // 임대차 시작계약기간
					this.ds_GrdRent.setColumn(bRow, "RENT_TDAY", nodeList[i].childNodes[j].childNodes[k].childNodes[1].childNodes[0].nodeValue);   // 임대차 종료계약기간
					this.ds_GrdRent.setColumn(bRow, "RENT_AMOT", nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[5].childNodes[0].nodeValue));   // 월세액
					rent_amt = rent_amt + nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[5].childNodes[0].nodeValue);
					
					this.ds_GrdRent.setColumn(bRow, "crudType", "I" );
					this.ds_GrdRent.setColumn(bRow, "REGI_ID",  "PDF" );				
					
				}
			}
			
			//주택자금 탭에 월세액 입력 필수			
			var rent_amt =  nexacro.toNumber(this.ds_GrdRent.getCaseSum("crudType != 'D'", "RENT_AMOT"));			
			
			this.ds_GrdJsba.setColumn(0, "JSBA_TG46", rent_amt);
		}		
		
		//this.alert(nodeList[i].getAttribute("form_cd"));
		this.ds_GrdGibu.set_enableevent(false);
		if(nodeList[i].getAttribute("form_cd") == 'L102Y'){   //기부금			
			trace('=== 기부금 ===');
			for ( var j = 0; j < nodeList[i].getElementsByTagName("man").length; j++ ) {
			    var nGibuAmt = 0;
				var sRela;
				
				for ( var k = 0; k < nodeList[i].childNodes[j].getElementsByTagName("data").length; k++ ) {
					//부양가족으로 등록이 되어 있어야함
					if(this.ds_GrdBuya.findRow("BUYA_JUMI", nodeList[i].childNodes[j].getAttribute("resid")) >= 0){					
						var gRow = this.ds_GrdGibu.addRow();						
						
						this.ds_GrdGibu.setColumn(gRow, "crudType", "I" ); 						
						this.ds_GrdGibu.setColumn(gRow, "COMP_CODE", this.fvCompCode );        //회사코드
						this.ds_GrdGibu.setColumn(gRow, "GIBU_YEAR", this.fvJsmtYear );        //년도
						this.ds_GrdGibu.setColumn(gRow, "SYST_ID", sSystId); //this.ds_Input.getColumn(0,"SRCH_EMST") );       //시스템사번
						this.ds_GrdGibu.setColumn(gRow, "GIBU_SERL", (j+1).toString().padLeft(2, "0"));       //일련번호
						this.ds_GrdGibu.setColumn(gRow, "GIBU_JUMI", nodeList[i].childNodes[j].getAttribute("resid"));   //주민번호
						this.ds_GrdGibu.setColumn(gRow, "GIBU_NAME", this.ds_GrdBuya.lookup("BUYA_JUMI", nodeList[i].childNodes[j].getAttribute("resid"), "BUYA_NAME"));  //성명
						
						this.ds_GrdGibu.setColumn(gRow, "GIBU_NOTE", '1');   //기부내용 - 금전(pr135)
						this.ds_GrdGibu.setColumn(gRow, "GIBU_CODE", nodeList[i].childNodes[j].childNodes[k].getAttribute("donation_cd") );   //유형코드(PR28)
						this.ds_GrdGibu.setColumn(gRow, "GIBU_COMP", nodeList[i].childNodes[j].childNodes[k].getAttribute("busnid") );   //사업자등록번호
						this.ds_GrdGibu.setColumn(gRow, "GIBU_COMM", nodeList[i].childNodes[j].childNodes[k].getAttribute("trade_nm") );   //상호	
						this.ds_GrdGibu.setColumn(gRow, "GIBU_GUNS", '1');	//건수		
						nGibuAmt = nexacro.toNumber(nodeList[i].childNodes[j].childNodes[k].childNodes[2].childNodes[0].nodeValue );								
						this.ds_GrdGibu.setColumn(gRow, "GIBU_GAMT", nGibuAmt );   //기부금액_20110701이후						
						//this.ds_GrdGibu.setColumn(gRow, "GIBU_RELA", this.ds_Pr125.lookup("CODM_CD", this.ds_GrdBuya.lookup("BUYA_JUMI", nodeList[i].childNodes[j].getAttribute("resid"), "BUYA_RELA"), "OP01_NM"));  //관계-작업대상						
						sRela = this.ds_GrdBuya.lookup("BUYA_JUMI", nodeList[i].childNodes[j].getAttribute("resid"), "BUYA_RELA");
						this.ds_GrdGibu.setColumn(gRow, "GIBU_RELA", this.ds_Pr125.lookup("CODM_CD",  sRela, "OP01_NM"));  //관계
						
						this.ds_GrdGibu.setColumn(gRow, "GIBU_GUBN", '0' );   //기부금 자료 구분(0: 국세청, 1:기타)
						//trace('=== 기부금액 = '+nodeList[i].childNodes[j].childNodes[k].childNodes[2].childNodes[0].nodeValue);
						this.ds_GrdGibu.setColumn(gRow, "REGI_ID", "PDF");							
					}
				}
			}
			//--기부금 이월내역
			this.fn_GibuSebu();				
		}
		this.ds_GrdGibu.set_enableevent(true);
		
		//--2022년 추가
		
		if(nodeList[i].getAttribute("form_cd") == 'R101M'){   //장애인증명자료
			trace('=== 장애인증명자료 ===');
			for ( var j = 0; j < nodeList[i].getElementsByTagName("man").length; j++ ) {
			    var nGibuAmt = 0;
				var sRela;
				var nRow = 0;
				
				for ( var k = 0; k < nodeList[i].childNodes[j].getElementsByTagName("data").length; k++ ) {
					//부양가족으로 등록이 되어 있어야함
					nRow = this.ds_GrdBuya.findRow("BUYA_JUMI", nodeList[i].childNodes[j].getAttribute("resid"));
					
					if(nRow >= 0){						
						this.ds_GrdBuya.setColumn(nRow, "BUYA_JANG", nodeList[i].childNodes[j].childNodes[k].getAttribute("pwd_cd"));						
					}
				}
			}
			//--기부금 이월내역
			this.fn_GibuSebu();				
		}
		
	}

}


/***********************************************************************************************
 * 15.08. [공통 그리드 버튼] 입력 버튼 설정
 ***********************************************************************************************/ 
this.fn_SetGridInputButton = function()
{
	//그리드 공통 버튼 권한이 있으면
	if (this.fvFormComBtnAuthYn)
	{
		this.gfn_SetGridInputBtnUrl(this.div_MasterView.form.div_ComGrdBtn);//[공통] 그리드 입력 버튼 URL 설정
		
		//상세 그리드버튼 설정 : 버튼ID|권한(Y/N)|호출함수명
		var objBtnInfo01List = ["COPY|N|fn_MasterGrd01Copy"
							 ,"ADD|Y|fn_MasterGrd01AddRow"
							 ,"INSERT|N|fn_MasterGrd01InsertRow"
							 ,"DELETE|Y|fn_MasterGrd01DeleteRow"
							 ,"CANCEL|Y|fn_MasterGrd01Cancel"];
		this.div_MasterView.form.div_ComGrdBtn.form.fn_SetGrdButtonFunc(this, objBtnInfo01List);	
		
		this.gfn_SetGridInputBtnUrl(this.div_MasterView.form.tab_Master.tpg_06.form.div_Gibu.form.div_ComGrdBtn);//[공통] 그리드 입력 버튼 URL 설정
		
		//상세 그리드버튼 설정 : 버튼ID|권한(Y/N)|호출함수명
		var objBtnInfo01List = ["COPY|N|fn_DetailGrd01Copy"
							 ,"ADD|Y|fn_DetailGrd01AddRow"
							 ,"INSERT|N|fn_DetailGrd01InsertRow"
							 ,"DELETE|Y|fn_DetailGrd01DeleteRow"
							 ,"CANCEL|Y|fn_DetailGrd01Cancel"];
		//기부상세는 우선 비활성 처리 (자동으로 데이터 넣어지고 있음)
		//this.div_MasterView.form.tab_Master.tpg_06.form.div_Gibu.form.div_ComGrdBtn.form.fn_SetGrdButtonFunc(this, objBtnInfo01List);	
	}
}

/***********************************************************************************************
 * 15.09. [공통 그리드 버튼] 입력 버튼 설정(활성 / 비활성)
 ***********************************************************************************************/ 
this.fn_SetGridInputButtonEnable= function()
{
	//그리드 공통 버튼 권한이 있으면
	if (this.fvFormComBtnAuthYn)
	{
		var objBtnInfo01List = [];
		
		//입력영역 버튼 비활성화
		objBtnInfo01List = ["COPY|N", "ADD|N", "INSERT|N", "DELETE|Y", "CANCEL|N"];
		
		if (this.div_DetailInput.form.tab_Detail.tabindex == 0) {
			this.div_DetailInput.form.div_ComGrdBtn.form.fn_SetGrdButtonEnable(objBtnInfo01List);
		}
	}
}

/***********************************************************************************************
 * 15.10 [연말정산] 데이터 변경여부 체크
 ***********************************************************************************************/ 
this.fn_DsIsUpdated  = function(){
	//데이터 변경여부 체크
	
	if (this.gfn_DsIsUpdated(this.ds_GrdBuya) 	||	// 부양가족
		this.gfn_DsIsUpdated(this.ds_GrdBuyaBo) ||  // 부양가족(보험료)
		this.gfn_DsIsUpdated(this.ds_GrdBuyaEd) ||  // 부양가족(교육비)
		this.gfn_DsIsUpdated(this.ds_GrdBuyaCa) ||  // 부양가족(신용카드)
		this.gfn_DsIsUpdated(this.ds_GrdHspt) 	||  // 의료비
		this.gfn_DsIsUpdated(this.ds_GrdGibu) 	||  // 기부금
		this.gfn_DsIsUpdated(this.ds_GrdGbch) 	||  // 기부금조정
		this.gfn_DsIsUpdated(this.ds_GrdSave) 	||  // 연금저축
		this.gfn_DsIsUpdated(this.ds_GrdJsjo) 	||  // 종근무지소득
		this.gfn_DsIsUpdated(this.ds_GrdJsmt) 	||  // 연말정산
		this.gfn_DsIsUpdated(this.ds_GrdJsba) 	||  
		this.gfn_DsIsUpdated(this.ds_GrdRent)){     // 월세.임차	
		
		return true;
	}	
	
	return false;
	
}

/***********************************************************************************************
 * 15.11. [연말정산 계산 버튼] 계산 버튼 설정
 ***********************************************************************************************/ 
this.div_MasterInput_btn_JstmM1_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	//연말정산 체크 함수 호출
	this.fn_Jstm01_compute();
}

this.fn_Jstm01_compute = function()
{
	var grdBuyaRow;
	
	//데이터 변경여부 체크
	if (this.fn_DsIsUpdated()) {
		
		this.gfn_Alert("SM002", "");//변경된 내용이 있습니다.\n저장 후 작업하시기 바랍니다.
		return false;
	}
	
	//연말정산 마감체크
	//if(this.fn_Jstg01_compute(this.div_Search.form.spn_JstaYear.value, true, false)){ 사용자 마감 체크안함
	if(this.fn_Jstg01_compute(this.div_Search.form.spn_JstaYear.value, true, true)){ 
		return false;
	}
	 
	
	trace("제출여부" + this.ds_GrdJsba.getColumn(0,"JSBA_FINS"));
	//제출 완료 체크
	if(this.ds_GrdJsba.getColumn(0,"JSBA_FINS")	 =="1"){
		this.gfn_Alert("HR101", "");	// 제출이 완료되었으므로 수정 및 계산작업을 할 수 없습니다.
		return false;
	}
	
	
	//중도정산 체크
	if(this.ds_GrdJsmt.getColumn(0,"GUBN_NAME")=="중도정산")
	{
		this.gfn_Alert("HR102", "");	// 중도정산 계산자입니다. 연말정산계산 화면을 이용하세요.
		return false;
	}

	//자녀가 없는데 한부모 체크 되어 있으면 에러
	if(this.ds_SaveBuya.getCaseCount(" BUYA_HANB=='1'") > 0 && this.ds_SaveBuya.getCaseCount("BUYA_RELA!='7' && BUYA_RELA!='8' && BUYA_MCHD=='1' && BUYA_GIBO=='1'") < 1)
	{
		this.gfn_Alert("HR103", "");	// 한부모공제 대상자가 아닙니다. 체크 해제 후 계산 바랍니다.
		return false;
	}
	
	trace("년도 -->" + this.ds_UserInfo.getColumn(0,"ENTR_YY"));
	
	// 해당년도에 입사한 경우에만 전근무지 내역 여부 체크
    if (this.ds_UserInfo.getColumn(0,"ENTR_YY") == this.fvJsmtYear)
    {	
		trace("올해입사");
		trace(this.ds_GrdJsjo.rowcount);
		//입사일이 귀속연도와 같고 종전근무지 데이터를 미입력한 경우 체크
        if (this.ds_GrdJsjo.rowcount == 0)
        {
			this.gfn_Confirm("HR104", "", "CONF.JSTM02", "fn_MsgCallback");//종전근무지 내역이 없습니다.\n\n연말정산 계산을 하시겠습니까?
	    }else{
			//종전근무지가 있고 내역이 있으면 다음체크
			this.fn_Jstm02_compute();
		}
    }else{
		//종전근무지 내역이 없으면 다음체크
		this.fn_Jstm02_compute();
	}
	
	
}


/***********************************************************************************************
 * 15.12. 
 ***********************************************************************************************/ 
this.fn_Jstm02_compute = function()
{
	trace("교육비 카운트-->"+ this.ds_GrdBuya.rowcount);
	//본인의 교육비 선택시 교육비구분은 본인으로 필수 선택 될 수 있도록 추가 
	
	for (var i=0; i<this.ds_GrdBuya.rowcount; i++)  
	{
	trace(i);
		if(this.ds_GrdBuyaEd.rowcount>0){
			iBuyaRow = this.ds_GrdBuya.findRow("BUYA_JUMI",this.ds_GrdBuyaEd.getColumn(i,"BUYA_JUMI"));
			if (this.ds_GrdBuya.getColumn(iBuyaRow, "BUYA_RELA") == "0"){  //본인이면서
				if (this.ds_GrdBuyaEd.getColumn(i,"BUYA_EDGB") != '0' ){ //교육비구분이 본인이 아니면
					this.gfn_Alert("HR105", "");	// 본인의 교육비구분은 본인으로 선택 되어야 합니다.
					this.div_MasterView.form.tab_Master.set_tabindex(2);
					return false;
				}
			}	
		}
	}
	
	//월세액 체크
	if (this.ds_GrdJsba.getColumn(0,"JSBA_TG46") > 0){
		if (this.ds_GrdRent.getCaseSum("crudType != 'D'", "RENT_AMOT") == 0){
			this.gfn_Alert("HR106", "");	// 주택자금 월세액 소득공제를 받는 근로자는 [월세/주택임차] 탭에 월세액 소득공제란을 입력하세요.
			return false;
		}
	}
	
	//주택임차차입금 체크
	if (this.ds_GrdJsba.getColumn(0,"JSBA_TG50") > 0){
		if (this.ds_GrdRent.getCaseSum("crudType != 'D'", "RENT_WONA") == 0){
			this.gfn_Alert("HR107", ""); // 거주자간 주택임차차입금 원리금상환공제를 받는 근로자는 [월세/주택임차] 탭에 거주자간 주택임차차입금 원리금상환공제란을 입력하세요.
			return false;
		}
	}
	
	//주택자금 월세액 금액 체크
	if (this.ds_GrdJsba.getColumn(0,"JSBA_TG46") > 0){
		if (nexacro.toNumber(this.ds_GrdJsba.getColumn(0,"JSBA_TG46")) != nexacro.toNumber(this.ds_GrdRent.getCaseSum("crudType != 'D'", "RENT_AMOT"))){
			this.gfn_Alert("HR108", ""); // 주택자금 월세액 금액과 [월세/주택임차] 탭에 월세액 합계 금액이 일치해야합니다.
			return false;
		}
	}
	
	//정산진행 여부
	this.gfn_Confirm("HR109", "", "CONF.JSTM03", "fn_MsgCallback");//정산계산을 하시겠습니까?
	
	
	
	/****************************************************************************  
	정상 정보를 팝업(레이어)에 표시 후 정산여부 진행여부 확인 필요
	
	var sMsg =   " - " + img_srchYear.Text + " : " + this.fvJsmtYear
		     + "\n - " + img_EmstNumb.Text + " : " + ds_srchEmst.getColumn(0, "EMST_NUMB") + " " + ds_srchEmst.getColumn(0, "EMST_NAME");
	
	
	// 정산계산을 하시겠습니까?
	if (gfn_GetMessage("HR148","&ITM1",sMsg) == false) return;
	
	*/
}

/***********************************************************************************************
 * 15.13. 정산 실행
 ***********************************************************************************************/ 
this.fn_Jstm03_compute = function()
{
	
	trace("정산구분값-->"+ this.div_Search.form.rdo_Gube.value);
	// 계산방식 - 자동
	if (this.div_Search.form.rdo_Gube.value == "1")
	{
		//[업무] 데이터셋 설정 - 데이터셋 초기화, 조회조건 설정
		this.ds_Input.clearData();
		
		this.ds_Input.addRow();
		this.ds_Input.setColumn(0, "PROC_GUBN"	, "MAKE");	
		this.ds_Input.setColumn(0, "BUYA_YEAR"	, this.div_Search.form.spn_JstaYear.value);		// 귀속년도
		this.ds_Input.setColumn(0, "SESU_ID"	, this.div_Search.form.edt_SystId.value);		// 사번
		this.ds_Input.setColumn(0, "GUBN"		, "2");											// 정산구분(1중도, 2연말)
		//this.ds_Input.setColumn(0, "BOHUMYN"	, this.div_Search.form.chk_BohuYn.value);		// 표준세액공제 적용 
		this.ds_Input.setColumn(0, "BOHUMYN"	, '1');											// 표준세액공제 적용 (체크하고 돌림)
		this.ds_Input.setColumn(0, "AUTOYN"		, "1");											// 자동,수동 선택값
		
				
		//[공통]서비스정보 초기화
		this.gfn_InitComService(this);
		
		//[공통]서비스정보 추가
		var svcAddObj = new Object();//[공통] 서비스 추가 파라메타 정보 Object
		svcAddObj.sSelectSql = "hr:M_HS_8390_M_IN00";
		this.gfn_AddComSearchService(this, svcAddObj);
		
		
		//[공통]서비스 호출 변수
		var svcCallObj = new Object();//[공통] 서비스 파라메타 정보 Object
		svcCallObj.sActionName = this.G_SV_HR;//서버에서 호출할 Action - 모듈별로 호출되는 기본 Actio이 다름 : 공통 서비스 Action 업무구분  변수 참조
		svcCallObj.sInputDaset = "ds_Input=ds_Input" //입력 데이터셋
		svcCallObj.sOutDatset = "ds_Rst=ds_Rst";//출력 데이터셋
		svcCallObj.sOtherArg = "";//서버로 전송할 기타 Argument 정보 문자열, 예) key=value key2=value2
		svcCallObj.isSync = true;//동기식으로 설정할지 여부  (동기 true, 비동기 false)	
		//[공통]서비스 호출
		this.gfn_CallComService(this, svcCallObj);		
		
		
		this.ds_Input.setColumn(0, "BOHUMYN"	, '0');		// 표준세액공제 적용 (해제하고 돌림)
		
		//[공통]서비스 호출 변수
		var svcCallObj = new Object();//[공통] 서비스 파라메타 정보 Object
		svcCallObj.sTrid = "MST_COMPUTE";//Transaction ID 등 callback에서 넘겨 받을 String을 지정
		svcCallObj.sActionName = this.G_SV_HR;//서버에서 호출할 Action - 모듈별로 호출되는 기본 Actio이 다름 : 공통 서비스 Action 업무구분  변수 참조
		svcCallObj.sInputDaset = "ds_Input=ds_Input" //입력 데이터셋
		svcCallObj.sOutDatset = "ds_Rst=ds_Rst";//출력 데이터셋
		svcCallObj.sOtherArg = "";//서버로 전송할 기타 Argument 정보 문자열, 예) key=value key2=value2
		svcCallObj.sCallBackFnc = "fn_Callback";//서버에서 처리가 완료된 후 Callback 받을 Function 명

		//[공통]서비스 호출
		this.gfn_CallComService(this, svcCallObj);		
	//수동
	}else{
		//[업무] 데이터셋 설정 - 데이터셋 초기화, 조회조건 설정
		this.ds_Input.clearData();
		
		this.ds_Input.addRow();
		this.ds_Input.setColumn(0, "BUYA_YEAR"	, this.div_Search.form.spn_JstaYear.value);		// 귀속년도
		this.ds_Input.setColumn(0, "SESU_ID"	, this.div_Search.form.edt_SystId.value);		// 사번
		this.ds_Input.setColumn(0, "GUBN"		, "2");											// 정산구분(1중도, 2연말)
		this.ds_Input.setColumn(0, "BOHUMYN"	, this.div_Search.form.chk_BohuYn.value);		// 표준세액공제 적용 
		this.ds_Input.setColumn(0, "AUTOYN"		, "0");											// 자동,수동 선택값
		
				
		//[공통]서비스정보 초기화
		this.gfn_InitComService(this);
		
		//[공통]서비스정보 추가
		var svcAddObj = new Object();//[공통] 서비스 추가 파라메타 정보 Object
		svcAddObj.sSelectSql = "hr:M_HS_8390_M_IN00";
		this.gfn_AddComSearchService(this, svcAddObj);
		
		//[공통]서비스 호출 변수
		var svcCallObj = new Object();//[공통] 서비스 파라메타 정보 Object
		svcCallObj.sTrid = "MST_COMPUTE";//Transaction ID 등 callback에서 넘겨 받을 String을 지정
		svcCallObj.sActionName = this.G_SV_HR;//서버에서 호출할 Action - 모듈별로 호출되는 기본 Actio이 다름 : 공통 서비스 Action 업무구분  변수 참조
		svcCallObj.sInputDaset = "ds_Input=ds_Input" //입력 데이터셋
		svcCallObj.sOutDatset = "ds_Rst=ds_Rst";//출력 데이터셋
		svcCallObj.sOtherArg = "";//서버로 전송할 기타 Argument 정보 문자열, 예) key=value key2=value2
		svcCallObj.sCallBackFnc = "fn_Callback";//서버에서 처리가 완료된 후 Callback 받을 Function 명

		//[공통]서비스 호출
		this.gfn_CallComService(this, svcCallObj);		
	}
}
	

/***********************************************************************************************
 * 15.14. [연말정산 제출 버튼] 제출 버튼 설정
 ***********************************************************************************************/ 
this.div_MasterInput_btn_CorhM2_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	
	//데이터 조회여부 체크
	if(this.ds_GrdBuya.rowcount == 0){
		this.gfn_Alert("SM038", "");//조회된 데이터가 없습니다.\n우선 데이터를 조회하세요.
		return false;
	}
	
	//데이터 변경여부 체크
	if (this.fn_DsIsUpdated()) {
		
		this.gfn_Alert("SM002", "");//변경된 내용이 있습니다.\n저장 후 작업하시기 바랍니다.
		return false;
	}
	
	//연말정산 마감체크
	//if(this.fn_Jstg01_compute(this.div_Search.form.spn_JstaYear.value, true, false)){ 사용자 마감 체크안함
	if(this.fn_Jstg01_compute(this.div_Search.form.spn_JstaYear.value, true, true)){ 
		return false;
	}
	
	
	trace("제출여부" + this.ds_GrdJsba.getColumn(0,"JSBA_FINS"));
	//제출 완료 체크
	if(this.ds_GrdJsba.getColumn(0,"JSBA_FINS")	 =="1"){
		this.gfn_Alert("HR200", "");	// 이미 제출이 되었습니다.
		return false;
	}
	
	//연말계산 체크
	if(this.ds_GrdJsba.getColumn(0,"JSBA_CHNG")	 =="Y"){
		this.gfn_Alert("HR201", "");	// 연말정산 계산 후 제출 바랍니다.
		return false;
	}
	
	//월세액 체크
	if (this.ds_GrdJsba.getColumn(0,"JSBA_TG46") > 0){
		if (this.ds_GrdRent.getCaseSum("crudType != 'D'", "RENT_AMOT") == 0){
			this.div_MasterView.form.tab_Master.set_tabindex(8);
			this.gfn_Alert("HR106", "");	// 주택자금 월세액 소득공제를 받는 근로자는 [월세/주택임차] 탭에 월세액 소득공제란을 입력하세요.
			return false;
		}
		
		if (this.ds_GrdJsba.getColumn(0, "JSBA_TG46") != this.ds_GrdRent.getCaseSum("crudType != 'D'", "RENT_AMOT")){
			this.div_MasterView.form.tab_Master.set_tabindex(8);
			this.gfn_Alert("HR202", "");	// 월세액 확인 바랍니다.
			return false;
		}
		
		for (var i=0; i<this.ds_GrdRent.rowcount; i++)
		{
			//임대인성명 있어야함
			if (this.gfn_IsNull(this.ds_GrdRent.getColumn(i,"RENT_NAME"))){
				this.div_MasterView.form.tab_Master.set_tabindex(8);
				this.gfn_Alert("HR203", "");	// 임대인성명을 입력하셔야 합니다.
				return false;
			}else{
				if (this.ds_GrdRent.getColumn(i, "RENT_NAME") == this.ds_GrdJsba.getColumn(0, "EMPM_NM")){
					this.div_MasterView.form.tab_Master.set_tabindex(8);
					this.gfn_Alert("HR204", "");	// 근로자 본인이름입니다. 임대인성명을 입력하세요.
					return false;
				}
			}
			
			//주민번호
			if (this.gfn_IsNull(this.ds_GrdRent.getColumn(i,"RENT_JUMI"))){
				this.div_MasterView.form.tab_Master.set_tabindex(8);
				this.gfn_Alert("HR205", "");	// 임대인주민등록번호 또는 사업자등록번호를 입력하셔야 합니다.
				return false;
			}else{
				/*
				if (this.ds_GrdRent.getColumn(i,"RENT_JUMI") ==  this.gfn_GetSessionValue("EMST_JUMI")){
					this.div_MasterView.form.tab_Master.set_tabindex(8);
					this.gfn_Alert("HR206", "");	// 임대인주민등록번호 또는 사업자등록번호를 입력하셔야 합니다.
					return false;
				}
				*/
			}
			//주소지
			if (this.gfn_IsNull(this.ds_GrdRent.getColumn(i,"RENT_ADDR"))){
				this.div_MasterView.form.tab_Master.set_tabindex(8);
				this.gfn_Alert("HR207", "");	// 주소지를 입력하셔야 합니다.
				return false;
			}
			//주택유형
			if (this.gfn_IsNull(this.ds_GrdRent.getColumn(i,"RENT_WTYP"))){
				this.div_MasterView.form.tab_Master.set_tabindex(8);
				this.gfn_Alert("HR208", "");	// 주택유형을 입력하셔야 합니다.
				return false;
			}
			
			//계약면적
			if (this.gfn_IsNull(this.ds_GrdRent.getColumn(i,"RENT_WARE"))){
				this.div_MasterView.form.tab_Master.set_tabindex(8);
				this.gfn_Alert("HR209", "");	// 계약면적을 입력하셔야 합니다.
				return false;
			}
			//계약시작일
			if (this.gfn_IsNull(this.ds_GrdRent.getColumn(i,"RENT_FDAY"))){
				this.div_MasterView.form.tab_Master.set_tabindex(8);
				this.gfn_Alert("HR211", "");	// 계약시작일을 입력하셔야 합니다.
				return false;
			}
			//계약종료일
			if (this.gfn_IsNull(this.ds_GrdRent.getColumn(i,"RENT_TDAY"))){
				this.div_MasterView.form.tab_Master.set_tabindex(8);
				this.gfn_Alert("HR212", "");	// 계약종료일을 입력하셔야 합니다.
				return false;
			}
			
		}
		
	}
	
	//주택임차차입금 체크
	if (this.ds_GrdJsba.getColumn(0,"JSBA_TG50") > 0){
		if (this.ds_GrdRent.getCaseSum("crudType != 'D'", "RENT_WONA") == 0){
			this.gfn_Alert("HR107", ""); // 거주자간 주택임차차입금 원리금상환공제를 받는 근로자는 [월세/주택임차] 탭에 거주자간 주택임차차입금 원리금상환공제란을 입력하세요.
			return false;
		}
	}
	
	//주택자금 월세액 금액 체크
	if (this.ds_GrdJsba.getColumn(0,"JSBA_TG46") > 0){
		if (this.ds_GrdJsba.getColumn(0,"JSBA_TG46") != this.ds_GrdRent.getCaseSum("crudType != 'D'", "RENT_AMOT")){
			this.gfn_Alert("HR108", ""); // 주택자금 월세액 금액과 [월세/주택임차] 탭에 월세액 합계 금액이 일치해야합니다.
			return false;
		}
	}
		
	//표준세액공제 적용여부
	var sJsmtBoyn = this.ds_GrdJsmt.getColumn(0,"JSMT_BOYN");
	var sJsmtBoyn = "";
	
	if (sJsmtBoyn = "1") {
		sJsmtBoyn ="적용";
	} else {
		sJsmtBoyn ="미적용";
	}
	
	//할부  
	var sHalbu = this.div_MasterView.form.tab_Master.tpg_12.form.div_Calc.form.cbo_JsmtHalb.value;
	
	//alert(sHalbu);
	if (this.ds_GrdJsmt.getColumn(0, "JSMT_CG01") + this.ds_GrdJsmt.getColumn(0, "JSMT_CG02") >= 100000 && sHalbu == ""){
		this.gfn_Alert("HR243", ""); // 납부세액에 대한 할부기간을 선택해야 합니다.
		return false;
	}
		
	//제출진행 여부
	this.gfn_Confirm("HR213", "", "CONF.JSTM04", "fn_MsgCallback");//제출 후에는 수정작업이 불가합니다.\n\n제출하시겠습니까?
	
	
	//실행처리
	//프로시저 SP_PR_JUNGSANPROCESS_SUBMIT
	
};

/***********************************************************************************************
 * 15.15. 연말정산 마감여부 체크
 = 인수  : sYear			: 귀속년도
			bShowMessage	: 메시지표시 여부 (디폴트 false)
			bCheckUser		: 사용자등록마감 체크 여부 (디폴트 false)
* @return
= 리턴  :  true(마감), false(미마감)
 ***********************************************************************************************/ 
this.fn_Jstg01_compute = function(sYear, bShowMessage, bCheckUser )
{
	this.ds_Input.clearData();
	
	this.ds_Input.addRow();
	this.ds_Input.setColumn(0, "MGAS_MM", sYear);
	
			
	//[공통]서비스정보 초기화
	this.gfn_InitComService(this);
	
	//[공통]서비스정보 추가
	var svcAddObj = new Object();//[공통] 서비스 추가 파라메타 정보 Object
	svcAddObj.sSelectSql = "hr:M_HR_MGAS_SL00";	//담당자
	this.gfn_AddComSearchService(this, svcAddObj)

	//[공통]서비스 호출 변수
	var svcCallObj = new Object();//[공통] 서비스 파라메타 정보 Object
	svcCallObj.sTrid = "MGAS_SEARCH";//Transaction ID 등 callback에서 넘겨 받을 String을 지정
	svcCallObj.sActionName = this.G_SV_HR;//서버에서 호출할 Action - 모듈별로 호출되는 기본 Actio이 다름 : 공통 서비스 Action 업무구분  변수 참조
	svcCallObj.sInputDaset = "ds_Input=ds_Input" //입력 데이터셋
	svcCallObj.sOutDatset = "ds_Mgas=ds_Mgas";//출력 데이터셋
	svcCallObj.sOtherArg = "";//서버로 전송할 기타 Argument 정보 문자열, 예) key=value key2=value2
	svcCallObj.sCallBackFnc = "fn_Callback";//서버에서 처리가 완료된 후 Callback 받을 Function 명
	svcCallObj.isSync = true;//동기식으로 설정할지 여부  (동기 true, 비동기 false)	
	//[공통]서비스 호출
	this.gfn_CallComService(this, svcCallObj);		
	
	
	if (this.ds_Mgas.getColumn(0, "ACCO_YN") == "1")
    {
		if (bShowMessage) {
			var arrMsgArg = [sYear];
			this.gfn_Alert("HR118", arrMsgArg);// 해당 년도(&ITM1)의 연말정산이 마감되었습니다.
		}
		return true;
	}
    if (this.ds_Mgas.getColumn(0, "CONF_YN") == "1" && bCheckUser)
    {
		if (bShowMessage){
			var arrMsgArg = [sYear];
			this.gfn_Alert("HR119", arrMsgArg);// 해당 년도(&ITM0)의 사용자등록이 마감되었습니다.
		}
		return true;
	}
	
	return false;
}

/***********************************************************************************************
 * 15.16. 주민번호로 나이계산
 ***********************************************************************************************/ 
this.fn_ageJumi = function(sJumi)
{
	var sTemp = sJumi.substr(6,1);
	trace(sTemp);
    var sBirth = "";
    if (sTemp=="1" || sTemp=="2" || sTemp=="5" || sTemp=="6")
		sBirth = "19" + sJumi.substr(0,2);
	else if (sTemp=="3" || sTemp=="4" || sTemp=="7" || sTemp=="8")
		sBirth = "20" + sJumi.substr(0,2);
	else if (sTemp=="9" || sTemp=="0")
		sBirth = "18" + sJumi.substr(0,2);
		
	trace("귀속년도-->"+this.fvJsmtYear );
	trace("생년-->"+sBirth);
		
	return this.fvJsmtYear - sBirth;
	
}

/***********************************************************************************************
 * 15.17. IIF 함수
 ***********************************************************************************************/ 
this.fn_iif = function()
{
    var arrArgument = this.fn_iif.arguments;; 
    if (arrArgument[0]) {
        return arrArgument[1];
    }else{
        return arrArgument[2];
    }
}

this.dataSet_oncolumnchanged = function(obj:nexacro.NormalDataset,e:nexacro.DSRowPosChangeEventInfo)
{
	
	this.gfn_GridUpdateProcess(this, obj, e);//crudType 변경-수정(U)	
	
	if(e.columnid=="HSPT_NANI"){
		this.ds_GrdHspt.setColumn(e.row, "HSPT_PREM", "0");
	}else if(e.columnid=="HSPT_PREM"){
		this.ds_GrdHspt.setColumn(e.row, "HSPT_NANI", "0");
	}
};

this.ds_GrdRent_oncolumnchanged = function(obj:nexacro.NormalDataset,e:nexacro.DSColChangeEventInfo)
{
	this.gfn_GridUpdateProcess(this, obj, e);//crudType 변경-수정(U)
};

this.ds_GrdJsjo_oncolumnchanged = function(obj:nexacro.NormalDataset,e:nexacro.DSColChangeEventInfo)
{
	this.gfn_GridUpdateProcess(this, obj, e);//crudType 변경-수정(U)
};



this.div_Search_Button00_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{

//[공통]서비스정보 초기화
	this.gfn_InitComService(this);
	
	this.ds_Input.addRow();
	this.ds_Input.setColumn(0,"dType","D");
	var sArg =  " JSBA_YEAR=2021"  
				 + " EMST_CODE=111" 
				 + " GUBN='PDF'" ;
			 alert(sArg);
		//의료비 삭제
		//[공통]서비스 정보 추가
		svcAddObj = new Object();//[공통] 서비스 추가 파라메타 정보 Object	
		svcAddObj.sDeleteSql = "hr:M_HS_8390_M_DL80";//삭제Sql
		svcAddObj.sSaveFlagColumn = "crudType";//insertSql, updateSql, deleteSql이 존재하여 신규, 수정, 삭제를 처리할 경우 기본적으로 Dataset의 getRowStates()로 판단하여 처리하며
								 //이를 Flag 컬럼으로 대체하고 싶은 경우 사용하는 [컬럼명], 해당 Flag 컬럼의 값은 신규 - I , 수정 - U , 삭제 - D의 값을 가져야 한다.
		
		this.gfn_AddComSaveService(this, svcAddObj);
			
this.ds_GrdHspt.setColumn(0,"crudType","D");
		
		//[공통]서비스 호출 변수
		var svcCallObj = new Object();//[공통] 서비스 파라메타 정보 Object
		svcCallObj.sTrid = "SEARCH";//Transaction ID 등 callback에서 넘겨 받을 String을 지정
		svcCallObj.sActionName = this.G_SV_HR;//서버에서 호출할 Action - 모듈별로 호출되는 기본 Actio이 다름 : 공통 서비스 Action 업무구분  변수 참조
		svcCallObj.sInputDaset = "ds_Input=ds_Input ds_GrdHspt=ds_GrdHspt:U" //입력 데이터셋
		svcCallObj.sOutDatset = "";//출력 데이터셋
		svcCallObj.sOtherArg = "JSBA_YEAR=2021 JSBA_AEAR=PDF";//서버로 전송할 기타 Argument 정보 문자열, 예) key=value key2=value2
		svcCallObj.sCallBackFnc = "fn_Callback";//서버에서 처리가 완료된 후 Callback 받을 Function 명


		
	//[공통]서비스 호출
	this.gfn_CallComService(this, svcCallObj);
	
	/*	
	var nJSBA_TG30=0;
	this.ds_GrdGibu.addRow();
	//this.ds_GrdGibu.addRow();
	this.ds_GrdGibu.setColumn(0,"GIBU_GAMT",445);
	//this.ds_GrdGibu.setColumn(1,"GIBU_GAMT",222);
	
	for (var i=0; i<this.ds_GrdGibu.rowcount; i++)
	{
		nJSBA_TG30 += this.ds_GrdGibu.getColumn(i,"GIBU_GAMT");
	}
	
	;
alert(this.ds_GrdGibu.getRowCount());

	//trace(this.fn_ageJumi("7602101148511"));
	
	for (var i=0; i<this.ds_GrdHspt.rowcount; i++)
	{
		// 국세청장이 연말정산간소화서비를 통해 제공하는 의료비 자료가 아니면...
		if (this.ds_GrdHspt.getColumn(i,"HSPT_CODE") != "1")
		{
			if (this.gfn_IsNull(this.ds_GrdHspt.getColumn(i,"HSPT_COMP")))
			{
				//gfn_GetMessage("HR299", "&ITM1", domain.hr.HSPT_COMP.Text); // &ITM1을(를) 입력하십시오. 사업자번호
				alert("사업자 입력하세요.");
				//this.ds_GrdHspt.set_rowposition(i);
				//의료비 탭으로 이동
				this.div_MasterView.form.tab_Master.set_tabindex(4);
				this.div_MasterView.form.tab_Master.tpg_05.form.div_Hspt.form.grd_Hspt.setCellPos(this.div_MasterView.form.tab_Master.tpg_05.form.div_Hspt.form.grd_Hspt.getBindCellIndex("body","HSPT_COMP"),  i);					 
				this.div_MasterView.form.tab_Master.tpg_05.form.div_Hspt.form.grd_Hspt.showEditor(true);

				return false;
			}
		}
	}
	*/
};







this.div_Search_btn_Htax_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	system.execBrowser( "https://www.hometax.go.kr/ui/pp/yrs_index.html" );
};



this.div_MasterView_Button00_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	
};

this.ds_GrdHspt_cancolumnchange = function(obj:nexacro.NormalDataset,e:nexacro.DSColChangeEventInfo)
{
	
	if(e.columnid == "HSPT_CODE"){
		var sRegiId = obj.getColumn(e.row, "REGI_ID");
		var sValue  = e.newvalue;
		
		if(sRegiId != "PDF"){ 
			if(sValue=="1"){
				var arrMsgArg = ["행추가시 국세청자료로 선택할 수"];
				this.gfn_Alert("MM046", arrMsgArg);
				return false;
			}			
		}		
	}
};

this.fn_Buya_Add = function(){
	
	//var sSystId = this.gfn_GetSessionValue("SYST_ID");
	var sSystId = this.div_Search.form.edt_SystId.value;
			
	this.ds_Detail10.clearData(); //가족사항
	
	this.ds_Input.clearData();
	
	this.ds_Input.addRow();
	this.ds_Input.setColumn(0, "BUYA_YEAR", this.div_Search.form.spn_JstaYear.value);
	this.ds_Input.setColumn(0, "SYST_ID", sSystId);
	this.ds_Input.setColumn(0, "PRGM_ID", this.fvComPrgmId);
			
	//[공통]서비스정보 초기화
	this.gfn_InitComService(this);
	
	//[공통]서비스정보 추가
	var svcAddObj = new Object();//[공통] 서비스 추가 파라메타 정보 Object
	
	svcAddObj.sSelectSql = "hr:M_HS_8390_D_SL10"; //가족사항
	this.gfn_AddComSearchService(this, svcAddObj);		
	
	
	
	//[공통]서비스 호출 변수
	var svcCallObj = new Object();//[공통] 서비스 파라메타 정보 Object
	svcCallObj.sTrid = "DTL_SEARCH";//Transaction ID 등 callback에서 넘겨 받을 String을 지정
	svcCallObj.sActionName = this.G_SV_HR;//서버에서 호출할 Action - 모듈별로 호출되는 기본 Actio이 다름 : 공통 서비스 Action 업무구분  변수 참조
	svcCallObj.sInputDaset = "ds_Input=ds_Input" //입력 데이터셋
	svcCallObj.sOutDatset = "ds_Detail10=ds_Detail10";//출력 데이터셋
	svcCallObj.sOtherArg = "";//서버로 전송할 기타 Argument 정보 문자열, 예) key=value key2=value2
	svcCallObj.sCallBackFnc = "fn_Callback";//서버에서 처리가 완료된 후 Callback 받을 Function 명
	svcCallObj.isSync = true;//동기식으로 설정할지 여부
	
	//[공통]서비스 호출
	this.gfn_CallComService(this, svcCallObj);

	var sSystId; 
	var sRelaCd; 
	var sEmpmNm; 
	var sInot; 
	var sJumi; 
	var sSeid; 
	var sGibo; 
	var sWife; 
	var sAg20; 
	var sAg60; 
	var sNoin; 
	var sJang; 
	var sBuin; 
	var sMchd; 
	var sChip;		
	var nRow = 0;
	var iAddRow;
	
	var sBuyaYear = this.div_Search.form.spn_JstaYear.value;
	//var sSystId   =  this.ds_GrdJsba.getColumn(0, "SYST_ID");
	
	
	this.ds_GrdBuya.set_enableevent(false);
	
	for(var iLoop=0; iLoop<this.ds_Detail10.rowcount; iLoop++){
		sSystId = this.ds_Detail10.getColumn(iLoop, "SYST_ID");
		sRelaCd = this.ds_Detail10.getColumn(iLoop, "RELA_CD");		//관계
		sEmpmNm = this.ds_Detail10.getColumn(iLoop, "EMPM_NM");
		sInot 	= this.ds_Detail10.getColumn(iLoop, "NATM_CD");
		sJumi 	= this.ds_Detail10.getColumn(iLoop, "JUMN_NO");
		sSeid 	= this.ds_Detail10.getColumn(iLoop, "HOSM_YN");		//세대주
		sGibo 	= this.ds_Detail10.getColumn(iLoop, "DEPE_YN");		//기본
		sWife   = this.ds_Detail10.getColumn(iLoop, "WIFE_YN");
		sAg20 	= this.ds_Detail10.getColumn(iLoop, "AG20_YN");
		sAg60 	= this.ds_Detail10.getColumn(iLoop, "AG60_YN"); 
		sNoin 	= this.ds_Detail10.getColumn(iLoop, "NOIN_YN");
		
		sJang 	= this.ds_Detail10.getColumn(iLoop, "DISA_YN");
		sBuin 	= this.ds_Detail10.getColumn(iLoop, "WIFE_YN");		
		sMchd 	= this.ds_Detail10.getColumn(iLoop, "MCHD_YN");
		sChip 	= this.ds_Detail10.getColumn(iLoop, "CHIP_YN");
		
		nRow = this.ds_GrdBuya.findRowExpr("BUYA_JUMI == '" + sJumi + "'");		
		
		if(nRow > -1){
		
		}else {
			iAddRow = this.gfn_GridInsertProcess(this, this.ds_GrdBuya );//crud_flag 변경-입력(I)
			
			this.ds_GrdBuya.setColumn(iAddRow, "BUYA_YEAR", sBuyaYear);
			this.ds_GrdBuya.setColumn(iAddRow, "SYST_ID", 	sSystId);
			this.ds_GrdBuya.setColumn(iAddRow, "BUYA_RELA", sRelaCd);
			this.ds_GrdBuya.setColumn(iAddRow, "BUYA_NAME", sEmpmNm);			
			this.ds_GrdBuya.setColumn(iAddRow, "BUYA_INOT", sInot);		
			this.ds_GrdBuya.setColumn(iAddRow, "BUYA_JUMI", sJumi);
			this.ds_GrdBuya.setColumn(iAddRow, "BUYA_SEID", sSeid);
			this.ds_GrdBuya.setColumn(iAddRow, "BUYA_GIBO", sGibo);
			this.ds_GrdBuya.setColumn(iAddRow, "BUYA_WIFE", sWife);
			this.ds_GrdBuya.setColumn(iAddRow, "BUYA_AG20", sAg20);
			this.ds_GrdBuya.setColumn(iAddRow, "BUYA_AG60", sAg60);
			this.ds_GrdBuya.setColumn(iAddRow, "BUYA_NOIN", sNoin);
			this.ds_GrdBuya.setColumn(iAddRow, "BUYA_JANG", sJang);
			this.ds_GrdBuya.setColumn(iAddRow, "BUYA_BUIN", "0");
			this.ds_GrdBuya.setColumn(iAddRow, "BUYA_HANB", "0");
			this.ds_GrdBuya.setColumn(iAddRow, "BUYA_MCHD", sMchd);
			this.ds_GrdBuya.setColumn(iAddRow, "BUYA_CHIP", sChip);
		}
	
	}
	this.ds_GrdBuya.set_enableevent(true);

}


this.ds_GrdBuya_cancolumnchange = function(obj:nexacro.NormalDataset,e:nexacro.DSColChangeEventInfo)
{
	
	if(e.columnid == "BUYA_RELA"){	
		var sRela = e.newvalue;
		var nCnt  = obj.getCaseCount("crudType != 'D' && BUYA_RELA== '0'");	
		
		if(sRela=="0" && nCnt > 0){
			var arrMsgArg = ["본인이 존재하여 수정할 수"];
			this.gfn_Alert("MM046", arrMsgArg); 
			return false;
		}		
	}else if(e.columnid ==  'BUYA_JUMI'){
		var sJumi  = e.newvalue;
		var bSsn   = this.gfn_IsSSN(e.newvalue);  //주민번호여부 체크		
				
		if(!bSsn) {
			var arrMsgArg = ["주민등록번호"];
			this.gfn_Alert("SM042", arrMsgArg); //주민등록번호를 확인하세요
			return false;
		}
		
		if(this.gfn_VaildDupDataset(this.ds_GrdBuya, "BUYA_JUMI")){
			var arrMsgArg = ["같은 주민번호가 존재하여 수정할 수"];
			this.gfn_Alert("MM046", arrMsgArg); 
			return false;		
		}
		
	}
};

this.ds_GrdBuya_oncolumnchanged = function(obj:nexacro.NormalDataset,e:nexacro.DSColChangeEventInfo)
{
	this.gfn_GridUpdateProcess(this, obj, e);//crudType 변경-수정(U)
	
	var sCrudType;
	var sSeid;
	
	if(e.columnid ==  'BUYA_RELA'){
		if(e.newvalue!="0"){
			this.ds_GrdBuya.setColumn(e.row, "BUYA_SEID", "0");
			this.ds_GrdBuya.setColumn(e.row, "BUYA_HANB", "0");
		}
	
	}else if(e.columnid ==  'BUYA_SEID'){
		var nCurrRow = this.ds_GrdBuya.rowposition;
		
		for(var iLoop=0; iLoop < this.ds_GrdBuya.rowcount; iLoop++){
			sCrudType = this.ds_GrdBuya.getColumn(iLoop, "crudType");
			sSeid 	  = this.ds_GrdBuya.getColumn(iLoop, "BUYA_SEID");									
			
			if(iLoop != nCurrRow && sSeid =="1"){				
				this.ds_GrdBuya.setColumn(iLoop, "BUYA_SEID", "0");
				if(sCrudType!="I"){
					this.ds_GrdBuya.setColumn(iLoop, "crudType",  "U");		
				}
				
			}
		}
	}else if(e.columnid == "BUYA_GIBO" || (e.columnid == "BUYA_JUMI"  && obj.getColumn(e.row,"BUYA_GIBO")== "1" )){		
		var sChk     = e.newvalue;	
		
		var nCurrRow = this.ds_GrdBuya.rowposition;
		var sJumnNo = this.ds_GrdBuya.getColumn(nCurrRow, "BUYA_JUMI");
		var century;
		
		var genderFlag = Number(sJumnNo.substr(6, 1));		
		
		//var sYMD   = this.gfn_GetBirthDateBySSN(sJumnNo);		
		
		switch(genderFlag) {
			case 1:
			case 2:
			case 5:
			case 6:
				century = "19";
				break;
			case 3:
			case 4:
			case 7:
			case 8:
				century = "20";
				break;
			case 9:
			case 0:
				century = "18";
				break;
		}
		
		var sToday  = this.gfn_GetCommDate("toDay").substr(0,4);
		var sYear   = century + sJumnNo.substr(0,2);
		
		var nAge    = nexacro.toNumber(sToday) - nexacro.toNumber(sYear);
		
		if(sChk=="0" || this.gfn_IsNull(sChk)){
			this.ds_GrdBuya.setColumn(nCurrRow, "BUYA_AG20", "0");
			this.ds_GrdBuya.setColumn(nCurrRow, "BUYA_AG60", "0");
			this.ds_GrdBuya.setColumn(nCurrRow, "BUYA_NOIN", "0");
			this.ds_GrdBuya.setColumn(nCurrRow, "BUYA_JANG", "0");
			this.ds_GrdBuya.setColumn(nCurrRow, "BUYA_WIFE", "0");
			this.ds_GrdBuya.setColumn(nCurrRow, "BUYA_MCHD", "0");
			this.ds_GrdBuya.setColumn(nCurrRow, "BUYA_CHIP", "0");	
			
		}else{
			if(nAge <= 20){
				this.ds_GrdBuya.setColumn(nCurrRow, "BUYA_AG20", "1");		
			}else{
				this.ds_GrdBuya.setColumn(nCurrRow, "BUYA_AG20", "0");
			}
			
			if(nAge >= 60){
				this.ds_GrdBuya.setColumn(nCurrRow, "BUYA_AG60", "1");		
			}else{
				this.ds_GrdBuya.setColumn(nCurrRow, "BUYA_AG60", "0");
			}
			
			if(nAge >= 70){
				this.ds_GrdBuya.setColumn(nCurrRow, "BUYA_NOIN", "1");		
			}else{
				this.ds_GrdBuya.setColumn(nCurrRow, "BUYA_NOIN", "0");
			}
			
			if(nAge >= 7 && nAge <= 20){
				this.ds_GrdBuya.setColumn(nCurrRow, "BUYA_MCHD", "1");		
			}else{
				this.ds_GrdBuya.setColumn(nCurrRow, "BUYA_MCHD", "0");
			}
			
			if(nAge == 0){
				this.ds_GrdBuya.setColumn(nCurrRow, "BUYA_CHIP", "1");		
			}else{
				this.ds_GrdBuya.setColumn(nCurrRow, "BUYA_CHIP", "0");
			}
		}	
		
	
	}
};
this.ds_GrdGibu_cancolumnchange = function(obj:nexacro.NormalDataset,e:nexacro.DSColChangeEventInfo)
{
// 		if(e.columnid == "GIBU_GUBN"){
// 		var sRegiId = obj.getColumn(e.row, "REGI_ID");
// 		var sValue  = e.newvalue;
// 		
// 		if(sRegiId != "PDF"){ 
// 			if(sValue=="1"){
// 				var arrMsgArg = ["행추가시 국세청자료로 선택할 수"];
// 				this.gfn_Alert("MM046", arrMsgArg);
// 				return false;
// 			}			
// 		}		
// 	}
};

this.ds_GrdGibu_oncolumnchanged = function(obj:nexacro.NormalDataset,e:nexacro.DSColChangeEventInfo)
{
	this.gfn_GridUpdateProcess(this, obj, e);//crudType 변경-수정(U)
	
	if(e.columnid=="GIBU_JUMI"){
		var sResi = e.newvalue;
		var sRela;
		
		this.ds_GrdGibu.setColumn(e.row, "GIBU_NAME", this.ds_GrdBuya.lookup("BUYA_JUMI", sResi, "BUYA_NAME"));  //성명
		sRela = this.ds_GrdBuya.lookup("BUYA_JUMI", sResi, "BUYA_RELA");
		this.ds_GrdGibu.setColumn(e.row, "GIBU_RELA", this.ds_Pr125.lookup("CODM_CD",  sRela, "OP01_NM"));  //관계
	
	}/*else if(e.columnid=="GIBU_CODE" || e.columnid=="GIBU_GAMT"){
		this.fn_GibuSebu();
	}*/
};

this.fn_GibuSebu = function(){

	this.ds_GrdGbch.set_enableevent(false);
	
	for (var i=this.ds_GrdGbch.getRowCount()-1; i>=0; i--){
			if (this.fvJsmtYear == this.ds_GrdGbch.getColumn(i,"GBCH_GBYY").toString().substr(0,4)) this.ds_GrdGbch.deleteRow(i);
	}
	
	var	sGibuCode; 
	var sGbchCode;
	var nGamt = 0;	
	var nGamtSum = 0;
	var nRow;	
	var scrudType;
	
	var sSystId  = this.div_Search.form.edt_SystId.value;
	
	for (var i=0; i<this.ds_GrdGibu.getRowCount(); i++){
	
		scrudType = this.ds_GrdGibu.getColumn(i, "crudType")
		
		if(this.gfn_IsNull(scrudType) || scrudType != "D"){			
	
			sGibuCode = this.ds_GrdGibu.getColumn(i, "GIBU_CODE");
			nGamt	  = nexacro.toNumber(this.ds_GrdGibu.getColumn(i, "GIBU_GAMT"));
			
			nRow = this.ds_GrdGbch.findRowExpr("GBCH_CODE=='" + sGibuCode + "' && GBCH_GBYY=='" + this.fvJsmtYear + "'");
			
			if(nRow <= -1){						
				var nRow = this.ds_GrdGbch.addRow();				
				this.ds_GrdGbch.setColumn(nRow, "COMP_CODE", this.fvCompCode);
				this.ds_GrdGbch.setColumn(nRow, "GBCH_YEAR", this.fvJsmtYear);
				this.ds_GrdGbch.setColumn(nRow, "SYST_ID", sSystId);
				this.ds_GrdGbch.setColumn(nRow, "GBCH_GBYY", this.fvJsmtYear);
				this.ds_GrdGbch.setColumn(nRow, "GBCH_CODE", sGibuCode);
				this.ds_GrdGbch.setColumn(nRow, "GBCH_GAMT", nGamt);
				this.ds_GrdGbch.setColumn(nRow, "GBCH_GDAM", nGamt);				
				this.ds_GrdGbch.setColumn(nRow, "REGI_ID", "PDF");
				this.ds_GrdGbch.setColumn(nRow, "crudType", "I");
				
				this.ds_GrdGbch.setColumn(nRow, "GBCH_SEYN", this.div_Search.form.chk_BohuYn.value);					
				
			}else{
				
				nGamtSum = nexacro.toNumber(this.ds_GrdGbch.getColumn(nRow, "GBCH_GAMT"));
				
				this.ds_GrdGbch.setColumn(nRow, "GBCH_GAMT", nGamtSum + nGamt);
				this.ds_GrdGbch.setColumn(nRow, "GBCH_GDAM", nGamtSum + nGamt);				
				this.ds_GrdGbch.setColumn(nRow, "crudType", "I");
			}
		}
	}
	
	this.ds_GrdGbch.set_keystring("S:GBCH_CODE");
	
	this.ds_GrdGbch.set_enableevent(true);

}
this.div_Search_spn_JstaYear_onchanged = function(obj:nexacro.Spin,e:nexacro.ChangeEventInfo)
{
	this.fn_ComBtnSearch();
};

this.ds_GrdSave_oncolumnchanged = function(obj:nexacro.NormalDataset,e:nexacro.DSColChangeEventInfo)
{
	var scrudType = this.ds_GrdSave.getColumn(e.newrow, "crudType");	
	
	if(scrudType!="I"){		
		this.gfn_GridUpdateProcess(this, obj, e);//crudType 변경-수정(U)
	}
	
	if(e.columnid=="SAVE_GRUP"){
	
		obj.setColumn(e.row, "SAVE_GUBN", null);
		obj.setColumn(e.row, "SAVE_ENDT", null);
		obj.setColumn(e.row, "SAVE_PERI", null);
		obj.setColumn(e.row, "SAVE_STYE", null);
		obj.setColumn(e.row, "SAVE_BKCD", null);
		obj.setColumn(e.row, "SAVE_BKAC", null);
		obj.setColumn(e.row, "SAVE_PAYY", null);
		obj.setColumn(e.row, "SAVE_BAMT", null);
	
		this.ds_Pr128.filter("");		
		var sCodmCd = this.ds_GrdSave.getColumn(e.row, "SAVE_GRUP");		
		this.ds_Pr128.filter("OP01_NM =='" + sCodmCd + "'");
		
	}else if(e.columnid=="SAVE_GUBN"){
		if(e.newvalue!="81"){
			obj.setColumn(e.row, "SAVE_ENDT", null);
			obj.setColumn(e.row, "SAVE_PERI", null);
		}
	}
};

this.ds_GrdJsjo_cancolumnchange = function(obj:nexacro.NormalDataset,e:nexacro.DSColChangeEventInfo)
{
	if(e.columnid == "JSJO_COMP"){
		var SaumNo = e.newvalue
		var bSsn   = this.gfn_IsBzIdNo(SaumNo);  //사업자등록번호 체크
		if(!bSsn) {
			var arrMsgArg = ["사업자등록번호"];
			this.gfn_Alert("SM042", arrMsgArg); 
			return false;
		}	
	}
};
 
 

this.div_MasterView_tab_Master_tpg_08_div_Save_onlbuttondown = function(obj:nexacro.Div,e:nexacro.MouseEventInfo)
{	
// 	var nRow = this.ds_GrdSave.rowposition;	
// 	
// 	var sCodmCd = this.ds_GrdSave.getColumn(nRow, "SAVE_GRUP");
// 	
// 	trace(nRow + "    " + sCodmCd);	
// 	
// 	this.ds_Pr128.filter("");
// 		
// 	this.ds_Pr128.filter("OP01_NM =='" + sCodmCd + "'");
	
};
 
this.fn_Filter = function(){
 
 	var nRow = this.ds_GrdSave.rowposition;	
	
	var sCodmCd = this.ds_GrdSave.getColumn(nRow, "SAVE_GRUP");
	
	trace(nRow + "    " + sCodmCd);	
	
	this.ds_Pr128.filter("");
		
	this.ds_Pr128.filter("OP01_NM =='" + sCodmCd + "'"); 
 }
 
this.fn_Modify = function(){
	this.ds_GrdJsba.setColumn(0, "crudType", "U"); 	
 }
 

this.ds_GrdBuyaBo_oncolumnchanged = function(obj:nexacro.NormalDataset,e:nexacro.DSColChangeEventInfo)
{
	this.gfn_GridUpdateProcess(this, obj, e);//crudType 변경-수정(U)
};


this.ds_GrdBuyaEd_cancolumnchange = function(obj:nexacro.NormalDataset,e:nexacro.DSColChangeEventInfo)
{
	if(e.columnid == "BUYA_EDGB"){	
		var sEdgb = e.newvalue;
		var nCnt  = obj.getCaseCount("crudType != 'D' && BUYA_EDGB== '0'");	
		
		if(sEdgb=="0" && nCnt > 0){
			var arrMsgArg = ["본인이 존재하여 수정할 수"];
			this.gfn_Alert("MM046", arrMsgArg); 
			return false;
		}		
	}
};

this.ds_GrdBuyaEd_oncolumnchanged = function(obj:nexacro.NormalDataset,e:nexacro.DSColChangeEventInfo)
{
	this.gfn_GridUpdateProcess(this, obj, e);//crudType 변경-수정(U)	
	
	if(e.columnid == "BUYA_EDGB"){
		var sEdgb = e.newvalue;
		
		obj.setColumn(e.row, "BUYA_EDU3", 0);	//교복비
		obj.setColumn(e.row, "BUYA_EDU4", 0);	//체험학습비
		obj.setColumn(e.row, "BUYA_EDU5", 0);	//학자금대출
		
		if(sEdgb=="0"){	//본인
			obj.setColumn(e.row,  "BUYA_EDU5", obj.getOrgColumn(e.row, "BUYA_EDU5"));		
		} else if(sEdgb=="2"){	 //초중고
			obj.setColumn(e.row,  "BUYA_EDU3", obj.getOrgColumn(e.row, "BUYA_EDU3"));		
			obj.setColumn(e.row,  "BUYA_EDU4", obj.getOrgColumn(e.row, "BUYA_EDU4"));
		}
	}
};

this.ds_GrdJsba_oncolumnchanged = function(obj:nexacro.NormalDataset,e:nexacro.DSColChangeEventInfo)
{
	this.ds_GrdJsba.setColumn(0, "crudType", "U"); 	
};


]]></Script>
  </Form>
</FDL>
