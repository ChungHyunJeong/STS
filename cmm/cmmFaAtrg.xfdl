<?xml version="1.0" encoding="utf-8"?>
<FDL version="2.1">
  <Form id="cmmFaAtrg" width="1433" height="520" titletext="자동전표등록" onload="fn_FormOnload" onclose="fn_FormClose" ontimer="cmmFaAtob_ontimer">
    <Layouts>
      <Layout height="520" width="1433">
        <Grid id="grd_Detail10" taborder="1" left="0" top="28" autofittype="none" oncellclick="div_DetailInput_tab_Detail_tpg_01_grd_Detail10_oncellclick" autoenter="select" cellsizingtype="col" binddataset="ds_Detail10" onenterdown="div_DetailInput_tab_Detail_tpg_01_grd_Detail10_onenterdown" onsetfocus="div_DetailInput_tab_Detail_tpg_01_grd_Detail10_onsetfocus" onnodataareadblclick="div_DetailInput_tab_Detail_tpg_01_grd_Detail10_onnodataareadblclick" bottom="0" right="400" selecttype="cell">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="30" band="left"/>
                <Column size="35" band="left"/>
                <Column size="35" band="left"/>
                <Column size="0" band="left"/>
                <Column size="100" band="left"/>
                <Column size="200" band="left"/>
                <Column size="24"/>
                <Column size="150"/>
                <Column size="24"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="200"/>
                <Column size="24"/>
                <Column size="100"/>
                <Column size="24"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="100"/>
                <Column size="100"/>
              </Columns>
              <Rows>
                <Row size="26" band="head"/>
                <Row size="24"/>
                <Row size="24" band="summ"/>
              </Rows>
              <Band id="head">
                <Cell/>
                <Cell col="1" text="No."/>
                <Cell col="2"/>
                <Cell col="3" text="차대구분"/>
                <Cell col="4" text="계정코드"/>
                <Cell col="5" text="계정명"/>
                <Cell col="6"/>
                <Cell col="7" text="회계기준코드"/>
                <Cell col="8"/>
                <Cell col="9" text="차변금액"/>
                <Cell col="10" text="대변금액"/>
                <Cell col="11" text="적요"/>
                <Cell col="12"/>
                <Cell col="13" text="예산부서"/>
                <Cell col="14"/>
                <Cell col="15" text="편성년월"/>
                <Cell col="16" text="화폐"/>
                <Cell col="17" text="환율"/>
                <Cell col="18" text="외화차변"/>
                <Cell col="19" text="외화대변"/>
              </Band>
              <Band id="body">
                <Cell cssclass="expr:comp.parent.gfn_Decode(crudType, &quot;I&quot;,&quot;cell_WF_Insert&quot;, &quot;U&quot;,&quot;cell_WF_Modify&quot;, &quot;D&quot;,&quot;cell_WF_Delete01&quot;, &quot;&quot;)"/>
                <Cell col="1" expr="currow+1" textAlign="center"/>
                <Cell col="2" displaytype="checkboxcontrol" edittype="checkbox" text="bind:s_chk"/>
                <Cell col="3" text="bind:DECR_GU" displaytype="combotext" combodataset="ds_Fa040" combocodecol="CODM_CD" combodatacol="CODM_NM" edittype="none"/>
                <Cell col="4" text="bind:ACOM_CD" edittype="normal"/>
                <Cell col="5" text="bind:ACOM_NM" edittype="none"/>
                <Cell col="6" cursor="pointer" expandshow="show" expandsize="24"/>
                <Cell col="7" text="bind:PALM_NM"/>
                <Cell col="8" cursor="pointer" expandshow="show" expandsize="24"/>
                <Cell col="9" text="bind:DEBI_AM" textAlign="right" maskeditformat="expr:(DECR_GU == 'C')?'#,##0': '#,###'" displaytype="number" editautoselect="false" maskeditautoselect="true" edittype="expr:(CRED_AM ==0 )?'mask': 'none'"/>
                <Cell col="10" text="bind:CRED_AM" textAlign="right" maskeditformat="expr:(DECR_GU == 'D')?'#,##0': '#,###'" displaytype="number" editautoselect="false" maskeditautoselect="true" edittype="expr:(DEBI_AM==0 )?'mask': 'none'"/>
                <Cell col="11" text="bind:REMK_NM" editautoselect="true" edittype="expr:(CONF_YN != '1')?'text':'none'"/>
                <Cell col="12" cursor="pointer" expandshow="show" expandsize="24"/>
                <Cell col="13" displaytype="normal" text="bind:BUDP_NM"/>
                <Cell col="14" cursor="pointer" expandshow="show" expandsize="24"/>
                <Cell col="15" calendareditformat="yyyy-MM" calendarshowmonthspin="true" calendarshowyearspin="true" displaytype="date" calendardateformat="yyyy-MM" text="bind:BUDG_MM"/>
                <Cell col="16" text="bind:CURR_CD" displaytype="combotext" combodataset="ds_Sm020" combocodecol="CODM_CD" combodatacol="CODM_NM" edittype="none"/>
                <Cell col="17" text="bind:EXCH_RT" textAlign="right" displaytype="number" maskeditformat="#,###.####" maskeditautoselect="true" edittype="none"/>
                <Cell col="18" text="bind:FRDB_AM" displaytype="number" maskeditformat="expr:(DECR_GU == 'D')?'#,##0.####': '#,###.####'" textAlign="right" maskeditautoselect="true" edittype="none"/>
                <Cell col="19" text="bind:FRCR_AM" displaytype="number" maskeditformat="expr:(DECR_GU == 'C')?'#,##0.####': '#,###.####'" textAlign="right" maskeditautoselect="true" edittype="none"/>
              </Band>
              <Band id="summary">
                <Cell/>
                <Cell col="1"/>
                <Cell col="2"/>
                <Cell col="3" text="합계" textAlign="center"/>
                <Cell col="4"/>
                <Cell col="5"/>
                <Cell col="6"/>
                <Cell col="7"/>
                <Cell col="8"/>
                <Cell col="9" displaytype="mask" maskeditformat="#,###" expr="dataset.getCaseSum(&quot;crudType != 'D'&quot;, &quot;DEBI_AM&quot;) "/>
                <Cell col="10" displaytype="mask" maskeditformat="#,###" expr="dataset.getCaseSum(&quot;crudType != 'D'&quot;, &quot;CRED_AM&quot;) "/>
                <Cell col="11" color="#f17264" expr="(dataset.getCaseSum(&quot;crudType != 'D'&quot;, &quot;DEBI_AM&quot;) - dataset.getCaseSum(&quot;crudType != 'D'&quot;, &quot;CRED_AM&quot;))==0?&quot;&quot;:&quot; 차액 : &quot; + (dataset.getCaseSum(&quot;crudType != 'D'&quot;, &quot;DEBI_AM&quot;) - dataset.getCaseSum(&quot;crudType != 'D'&quot;, &quot;CRED_AM&quot;)).toString().replace(/\B(?=(\d{3})+(?!\d))/g, &quot;,&quot;)"/>
                <Cell col="12"/>
                <Cell col="13"/>
                <Cell col="14"/>
                <Cell col="15"/>
                <Cell col="16"/>
                <Cell col="17"/>
                <Cell col="18" expr="dataset.getCaseSum(&quot;crudType != 'D'&quot;, &quot;FRDB_AM&quot;) " displaytype="mask" maskeditformat="#,###.####"/>
                <Cell col="19" expr="dataset.getCaseSum(&quot;crudType != 'D'&quot;, &quot;FRCR_AM&quot;) " displaytype="mask" maskeditformat="#,###.####"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Div id="div_detailRight" taborder="0" top="0" text="" left="grd_Detail10:15" right="0" bottom="0" enable="true">
          <Layouts>
            <Layout>
              <Div id="div_Item" taborder="0" left="0" top="0" right="0" height="41" enable="true" text="">
                <Layouts>
                  <Layout>
                    <Static id="sta_DetailRightBottom" taborder="28" text="관리항목" left="0" top="0" width="220" height="22" cssclass="sta_WF_Title" verticalAlign="middle" textAlign="left"/>
                  </Layout>
                </Layouts>
              </Div>
              <Div id="div_Budget" taborder="1" left="0" top="div_Item:0" height="180" right="0" visible="true" enable="false">
                <Layouts>
                  <Layout>
                    <Static id="StaticBudget1F" taborder="0" top="210" height="30" cssclass="sta_WF_DBg" left="0" text="" right="0" visible="false"/>
                    <Static id="StaticBudget2F" taborder="1" top="240" height="30" cssclass="sta_WF_DBg" right="0" left="0" visible="false"/>
                    <Static id="StaticBudget3F" taborder="2" top="29" height="30" cssclass="sta_WF_DBg" right="0" left="0"/>
                    <Static id="StaticBudget4F" taborder="3" top="58" height="30" cssclass="sta_WF_DBg" left="0" right="0"/>
                    <Static id="StaticBudget5F" taborder="4" top="87" height="30" cssclass="sta_WF_DBg" right="0" left="0"/>
                    <Static id="StaticBudget6F" taborder="5" top="145" height="30" cssclass="sta_WF_DBg" left="0" right="0"/>
                    <Static id="Static01" taborder="6" text="편성년월" top="StaticBudget1F:-30" width="85" height="30" cssclass="sta_WF_DLabel" left="0" DomainID="S00001" visible="false"/>
                    <Static id="sta_DepmCd" taborder="7" text="예산부서" top="StaticBudget2F:-30" width="85" height="30" cssclass="sta_WF_DLabel" left="0" DomainID="S00003" usedecorate="true" visible="false"/>
                    <Static id="Static01_00_01" taborder="8" text="예산계정" top="StaticBudget3F:-30" width="93" height="30" cssclass="sta_WF_DLabel" left="0"/>
                    <Static id="Static01_04" taborder="9" text="편성금액" top="StaticBudget4F:-30" width="93" height="30" cssclass="sta_WF_DLabel" left="0"/>
                    <Static id="Static01_00_02" taborder="10" text="기사용금액" top="87" width="93" height="30" cssclass="sta_WF_DLabel" left="0"/>
                    <Static id="Static01_01_00" taborder="11" text="가용잔액" top="145" width="93" height="30" cssclass="sta_WF_DLabel" left="0"/>
                    <Edit id="edt_BudgetAcomCd" taborder="12" left="96" top="StaticBudget3F:-27" height="24" text="ssdsdewweew" right="3" readonly="true"/>
                    <Static id="sta_Master10" taborder="13" text="예산" left="0" top="0" width="220" height="32" cssclass="sta_WF_Title"/>
                    <MaskEdit id="mae_RecAm" taborder="14" left="96" top="StaticBudget4F:-27" height="24" format="#,##0" right="3" readonly="true"/>
                    <MaskEdit id="mae_AvailAm" taborder="15" left="96" top="148" height="24" format="#,##0" right="3" readonly="true"/>
                    <MaskEdit id="mae_UsedAm" taborder="16" left="96" top="90" height="24" format="#,##0" right="3" readonly="true"/>
                    <CheckBox id="chk_BgcmYn" taborder="17" text="예산통제여부" top="6" width="96" height="20" right="0" enable="false" falsevalue="0" truevalue="1"/>
                    <Static id="StaticBudget5F00" taborder="18" top="116" height="30" cssclass="sta_WF_DBg" right="0" left="0"/>
                    <Static id="Static01_00_02_00" taborder="19" text="사용금액" top="116" width="93" height="30" cssclass="sta_WF_DLabel" left="0"/>
                    <MaskEdit id="mae_RegAm" taborder="20" left="96" top="119" height="24" format="#,##0" right="3" readonly="true"/>
                  </Layout>
                </Layouts>
              </Div>
            </Layout>
          </Layouts>
        </Div>
        <Div id="div_ComGrdBtn" taborder="2" top="6" height="20" right="400" width="435" async="false" enable="false" text="" visible="false"/>
        <Button id="btn_banFind" taborder="3" text="반제전표찾기" height="20" cssclass="bt_WF_InputArea_White" width="119" right="717" enable="false" top="6" onclick="div_DetailInput_btn_banFind_onclick" visible="false"/>
        <Edit id="edt_CusmCd" taborder="4" left="726" top="6" width="130" height="24" enable="true" maxlength="30" onchanged="div_Search_edt_EmpmNm_onchanged" visible="false"/>
        <Edit id="edt_CusmNm" taborder="5" left="887" top="6" width="130" height="24" enable="true" maxlength="30" onchanged="div_Search_edt_EmpmNm_onchanged" visible="false"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_Input">
        <ColumnInfo>
          <Column id="PRGM_ID" type="STRING" size="256"/>
          <Column id="ACOM_CD" type="STRING" size="256"/>
          <Column id="MANA_NO" type="STRING" size="256"/>
          <Column id="WOFH_SQ" type="STRING" size="256"/>
          <Column id="BUGS_YM" type="STRING" size="256"/>
          <Column id="DEPM_CD" type="STRING" size="256"/>
          <Column id="WOFH_ST" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_Detail10" oncolumnchanged="ds_Detail10_oncolumnchanged" onvaluechanged="ds_Detail10_onvaluechanged" onrowposchanged="ds_Detail10_onrowposchanged" cancolumnchange="ds_Detail10_cancolumnchange">
        <ColumnInfo>
          <Column id="COMM_CD" type="STRING" size="256"/>
          <Column id="ACCH_NO" type="STRING" size="256"/>
          <Column id="WOFH_SQ" type="STRING" size="256"/>
          <Column id="ATOB_SE" type="STRING" size="256"/>
          <Column id="ACCB_SE" type="STRING" size="256"/>
          <Column id="ACUM_CD" type="STRING" size="256"/>
          <Column id="DECR_GU" type="STRING" size="256"/>
          <Column id="ACOM_CD" type="STRING" size="256"/>
          <Column id="ACOM_NM" type="STRING" size="256"/>
          <Column id="PALM_CD" type="STRING" size="256"/>
          <Column id="PALM_NM" type="STRING" size="256"/>
          <Column id="CRED_AM" type="BIGDECIMAL" size="256"/>
          <Column id="DEBI_AM" type="BIGDECIMAL" size="256"/>
          <Column id="REMK_NM" type="STRING" size="256"/>
          <Column id="MANA_CD" type="STRING" size="256"/>
          <Column id="MANA_NM" type="STRING" size="256"/>
          <Column id="DETA_CD" type="STRING" size="256"/>
          <Column id="DETA_NM" type="STRING" size="256"/>
          <Column id="MA01_CD" type="STRING" size="256"/>
          <Column id="MA02_CD" type="STRING" size="256"/>
          <Column id="MA03_CD" type="STRING" size="256"/>
          <Column id="MA04_CD" type="STRING" size="256"/>
          <Column id="MA05_CD" type="STRING" size="256"/>
          <Column id="MA06_CD" type="STRING" size="256"/>
          <Column id="MA07_CD" type="STRING" size="256"/>
          <Column id="MA08_CD" type="STRING" size="256"/>
          <Column id="MA01_NM" type="STRING" size="256"/>
          <Column id="MA02_NM" type="STRING" size="256"/>
          <Column id="MA03_NM" type="STRING" size="256"/>
          <Column id="MA04_NM" type="STRING" size="256"/>
          <Column id="MA05_NM" type="STRING" size="256"/>
          <Column id="MA06_NM" type="STRING" size="256"/>
          <Column id="MA07_NM" type="STRING" size="256"/>
          <Column id="MA08_NM" type="STRING" size="256"/>
          <Column id="DE01_CD" type="STRING" size="256"/>
          <Column id="DE02_CD" type="STRING" size="256"/>
          <Column id="DE03_CD" type="STRING" size="256"/>
          <Column id="DE04_CD" type="STRING" size="256"/>
          <Column id="DE05_CD" type="STRING" size="256"/>
          <Column id="DE06_CD" type="STRING" size="256"/>
          <Column id="DE07_CD" type="STRING" size="256"/>
          <Column id="DE08_CD" type="STRING" size="256"/>
          <Column id="VDE01_CD" type="STRING" size="256"/>
          <Column id="VDE02_CD" type="STRING" size="256"/>
          <Column id="VDE03_CD" type="STRING" size="256"/>
          <Column id="VDE04_CD" type="STRING" size="256"/>
          <Column id="VDE05_CD" type="STRING" size="256"/>
          <Column id="VDE06_CD" type="STRING" size="256"/>
          <Column id="VDE07_CD" type="STRING" size="256"/>
          <Column id="VDE08_CD" type="STRING" size="256"/>
          <Column id="DE01_NM" type="STRING" size="256"/>
          <Column id="DE02_NM" type="STRING" size="256"/>
          <Column id="DE03_NM" type="STRING" size="256"/>
          <Column id="DE04_NM" type="STRING" size="256"/>
          <Column id="DE05_NM" type="STRING" size="256"/>
          <Column id="DE06_NM" type="STRING" size="256"/>
          <Column id="DE07_NM" type="STRING" size="256"/>
          <Column id="DE08_NM" type="STRING" size="256"/>
          <Column id="MA01_YN" type="STRING" size="256"/>
          <Column id="MA02_YN" type="STRING" size="256"/>
          <Column id="MA03_YN" type="STRING" size="256"/>
          <Column id="MA04_YN" type="STRING" size="256"/>
          <Column id="MA05_YN" type="STRING" size="256"/>
          <Column id="MA06_YN" type="STRING" size="256"/>
          <Column id="MA07_YN" type="STRING" size="256"/>
          <Column id="MA08_YN" type="STRING" size="256"/>
          <Column id="SLIP_YN" type="STRING" size="256"/>
          <Column id="SLIP_NO" type="STRING" size="256"/>
          <Column id="SLIP_DD" type="STRING" size="256"/>
          <Column id="SORT_NO" type="STRING" size="256"/>
          <Column id="BUDG_MM" type="STRING" size="256"/>
          <Column id="BUDP_CD" type="STRING" size="256"/>
          <Column id="BUDP_NM" type="STRING" size="256"/>
          <Column id="ACDE_CD" type="STRING" size="256"/>
          <Column id="ACDE_NM" type="STRING" size="256"/>
          <Column id="REFE_NO" type="STRING" size="256"/>
          <Column id="CURR_CD" type="STRING" size="256"/>
          <Column id="EXCH_RT" type="STRING" size="256"/>
          <Column id="FRDB_AM" type="BIGDECIMAL" size="256"/>
          <Column id="FRCR_AM" type="BIGDECIMAL" size="256"/>
          <Column id="ANTI_NO" type="STRING" size="256"/>
          <Column id="ANTI_SE" type="STRING" size="256"/>
          <Column id="JBGU_CD" type="STRING" size="256"/>
          <Column id="JBAC_NO" type="STRING" size="256"/>
          <Column id="DELE_YN" type="STRING" size="256"/>
          <Column id="EXPT_YN" type="STRING" size="256"/>
          <Column id="EXPT_RE" type="STRING" size="256"/>
          <Column id="REGI_ID" type="STRING" size="256"/>
          <Column id="REGI_NM" type="STRING" size="256"/>
          <Column id="REGI_DT" type="STRING" size="256"/>
          <Column id="MODI_ID" type="STRING" size="256"/>
          <Column id="MODI_NM" type="STRING" size="256"/>
          <Column id="MODI_DT" type="STRING" size="256"/>
          <Column id="DELE_ID" type="STRING" size="256"/>
          <Column id="DELE_NM" type="STRING" size="256"/>
          <Column id="DELE_DT" type="STRING" size="256"/>
          <Column id="s_chk" type="STRING" size="256"/>
          <Column id="crudType" type="STRING" size="256"/>
          <Column id="PRGM_ID" type="STRING" size="256"/>
          <Column id="MANA_NO" type="STRING" size="256"/>
          <Column id="DECR_GU_CHK" type="STRING" size="256"/>
          <Column id="BGCM_YN" type="STRING" size="256"/>
          <Column id="CONF_YN" type="STRING" size="256"/>
          <Column id="WFAT_YN" type="STRING" size="256"/>
          <Column id="WFRE_YN" type="STRING" size="256"/>
          <Column id="ANTI_YN" type="STRING" size="256"/>
          <Column id="CREA_YN" type="STRING" size="256"/>
          <Column id="NUMB_SE" type="STRING" size="256"/>
          <Column id="CTRL_CD" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_Fa040">
        <ColumnInfo>
          <Column id="COMM_CD" type="STRING" size="256"/>
          <Column id="GRCM_CD" type="STRING" size="256"/>
          <Column id="CODM_CD" type="STRING" size="256"/>
          <Column id="CODM_NM" type="STRING" size="256"/>
          <Column id="OP01_NM" type="STRING" size="256"/>
          <Column id="OP02_NM" type="STRING" size="256"/>
          <Column id="OP03_NM" type="STRING" size="256"/>
          <Column id="OP04_NM" type="STRING" size="256"/>
          <Column id="OP05_NM" type="STRING" size="256"/>
          <Column id="OP06_NM" type="STRING" size="256"/>
          <Column id="OP07_NM" type="STRING" size="256"/>
          <Column id="OP08_NM" type="STRING" size="256"/>
          <Column id="OP09_NM" type="STRING" size="256"/>
          <Column id="OP10_NM" type="STRING" size="256"/>
          <Column id="SORT_NO" type="STRING" size="256"/>
          <Column id="USED_YN" type="STRING" size="256"/>
          <Column id="REMK_NM" type="STRING" size="256"/>
          <Column id="EXPT_YN" type="STRING" size="256"/>
          <Column id="EXPT_RE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_Sm020">
        <ColumnInfo>
          <Column id="CODM_CD" type="STRING" size="256"/>
          <Column id="CODM_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_AcomMa">
        <ColumnInfo>
          <Column id="COMM_CD" type="STRING" size="256"/>
          <Column id="ACOM_CD" type="STRING" size="256"/>
          <Column id="ACOM_NM" type="STRING" size="256"/>
          <Column id="MA_CD" type="STRING" size="256"/>
          <Column id="MA_NM" type="STRING" size="256"/>
          <Column id="MA_YN" type="STRING" size="256"/>
          <Column id="TYPE_CD" type="STRING" size="256"/>
          <Column id="TYPE_NM" type="STRING" size="256"/>
          <Column id="LENG_CT" type="STRING" size="256"/>
          <Column id="ITEM_GU" type="STRING" size="256"/>
          <Column id="ITEM_GU_NM" type="STRING" size="256"/>
          <Column id="DETA_CD" type="STRING" size="256"/>
          <Column id="MA_NUM" type="STRING" size="256"/>
          <Column id="CODM_CD" type="STRING" size="256"/>
          <Column id="CD01_NM" type="STRING" size="256"/>
          <Column id="CD02_NM" type="STRING" size="256"/>
          <Column id="FUNC_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_FaBanm">
        <ColumnInfo>
          <Column id="COMM_CD" type="STRING" size="256"/>
          <Column id="BANM_CD" type="STRING" size="256"/>
          <Column id="BANM_NM" type="STRING" size="256"/>
          <Column id="BANM_GU" type="STRING" size="256"/>
          <Column id="BANS_NM" type="STRING" size="256"/>
          <Column id="SAUM_NO" type="STRING" size="256"/>
          <Column id="OTEL_NO" type="STRING" size="256"/>
          <Column id="POST_NO" type="STRING" size="256"/>
          <Column id="ADDR_NM" type="STRING" size="256"/>
          <Column id="SORT_NO" type="STRING" size="256"/>
          <Column id="USED_YN" type="STRING" size="256"/>
          <Column id="REMK_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_CmMaInfo" oncolumnchanged="ds_CmMaInfo_oncolumnchanged">
        <ColumnInfo>
          <Column id="ITEM_GU" type="STRING" size="256"/>
          <Column id="COMP_CD" type="STRING" size="256"/>
          <Column id="COMP_NM" type="STRING" size="256"/>
          <Column id="VDE01_CD" type="STRING" size="256"/>
          <Column id="DE01_CD" type="STRING" size="256"/>
          <Column id="DE01_NM" type="STRING" size="256"/>
          <Column id="VDE02_CD" type="STRING" size="256"/>
          <Column id="DE02_CD" type="STRING" size="256"/>
          <Column id="DE02_NM" type="STRING" size="256"/>
          <Column id="VDE03_CD" type="STRING" size="256"/>
          <Column id="DE03_CD" type="STRING" size="256"/>
          <Column id="DE03_NM" type="STRING" size="256"/>
          <Column id="VDE04_CD" type="STRING" size="256"/>
          <Column id="DE04_CD" type="STRING" size="256"/>
          <Column id="DE04_NM" type="STRING" size="256"/>
          <Column id="VDE05_CD" type="STRING" size="256"/>
          <Column id="DE05_CD" type="STRING" size="256"/>
          <Column id="DE05_NM" type="STRING" size="256"/>
          <Column id="VDE06_CD" type="STRING" size="256"/>
          <Column id="DE06_CD" type="STRING" size="256"/>
          <Column id="DE06_NM" type="STRING" size="256"/>
          <Column id="VDE07_CD" type="STRING" size="256"/>
          <Column id="DE07_CD" type="STRING" size="256"/>
          <Column id="DE07_NM" type="STRING" size="256"/>
          <Column id="VDE08_CD" type="STRING" size="256"/>
          <Column id="DE08_CD" type="STRING" size="256"/>
          <Column id="DE08_NM" type="STRING" size="256"/>
          <Column id="DETA_CD" type="STRING" size="256"/>
          <Column id="DETA_NM" type="STRING" size="256"/>
          <Column id="VDETA_CD" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_AtobProc">
        <ColumnInfo>
          <Column id="COMM_CD" type="STRING" size="256"/>
          <Column id="AUTM_CD" type="STRING" size="256"/>
          <Column id="PRGM_ID" type="STRING" size="256"/>
          <Column id="MANA_NO" type="STRING" size="256"/>
          <Column id="WOFH_SQ" type="STRING" size="256"/>
          <Column id="REGI_ID" type="STRING" size="256"/>
          <Column id="REGI_NM" type="STRING" size="256"/>
          <Column id="KEY_01" type="STRING" size="256"/>
          <Column id="KEY_02" type="STRING" size="256"/>
          <Column id="KEY_03" type="STRING" size="256"/>
          <Column id="KEY_04" type="STRING" size="256"/>
          <Column id="KEY_05" type="STRING" size="256"/>
          <Column id="KEY_06" type="STRING" size="256"/>
          <Column id="KEY_07" type="STRING" size="256"/>
          <Column id="KEY_08" type="STRING" size="256"/>
          <Column id="KEY_09" type="STRING" size="256"/>
          <Column id="KEY_10" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_AtobRt">
        <ColumnInfo>
          <Column id="O_RET_CODE" type="STRING" size="256"/>
          <Column id="O_RET_CMSG" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_Detail11">
        <ColumnInfo>
          <Column id="COMM_CD" type="STRING" size="256"/>
          <Column id="BUGS_YM" type="STRING" size="256"/>
          <Column id="DEPM_CD" type="STRING" size="256"/>
          <Column id="ACOM_CD" type="STRING" size="256"/>
          <Column id="BGMM_AM" type="STRING" size="256"/>
          <Column id="BGAD_AM" type="STRING" size="256"/>
          <Column id="BGCH_AM" type="STRING" size="256"/>
          <Column id="BGSU_AM" type="STRING" size="256"/>
          <Column id="BGAC_AM" type="STRING" size="256"/>
          <Column id="BGSL_AM" type="STRING" size="256"/>
          <Column id="REAC_AM" type="STRING" size="256"/>
          <Column id="RESL_AM" type="STRING" size="256"/>
          <Column id="USED_AM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_Detail12">
        <ColumnInfo>
          <Column id="COMM_CD" type="STRING" size="256"/>
          <Column id="BUGS_YM" type="STRING" size="256"/>
          <Column id="DEPM_CD" type="STRING" size="256"/>
          <Column id="ACOM_CD" type="STRING" size="256"/>
          <Column id="ACOM_NM" type="STRING" size="256"/>
          <Column id="USED_AM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_Detail13">
        <ColumnInfo>
          <Column id="COMM_CD" type="STRING" size="256"/>
          <Column id="BUGS_YM" type="STRING" size="256"/>
          <Column id="DEPM_CD" type="STRING" size="256"/>
          <Column id="ACOM_CD" type="STRING" size="256"/>
          <Column id="BGAC_AM" type="STRING" size="256"/>
          <Column id="crudType" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_EmPalm">
        <ColumnInfo>
          <Column id="COMM_CD" type="STRING" size="256"/>
          <Column id="SYST_ID" type="STRING" size="256"/>
          <Column id="EMPM_CD" type="STRING" size="256"/>
          <Column id="EMPM_NM" type="STRING" size="256"/>
          <Column id="PALM_CD" type="STRING" size="256"/>
          <Column id="PALM_NM" type="STRING" size="256"/>
          <Column id="DEPM_CD" type="STRING" size="256"/>
          <Column id="DEPM_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_SdCbabFull">
        <ColumnInfo>
          <Column id="COMM_CD" type="STRING" size="256"/>
          <Column id="CUSM_CD" type="STRING" size="256"/>
          <Column id="WOFH_SQ" type="STRING" size="256"/>
          <Column id="CBAB_SE" type="STRING" size="256"/>
          <Column id="ACNO_GU" type="STRING" size="256"/>
          <Column id="BANM_CD" type="STRING" size="256"/>
          <Column id="ACNM_NO" type="STRING" size="256"/>
          <Column id="ACNM_CD" type="STRING" size="256"/>
          <Column id="ACNM_FULL" type="STRING" size="256"/>
          <Column id="ACEM_NM" type="STRING" size="256"/>
          <Column id="CBAB_YN" type="STRING" size="256"/>
          <Column id="USED_YN" type="STRING" size="256"/>
          <Column id="CHAN_NM" type="STRING" size="256"/>
          <Column id="REMK_NM" type="STRING" size="256"/>
          <Column id="ACNO_NM" type="STRING" size="256"/>
          <Column id="BANM_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_Master10" onrowposchanged="ds_Master10_onrowposchanged" canrowposchange="ds_Master10_canrowposchange" oncolumnchanged="ds_Master10_oncolumnchanged">
        <ColumnInfo>
          <Column id="COMM_CD" type="STRING" size="256"/>
          <Column id="ACCH_NO" type="STRING" size="256"/>
          <Column id="WOFH_SQ" type="STRING" size="256"/>
          <Column id="WOFH_YN" type="STRING" size="256"/>
          <Column id="WOFH_YN_NM" type="STRING" size="256"/>
          <Column id="ACCH_DD" type="STRING" size="256"/>
          <Column id="DEPM_CD" type="STRING" size="256"/>
          <Column id="DEPM_NM" type="STRING" size="256"/>
          <Column id="EMPM_CD" type="STRING" size="256"/>
          <Column id="EMPM_NM" type="STRING" size="256"/>
          <Column id="SYST_ID" type="STRING" size="256"/>
          <Column id="ACUM_CD" type="STRING" size="256"/>
          <Column id="ACUM_NM" type="STRING" size="256"/>
          <Column id="ACCH_GU" type="STRING" size="256"/>
          <Column id="ACCH_GU_NM" type="STRING" size="256"/>
          <Column id="ACTY_CD" type="STRING" size="256"/>
          <Column id="ACTY_NM" type="STRING" size="256"/>
          <Column id="ACCH_NM" type="STRING" size="256"/>
          <Column id="ACRE_NM" type="STRING" size="256"/>
          <Column id="ACCH_AM" type="STRING" size="256"/>
          <Column id="PARE_DD" type="STRING" size="256"/>
          <Column id="PACS_GU" type="STRING" size="256"/>
          <Column id="PACS_GU_NM" type="STRING" size="256"/>
          <Column id="PACS_CD" type="STRING" size="256"/>
          <Column id="PACS_NM" type="STRING" size="256"/>
          <Column id="PABA_CD" type="STRING" size="256"/>
          <Column id="PABA_NM" type="STRING" size="256"/>
          <Column id="PAAC_NO" type="STRING" size="256"/>
          <Column id="IPARE_DD" type="STRING" size="256"/>
          <Column id="IPACS_GU" type="STRING" size="256"/>
          <Column id="IPACS_CD" type="STRING" size="256"/>
          <Column id="IPACS_NM" type="STRING" size="256"/>
          <Column id="IPABA_CD" type="STRING" size="256"/>
          <Column id="IPABA_NM" type="STRING" size="256"/>
          <Column id="IPAAC_NO" type="STRING" size="256"/>
          <Column id="SLIP_YN" type="STRING" size="256"/>
          <Column id="SLIP_NO" type="STRING" size="256"/>
          <Column id="SLIP_DD" type="STRING" size="256"/>
          <Column id="SLIP_EMP_NO" type="STRING" size="256"/>
          <Column id="SLIP_EMP_NM" type="STRING" size="256"/>
          <Column id="SLIP_ID" type="STRING" size="256"/>
          <Column id="SLIP_NM" type="STRING" size="256"/>
          <Column id="SLIP_DEPMCD" type="STRING" size="256"/>
          <Column id="SLIP_DEPMNM" type="STRING" size="256"/>
          <Column id="TRAN_YN" type="STRING" size="256"/>
          <Column id="DELE_YN" type="STRING" size="256"/>
          <Column id="WOFH_NO" type="STRING" size="256"/>
          <Column id="WOFH_ST" type="STRING" size="256"/>
          <Column id="WOFH_ST_NM" type="STRING" size="256"/>
          <Column id="REMK_NM" type="STRING" size="256"/>
          <Column id="EXPT_YN" type="STRING" size="256"/>
          <Column id="EXPT_RE" type="STRING" size="256"/>
          <Column id="REGI_ID" type="STRING" size="256"/>
          <Column id="REGI_NM" type="STRING" size="256"/>
          <Column id="REGI_DT" type="STRING" size="256"/>
          <Column id="MODI_ID" type="STRING" size="256"/>
          <Column id="MODI_NM" type="STRING" size="256"/>
          <Column id="MODI_DT" type="STRING" size="256"/>
          <Column id="DELE_ID" type="STRING" size="256"/>
          <Column id="DELE_NM" type="STRING" size="256"/>
          <Column id="DELE_DT" type="STRING" size="256"/>
          <Column id="PRGM_ID" type="STRING" size="256"/>
          <Column id="MANA_NO" type="STRING" size="256"/>
          <Column id="crudType" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_ItemList">
        <ColumnInfo>
          <Column id="COMM_CD" type="STRING" size="256"/>
          <Column id="ITEM_CD" type="STRING" size="256"/>
          <Column id="ITEM_NM" type="STRING" size="256"/>
          <Column id="TYPE_CD" type="STRING" size="256"/>
          <Column id="LENG_CT" type="STRING" size="256"/>
          <Column id="ITEM_GU" type="STRING" size="256"/>
          <Column id="DETA_CD" type="STRING" size="256"/>
          <Column id="CODM_CD" type="STRING" size="256"/>
          <Column id="FUNC_NM" type="STRING" size="256"/>
          <Column id="CD01_NM" type="STRING" size="256"/>
          <Column id="CD02_NM" type="STRING" size="256"/>
          <Column id="BALA_YN" type="STRING" size="256"/>
          <Column id="PREP_CD" type="STRING" size="256"/>
          <Column id="SORT_NO" type="STRING" size="256"/>
          <Column id="USED_YN" type="STRING" size="256"/>
          <Column id="REMK_NM" type="STRING" size="256"/>
          <Column id="REGI_ID" type="STRING" size="256"/>
          <Column id="REGI_NM" type="STRING" size="256"/>
          <Column id="REGI_DT" type="STRING" size="256"/>
          <Column id="MODI_ID" type="STRING" size="256"/>
          <Column id="MODI_NM" type="STRING" size="256"/>
          <Column id="MODI_DT" type="STRING" size="256"/>
          <Column id="DELE_ID" type="STRING" size="256"/>
          <Column id="DELE_NM" type="STRING" size="256"/>
          <Column id="DELE_DT" type="STRING" size="256"/>
          <Column id="COPY_YN" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Script type="xscript5.1"><![CDATA[/**
*  @화면ID   : cmmFaAtob
*  @화면설명 : 자동전표미리보기
*  @시스템명 : (FA) 재무회계
*  @작성자   : 최석목
*  @작성일   : 2021.07.26
*  @Desction    
******************* 소스 수정 이력 ************************************************************
*  일자          		수정자                비고
*************************************************************************************************
*  2021.07.26     	    최석목 	           최초 생성 
*************************************************************************************************
*/    
       
/***********************************************************************************************
 * 0. 폼로드
 ***********************************************************************************************/
/***********************************************************************************************
 * 00.01. Form Include 선언
 ***********************************************************************************************/

  
/***********************************************************************************************
 * 00.02. Form 변수 선언
 ***********************************************************************************************/
this.fvComPrgmId = "";//[필수]프로그램ID-메인화면기준, 팝업일경우 해당 메인화면의 프로그램ID

//자동전표 미리보기 조회용 Key
this.fvCmAtobPrgmId = "";//프로그램ID
this.fvCmAtobManaNo = "";//관리번호-업무Key
this.fvCmAtobWofhSq = "";//결재차수
this.fvCmAtobWofhSt = "";//결재상태

//관리항목 팝업 콜백관련 변수
this.fvCmMaPopupId01 = "";//팝업호출ID-01
this.fvCmMaRtnColCd01 = "";//팝업리턴 코드변수-01
this.fvCmMaRtnVColCd01 = "";//팝업리턴 코드변수-01
this.fvCmMaRtnColNm01 = "";//팝업리턴 코드명변수-01
this.fvCmMaPopupId02 = "";//팝업호출ID-02
this.fvCmMaRtnColCd02 = "";//팝업리턴 코드변수-02
this.fvCmMaRtnVColCd02 = "";//팝업리턴 코드변수-02
this.fvCmMaRtnColNm02 = "";//팝업리턴 코드명변수-02
this.fvCmMaPopupId03 = "";//팝업호출ID-03
this.fvCmMaRtnColCd03 = "";//팝업리턴 코드변수-03
this.fvCmMaRtnVColCd03 = "";//팝업리턴 코드변수-03
this.fvCmMaRtnColNm03 = "";//팝업리턴 코드명변수-03
this.fvCmMaPopupId04 = "";//팝업호출ID-04
this.fvCmMaRtnColCd04 = "";//팝업리턴 코드변수-04
this.fvCmMaRtnVColCd04 = "";//팝업리턴 코드변수-04
this.fvCmMaRtnColNm04 = "";//팝업리턴 코드명변수-04
this.fvCmMaPopupId05 = "";//팝업호출ID-05
this.fvCmMaRtnColCd05 = "";//팝업리턴 코드변수-05
this.fvCmMaRtnVColCd05 = "";//팝업리턴 코드변수-05
this.fvCmMaRtnColNm05 = "";//팝업리턴 코드명변수-05
this.fvCmMaPopupId06 = "";//팝업호출ID-06
this.fvCmMaRtnColCd06 = "";//팝업리턴 코드변수-06
this.fvCmMaRtnVColCd06 = "";//팝업리턴 코드변수-06
this.fvCmMaRtnColNm06 = "";//팝업리턴 코드명변수-06
this.fvCmMaPopupId07 = "";//팝업호출ID-07
this.fvCmMaRtnColCd07 = "";//팝업리턴 코드변수-07
this.fvCmMaRtnVColCd07 = "";//팝업리턴 코드변수-07
this.fvCmMaRtnColNm07 = "";//팝업리턴 코드명변수-07
this.fvCmMaPopupId08 = "";//팝업호출ID-08
this.fvCmMaRtnColCd08 = "";//팝업리턴 코드변수-08
this.fvCmMaRtnVColCd08 = "";//팝업리턴 코드변수-08
this.fvCmMaRtnColNm08 = "";//팝업리턴 코드명변수-08
this.wfreYn = ""; //자동전표재실행여부
this.scrnEnable = true; //화면 이벤트 활성화

this.fvBCalAvailAmt = false;//가용금액계산여부
this.fvGridForcusYn = false;//그리드포커스여부-메세지무한출력때문에 추가

this.fvResetMode = false;//리셋모드여부
this.fvWofhStatus = false; // 결재진행상태
this.fvMasterSearchMode = false;//마스터내역 조회중여부
 
this.dsAcomMaSetYn = "SET";  // 복사시 관리항목세팅구분자 SET 으로 할지 여부

//반제전표찾기
this.fvDsRowPosChangeDetail = true;//데이터셋 Row 변경이벤트-실행유무
this.fvDetailGu = false;

this.fvOrgDebiAmt =0;  // 차변금액 입력 오류시 이전금액을 넣는다.
this.fvOrgCredAmt =0;  // 대변금액 입력 오류시 이전금액을 넣는다.


/***********************************************************************************************
 * 00.03. Form Onload 이벤트
 ***********************************************************************************************/
this.fn_FormOnload = function (obj:Form, e:LoadEventInfo)
{
	this.fn_FormComInit();//[공통] 화면로드시 초기 설정 함수
	this.fn_FormBizInit();//[업무] 화면로드시 초기 설정 함수 

}

/***********************************************************************************************
 * 00.04. Form [공통] 초기설정 함수 - 필수
 ***********************************************************************************************/
this.fn_FormComInit = function() 
{
	this.gfn_CommFormOnLoad(this);//[공통] 화면로드시 처리 함수(다국어등)
	this.gfn_SetGrid(this.grd_Detail10);//[공통]그리드 이벤트 설정 - 출력목록
	this.div_detailRight.form.div_Budget.set_enable(false);
	this.grd_Detail10.set_readonly(true);
	this.div_ComGrdBtn.set_enable(false);// 행 버튼  
	this.btn_banFind.set_enable(false);  // 반제전표
	this.div_detailRight.set_enable(false); 
	
	this.grd_Detail10.set_top(0);
	
	var objCompCheckList = ["this.div_ComGrdBtn"];		
	if (this.gfn_CommCompAuthCheck(this, objCompCheckList))
	{
		this.fvFormComBtnAuthYn = true;//그리드 공통버튼 권한 유무
	}
	
	
	this.fn_SetGridInputButton();//[공통] 그리드 입력 버튼 설정
	
}

/***********************************************************************************************
 * 00.05. Form [업무] 초기설정 함수
 ***********************************************************************************************/
this.fn_FormBizInit = function() 
{ 

	//[공통] 공통코드 설정 : 공통코드|데이터셋명|초기항목추가여부(Y/N)|추가항목
	//ds_Fa026 //차대구분
	var objCondList = ["FA040|ds_Fa040","SM020|ds_Sm020"];
	//공통코드 설정함수 호출				   
	this.gfn_GetCommCode(this, objCondList, "");

	//차대구분filter
	this.ds_Fa040.filter();
	this.ds_Fa040.filter("OP01_NM == '1'");

	//[업무] 일반콤보조회
	this.fn_ComboSearch();

}

/***********************************************************************************************
 * 00.06. Form [업무] 일반콤보 조회 함수
 ***********************************************************************************************/
this.fn_ComboSearch = function() 
{
	
	//this.ds_Item.clearData();
	this.ds_Input.clearData();
	this.ds_Input.addRow();

	//[공통]서비스정보 초기화
	this.gfn_InitComService(this);
	
	var acumCd = this.ds_Master10.getColumn(0, "ACUM_CD");
	if(this.gfn_IsNull(acumCd)){
		acumCd = this.gfn_GetSessionValue("ACUM_CD");
	}
	this.ds_Input.setColumn(0, "ACUM_CD", acumCd);  //회계단위
	
	
	//[공통]서비스정보 추가
	var svcAddObj = new Object();//[공통] 서비스 추가 파라메타 정보 Object
// 	svcAddObj.sSelectSql = "sd:M_SD_CBAB_C_SL30";	//사업자
// 	this.gfn_AddComSearchService(this, svcAddObj);
 	svcAddObj.sSelectSql = "fa:M_FA_1000_D_SL14";	//사업자
 	this.gfn_AddComSearchService(this, svcAddObj);
	svcAddObj.sSelectSql = "fa:M_FA_0030_M_SL10";	//관리항목리스트
	this.gfn_AddComSearchService(this, svcAddObj);

	//[공통]서비스 호출 변수
	var svcCallObj = new Object();//[공통] 서비스 파라메타 정보 Object
	svcCallObj.sTrid = "COMBO_SEARCH";//Transaction ID 등 callback에서 넘겨 받을 String을 지정
	svcCallObj.sActionName = this.G_SV_SD;//서버에서 호출할 Action - 모듈별로 호출되는 기본 Actio이 다름 : 공통 서비스 Action 업무구분  변수 참조
	svcCallObj.sInputDaset = "ds_Input=ds_Input" //입력 데이터셋
	//svcCallObj.sOutDatset = "ds_SdCbabFull=ds_SdCbabFull ds_EmPalm=ds_EmPalm ds_ItemList=ds_Master10";//출력 데이터셋
	svcCallObj.sOutDatset = "ds_EmPalm=ds_EmPalm ds_ItemList=ds_Master10";//출력 데이터셋
	svcCallObj.sOtherArg = "";//서버로 전송할 기타 Argument 정보 문자열, 예) key=value key2=value2
	svcCallObj.sCallBackFnc = "fn_Callback";//서버에서 처리가 완료된 후 Callback 받을 Function 명
	svcCallObj.isSync = true;//동기식으로 설정할지 여부
	//[공통]서비스 호출
	this.gfn_CallComService(this, svcCallObj);
}

/***********************************************************************************************
 * 00.07. Form OnClose 이벤트
 ***********************************************************************************************/
this.fn_FormClose = function(obj:nexacro.Form,e:nexacro.CloseEventInfo)
{
	//현재 이벤트를 상위컴포넌트로 전파하지 않게 중지시키는 메소드
	e.stopPropagation(); 
};

/***********************************************************************************************
 * 1. 조회 영역
 ***********************************************************************************************/
/***********************************************************************************************
 * 01.01. [공통버튼] 조회 버튼 클릭 이벤트
 ***********************************************************************************************/
this.fn_ComBtnSearch = function(objParm)
{ 


	this.fvMasterSearchMode = false;//마스터내역 조회중여부
	
	
	//[업무] 데이터셋 설정 - 데이터셋 초기화, 조회조건 설정
	this.ds_Detail10.clearData();
	this.ds_Input.clearData();
	
	//[업무] 조회조건 입력
	this.ds_Input.addRow();	

	this.ds_Input.setColumn(0, "PRGM_ID", objParm.PRGM_ID);	//프로그램ID
	this.ds_Input.setColumn(0, "MANA_NO", objParm.MANA_NO);	//관리번호
	this.ds_Input.setColumn(0, "WOFH_SQ", objParm.WOFH_SQ);	//결재차수
	this.ds_Input.setColumn(0, "WOFH_ST", objParm.WOFH_ST);	//결재상태
	
	//trace(" objParm.WOFH_ST = " +  objParm.WOFH_ST);
	this.fvCmAtobWofhSt = objParm.WOFH_ST;

	//[공통]서비스정보 초기화
	this.gfn_InitComService(this);
	
	//[공통]서비스정보 추가
	var svcAddObj = new Object();//[공통] 서비스 추가 파라메타 정보 Object
	svcAddObj.sSelectSql = "fa:M_FA_ATOB_M_SL10";	//BODY
	this.gfn_AddComSearchService(this, svcAddObj);
	svcAddObj.sSelectSql = "fa:M_FA_ATRG_M_SL10";	//HEAD
	this.gfn_AddComSearchService(this, svcAddObj);
	
	//[공통]서비스 호출 변수
	var svcCallObj = new Object();//[공통] 서비스 파라메타 정보 Object
	svcCallObj.sTrid = "ATOB_SEARCH";//Transaction ID 등 callback에서 넘겨 받을 String을 지정
	svcCallObj.sActionName = this.G_SV_FA;//서버에서 호출할 Action - 모듈별로 호출되는 기본 Actio이 다름 : 공통 서비스 Action 업무구분  변수 참조
	svcCallObj.sInputDaset = "ds_Input=ds_Input" //입력 데이터셋
	svcCallObj.sOutDatset = "ds_Detail10=ds_Detail10 ds_Master10=ds_Master10";//출력 데이터셋
	svcCallObj.sOtherArg = "";//서버로 전송할 기타 Argument 정보 문자열, 예) key=value key2=value2
	svcCallObj.sCallBackFnc = "fn_Callback";//서버에서 처리가 완료된 후 Callback 받을 Function 명
	svcCallObj.isSync = true;//동기식으로 설정할지 여부

	//[공통]서비스 호출
	this.gfn_CallComService(this, svcCallObj);	
	

}

/***********************************************************************************************
 * 01.02. [Vaildation] 조회 필수값 체크
 ***********************************************************************************************/
this.fn_VaildSearch = function()
{

	//조회조건 필수입력값 있으면 체크
	return true;
}

/***********************************************************************************************
 * 02.DG0.06. [Detail그리드] 셀 클릭 이벤트
 ***********************************************************************************************/ 
/*---------------------------------------------------------------------------------------------
 *    01. [그리드-grd_Detail10] 셀클릭 이벤트
  ---------------------------------------------------------------------------------------------*/
this.div_DetailInput_tab_Detail_tpg_01_grd_Detail10_oncellclick = function(obj:nexacro.Grid,e:nexacro.GridClickEventInfo)
{	
	if (this.ds_Detail10.rowposition < 0) {
		return;
	}
	
	//그리드 콤보 및 캘린더 클릭시 펼치기
	obj.dropdownCombo();
	obj.dropdownCalendar();
		 
	var sCONF_YN = this.ds_Detail10.getColumn(this.ds_Detail10.rowposition, "CONF_YN");//마감여부
	
	//마감되었으면 팝업호출 안됨.
	if (sCONF_YN == "1" && e.col != 12) {
		return;
	}
	//자동전표재실행여부가 아니면
	if(this.wfreYn == "1"){
		return;
	}
	//화면활성화
	if(!this.scrnEnable){
		return;
	}
	
	//return;//팝업호출 안함
	
	if (e.col == 6) {
		//결재진행상태가 아닌경우
		if (!this.fvWofhStatus) {
		   //계정
			var sPopupId = "S_ACOM_CD_01";//팝업ID - 계정코드
			var oArg = { AcomNm:this.ds_Detail10.getColumn(this.ds_Detail10.rowposition, "ACOM_CD")};//Argument처리
			this.gfn_AcomPop(sPopupId, oArg);  
		}
	} else if (e.col == 8){
		//결재진행상태가 아닌경우
		if (!this.fvWofhStatus) {
			//손익
			var sPopupId = "B_PALM_CD_01";//팝업ID - 손익코드
			var oArg = { PalmCd:"", PalmNm:"" };//Argument처리
			this.gfn_PalmPop(sPopupId, oArg);
		}
	} else if (e.col == 12){
		//적요
		if (!this.gfn_IsNull(this.ds_Detail10.getColumn(this.ds_Detail10.rowposition, "REMK_NM"))) {
			var sPopupId = "B_REMK_01";//팝업ID - 비고상세
			var sTitle = "적요";//팝업 타이틀
			var oArg = {  Remk:this.ds_Detail10.getColumn(this.ds_Detail10.rowposition, "REMK_NM")};//Argument처리
			this.gfn_RemkPop(sPopupId, sTitle, oArg);		
		}
	} else if (e.col == 14){
		//결재진행상태가 아닌경우
		if (!this.fvWofhStatus) {
			//예산부서 BUDP_NM
			var sPopupId = "B_DEPM_CD_01";//팝업ID - 부서코드
			var oArg = { BudpNm:""};  // Argument처리
			this.gfn_DeptPop(sPopupId, oArg);
		}
	}
};

/***********************************************************************************************
 *    01. [그리드-grd_Detail10] enterkey 이벤트
 ***********************************************************************************************/ 
this.div_DetailInput_tab_Detail_tpg_01_grd_Detail10_onenterdown = function(obj:nexacro.Grid,e:nexacro.GridEditEventInfo)
{
	//자동전표재실행여부가 아니면
	if(this.wfreYn == "1"){
		return;
	}
	//화면활성화
	if(!this.scrnEnable){
		return;
	}
	obj.moveToNextCell();
};


/***********************************************************************************************
 *    01. [그리드-grd_Detail10] enterkey 이벤트
 ***********************************************************************************************/ 
this.div_DetailInput_tab_Detail_tpg_01_grd_Detail10_onnodataareadblclick = function(obj:nexacro.Grid,e:nexacro.MouseEventInfo)
{

	//자동전표재실행여부가 아니면
	if(this.wfreYn == "1"){
		return;
	}
	//화면활성화
	if(!this.scrnEnable){
		return;
	}
	
	this.fvGridForcusYn = true;//그리드포커스여부-메세지무한출력때문에 추가
	//add row
	this.fn_DetailGrd01AddRow();
};


/***********************************************************************************************
 *    02. [그리드-grd_Detail10] onsetFocus 이벤트
 ***********************************************************************************************/ 
this.div_DetailInput_tab_Detail_tpg_01_grd_Detail10_onsetfocus = function(obj:nexacro.Grid,e:nexacro.SetFocusEventInfo)
{
	//그리드포커스여부-메세지무한출력때문에 추가
	if (this.fvGridForcusYn) {
		return;
	}
	
	//자동전표재실행여부가 아니면
	if(this.wfreYn == "1"){
		return;
	}
	//화면활성화
	if(!this.scrnEnable){
		return;
	}
	
	
	if(this.ds_Detail10.rowcount == 0){
		this.fvGridForcusYn = true;//그리드포커스여부-메세지무한출력때문에 추가
		//ds_Detail add Row
		this.fn_DetailGrd01AddRow();
		
	}
};


/***********************************************************************************************
 * 02.DG0.07. [Detail 데이터셋] 변경 이벤트
 ***********************************************************************************************/

/*---------------------------------------------------------------------------------------------
 *    01. [데이터셋-ds_Detail10] 데이터변경 이벤트
  ---------------------------------------------------------------------------------------------*/  
this.ds_Detail10_oncolumnchanged = function(obj:nexacro.NormalDataset,e:nexacro.DSColChangeEventInfo)
{
	//trace("===============this.ds_Detail10_oncolumnchanged================" + e.columnid);
	//trace("===============this.ds_Detail10_oncolumnchanged================  "+e.row + "   " + obj.getColumn(e.row, "ACUM_CD"));

	var sDecrGu="";

	if (!this.fvDsRowPosChangeDetail) return;//반제전표에서 가져올때는 이벤트를 타지않게한다
	
	
	var bCheckBgcm = false;//예산편성계정여부

	this.gfn_GridUpdateProcess(this, obj, e);//crudType 변경-수정(U)
	
	
	if(e.columnid == "ACUM_CD"){
	
			//trace("111===============this.ds_Detail10_oncolumnchanged================  "+e.row + "   " + obj.getColumn(e.row, "ACUM_CD"));
	}
	//예산부서명
	else if(e.columnid == "BUDP_CD"){
		this.fn_GetBudg();//예산통제정보 조회
		//this.gfn_GetCommDepmGrid(obj, "BUDP_CD", "BUDP_NM");//부서명 검색
	} else if(e.columnid == "PALM_NM"){
		//this.gfn_GetCommPalmGrid(obj, "PALM_CD", "PALM_NM");//손익 검색
		if(this.gfn_IsNull(e.newvalue) || e.newvalue ==""){
			this.ds_Detail10.setColumn(e.row, "PALM_CD", "")
		}
	//대변금액
	} else if(e.columnid == "CRED_AM"){
	
		this.fvOrgCredAmt = e.oldvalue; // 이전 대변금액
		//this.ds_Detail10.set_enableevent(false);
		//차대구분 변경
		sDecrGu = this.ds_Detail10.getColumn(e.row, "DECR_GU");
		this.ds_Detail10.setColumn(e.row, "FRDB_AM", 0);
		if(e.newvalue != 0){
			this.ds_Detail10.setColumn(e.row, "DECR_GU", "C");
		}
// 		//금액이 0 이 아니었다가 0 으로 변경시 계정의 차대구분을 넣는다.
// 		if(e.newvalue == 0 && e.oldvalue != 0){
// 			this.ds_Detail10.setColumn(e.row, "DECR_GU", this.ds_Detail10.getColumn(e.row, "DECR_GU_CHK"));
// 		}
		
	
	
		//master10 금액에 차변금액 자동 입력
		this.fn_AcchAmt();
		if (!this.fvBCalAvailAmt) {
			this.fn_CalAvailAm();//가용금액 계산
		}		
		
		
		
		//관리항목 자동입력
		this.fn_maAutoInput(e.row, "CRED_AM");
		
		// event trriger
		//if(sDecrGu != "C"){
		e.columnid = "DECR_GU";
		e.newvalue = "C";
		e.oldvalue = sDecrGu;
		this.ds_Detail10_oncolumnchanged(obj, e);
		//}
		//this.ds_Detail10.set_enableevent(true);
		
	//차변금액
	} else if(e.columnid == "DEBI_AM"){	
	
		this.fvOrgDebiAmt = e.oldvalue;//이전 차변금액
		//this.ds_Detail10.set_enableevent(false);
		//차대구분 변경
		sDecrGu = this.ds_Detail10.getColumn(e.row, "DECR_GU");
		this.ds_Detail10.setColumn(e.row, "FRCR_AM", 0);
		
		if(e.newvalue !=  0){
			this.ds_Detail10.setColumn(e.row, "DECR_GU", "D");
		}
	
// 		//금액이 0 이 아니었다가 0 으로 변경시 계정의 차대구분을 넣는다.
// 		if(e.newvalue == 0 && e.oldvalue != 0){
// 			this.ds_Detail10.setColumn(e.row, "DECR_GU", this.ds_Detail10.getColumn(e.row, "DECR_GU_CHK"));
// 		}
	
	
	
		if (!this.fvBCalAvailAmt) {
			this.fn_CalAvailAm();//가용금액 계산
		}	
		
		////trace("===1");
		// event trriger
		//if(sDecrGu != "D"){
		
		
		
		//관리항목 자동입력
		this.fn_maAutoInput(e.row, "DEBI_AM");
		
		
		e.columnid = "DECR_GU";
		e.newvalue = "D";
		e.oldvalue = sDecrGu;
		//trace("===2");
		this.ds_Detail10_oncolumnchanged(obj, e);
		//}
		
		//this.ds_Detail10.set_enableevent(true);
		
		
	//계정코드
	} else if(e.columnid == "ACOM_CD"){
	    
		var arrArgs = ["DECR_GU_CHK"
		              , "CTRL_CD"
					  , "ANTI_YN"
					  ];
		this.gfn_GetCommAcomGrid(obj, "ACOM_CD", "ACOM_NM", arrArgs, "fn_CommAcomCallbackFunc"); // 계정명검색	


		this.ds_Detail10.setColumn(this.ds_Detail10.rowposition, "CURR_CD", "0090");
		this.ds_Detail10.setColumn(this.ds_Detail10.rowposition, "EXCH_RT", 1);
		this.ds_Detail10.setColumn(this.ds_Detail10.rowposition, "FRDB_AM", 0);
		this.ds_Detail10.setColumn(this.ds_Detail10.rowposition, "FRCR_AM", 0);
		
		
	//차대구분
	} else if (e.columnid == "DECR_GU"){
		////trace("===3");
		/**
		반제계정인경우 차대구분 변경 불가
		**/
		
		var sDECR_GU = this.ds_Detail10.getColumn(e.row, "DECR_GU");//차대구분
		var sDECR_GU_CHK = this.ds_Detail10.getColumn(e.row, "DECR_GU_CHK");//차대구분-계정
		var sAntiNo =  this.ds_Detail10.getColumn(e.row, "ANTI_NO");//
		
		
		//if(obj.getColumn(e.row, "ANTI_YN") == "1" && e.newvalue != e.oldvalue){
		if(obj.getColumn(e.row, "ANTI_YN") == "1" && (this.gfn_IsNull(sAntiNo) || sAntiNo =="") && sDECR_GU != sDECR_GU_CHK){
	  	
			//this.gfn_Alert("FA022");  //반제계정은 차대구분을 변경 할 수 없습니다.
			//trace("차대구분을 변경 할 수 없습니다.");
			
			//this.gfn_Alert("FA022", arrMsgArg);  //반제계정은 차대구분을 변경 할 수 없습니다.
			var sDEcrGuNm = "";
			if(e.newvalue == "D"){
				sDEcrGuNm = "대변";
			}else{
				sDEcrGuNm = "차변";
			}
			
			//trace("sDEcrGuNm = " + sDEcrGuNm);
			var arrMsgArg = [sDEcrGuNm];
			this.gfn_Alert("FA020", arrMsgArg); //반제계정은 [ &ITM0 ] 만 가능합니다. 
			
			
			
			obj.setColumn(e.row, "DECR_GU", e.oldvalue);
			
			
			
			if(e.newvalue =="D"){
				//대변
				//trace("newvalue = " + e.newvalue);
				this.ds_Detail10.setColumn(e.row, "DEBI_AM", 0);
				this.ds_Detail10.setColumn(e.row, "FRDB_AM", 0);
			}else{
				//차변
				//대변일경우 차변금액을 지운다.
				//trace("newvalue = " + e.newvalue);
				this.ds_Detail10.setColumn(e.row, "CRED_AM", 0);
				this.ds_Detail10.setColumn(e.row, "FRCR_AM", 0);
			}
			

		
			//trace("차대구분을 변경 할 수 없습니다. ===crudType=="+ this.ds_Master10.getColumn(0, "crudType"));
			//trace("차대구분을 변경 할 수 없습니다. ===ACCH_AM=="+ this.ds_Master10.getColumn(0, "ACCH_AM"));
			return; 
			
		}
		//trace("===4");
		// D: 차변 일 경우 대변 금액을 지우고
		// C: 대변 일 경우 차변 금액을 지운자.
		
		//trace("===5");
		//차대구분에 따라 필수 체크표시
		this.fn_DecrGuCssclass(e.newvalue);
		
		//관리항목 조회
		if(e.oldvalue == e.newvalue){
			this.fn_dsAcomMa(this.ds_Detail10.getColumn(e.row, "ACOM_CD"), "", bCheckBgcm);	
		}else{
			
			this.ds_Detail10.setColumn(e.row, "EXCH_RT", 0);
			this.ds_Detail10.setColumn(e.row, "CURR_CD", "0090");
			//trace("set 2");
			this.fn_dsAcomMa(this.ds_Detail10.getColumn(e.row, "ACOM_CD"), "SET", bCheckBgcm);
		}
	
		//예산조회
		this.fn_GetBudg();
		if (!this.fvBCalAvailAmt) {
			this.fn_CalAvailAm();//가용금액 계산
		}
			
			
	//편성년월
	} else if(e.columnid == "BUDG_MM"){
		var sACOM_CD = this.ds_Detail10.getColumn(e.row, "ACOM_CD");//계정코드
		var sBUDG_MM = this.gfn_Nvl(this.ds_Detail10.getColumn(e.row, "BUDG_MM"), "");//편성년월
	
		if (!this.gfn_IsNull(sACOM_CD) && !this.gfn_IsNull(sBUDG_MM)) {
			//[예산통제 계정] 체크
			var paramObj= new Object();//[공통] 예산통제체크 파라메타 정보 Object
			paramObj.BGCM_YY = sBUDG_MM.substr(0, 4);//편성년도
			paramObj.ACOM_CD = sACOM_CD;//계정코드
			bCheckBgcm = this.gfn_CheckBgcm(paramObj);//예산편성계정여부 체크

			//예산통제계정
			if (bCheckBgcm) {
	
				var sDECR_GU = this.ds_Detail10.getColumn(e.row, "DECR_GU");//차대구분
				var sDECR_GU_CHK = this.ds_Detail10.getColumn(e.row, "DECR_GU_CHK");//차대구분-계정
	
				//선택한것과 계정코드의 차대구분이 같을 경우
				if ((sDECR_GU == "D" && sDECR_GU_CHK == "D") || (sDECR_GU == "C" && sDECR_GU_CHK == "C")) {
					this.div_detailRight.form.div_Budget.form.chk_BgcmYn.set_value("1");
					this.ds_Detail10.setColumn(e.row, "BGCM_YN", "Y");//예산통제여부
				} else {
					this.div_detailRight.form.div_Budget.form.chk_BgcmYn.set_value("0");
					this.ds_Detail10.setColumn(e.row, "BGCM_YN", "N");//예산통제여부
				}
				
			} else {
				this.div_detailRight.form.div_Budget.form.chk_BgcmYn.set_value("0");
				this.ds_Detail10.setColumn(e.row, "BGCM_YN", "N");//예산통제여부
			}
		}		
		this.fn_GetBudg();//예산통제정보 조회

	}
};

/*---------------------------------------------------------------------------------------------
 *    02. [데이터셋-ds_Detail10] rowposchanged
  ---------------------------------------------------------------------------------------------*/  
this.ds_Detail10_onrowposchanged = function(obj:nexacro.NormalDataset,e:nexacro.DSRowPosChangeEventInfo)
{
	//줄 변경시 관리항목 리스트만 조회
	//this.fn_dsAcomMa(this.ds_Detail10.getColumn(this.ds_Detail10.rowposition, "ACOM_CD"), "");
	
	
	if (!this.fvDsRowPosChangeDetail) return;//반제전표에서 가져올때는 이벤트를 타지않게한다
	
	
	var bCheckBgcm = false;//예산편성계정여부
	//trace("this.fvMasterSearchMode = " + this.fvMasterSearchMode);
	//trace("e.newrow 1 = " + e.newrow );
	//예산정보 설정
	if (e.newrow > -1 && !this.fvMasterSearchMode) {
	//if (e.newrow > -1) {
		//trace("e.newrow 2 = " + e.newrow );
	
		this.fvMasterSearchMode = true;//마스터내역 조회중여부
		
		
		//예산정보 초기화
		this.div_detailRight.form.div_Budget.form.chk_BgcmYn.set_value("0");
		//this.div_detailRight.form.div_Budget.form.edt_BudgetAcomCd.set_value("");
		this.div_detailRight.form.div_Budget.form.mae_RecAm.set_value("0");
		this.div_detailRight.form.div_Budget.form.mae_UsedAm.set_value("0");
		this.div_detailRight.form.div_Budget.form.mae_RegAm.set_value("0");
		this.div_detailRight.form.div_Budget.form.mae_AvailAm.set_value("0");		
	
		var sACOM_CD = this.ds_Detail10.getColumn(e.newrow, "ACOM_CD");//계정코드
		var sBUDG_MM = this.gfn_Nvl(this.ds_Detail10.getColumn(e.newrow, "BUDG_MM"), "");//편성년월
		var sDECR_GU = this.ds_Detail10.getColumn(e.newrow, "DECR_GU");//차대구분
		
		if(this.gfn_IsNull(sACOM_CD) || sACOM_CD == ""){
			var arrComList = this.div_detailRight.form.div_Item.form.components;//Div 생성된 전체 컴폰넌트

			if (!this.gfn_IsNull(arrComList)) {

				for (var iLoop = arrComList.length-1; iLoop >= 0; iLoop--) {
					if (arrComList[iLoop].id != "sta_DetailRightBottom") {
						var rObj = this.div_detailRight.form.div_Item.removeChild(arrComList[iLoop].id);
						rObj.destroy();
						rObj = null;
					}
				}
			}
		}

			
		
		if (!this.gfn_IsNull(sACOM_CD) && !this.gfn_IsNull(sBUDG_MM)) {
			//[예산통제 계정] 체크
			var paramObj= new Object();//[공통] 예산통제체크 파라메타 정보 Object
			paramObj.BGCM_YY = sBUDG_MM.substr(0, 4);//편성년도
			paramObj.ACOM_CD = sACOM_CD;//계정코드
			bCheckBgcm = this.gfn_CheckBgcm(paramObj);//예산편성계정여부 체크

			//예산통제계정
			if (bCheckBgcm) {
				//this.div_detailRight.form.div_Budget.set_visible(true);
				
				var sDECR_GU_CHK = this.ds_Detail10.getColumn(e.newrow, "DECR_GU_CHK");//차대구분-계정
	
				//선택한것과 계정코드의 차대구분이 같을 경우
				if ((sDECR_GU == "D" && sDECR_GU_CHK == "D") || (sDECR_GU == "C" && sDECR_GU_CHK == "C")) {
					this.div_detailRight.form.div_Budget.form.chk_BgcmYn.set_value("1");
				} else {
					this.div_detailRight.form.div_Budget.form.chk_BgcmYn.set_value("0");
				}				
			} else {
				//this.div_detailRight.form.div_Budget.set_visible(false);
				this.div_detailRight.form.div_Budget.form.chk_BgcmYn.set_value("0");
			}
		}
		
		//줄 변경시 관리항목 리스트만 조회
		this.fn_dsAcomMa(this.ds_Detail10.getColumn(this.ds_Detail10.rowposition, "ACOM_CD"), "", bCheckBgcm);
	
		this.fn_DecrGuCssclass(sDECR_GU);
		//this.fvMasterSearchMode = false;//마스터내역 조회중여부
	} else {
	
		
		
		this.div_detailRight.form.div_Budget.form.chk_BgcmYn.set_value("0");
		
		
		//예산정보 초기화
		this.div_detailRight.form.div_Budget.form.mae_RecAm.set_value(0);
		this.div_detailRight.form.div_Budget.form.mae_UsedAm.set_value(0);
		this.div_detailRight.form.div_Budget.form.mae_RegAm.set_value(0);
		this.div_detailRight.form.div_Budget.form.mae_AvailAm.set_value(0);
	
	
	
		//생성된 관리항목 컴포넌트 삭제
		var arrComList = this.div_detailRight.form.div_Item.form.components;//Div 생성된 전체 컴폰넌트

		if (!this.gfn_IsNull(arrComList)) {

			for (var iLoop = arrComList.length-1; iLoop >= 0; iLoop--) {
				if (arrComList[iLoop].id != "sta_DetailRightBottom") {
					var rObj = this.div_detailRight.form.div_Item.removeChild(arrComList[iLoop].id);
					rObj.destroy();
					rObj = null;
				}
			}
		}
		
		this.div_detailRight.form.div_Item.set_height(60);
		this.div_detailRight.form.div_Budget.set_top("div_Item:0");
				
		this.fvMasterSearchMode = false;//마스터내역 조회중여부
	}	
};


/***********************************************************************************************
 * 02.DG0.01. [Detail그리드-버튼] 복사 클릭 이벤트
 ***********************************************************************************************/
this.fn_DetailGrd01Copy = function()
{

	//선택된 Row
	var arrRows = this.grd_Detail10.getSelectedRows();
	var iAddRow = 0;
	
	for (var iLoop=0; iLoop < arrRows.length; iLoop++) {
		iAddRow = this.ds_Detail10.addRow();
		this.ds_Detail10.copyRow(iAddRow, this.ds_Detail10, arrRows[iLoop]);
		
		this.ds_Detail10.setColumn(iAddRow, "ACCB_SE", "");
		
		for (var iRowNum =0; iRowNum < this.ds_Detail10.getRowCount(); iRowNum++) {
			this.ds_Detail10.setColumn(iRowNum, "NUMB_SE", iRowNum);
		}
		
		
		//금액 0 으로 세팅
		this.ds_Detail10.setColumn(iAddRow, "DEBI_AM", "0");
		this.ds_Detail10.setColumn(iAddRow, "CRED_AM", "0");
		
		this.ds_Detail10.setColumn(iAddRow, "crudType", "I");
		
		
		//관리항목복사
		this.f_ItemCopy(iAddRow);
		
		
		
		//예산체크
		this.dsAcomMaSetYn = "";
		//trace("this.dsAcomMaSetYn =" + this.dsAcomMaSetYn );
		this.fn_CommAcomCallbackFunc();

	}
	
	
	//줄 변경시 관리항목 리스트만 조회
	
	var bCheckBgcm = false;//예산편성계정여부
	var acomCd = this.ds_Detail10.getColumn(iAddRow, "ACOM_CD");
	
	//trace("acomCd = " + acomCd);
	
	//this.fn_dsAcomMa(this.ds_Detail10.getColumn(iAddRow, "ACOM_CD"), "", bCheckBgcm);

};


/***********************************************************************************************
 * 02.DG0.03. [Detail그리드-버튼] 행삽입 클릭 이벤트
 ***********************************************************************************************/
this.fn_DetailGrd01InsertRow = function()
{


	if (this.ds_Detail10.getRowCount() < 1) {
		this.gfn_Alert("FA011");//자동전표 미리보기를 먼저 실행 하신후 작업 하세요.
		return;
	}
	
	this.fvGridForcusYn = false;//그리드포커스여부-메세지무한출력때문에 추가
	
	var iAddRow = this.gfn_GridInsertionProcess(this, this.ds_Detail10);//crud_flag 변경-입력(I)	
	this.fvMasterSearchMode = false;//마스터내역 조회중여부
	
	this.ds_Detail10.setColumn(iAddRow, "COMM_CD", this.ds_Master10.getColumn(0, "COMM_CD"));
	this.ds_Detail10.setColumn(iAddRow, "PRGM_ID", this.ds_Master10.getColumn(0, "PRGM_ID"));
	this.ds_Detail10.setColumn(iAddRow, "MANA_NO", this.ds_Master10.getColumn(0, "MANA_NO"));
	this.ds_Detail10.setColumn(iAddRow, "ACCH_NO", this.ds_Master10.getColumn(0, "ACCH_NO"));
	this.ds_Detail10.setColumn(iAddRow, "WOFH_SQ", this.ds_Master10.getColumn(0, "WOFH_SQ"));
	
	for (var iRowNum =0; iRowNum < this.ds_Detail10.getRowCount(); iRowNum++) {
		this.ds_Detail10.setColumn(iRowNum, "NUMB_SE", iRowNum);
	}
	
	//this.ds_Detail10.setColumn(iAddRow, "NUMB_SE", this.ds_Detail10.getMax("NUMB_SE")+'1');  // 디폴트 차변으로 설정
	
	//생성여부(자동/수기)
	//this.ds_Detail10.addColumn("CREA_YN", "string");
	this.ds_Detail10.setColumn(iAddRow, "CREA_YN", "0");
	//trace("fn_DetailGrd01AddRow ACUM_CD 1= iAddRow" + iAddRow+ "   " + this.ds_Master10.getColumn(0, "ACUM_CD"));
	this.ds_Detail10.setColumn(iAddRow, "ACUM_CD", this.ds_Master10.getColumn(0, "ACUM_CD"));
	
	//trace("fn_DetailGrd01AddRow PRGM_ID 2= iAddRow" + iAddRow+ "   " + this.ds_Detail10.getColumn(iAddRow, "PRGM_ID"));
	//trace("fn_DetailGrd01AddRow ACUM_CD 2= iAddRow" + iAddRow+ "   " + this.ds_Detail10.getColumn(iAddRow, "ACUM_CD"));
	
	
	
	this.ds_Detail10.setColumn(iAddRow, "DECR_GU", "D");  // 디폴트 차변으로 설정
	
	//편성월
	//trace(this.div_MasterInput.form.tab_Master.tpg_01.form.cal_AcchDd.value.substring(0, 6));
	this.ds_Detail10.setColumn(iAddRow, "BUDG_MM", this.ds_Detail10.getColumn(0, "BUDG_MM"));  // 디폴트 차변으로 설정
	
	//화폐 defalut  krw
	this.ds_Detail10.setColumn(iAddRow, "CURR_CD","0090");  // 디폴트 KRW
	//환율 
	this.ds_Detail10.setColumn(iAddRow, "EXCH_RT", 1);  // 환율 1
	//예산부서
	this.ds_Detail10.setColumn(iAddRow, "BUDP_CD", this.ds_Detail10.getColumn(0, "BUDP_CD")); 
	this.ds_Detail10.setColumn(iAddRow, "BUDP_NM", this.ds_Detail10.getColumn(0, "BUDP_NM"));  
	//차/대금액
	this.ds_Detail10.setColumn(iAddRow, "CRED_AM", 0);//차변금액	
	this.ds_Detail10.setColumn(iAddRow, "DEBI_AM", 0);//대변금액	
	//결의승인여부
	this.ds_Detail10.setColumn(iAddRow, "SLIP_YN", this.ds_Master10.getColumn(0, "SLIP_YN"));
	
	//차대구분에 따라 필수 체크표시
	this.fn_DecrGuCssclass("D");
	
		var arrComList = this.div_detailRight.form.div_Item.form.components;//Div 생성된 전체 컴폰넌트

	if (!this.gfn_IsNull(arrComList)) {

		for (var iLoop = arrComList.length-1; iLoop >= 0; iLoop--) {
			if (arrComList[iLoop].id != "sta_DetailRightBottom") {
				var rObj = this.div_detailRight.form.div_Item.removeChild(arrComList[iLoop].id);
				rObj.destroy();
				rObj = null;
			}
		}

	}
	
	
};



/***********************************************************************************************
 * 02.DG0.02. [Detail그리드-버튼] 행추가 클릭 이벤트
 ***********************************************************************************************/
this.fn_DetailGrd01AddRow = function()
{
	if (this.ds_Detail10.getRowCount() < 1) {
		this.gfn_Alert("FA011");//자동전표 미리보기를 먼저 실행 하신후 작업 하세요.
		return;
	}

	var sAcumCd = "";
	this.fvGridForcusYn = false;//그리드포커스여부-메세지무한출력때문에 추가
	
	var iAddRow = this.gfn_GridInsertProcess(this, this.ds_Detail10);//crud_flag 변경-입력(I)
	this.fvMasterSearchMode = false;//마스터내역 조회중여부
	
	this.ds_Detail10.setColumn(iAddRow, "COMM_CD", this.ds_Master10.getColumn(0, "COMM_CD"));
	this.ds_Detail10.setColumn(iAddRow, "PRGM_ID", this.ds_Master10.getColumn(0, "PRGM_ID"));
	this.ds_Detail10.setColumn(iAddRow, "MANA_NO", this.ds_Master10.getColumn(0, "MANA_NO"));
	this.ds_Detail10.setColumn(iAddRow, "ACCH_NO", this.ds_Master10.getColumn(0, "ACCH_NO"));
	this.ds_Detail10.setColumn(iAddRow, "WOFH_SQ", this.ds_Master10.getColumn(0, "WOFH_SQ"));
	
		
	for (var iRowNum =0; iRowNum < this.ds_Detail10.getRowCount(); iRowNum++) {
		this.ds_Detail10.setColumn(iRowNum, "NUMB_SE", iRowNum);
	}
	
	
	//this.ds_Detail10.setColumn(iAddRow, "NUMB_SE", this.ds_Detail10.getMax("NUMB_SE")+'1');  // 디폴트 차변으로 설정
	
	sAcumCd = this.ds_Master10.getColumn(0, "ACUM_CD");
	
	//trace("fn_DetailGrd01AddRow ACUM_CD 1= iAddRow" + iAddRow+ "   " + sAcumCd);
	
	
	
	this.ds_Detail10.setColumn(iAddRow, "ACUM_CD", this.ds_Master10.getColumn(0, "ACUM_CD"));
	
	//생성여부(자동/수기)
	//this.ds_Detail10.addColumn("CREA_YN", "string");
	this.ds_Detail10.setColumn(iAddRow, "CREA_YN", "0");
	
	
	//trace("fn_DetailGrd01AddRow PRGM_ID 2= iAddRow" + iAddRow+ "   " + this.ds_Detail10.getColumn(iAddRow, "PRGM_ID"));
	//trace("fn_DetailGrd01AddRow ACUM_CD 2= iAddRow" + iAddRow+ "   " + this.ds_Detail10.getColumn(iAddRow, "ACUM_CD"));
	
	this.ds_Detail10.setColumn(iAddRow, "DECR_GU", "D");  // 디폴트 차변으로 설정
	
	//편성월
	//trace(this.div_MasterInput.form.tab_Master.tpg_01.form.cal_AcchDd.value.substring(0, 6));
	this.ds_Detail10.setColumn(iAddRow, "BUDG_MM", this.ds_Detail10.getColumn(0, "BUDG_MM"));  // 디폴트 차변으로 설정
	
	//화폐 defalut  krw
	this.ds_Detail10.setColumn(iAddRow, "CURR_CD","0090");  // 디폴트 KRW
	//환율 
	this.ds_Detail10.setColumn(iAddRow, "EXCH_RT", 1);  // 환율 1
	//예산부서
	this.ds_Detail10.setColumn(iAddRow, "BUDP_CD", this.ds_Detail10.getColumn(0, "BUDP_CD")); 
	this.ds_Detail10.setColumn(iAddRow, "BUDP_NM", this.ds_Detail10.getColumn(0, "BUDP_NM"));  
	
	
	//차/대금액
	this.ds_Detail10.setColumn(iAddRow, "CRED_AM", 0);//차변금액	
	this.ds_Detail10.setColumn(iAddRow, "DEBI_AM", 0);//대변금액	
	//결의승인여부
	this.ds_Detail10.setColumn(iAddRow, "SLIP_YN", this.ds_Master10.getColumn(0, "SLIP_YN"));
	
	//차대구분에 따라 필수 체크표시
	this.fn_DecrGuCssclass("D");	
	
	var arrComList = this.div_detailRight.form.div_Item.form.components;//Div 생성된 전체 컴폰넌트

	if (!this.gfn_IsNull(arrComList)) {

		for (var iLoop = arrComList.length-1; iLoop >= 0; iLoop--) {
			if (arrComList[iLoop].id != "sta_DetailRightBottom") {
				var rObj = this.div_detailRight.form.div_Item.removeChild(arrComList[iLoop].id);
				rObj.destroy();
				rObj = null;
			}
		}

	}
	
};

/***********************************************************************************************
 * 02.DG0.03. [Detail그리드-버튼] 행삭제 클릭 이벤트
 ***********************************************************************************************/
this.fn_DetailGrd01DeleteRow = function()
{

	this.gfn_GridDelProcess(this, this.ds_Detail10);//crud_flag 변경-삭제(D)	
};


/***********************************************************************************************
 * 02.DG0.05. [Detail그리드-버튼] 취소 클릭 이벤트
 ***********************************************************************************************/
this.fn_DetailGrd01Cancel = function()
{
	this.gfn_UndoColumn(this.grd_Detail10);
};
 
 
 
/***********************************************************************************************
 * 02.DG0.04. [Detail그리드-버튼] 자동전표 미리보기 클릭 이벤트
 ***********************************************************************************************/
this.fn_DetailGrd01Atob = function(pObj)
{
	this.ds_AtobProc.clearData();
	this.ds_AtobRt.clearData();
	
	this.ds_AtobProc.addRow();
	this.ds_AtobProc.setColumn(0, "COMM_CD", pObj.COMM_CD);//회사코드
	this.ds_AtobProc.setColumn(0, "AUTM_CD", pObj.AUTM_CD);//분류코드-T_FA_AUTM(자동전표환경설정) 테이블 내용 참조
	this.ds_AtobProc.setColumn(0, "PRGM_ID", pObj.PRGM_ID);//프로그램ID
	this.ds_AtobProc.setColumn(0, "MANA_NO", pObj.MANA_NO);//관리번호-업무Key
	this.ds_AtobProc.setColumn(0, "WOFH_SQ", pObj.WOFH_SQ);//결재차수
	this.ds_AtobProc.setColumn(0, "REGI_ID", pObj.REGI_ID);//등록자
	this.ds_AtobProc.setColumn(0, "REGI_NM", pObj.REGI_NM);//등록자명
	this.ds_AtobProc.setColumn(0, "KEY_01", pObj.KEY_01);//T_FA_AUTD-자동전표환경설정-D 테이블의 쿼리에 사용하는 파라메타 Key-Value정보
	this.ds_AtobProc.setColumn(0, "KEY_02", pObj.KEY_02);//Key02
	this.ds_AtobProc.setColumn(0, "KEY_03", pObj.KEY_03);//Key03
	this.ds_AtobProc.setColumn(0, "KEY_04", pObj.KEY_04);//Key04
	this.ds_AtobProc.setColumn(0, "KEY_05", pObj.KEY_05);//Key05
	this.ds_AtobProc.setColumn(0, "KEY_06", pObj.KEY_06);//Key06
	this.ds_AtobProc.setColumn(0, "KEY_07", pObj.KEY_07);//Key07
	this.ds_AtobProc.setColumn(0, "KEY_08", pObj.KEY_08);//Key08
	this.ds_AtobProc.setColumn(0, "KEY_09", pObj.KEY_09);//Key09
	this.ds_AtobProc.setColumn(0, "KEY_10", pObj.KEY_10);//Key10
	
	//자동전표 미리보기 조회용 Key
	this.fvCmAtobPrgmId = pObj.PRGM_ID;//프로그램ID
	this.fvCmAtobManaNo = pObj.MANA_NO;//관리번호-업무Key
	this.fvCmAtobWofhSq = pObj.WOFH_SQ;//결재차수
	this.fvCmAtobWofhSt = pObj.WOFH_ST;//결재상태
	
	//[공통]서비스정보 초기화
	this.gfn_InitComService(this);
	
	//[공통]서비스정보 추가
	var svcAddObj = new Object();//[공통] 서비스 추가 파라메타 정보 Object
	svcAddObj.sSelectSql = "fa:M_FA_ATOB_M_IN10";
	this.gfn_AddComSearchService(this, svcAddObj);
	
	//[공통]서비스 호출 변수
	var svcCallObj = new Object();//[공통] 서비스 파라메타 정보 Object
	svcCallObj.sTrid 		= "ATOB_PROC";			//Transaction ID 등 callback에서 넘겨 받을 String을 지정
	svcCallObj.sActionName 	= "";			//서버에서 호출할 Action - 모듈별로 호출되는 기본 Actio이 다름 : 공통 서비스 Action 업무구분  변수 참조
	svcCallObj.sInputDaset 	= "ds_AtobProc=ds_AtobProc" 	//입력 데이터셋
	svcCallObj.sOutDatset 	= "ds_AtobRt=ds_AtobRt";//출력 데이터셋
	svcCallObj.sOtherArg 	= "";					//서버로 전송할 기타 Argument 정보 문자열, 예) key=value key2=value2
	svcCallObj.sCallBackFnc = "fn_Callback";		//서버에서 처리가 완료된 후 Callback 받을 Function 명
	//svcCallObj.isSync = true;//동기식으로 설정할지 여부
	//[공통]서비스 호출
	this.gfn_CallComService(this, svcCallObj);		
	
	
	
};

/***********************************************************************************************
 * 13. [CallBack] 함수
 ***********************************************************************************************/
/***********************************************************************************************
 * 13.01. [서비스] CallBack 함수 처리
 ***********************************************************************************************/ 
this.fn_Callback = function(sSvcId, nErrorCode, sErrorMsg)
{
	if(nErrorCode != 0)
	{
		return;
	}	
	switch(sSvcId)
	{
		case "COMBO_SEARCH":
			
			//trace("==============================" + this.ds_ItemList.getRowCount());
		
			break;
		case "DTL_SEARCH": //조회		

			if (this.ds_Detail10.getRowCount() > 0) {
				//[공통]그리드NoData Text 초기화 설정
				this.gfn_InitGridNoDataText(this.grd_Detail10);
			} else {
				//[공통]그리드NoData Text설정
				this.gfn_SetGridNoDataText(this.grd_Detail10);			
			}
			break;		
			
		case "ATOB_PROC": //자동전표 미리보기 데이터 생성		

			if (this.ds_AtobRt.getRowCount() > 0) {
				//trace(this.ds_AtobRt.saveXML());
				
				//오류발생시
				if (this.ds_AtobRt.getColumn(0, "O_RET_CODE") == "FALSE") {
					//자동전표 미리보기 데이터 생성중 오류가 발생하였습니다.
					var arrMsgArg = [this.ds_AtobRt.getColumn(0, "O_RET_CMSG")];
					this.gfn_Alert("FA004", arrMsgArg);
				}
				//this.gfn_Alert("WF006");//결재 처리 되었습니다.
				var sPRGM_ID = this.fvCmAtobPrgmId;//프로그램ID
				var sMANA_NO = this.fvCmAtobManaNo;//관리번호-업무Key
				var sWOFH_ST = this.fvCmAtobWofhSt;//결재상태
				var sWOFH_SQ = this.fvCmAtobWofhSq;//결재차수
				var atobObj = new Object();//[공통] 자동전표 파라메타 정보 Object
				atobObj.PRGM_ID = sPRGM_ID;
				atobObj.MANA_NO = sMANA_NO;
				atobObj.WOFH_ST = sWOFH_ST;
				atobObj.WOFH_SQ = sWOFH_SQ;
				
				this.fn_ComBtnSearch(atobObj);//자동전표 상세내역 조회	
				
				//this.fn_ScrnEnable(true);
			} else {
				//자동전표 미리보기 데이터 생성중 오류가 발생하였습니다.
				var arrMsgArg = [];
                this.gfn_Alert("FA004", arrMsgArg);
			}
			break;				
	
		case "ACOM_MA_SET":
		
			//alert("2");
			//trace("ACOM_MA_SET");
			//계정별 관리항목 ds_AcomMa
			
			//관리항목 조회 후 ds_Detail에 MA_NM 값을 넣어준다.
			this.fn_SetMaNm(this.ds_Detail10.rowposition);
			
			//관리항목 컴포넌트 동적생성
			this.fn_MakeMaData();
			
			//가용금액 계산중이 아닐경우-계산
			if (!this.fvBCalAvailAmt) {
				this.fn_CalAvailAm();//가용금액 계산
			}		
			this.fvMasterSearchMode = false;//마스터내역 조회중여부
			//trace("this.fvMasterSearchMode 1 = " + this.fvMasterSearchMode);
			break;
		case "ACOM_MA":
			//관리항목 컴포넌트 동적생성
			
		
			//trace("ACOM_MA");
			this.fn_MakeMaData();
			
			//반제전표찾기
			if (this.fvDetailGu == true) {
				this.fvDetailGu = false;
			}
			/*
			//가용금액 계산중이 아닐경우-계산
			if (!this.fvBCalAvailAmt) {
				this.fn_CalAvailAm();//가용금액 계산
			}		
			*/
			this.fn_GetBudg();//예산통제정보 조회
			
			this.fvMasterSearchMode = false;//마스터내역 조회중여부
			//trace("this.fvMasterSearchMode 2 = " + this.fvMasterSearchMode);
			
			
			break;		
			
		case "GET_BUDG": //예산통제정보 조회

			//가용금액 계산중이 아닐경우-계산
			

				//trace("====BSGU_AM1=====" + this.div_detailRight.form.div_Budget.form.mae_RecAm.value);
			
			if (!this.fvBCalAvailAmt) {
				this.fn_CalAvailAm();//가용금액 계산
					
				//trace("====BSGU_AM9=====" + this.div_detailRight.form.div_Budget.form.mae_RecAm.value);
			}		
			break; 
			
		case "ATOB_SEARCH":
			this.wfreYn = ""; //자동전표재실행여부
			if(this.ds_Detail10.rowcount > 0 ){
				// 행추가.. 버튼 visible true
				//this.fn_ScrnEnable(true);
				
				//자동전표재실행여부
				this.wfreYn = this.ds_Detail10.getColumn(0, "WFRE_YN");
				
				
				//trace("VDE01_CD = " + this.ds_Detail10.getColumn(0, "VDE01_CD"));
				//trace("VDE01_CD = " + this.ds_CmMaInfo.getColumn(0, "VDE01_CD"));
				
				
				//화면활성화
				//trace("this.wfreYn = " + this.wfreYn);
				//trace("this.scrnEnable1 = " + this.scrnEnable);
				//trace("this.input WOFH_ST = " + this.ds_Input.getColumn(0, "WOFH_ST"));




				if(!this.scrnEnable){
					this.wfreYn = "1";
				}
				if(this.fvCmAtobWofhSt=="0010"){
					this.wfreYn = "0";
				}
				
				if(this.wfreYn=="0"){
					//여부(여)
					this.grd_Detail10.setFormatColProperty(0,"size",30);
					this.grd_Detail10.setFormatColProperty(2,"size",35);
					this.grd_Detail10.setFormatColProperty(6,"size",24);
					this.grd_Detail10.setFormatColProperty(8,"size",24);
					this.grd_Detail10.setFormatColProperty(12,"size",24);
					this.grd_Detail10.setFormatColProperty(14,"size",24);
					
					
					this.div_detailRight.form.div_Budget.set_visible(true);
					
					this.fn_ScrnEnable(true);
				}else{
					//여부(부)
					this.grd_Detail10.setFormatColProperty(0,"size",0);
					this.grd_Detail10.setFormatColProperty(2,"size",0);
					this.grd_Detail10.setFormatColProperty(6,"size",0);
					this.grd_Detail10.setFormatColProperty(8,"size",0);
					this.grd_Detail10.setFormatColProperty(12,"size",0);
					this.grd_Detail10.setFormatColProperty(14,"size",0);
					this.div_detailRight.form.div_Budget.set_visible(true);
					this.fn_ScrnEnable(false);
				}
				
				
				
			}else{
				this.fn_ScrnEnable(false);
			}
			
			this.ds_Detail10.addColumn("crudType", "string");
			this.ds_Detail10.addColumn("s_chk", "string");
			
			
			this.ds_Master10.addColumn("crudType", "string");
		
			
			this.fvMasterSearchMode = false;//마스터내역 조회중여부
			break;	
			
						
	}
};

/***********************************************************************************************
 * 13.02. [팝업] CallBack 함수 처리
          strId : 팝업호출시 지정한 팝업ID
	      rtnValue : 팝업창에서 close시 지정한 반환값
          주의 : Open(popuptype=modeless)창은 팝업콜백을 지원하지 않음
 ***********************************************************************************************/ 
this.fn_PopupCallback = function(strId, rtnValue)
{

	// pop창 콜백 id
	
	//[결재요청/결재취소]
	if (strId == "C_WF_REQUEST") {
		if (!this.gfn_IsNull(rtnValue)) {
			var arrRtnVal = eval(rtnValue);
			
			//리턴메세지코드
			if (!this.gfn_IsNull(arrRtnVal.MSG_CODE)) {
				//결재정상처리 된경우
				if (arrRtnVal.MSG_CODE == "0") {
					//[공통] 결재요청/결재취소 재조회시 KEY값 설정
					this.fvSchKeyYn = true;
					this.fvSchKey01 = this.ds_Master10.getColumn(0, "PRGM_ID");//조회Key01
					this.fvSchKey02 = this.ds_Master10.getColumn(0, "MANA_NO");//조회Key01
					this.fvSchKey03 = this.ds_Master10.getColumn(0, "WOFH_SQ");//조회Key02					
					//재조회
					this.fn_ComBtnSearch();
				}
			}	
		}		
		
	//[Detail영역]
	//예산부서		
	} else if (strId == "B_DEPM_CD_01") {
		if (!this.gfn_IsNull(rtnValue)) {
			var arrRtnVal = eval(rtnValue);	
			//trace("arrRtnVal.DEPM_CD = " + arrRtnVal.DEPM_CD);
			if (!this.gfn_IsNull(arrRtnVal.DEPM_CD)) {
				this.ds_Detail10.setColumn(this.ds_Detail10.rowposition, "BUDP_CD", arrRtnVal.DEPM_CD);
				this.ds_Detail10.setColumn(this.ds_Detail10.rowposition, "BUDP_NM", arrRtnVal.DEPM_NM);
			}
		} else {
			this.ds_Detail10.setColumn(this.ds_Detail10.rowposition, "BUDP_CD", "");
			this.ds_Detail10.setColumn(this.ds_Detail10.rowposition, "BUDP_NM", "");		
		}
		
	//예산 - 예산부서		
	} else if (strId == "B_SDDP_CD_01") {
		if (!this.gfn_IsNull(rtnValue)) {
			var arrRtnVal = eval(rtnValue);	
			
			if (!this.gfn_IsNull(arrRtnVal.DEPM_CD)) {
				this.div_detailRight.form.div_Budget.form.edt_BudgetDeptCd.set_value(arrRtnVal.DEPM_CD);//.set_value(arrRtnVal.DEPM_CD);
				this.div_detailRight.form.div_Budget.form.edt_BudgetDeptNm.set_value(arrRtnVal.DEPM_NM);				
			}
		} else {
			this.div_detailRight.form.div_Budget.form.edt_BudgetDeptCd.set_value("");//.set_value(arrRtnVal.DEPM_CD);
			this.div_detailRight.form.div_Budget.form.edt_BudgetDeptNm.set_value("");			
		}
	} else if(strId == "B_PALM_CD_01"){
		if (!this.gfn_IsNull(rtnValue)) {
			var arrRtnVal = eval(rtnValue);	
			
			if (!this.gfn_IsNull(arrRtnVal.PALM_CD)) {
				this.ds_Detail10.setColumn(this.ds_Detail10.rowposition, "PALM_CD", arrRtnVal.PALM_CD);
				this.ds_Detail10.setColumn(this.ds_Detail10.rowposition, "PALM_NM", arrRtnVal.PALM_NM);
				
			}
		} else {
			this.ds_Detail10.setColumn(this.ds_Detail10.rowposition, "PALM_CD", "");
			this.ds_Detail10.setColumn(this.ds_Detail10.rowposition, "PALM_NM", "");		
		}
	} else if(strId == "S_ACOM_CD_01"){
		//계정 popup
		if (!this.gfn_IsNull(rtnValue)) {
			var arrRtnVal = eval(rtnValue);	

			if (!this.gfn_IsNull(arrRtnVal.ACOM_CD)) {

				this.ds_Detail10.setColumn(this.ds_Detail10.rowposition, "ACOM_CD", arrRtnVal.ACOM_CD);
				this.ds_Detail10.setColumn(this.ds_Detail10.rowposition, "ACOM_NM", arrRtnVal.ACOM_NM);
				this.ds_Detail10.setColumn(this.ds_Detail10.rowposition, "DECR_GU_CHK", arrRtnVal.DECR_GU);//차대구분		
				
				
				//차대금액 둘다 0 이면
				//차대구분은 계정의 차대구분을 넣는다.
				if(this.ds_Detail10.getColumn(this.ds_Detail10.rowposition, "DEBI_AM")==0 && this.ds_Detail10.getColumn(this.ds_Detail10.rowposition, "CRED_AM")==0){
				    if(this.gfn_IsNull(arrRtnVal.DECR_GU) || arrRtnVal.DECR_GU ==""){
						this.ds_Detail10.setColumn(this.ds_Detail10.rowposition, "DECR_GU", "D");
					}else{
						this.ds_Detail10.setColumn(this.ds_Detail10.rowposition, "DECR_GU", arrRtnVal.DECR_GU);
					}
				}
				
			}
		}else{
			 this.ds_Detail10.setColumn(this.ds_Detail10.rowposition, "ACOM_CD", "");
			 this.grd_Detail10.setCellPos(this.grd_Detail10.getBindCellIndex("body",'ACOM_CD'));
		     this.grd_Detail10.setFocus();
		}

	//반제전표찾기
	} else if(strId == "S_BANJE_CD_01"){
		if (!this.gfn_IsNull(rtnValue)) {
			var arrRtnVal01 = rtnValue.split("@^&");
			var sAcchNo = "";
			var sAccbSe = "";
			var sRemkNm = ""; 
			var iFvFindRow = 0;
			
			//this.ds_Detail10.clearData();
			bCheckBgcm = false;
			
  			for(var iLoop = 0; iLoop < arrRtnVal01.length-1; iLoop++) {
			
				//trace();
				var arrRtnVal = eval(arrRtnVal01[iLoop]);
				
				sAcchNo = arrRtnVal.ACCH_NO;
				sAccbSe = arrRtnVal.ACCB_SE;
				sRemkNm = arrRtnVal.REMK_NM; //적요
				//같은 반제전표는 등록 안되게 한다.
				iFvFindRow = this.ds_Detail10.findRowExpr("ANTI_NO=='" + sAcchNo+ "' && ANTI_SE=='"+sAccbSe+"'");//업무Key Row 찾기

				//trace("iFvFindRow = " + iFvFindRow);

				if(iFvFindRow < 0){
					

					
				
					this.fvDsRowPosChangeDetail = false; //DETAIL10 컬럼변경, ROW 변경 이벤트 타지않도록
					this.fvDetailGu = true;
					
					
					//var iAddRow = this.gfn_GridInsertProcess(this, this.ds_Detail10);//crud_flag 변경-입력(I)
					//var iAddRow = this.ds_Detail10.addRow();
					var iAddRow = this.gfn_GridInsertProcess(this, this.ds_Detail10);//crud_flag 변경-입력(I)
					
					var sDecrGu = arrRtnVal.DECR_GU//차대변구분1
					var sConverGu = "";//차대변구분2
					var dDebiAm = 0;//차변금액
					var dCredAm = 0;//대변금액
					
					//계정구분이 차변일때
					if (sDecrGu == "D") {
						sConverGu = "C";
						dCredAm = arrRtnVal.MIBAN_AM;//대변금액에 잔액 세팅
					//대변일때	
					} else if (sDecrGu == "C") {
						sConverGu = "D";
						dDebiAm = arrRtnVal.MIBAN_AM;//차변금액에 잔액 세팅
					}
					
					this.ds_Detail10.setColumn(iAddRow, "crudType", "I"); //회사코드
					this.ds_Detail10.setColumn(iAddRow, "COMM_CD", this.ds_Master10.getColumn(0, "COMM_CD")); //회사코드
					this.ds_Detail10.setColumn(iAddRow, "PRGM_ID", this.ds_Master10.getColumn(0, "PRGM_ID")); //발의번호
					this.ds_Detail10.setColumn(iAddRow, "MANA_NO", this.ds_Master10.getColumn(0, "MANA_NO")); //발의번호
					this.ds_Detail10.setColumn(iAddRow, "WOFH_SQ", this.ds_Master10.getColumn(0, "WOFH_SQ")); //결재차수
					this.ds_Detail10.setColumn(iAddRow, "ACUM_CD", this.ds_Master10.getColumn(0, "ACUM_CD")); //회계단위코드
					this.ds_Detail10.setColumn(iAddRow, "CREA_YN", "0");
		
					//this.ds_Detail10.setColumn(iAddRow, "ACUM_CD", arrRtnVal.ACUM_CD);//회계단위코드
					this.ds_Detail10.setColumn(iAddRow, "DECR_GU", sConverGu);//차대구분
					this.ds_Detail10.setColumn(iAddRow, "ACOM_CD", arrRtnVal.ACOM_CD);//계정코드
					this.ds_Detail10.setColumn(iAddRow, "ACOM_NM", arrRtnVal.ACOM_NM);//계정명
					this.ds_Detail10.setColumn(iAddRow, "PALM_CD", arrRtnVal.PALM_CD);//회계기준코드   .replace("undefined","")
					this.ds_Detail10.setColumn(iAddRow, "PALM_NM", arrRtnVal.PALM_NM);//회계기준명
					this.ds_Detail10.setColumn(iAddRow, "CRED_AM", dCredAm);//대변금액
					this.ds_Detail10.setColumn(iAddRow, "DEBI_AM", dDebiAm);//차변금액
					//반제잔액 체크용
					this.ds_Detail10.setColumn(iAddRow, "ANTI_AM", arrRtnVal.MIBAN_AM);//반제잔액
					
					this.ds_Detail10.setColumn(iAddRow, "REMK_NM", arrRtnVal.REMK_NM);//적요
					
					this.ds_Detail10.setColumn(iAddRow, "MANA_CD", arrRtnVal.MANA_CD);//대표_관리항목코드
					this.ds_Detail10.setColumn(iAddRow, "MANA_NM", arrRtnVal.MANA_NM);//대표_관리항목명
					this.ds_Detail10.setColumn(iAddRow, "DETA_CD", arrRtnVal.DETA_CD);//대표_관리상세코드
					this.ds_Detail10.setColumn(iAddRow, "DETA_CD", arrRtnVal.DETA_CD);//대표_관리상세코드
					this.ds_Detail10.setColumn(iAddRow, "DETA_NM", arrRtnVal.DETA_NM);//대표_관리상세명
					this.ds_Detail10.setColumn(iAddRow, "MA01_CD", arrRtnVal.MA01_CD);//관리항목코드1
					this.ds_Detail10.setColumn(iAddRow, "MA02_CD", arrRtnVal.MA02_CD);//관리항목코드2
					this.ds_Detail10.setColumn(iAddRow, "MA03_CD", arrRtnVal.MA03_CD);//관리항목코드3
					this.ds_Detail10.setColumn(iAddRow, "MA04_CD", arrRtnVal.MA04_CD);//관리항목코드4
					this.ds_Detail10.setColumn(iAddRow, "MA05_CD", arrRtnVal.MA05_CD);//관리항목코드5
					this.ds_Detail10.setColumn(iAddRow, "MA06_CD", arrRtnVal.MA06_CD);//관리항목코드6
					this.ds_Detail10.setColumn(iAddRow, "MA07_CD", arrRtnVal.MA07_CD);//관리항목코드7
					this.ds_Detail10.setColumn(iAddRow, "MA08_CD", arrRtnVal.MA08_CD);//관리항목코드8
					this.ds_Detail10.setColumn(iAddRow, "MA01_NM", arrRtnVal.MA01_NM);//관리항목명1
					this.ds_Detail10.setColumn(iAddRow, "MA02_NM", arrRtnVal.MA02_NM);//관리항목명2
					this.ds_Detail10.setColumn(iAddRow, "MA03_NM", arrRtnVal.MA03_NM);//관리항목명3
					this.ds_Detail10.setColumn(iAddRow, "MA04_NM", arrRtnVal.MA04_NM);//관리항목명4
					this.ds_Detail10.setColumn(iAddRow, "MA05_NM", arrRtnVal.MA05_NM);//관리항목명5
					this.ds_Detail10.setColumn(iAddRow, "MA06_NM", arrRtnVal.MA06_NM);//관리항목명6
					this.ds_Detail10.setColumn(iAddRow, "MA07_NM", arrRtnVal.MA07_NM);//관리항목명7
					this.ds_Detail10.setColumn(iAddRow, "MA08_NM", arrRtnVal.MA08_NM);//관리항목명8
					this.ds_Detail10.setColumn(iAddRow, "DE01_CD", arrRtnVal.DE01_CD);//관리상세코드1
					this.ds_Detail10.setColumn(iAddRow, "DE02_CD", arrRtnVal.DE02_CD);//관리상세코드2
					this.ds_Detail10.setColumn(iAddRow, "DE03_CD", arrRtnVal.DE03_CD);//관리상세코드3
					this.ds_Detail10.setColumn(iAddRow, "DE04_CD", arrRtnVal.DE04_CD);//관리상세코드4
					this.ds_Detail10.setColumn(iAddRow, "DE05_CD", arrRtnVal.DE05_CD);//관리상세코드5
					this.ds_Detail10.setColumn(iAddRow, "DE06_CD", arrRtnVal.DE06_CD);//관리상세코드6
					this.ds_Detail10.setColumn(iAddRow, "DE07_CD", arrRtnVal.DE07_CD);//관리상세코드7
					this.ds_Detail10.setColumn(iAddRow, "DE08_CD", arrRtnVal.DE08_CD);//관리상세코드8
					
					this.ds_Detail10.setColumn(iAddRow, "VDE01_CD", arrRtnVal.DE01_CD);//관리상세코드1
					this.ds_Detail10.setColumn(iAddRow, "VDE02_CD", arrRtnVal.DE02_CD);//관리상세코드2
					this.ds_Detail10.setColumn(iAddRow, "VDE03_CD", arrRtnVal.DE03_CD);//관리상세코드3
					this.ds_Detail10.setColumn(iAddRow, "VDE04_CD", arrRtnVal.DE04_CD);//관리상세코드4
					this.ds_Detail10.setColumn(iAddRow, "VDE05_CD", arrRtnVal.DE05_CD);//관리상세코드5
					this.ds_Detail10.setColumn(iAddRow, "VDE06_CD", arrRtnVal.DE06_CD);//관리상세코드6
					this.ds_Detail10.setColumn(iAddRow, "VDE07_CD", arrRtnVal.DE07_CD);//관리상세코드7
					this.ds_Detail10.setColumn(iAddRow, "VDE08_CD", arrRtnVal.DE08_CD);//관리상세코드8
					
					this.ds_Detail10.setColumn(iAddRow, "DE01_NM", arrRtnVal.DE01_NM);//관리상세명1
					this.ds_Detail10.setColumn(iAddRow, "DE02_NM", arrRtnVal.DE02_NM);//관리상세명2
					this.ds_Detail10.setColumn(iAddRow, "DE03_NM", arrRtnVal.DE03_NM);//관리상세명3
					this.ds_Detail10.setColumn(iAddRow, "DE04_NM", arrRtnVal.DE04_NM);//관리상세명4
					this.ds_Detail10.setColumn(iAddRow, "DE05_NM", arrRtnVal.DE05_NM);//관리상세명5
					this.ds_Detail10.setColumn(iAddRow, "DE06_NM", arrRtnVal.DE06_NM);//관리상세명6
					this.ds_Detail10.setColumn(iAddRow, "DE07_NM", arrRtnVal.DE07_NM);//관리상세명7
					this.ds_Detail10.setColumn(iAddRow, "DE08_NM", arrRtnVal.DE08_NM);//관리상세명8
					
					var acchDD = this.ds_Master10.getColumn(0, "ACCH_DD");
					
					this.ds_Detail10.setColumn(iAddRow, "SLIP_YN", this.ds_Master10.getColumn(0, "SLIP_YN"));//결의승인여부
					this.ds_Detail10.setColumn(iAddRow, "BUDG_MM", acchDD.substring(0, 6));//this.div_MasterInput.form.tab_Master.tpg_01.form.cal_AcchDd.value.substring(0, 6));//편성년월
					this.ds_Detail10.setColumn(iAddRow, "BUDP_CD", this.ds_Master10.getColumn(0, "DEPM_CD"));//예산부서코드
					this.ds_Detail10.setColumn(iAddRow, "BUDP_NM", this.ds_Master10.getColumn(0, "DEPM_NM"));//예산부서명
					this.ds_Detail10.setColumn(iAddRow, "CURR_CD","0090");//화폐(디폴트KRW)
					this.ds_Detail10.setColumn(iAddRow, "EXCH_RT", 1);//환율
					
				
					if(sConverGu=="D"){
						this.ds_Detail10.setColumn(iAddRow, "FRDB_AM", arrRtnVal.FRCR_AM);//외화차변
						this.ds_Detail10.setColumn(iAddRow, "FRCR_AM", 0);//외화대변
					}else{
						this.ds_Detail10.setColumn(iAddRow, "FRDB_AM", 0);//외화차변
						this.ds_Detail10.setColumn(iAddRow, "FRCR_AM", arrRtnVal.FRDB_AM);//외화대변
					}
					
					this.ds_Detail10.setColumn(iAddRow, "ANTI_NO", arrRtnVal.ACCH_NO);//결의번호-반제_발의번호
					this.ds_Detail10.setColumn(iAddRow, "ANTI_SE", arrRtnVal.ACCB_SE);//발의순번-반제_발의순번
					
					this.ds_Detail10.setColumn(iAddRow, "ANTI_YN", "1");//반제YN
					
					this.ds_Detail10.setColumn(iAddRow, "ACOM_ENABLE", "0");//계정코드 수정할수없게(0은 수정X, 나머지는 수정O)
				
					this.fn_dsAcomMa(this.ds_Detail10.getColumn(iAddRow, "ACOM_CD"), "", bCheckBgcm);//관리항목
					this.fvDsRowPosChangeDetail = true;
				}else{
					//반제 전표가 있는경우 메세지 처리
					//
					var arrMsgArg = [sRemkNm];
					this.gfn_Alert("FA023", arrMsgArg);//[ &ITM0 ]은(는) 중복 데이터 입니다.
				}
  			}
 		}
  	}

	//[Detail영역-검색]
};
 
/***********************************************************************************************
 * 13.03. [메세지] CallBack 함수 처리
 ***********************************************************************************************/  
this.fn_MsgCallback = function (strId, strVal)
{ 
	if (strId == "msgPop") {
		this.fvGridForcusYn = false;//그리드포커스여부-메세지무한출력때문에 추가
	}
}; 
 

/***********************************************************************************************
 * 15. [사용자정의 함수]
 ***********************************************************************************************/

/***********************************************************************************************
 * 15.01. [공통 그리드 버튼] 입력 버튼 설정
 ***********************************************************************************************/ 
this.fn_SetGridInputButton = function()
{
	//그리드 공통 버튼 권한이 있으면
	if (this.fvFormComBtnAuthYn)
	{
		this.gfn_SetGridInputBtnUrl(this.div_ComGrdBtn);//[공통] 그리드 입력 버튼 URL 설정
		
		//상세 그리드버튼 설정 : 버튼ID|권한(Y/N)|호출함수명
		var objBtnInfo01List = ["COPY|Y|fn_DetailGrd01Copy"
							 ,"ADD|Y|fn_DetailGrd01AddRow"
							 ,"INSERT|Y|fn_DetailGrd01InsertRow"
							 ,"DELETE|Y|fn_DetailGrd01DeleteRow"
							 ,"CANCEL|Y|fn_DetailGrd01Cancel"];
		this.div_ComGrdBtn.form.fn_SetGrdButtonFunc(this, objBtnInfo01List);	
		
		
	}
}
/***********************************************************************************************
 * 15.07. [계정코드 변경시]  datastore ds_acomMa 조회
 ***********************************************************************************************/ 
this.fn_dsAcomMa = function(acomCd, fnGu, bCheckBgcm)
{ 
	//acomCd : 계정코드
	//1. ds_acomMa 조회
	this.ds_Input.clearData();
	this.ds_Detail11.clearData();
	
	if(this.gfn_IsNull(acomCd)){
		return;
	}
	
	this.ds_Input.addRow();
	this.ds_Input.setColumn(0, "ACOM_CD", acomCd);
	
	//trace("fn_dsAcomMa acomCd =" +  acomCd + " fnGu =" + fnGu );
	
	
	
	//[공통]서비스정보 초기화
	this.gfn_InitComService(this);
	
	
	//[공통]서비스정보 추가
	var svcAddObj = new Object();//[공통] 서비스 추가 파라메타 정보 Object
	svcAddObj.sSelectSql = "fa:M_FA_1000_D_SL11";
	this.gfn_AddComSearchService(this, svcAddObj);
	
	//[공통]서비스 호출 변수
	var svcCallObj = new Object();//[공통] 서비스 파라메타 정보 Object
	
	
	if (fnGu =="SET"){
		//계정코드 입력
		svcCallObj.sTrid = "ACOM_MA_SET";//Transaction ID 등 callback에서 넘겨 받을 String을 지정
	}else{
		//rowsfocuschange
		svcCallObj.sTrid = "ACOM_MA";//Transaction ID 등 callback에서 넘겨 받을 String을 지정
	}
	svcCallObj.sActionName = this.G_SV_FA;//서버에서 호출할 Action - 모듈별로 호출되는 기본 Actio이 다름 : 공통 서비스 Action 업무구분  변수 참조
	svcCallObj.sInputDaset = "ds_Input=ds_Input" //입력 데이터셋
	svcCallObj.sOutDatset = "ds_AcomMa=ds_AcomMa";//출력 데이터셋
	svcCallObj.sOtherArg = "";//서버로 전송할 기타 Argument 정보 문자열, 예) key=value key2=value2
	svcCallObj.sCallBackFnc = "fn_Callback";//서버에서 처리가 완료된 후 Callback 받을 Function 명
	svcCallObj.isSync = true;//동기식으로 설정할지 여부
	
	//반제전표찾기시 동기식으로 설정
	//if (this.fvDetailGu == true) {
	//	svcCallObj.isSync = true;
	//}
			
	
	
	//[공통]서비스 호출
	this.gfn_CallComService(this, svcCallObj);
	
	
	/*
	//1. callback  에서 관리항목변경 및 입력된 데이타 입력
	*/
	
}

/***********************************************************************************************
 * 15.06. [MASTER 금액] DETAIL 차변금액 -> MASTER 금액 데이타 넣기 
 ***********************************************************************************************/ 
this.fn_AcchAmt = function()
{

	//DETAIL 차변금액 합을 Master그리드  금액으로 올린다.	
	var varSum;
	varSum = this.ds_Detail10.getCaseSum("crudType != 'D'", "CRED_AM");
	
	//trace("varSum ======= " + varSum);
	
	
	this.ds_Master10.setColumn(0, "ACCH_AM", varSum);	//Master에 금액 표기
	
	
	//trace("ACCH_AM ======= " + this.ds_Master10.getColumn(0, "ACCH_AM"));
	
	
	this.ds_Master10.setColumn(0, "crudType", "U");	    //crudType 변경
	
}

/***********************************************************************************************
 * 15.07. [계정코드 변경시]  datastore ds_acomMa 조회 후 MA_CD, 
 ***********************************************************************************************/ 
this.fn_SetMaNm = function(aRow)
{
	/*
	1. aRow = ds_Detail row 
	*/
	
	//this.ds_Detail10.setColumn(aRow, )
	var maNum;  //관리항목번호
	var maNm;   //관리항목명
	var maCd;   //관리항목코드
	var maYn;   // 관리항목 필수체크
	var Num;
	var reprYn;  //대표관리항목
	var iLoop=0;
	
	for (iLoop=0; iLoop < 8; iLoop++) {
		Num = "0"+ (iLoop+1);
		this.ds_Detail10.setColumn(aRow, "MA"+Num+"_NM", "");
		this.ds_Detail10.setColumn(aRow, "MA"+Num+"_CD", "");
		this.ds_Detail10.setColumn(aRow, "MA"+Num+"_YN", "");
		this.ds_Detail10.setColumn(aRow, "DE"+Num+"_CD", "");
		this.ds_Detail10.setColumn(aRow, "VDE"+Num+"_CD", "");
		this.ds_Detail10.setColumn(aRow, "DE"+Num+"_NM", "");
	
	}
	
	for (iLoop=0; iLoop < this.ds_AcomMa.getRowCount(); iLoop++) {
	
		//관리항목 컬럼 위치
		maNum =  this.ds_AcomMa.getColumn(iLoop, "MA_NUM")
		//관리항목명
		maNm = this.ds_AcomMa.getColumn(iLoop, "MA_NM");
		maCd = this.ds_AcomMa.getColumn(iLoop, "MA_CD");
		reprYn = this.ds_AcomMa.getColumn(iLoop, "REPR_YN"); //대표관리항목체크
		
		
		this.ds_Detail10.setColumn(aRow, "MA"+maNum+"_NM", maNm);
		this.ds_Detail10.setColumn(aRow, "MA"+maNum+"_CD", maCd);
	
	
		if (maCd == "Y"){
			//환율 관리항목이 있을 경우 환율은 0으로 한다.
			this.ds_Detail10.setColumn(aRow, "EXCH_RT", 0);
		}
			
			
		
		if(reprYn=="1"){
			this.ds_Detail10.setColumn(aRow, "MANA_NM", maNm);
			this.ds_Detail10.setColumn(aRow, "MANA_CD", maCd);
		}
		/*
		//default 값 자동입력
		 1) row = ds_Detail.rowposition
		 2) maCd = ds_Detail의 관리항목컬럼
		 3) maCdValue = 관리항목코드
		 4) deCd = 관리항목 상세컬럼
		 5) deNm = 관리항목명 상세컬럼
		*/
		this.fn_ItemAutoInput(aRow, "MA"+maNum+"_CD", maCd, "DE"+maNum+"_CD", "DE"+maNum+"_NM");
			
			
			
			
		//관리항목필수체크
		maYn = this.ds_AcomMa.getColumn(iLoop, "MA_YN")
		this.ds_Detail10.setColumn(aRow, "MA"+maNum+"_YN", maYn);
	}
	
	
			
}


/***********************************************************************************************
 * 15.08 [div taborder ] 공통함수
 ***********************************************************************************************/ 
this.fn_enterkeyTabOrder = function(obj, e)
{
	if(e.keycode == "13"){
		var curObj = this.getFocus();
		//trace("curObj = " + curObj);
		//  component = TextArea 인경우 엔터키 제외 시킨다. (예 비고)
		if (curObj != "[object TextArea]"){
			var objCom = curObj.parent.parent.form.getNextComponent(this.getFocus(),true);
					
			if(objCom.enable == false){
				objCom = curObj.parent.parent.form.getNextComponent(objCom.getFocus(),true);
			}
			
			if (objCom == "[object Combo]"){
			
			}
			objCom.setFocus();
		}
	}
}

/***********************************************************************************************
 * 15.09 [fn_MakeMaData ] 관리항목 컴포넌트 동적 생성
 ***********************************************************************************************/ 
this.fn_MakeMaData = function() {
		//생성된 컴포넌트 삭제
	var arrComList = this.div_detailRight.form.div_Item.form.components;//Div 생성된 전체 컴폰넌트

	if (!this.gfn_IsNull(arrComList)) {

		for (var iLoop = arrComList.length-1; iLoop >= 0; iLoop--) {
			if (arrComList[iLoop].id != "sta_DetailRightBottom") {
				var rObj = this.div_detailRight.form.div_Item.removeChild(arrComList[iLoop].id);
				rObj.destroy();
				rObj = null;
			}
		}

	}

	if (this.ds_AcomMa.getRowCount() > 0) {
	
		// div height 관리항목 개수에 맞게 조정 
		this.div_detailRight.form.div_Item.set_height(this.ds_AcomMa.getRowCount() * 30 + 30);
		//trace("this.div_detailRight.form.div_Item. = " + this.div_detailRight.form.div_Item.height);
		
		//if(this.wfreYn=="0"){
			// div 예산 top은 관리항목 div 밑으로 
		this.div_detailRight.form.div_Budget.set_top("div_Item:0");
		//}

	
		var iCompTop = 30;//컴포넌트Top
		var staBack;//Back Static
		var staLabel;//Label Static
		var sItemGu = "";//컴포넌트구분
		var edtCd;//Edit Code입력
		var VedtCd;//Edit Code입력
		var edtNm;//Edit CodeName입력
		var btnPopup;//Popup 버튼
		var calCd;//Calendar 입력
		var maeCd;//MaskEdit 입력
		var cboCd;//Combo 입력
		var sMaYn = "";//필수입력여부
		var sLengCt = 0;//자릿수
		var sGRCM_CD = "";//그룹코드
		var sDETA_CD = "";//함수명
		var sCD01_NM = "";//코드컬럼명
		var sCD02_NM = "";//코드명컬럼명
		var sFUNC_NM = "";//코드명함수명
		var sMA_NUM  = "";//관리항목순서
		var sACOM_CD = "";//계정코드
		var sDecrGu  = "";//차대구분
		var sAcchDecrGu  = "";//계정차대구분
		var sMaCd    = ""; //관리항목코드
		var iFvFindRow;
		var sBilmGu  = "";
		
		//관리항목 컴포넌트정보 데이터셋 초기화
		this.ds_CmMaInfo.clearData();
		this.ds_CmMaInfo.addRow();
		
		//바인딩
		var objBindItem = new BindItem();
		
		for (var iLoop=1; iLoop < 9; iLoop++) {
		
		
			
			//관리항목번호를 가져온다.
			sMA_NUM = this.fn_GetMakeMaData(iLoop, "MA_NUM");//관리항목순서
			//trace("sMA_NUM = " +sMA_NUM);
			if (sMA_NUM ==""){
				break;
			}
			//Back Static - 생성
			staBack = new Static("sta_Back" + iLoop, 0, iCompTop , null, 30, 0, null);
			staBack.set_cssclass("sta_WF_DBg");		
			this.div_detailRight.form.div_Item.addChild(staBack.name, staBack);		
			staBack.show();
			
			//Label Static - 생성
			staLabel = new Static("sta_Ma" + sMA_NUM, 0, iCompTop, 95, 30, null, null);
			staLabel.set_cssclass("sta_WF_DLabel");		
			staLabel.set_text(this.fn_GetMakeMaData(iLoop, "MA_NM"));//라벨명
			this.div_detailRight.form.div_Item.addChild(staLabel.name, staLabel);		
			staLabel.show();
			
			//입력컴포넌트 생성
			sItemGu = this.fn_GetMakeMaData(iLoop, "ITEM_GU");//컴포넌트구분
			sMaYn = this.fn_GetMakeMaData(iLoop, "MA_YN");//필수입력여부
			sLengCt = this.fn_GetMakeMaData(iLoop, "LENG_CT");//자릿수
			sGRCM_CD = this.fn_GetMakeMaData(iLoop, "CODM_CD");//그룹코드
			sDETA_CD = this.fn_GetMakeMaData(iLoop, "DETA_CD");//함수명
			sCD01_NM = this.fn_GetMakeMaData(iLoop, "CD01_NM");//코드컬럼명
			sCD02_NM = this.fn_GetMakeMaData(iLoop, "CD02_NM");//코드명컬럼명
			sFUNC_NM = this.fn_GetMakeMaData(iLoop, "FUNC_NM");//코드명함수명
			sACOM_CD = this.fn_GetMakeMaData(iLoop, "ACOM_CD");//계정코드
			sACOM_GU = this.fn_GetMakeMaData(iLoop, "ACOM_GU");//계정코드
			sDecrGu  = this.fn_GetMakeMaData(iLoop, "DECR_GU");//계정차대구분
			sMaCd    = this.fn_GetMakeMaData(iLoop, "MA_CD");  //관리항목코드
			sReprYn  = this.fn_GetMakeMaData(iLoop, "REPR_YN");//대표관리항목YN
			sAcchDecrGu = this.ds_Detail10.getColumn(this.ds_Detail10.rowposition, "DECR_GU");
			
			
			/*
				1. 받을어음, 지급어음의 계정차대구분과 전표등록 차대구분이 같을경우 TEXT로 변경한다.
			*/
			if((sACOM_GU =="0020" || sACOM_GU =="0030") && sItemGu == "0020" && sMaCd == "6"){
				//받을어음, 지급어음의 계정차대구분과 전표등록 차대구분이 같을경우 TEXT로 변경한다.
				if(sDecrGu == sAcchDecrGu){
					sItemGu = "0010";
					// 코드값은 삭제한다.
					//this.ds_CmMaInfo.setColumn(0, "DE"+sMA_NUM+"_CD", "");
				}
			}
			
			
			//컴포넌트 바인딩 정보 삭제
			if (this.fn_FindBindItem("this.itemMa" + sMA_NUM + "Cd")) {
				var rtnobj = this.removeChild("this.itemMa" + sMA_NUM + "Cd");
				rtnobj.destroy();
			}
			if (this.fn_FindBindItem("this.itemMa" + sMA_NUM + "Nm")) {
				var rtnobj = this.removeChild("this.itemMa" + sMA_NUM + "Nm");
				rtnobj.destroy();
			}			
							
			if (this.fn_FindBindItem("this.itemMaV" + sMA_NUM + "Cd")) {
				var rtnobj = this.removeChild("this.itemMaV" + sMA_NUM + "Cd");
				rtnobj.destroy();
			}				
				
			//TEXT
			if (sItemGu == "0010") {
				//Edit Code - 생성
				edtCd = new Edit("edt_De" + sMA_NUM + "Cd", 98, iCompTop+3, null, 24, 3, null);
	
				//필수입력일때 - CSS변경
				if (sMaYn == "1") {
					edtCd.set_cssclass("essential");	
				}							 
				  
				//Max Length 설정
				edtCd.set_maxlength(sLengCt);
				this.div_detailRight.form.div_Item.addChild(edtCd.name, edtCd);		
				edtCd.show();		
				
				//바인딩설정
				objBindItem = new BindItem();
				objBindItem.init("this.itemMa" + sMA_NUM + "Cd", "div_detailRight.form.div_Item.form." + "edt_De" + sMA_NUM + "Cd", "value", "ds_CmMaInfo", "DE" + sMA_NUM + "_NM");
				this.addChild("this.itemMa" + sMA_NUM + "Cd", objBindItem); 
				objBindItem.bind();
		
			//POPUP
			} else if (sItemGu == "0020") {
				
				//Edit Code - 생성
				edtCd = new Edit("edt_De" + sMA_NUM + "Cd", 98, iCompTop+3, 103, 24, null, null);
	
				//필수입력일때 - CSS변경
				if (sMaYn == "1") {
					edtCd.set_cssclass("essential");	
				}
				edtCd.set_visible(false);
				
				//Max Length 설정
				edtCd.set_maxlength(sLengCt);
				this.div_detailRight.form.div_Item.addChild(edtCd.name, edtCd);		
				edtCd.FUNC_NM = sFUNC_NM;
				edtCd.ColCd = "this.div_detailRight.form.div_Item.form." + "edt_De" + sMA_NUM + "Cd";//관리항목-코드컴포넌트
				edtCd.VColCd = "this.div_detailRight.form.div_Item.form." + "edt_VDe" + sMA_NUM + "Cd";//관리항목-코드컴포넌트
				edtCd.ColNm = "this.div_detailRight.form.div_Item.form." + "edt_De" + sMA_NUM + "Nm";//관리항목-코드명컴포넌트				
				edtCd.GRCM_CD = sGRCM_CD;  // 공통그룹코드
				//trace("sGRCM_CD ===========" + sGRCM_CD);
				//trace("sFUNC_NM ===========" + sFUNC_NM);
				edtCd.sCD01_NM = sCD01_NM;//관리항목-코드컬럼명
				edtCd.sCD02_NM = sCD02_NM;//관리항목-코드명컬럼명
				
				edtCd.ACOM_GU = sACOM_GU;  // 계정자료구분
				edtCd.MaSeq = sMA_NUM;//관리항목-순번
				edtCd.DETA_CD = sDETA_CD;//관리항목-함수명
				edtCd.DecrGu = sDecrGu;   //차대구분
				edtCd.MaCd = sMaCd; //관리항목코드
				edtCd.ReprYn = sReprYn;//대표관리항목
				edtCd.AcchDecrGu = sAcchDecrGu;  //전표등록의 차대구분
				
				edtCd.addEventHandler("onchanged", this.fn_ComMaEditChangedEvent, this);//Edit 변경이벤트
				edtCd.show();		
				
				
				
				//Edit Code - 생성
				VedtCd = new Edit("edt_VDe" + sMA_NUM + "Cd", 98, iCompTop+3, 103, 24, null, null);
	
				//필수입력일때 - CSS변경
				if (sMaYn == "1") {
					VedtCd.set_cssclass("essential");	
				}
				
				//VedtCd.set_visible(false);
				//Max Length 설정
				VedtCd.set_maxlength(sLengCt);
				this.div_detailRight.form.div_Item.addChild(VedtCd.name, VedtCd);		
				VedtCd.FUNC_NM = sFUNC_NM;
				VedtCd.ColCd = "this.div_detailRight.form.div_Item.form." + "edt_De" + sMA_NUM + "Cd";//관리항목-코드컴포넌트
				VedtCd.VColCd = "this.div_detailRight.form.div_Item.form." + "edt_VDe" + sMA_NUM + "Cd";//관리항목-코드컴포넌트
				VedtCd.ColNm = "this.div_detailRight.form.div_Item.form." + "edt_De" + sMA_NUM + "Nm";//관리항목-코드명컴포넌트				
				VedtCd.GRCM_CD = sGRCM_CD;  // 공통그룹코드
				VedtCd.sCD01_NM = sCD01_NM;//관리항목-코드컬럼명
				VedtCd.sCD02_NM = sCD02_NM;//관리항목-코드명컬럼명
				
				
				VedtCd.ACOM_GU = sACOM_GU;  // 계정자료구분
				VedtCd.MaSeq = sMA_NUM;//관리항목-순번
				VedtCd.DETA_CD = sDETA_CD;//관리항목-함수명
				VedtCd.DecrGu = sDecrGu;   //차대구분
				VedtCd.MaCd = sMaCd; //관리항목코드
				VedtCd.ReprYn = sReprYn;//대표관리항목
				VedtCd.AcchDecrGu = sAcchDecrGu;  //전표등록의 차대구분
				
				
				VedtCd.addEventHandler("onchanged", this.fn_ComMaEditChangedEvent, this);//Edit 변경이벤트
				//trace("POPUP 4235=====1");
				VedtCd.show();		
				
				
				
				//Edit CodeName - 생성
				edtNm = new Edit("edt_De" + sMA_NUM + "Nm", 204, iCompTop+3, null, 24, 30, null);
				this.div_detailRight.form.div_Item.addChild(edtNm.name, edtNm);		
				//edtNm.set_enable(false);
				edtNm.set_readonly(true);
				edtNm.show();				

				btnPopup;//Popup 버튼
				btnPopup = new Button("btn_Ma" + sMA_NUM, null, iCompTop+3, 24, 24, 3, null);
				btnPopup.set_cssclass("btn_WF_SmallSearch");
				btnPopup.set_cursor("pointer");
				this.div_detailRight.form.div_Item.addChild(btnPopup.name, btnPopup);			
				btnPopup.addEventHandler("onclick", this.fn_ComMaPopupBtnEvent, this);
				btnPopup.MaSeq = sMA_NUM;//관리항목-순번
				btnPopup.DETA_CD = sDETA_CD;//관리항목-함수명
				btnPopup.ColCd = sCD01_NM;//관리항목-코드컬럼명
				btnPopup.VColCd = sCD01_NM;//관리항목-코드컬럼명
				btnPopup.ColNm = sCD02_NM;//관리항목-코드명컬럼명
				btnPopup.GrcmCd = sGRCM_CD;  //그룹코드
				btnPopup.AcomCd = sACOM_CD;  //계정코드
				btnPopup.AcomGu = sACOM_GU;  //계정구분
				btnPopup.DecrGu = sDecrGu;   //차대구분
				btnPopup.show();	
				
				//바인딩설정
				objBindItem = new BindItem();
				objBindItem.init("this.itemMa" + sMA_NUM + "Cd", "div_detailRight.form.div_Item.form." + "edt_De" + sMA_NUM + "Cd", "value", "ds_CmMaInfo", "DE" + sMA_NUM + "_CD");
				this.addChild("this.itemMa" + sMA_NUM + "Cd", objBindItem); 
				objBindItem.bind();
								
				//바인딩설정
				objBindItem = new BindItem();
				objBindItem.init("this.itemMaV" + sMA_NUM + "Cd", "div_detailRight.form.div_Item.form." + "edt_VDe" + sMA_NUM + "Cd", "value", "ds_CmMaInfo", "VDE" + sMA_NUM + "_CD");
				this.addChild("this.itemMaV" + sMA_NUM + "Cd", objBindItem); 
				objBindItem.bind();
				
				//바인딩설정
				objBindItem = new BindItem();
				objBindItem.init("this.itemMa" + sMA_NUM + "Nm", "div_detailRight.form.div_Item.form." + "edt_De" + sMA_NUM + "Nm", "value", "ds_CmMaInfo", "DE" + sMA_NUM + "_NM");
				this.addChild("this.itemMa" + sMA_NUM + "Nm", objBindItem); 
				objBindItem.bind();

			//Number(형식없음)
			} else if (sItemGu == "0030") {
				//Edit Code - 생성
				maeCd = new MaskEdit("mae_De" + sMA_NUM + "Cd", 98, iCompTop+3, null, 24, 3, null);
	
				//필수입력일때 - CSS변경
				if (sMaYn == "1") {
					maeCd.set_cssclass("essential");	
				}
				
				//Mask 설정
				maeCd.set_format("##0");
				maeCd.set_type("number");
				this.div_detailRight.form.div_Item.addChild(maeCd.name, maeCd);		
				maeCd.show();	
				
				//바인딩설정
				objBindItem = new BindItem();
				objBindItem.init("this.itemMa" + sMA_NUM + "Cd", "div_detailRight.form.div_Item.form." + "mae_De" + sMA_NUM + "Cd", "value", "ds_CmMaInfo", "DE" + sMA_NUM + "_NM");
				this.addChild("this.itemMa" + sMA_NUM + "Cd", objBindItem); 
				objBindItem.bind();

			//Number(천단위)
			} else if (sItemGu == "0040") {
				//Edit Code - 생성
				maeCd = new MaskEdit("mae_De" + sMA_NUM + "Cd", 98, iCompTop+3, null, 24, 3, null);
	
				//필수입력일때 - CSS변경
				if (sMaYn == "1") {
					maeCd.set_cssclass("essential");	
				}
				
				//Mask 설정
				maeCd.set_format("###,###,###,##0");
				maeCd.set_type("number");
				this.div_detailRight.form.div_Item.addChild(maeCd.name, maeCd);		
				maeCd.show();		
				
				//바인딩설정
				objBindItem = new BindItem();
				objBindItem.init("this.itemMa" + sMA_NUM + "Cd", "div_detailRight.form.div_Item.form." + "mae_De" + sMA_NUM + "Cd", "value", "ds_CmMaInfo", "DE" + sMA_NUM + "_NM");
				this.addChild("this.itemMa" + sMA_NUM + "Cd", objBindItem); 
				objBindItem.bind();				

			//Number(소숫점2자리)
			} else if (sItemGu == "0050") {
				//Edit Code - 생성
				maeCd = new MaskEdit("mae_De0" + iLoop + "Cd", 98, iCompTop+3, null, 24, 3, null);
	
				//필수입력일때 - CSS변경
				if (sMaYn == "1") {
					maeCd.set_cssclass("essential");	
				}
				
				//Mask 설정
				maeCd.set_format("###,###,###,##0.##");
				maeCd.set_type("number");
				maeCd.set_limitbymask("both");
				this.div_detailRight.form.div_Item.addChild(maeCd.name, maeCd);		
				maeCd.show();		
				
				maeCd.MaCd = sMaCd; //관리항목코드
				maeCd.ReprYn = sReprYn;//대표관리항목
				maeCd.DecrGu = sDecrGu;   //차대구분
				maeCd.AcchDecrGu = sAcchDecrGu;  //전표등록의 차대구분
				
				maeCd.addEventHandler("onchanged", this.fn_ComMaEditChangedEvent, this);//Edit 변경이벤트
				maeCd.show();
				
				
				//바인딩설정
				objBindItem = new BindItem();
				objBindItem.init("this.itemMa" + sMA_NUM + "Cd", "div_detailRight.form.div_Item.form." + "mae_De" + sMA_NUM + "Cd", "value", "ds_CmMaInfo", "DE0" + iLoop + "_NM");
				this.addChild("this.itemMa" + sMA_NUM + "Cd", objBindItem); 
				objBindItem.bind();

			//Number(소숫점4자리)
			} else if (sItemGu == "0055") {
				//Edit Code - 생성
				maeCd = new MaskEdit("mae_De" + sMA_NUM + "Cd", 98, iCompTop+3, null, 24, 3, null);
	
				//필수입력일때 - CSS변경
				if (sMaYn == "1") {
					maeCd.set_cssclass("essential");	
				}
				
				//Mask 설정
				maeCd.set_format("###,###,###,##0.####");
				maeCd.set_type("number");
				maeCd.set_limitbymask("both");
				this.div_detailRight.form.div_Item.addChild(maeCd.name, maeCd);		
				maeCd.show();	
				
				
				maeCd.MaCd = sMaCd; //관리항목코드
				maeCd.ReprYn = sReprYn;//대표관리항목
				maeCd.DecrGu = sDecrGu;   //차대구분
				maeCd.AcchDecrGu = sAcchDecrGu;  //전표등록의 차대구분
				
				maeCd.addEventHandler("onchanged", this.fn_ComMaEditChangedEvent, this);//Edit 변경이벤트
				maeCd.show();
				
				
				//바인딩설정
				objBindItem = new BindItem();
				objBindItem.init("this.itemMa" + sMA_NUM + "Cd", "div_detailRight.form.div_Item.form." + "mae_De" + sMA_NUM + "Cd", "value", "ds_CmMaInfo", "DE" + sMA_NUM + "_NM");
				this.addChild("this.itemMa" + sMA_NUM + "Cd", objBindItem); 
				objBindItem.bind();

			//DATE(YYYY/MM/DD)	
			} else if (sItemGu == "0060") {
				//Edit Code - 생성
				calCd = new Calendar("cal_De" + sMA_NUM + "Cd", 98, iCompTop+3, 113, 24, null, null);
	
				//필수입력일때 - CSS변경
				if (sMaYn == "1") {
					calCd.set_cssclass("essential");	
				}
				calCd.set_dateformat("yyyy-MM-dd");
				this.div_detailRight.form.div_Item.addChild(calCd.name, calCd);		
				calCd.show();			
				
				//바인딩설정
				objBindItem = new BindItem();
				objBindItem.init("this.itemMa" + sMA_NUM + "Cd", "div_detailRight.form.div_Item.form." + "cal_De" + sMA_NUM + "Cd", "value", "ds_CmMaInfo", "DE" + sMA_NUM + "_NM");
				this.addChild("this.itemMa" + sMA_NUM + "Cd", objBindItem); 
				objBindItem.bind();			
			//DATE(YYYY/MM/DD) ~ DATE(YYYY/MM/DD)
			} else if (sItemGu == "0065") {
				//Edit Code - 생성
				calCd = new Calendar("cal_De" + sMA_NUM + "Cd", 96, iCompTop+3, 113, 24, null, null);
				calText = new Static("sta_Ca" + sMA_NUM, 213, iCompTop , 22, 30, null, null);
				calNm = new Calendar("cal_De" + sMA_NUM + "Nm", 238, iCompTop+3, 113, 24, null, null);
	
				//필수입력일때 - CSS변경
				if (sMaYn == "1") {
					calCd.set_cssclass("essential");	
					calNm.set_cssclass("essential");	
				}
				calCd.set_dateformat("yyyy-MM-dd");
				this.div_detailRight.form.div_Item.addChild(calCd.name, calCd);		
				calCd.show();			


				calText.set_cssclass("sta_WF_DLabel");		
				calText.set_text("~");//~
				this.div_detailRight.form.div_Item.addChild(calText.name, calText);
				calText.show();
				
				
				calNm.set_dateformat("yyyy-MM-dd");
				this.div_detailRight.form.div_Item.addChild(calNm.name, calNm);		
				calNm.show();			


				//바인딩설정
				objBindItem = new BindItem();
				objBindItem.init("this.itemMa" + sMA_NUM + "Cd", "div_detailRight.form.div_Item.form." + "cal_De" + sMA_NUM + "Cd", "value", "ds_CmMaInfo", "DE" + sMA_NUM + "_CD");
				this.addChild("this.itemMa" + sMA_NUM + "Cd", objBindItem); 
				objBindItem.bind();	
				
				objBindItem = new BindItem();
				objBindItem.init("this.itemMa" + sMA_NUM + "Nm", "div_detailRight.form.div_Item.form." + "cal_De" + sMA_NUM + "Nm", "value", "ds_CmMaInfo", "DE" + sMA_NUM + "_NM");
				this.addChild("this.itemMa" + sMA_NUM + "Nm", objBindItem); 
				objBindItem.bind();		
				
			 //DATE(YYYY/MM)   
			 } else if (sItemGu == "0070") {
				//Edit Code - 생성
				calCd = new Calendar("cal_De" + sMA_NUM + "Cd", 96, iCompTop+3, 113, 24, null, null);
	
				//필수입력일때 - CSS변경
				if (sMaYn == "1") {
					calCd.set_cssclass("essential");	
				}
				
				calCd.set_dateformat("yyyy-MM");
				calCd.set_editformat("yyyy-MM");
				
				calCd.Id = "cal_De" + sMA_NUM + "Cd";
				calCd.popuptype = "none";
				calCd.addEventHandler("ondropdown", this.cal_ondropdown , this, this);
				
				
				this.div_detailRight.form.div_Item.addChild(calCd.name, calCd);		
				calCd.show();			
				
				//바인딩설정
				objBindItem = new BindItem();
				objBindItem.init("this.itemMa" + sMA_NUM + "Cd", "div_detailRight.form.div_Item.form." + "cal_De" + sMA_NUM + "Cd", "value", "ds_CmMaInfo", "DE" + sMA_NUM + "_NM");
				this.addChild("this.itemMa" + sMA_NUM + "Cd", objBindItem); 
				objBindItem.bind();						

			//콤보입력
			} else if (sItemGu == "0090") {
				//콤보관련 데이터셋 생성
				this.fn_MakeMaDataSet(sGRCM_CD);
				
				//Edit Code - 생성
				cboCd = new Combo("cbo_De" + sMA_NUM + "Cd", 98, iCompTop+3, null, 24, 3, null);
	
				//필수입력일때 - CSS변경
				if (sMaYn == "1") {
					cboCd.set_cssclass("essential");	
				}
				
				//콤보 설정
				cboCd.set_codecolumn("CODM_CD");
				cboCd.set_datacolumn("CODM_NM");
				cboCd.set_innerdataset("ds_ComMa" + sGRCM_CD);
				cboCd.CD_NM = "DE" + sMA_NUM + "_NM";//[콤보]관리항목-코드명컬럼명
				cboCd.VCD_CD = "VDE" + sMA_NUM + "_CD";//[콤보]관리항목-코드명컬럼명
				this.div_detailRight.form.div_Item.addChild(cboCd.name, cboCd);		
		
				
				cboCd.addEventHandler("onitemchanged", this.fn_ComMaComboChangedEvent, this);//[콤보] 변경이벤트
				cboCd.show();
				
				
				
				//바인딩설정
				objBindItem = new BindItem();
				objBindItem.init("this.itemMa" +sMA_NUM + "Cd", "div_detailRight.form.div_Item.form." + "cbo_De" + sMA_NUM + "Cd", "value", "ds_CmMaInfo", "DE" + sMA_NUM + "_CD");
				this.addChild("this.itemMa" + sMA_NUM + "Cd", objBindItem); 
				objBindItem.bind();						

			}
			
			iCompTop = iCompTop + 29;		
		}
		
		//ds_Detail10 데이터를 관리항목 데이터셋에 복사
		var iPos = this.ds_Detail10.rowposition;
		
		var fromDd;
		var toDd;
		for (var iLoop=1; iLoop < 9; iLoop++) {
			
			if(this.ds_Detail10.getColumn(iPos, "MA0" + iLoop + "_CD") == "f"){
				//기간인경우 DEXX_NM을 '-' 잘라서 넣는다.
				//trace("fn_MakeMaData");
				if(!this.gfn_IsNull(this.ds_Detail10.getColumn(iPos, "DE0" + iLoop + "_NM"))){
				    
					fromDd = this.ds_Detail10.getColumn(iPos, "DE0" + iLoop + "_NM").substring(0,8);
					
					//trace("fn_MakeMaData fromDd = " + fromDd);
					
					
					this.ds_CmMaInfo.setColumn(0, "DE0" + iLoop + "_CD", fromDd);
					//this.ds_CmMaInfo.setColumn(0, "VDE0" + iLoop + "_CD", fromDd);
				}
				
				if(!this.gfn_IsNull(this.ds_Detail10.getColumn(iPos, "DE0" + iLoop + "_NM"))){
					toDd   = this.ds_Detail10.getColumn(iPos, "DE0" + iLoop + "_NM").substring(9,17);
					this.ds_CmMaInfo.setColumn(0, "DE0" + iLoop + "_NM", toDd);
				}
			} else if(this.ds_Detail10.getColumn(iPos, "MA0" + iLoop + "_CD") == "q"){
				//관리년월은 6자리만 입력한다.
				
				if(!this.gfn_IsNull(this.ds_Detail10.getColumn(iPos, "DE0" + iLoop + "_NM"))){
					fromDd = this.ds_Detail10.getColumn(iPos, "DE0" + iLoop + "_NM");
					this.ds_CmMaInfo.setColumn(0, "DE0" + iLoop + "_NM", fromDd);
					//this.ds_CmMaInfo.setColumn(0, "VDE0" + iLoop + "_CD", fromDd);
				}				
	
			}else{
			
				
			
				this.ds_CmMaInfo.setColumn(0, "DE0" + iLoop + "_CD", this.ds_Detail10.getColumn(iPos, "DE0" + iLoop + "_CD"));
				this.ds_CmMaInfo.setColumn(0, "VDE0" + iLoop + "_CD", this.ds_Detail10.getColumn(iPos, "VDE0" + iLoop + "_CD"));
				this.ds_CmMaInfo.setColumn(0, "DE0" + iLoop + "_NM", this.ds_Detail10.getColumn(iPos, "DE0" + iLoop + "_NM"));
			}
		
		}
	}else{
	
	
		this.div_detailRight.form.div_Item.set_height(60);
	}

	//[결재] Div하위의 컴포넌트 Enable 처리
	//this.gfn_SetCompGroupEnable(this.div_detailRight.form, false);
}
 
/***********************************************************************************************
 * 15.10 [fn_GetMakeMaData ] 관리항목 컴포넌트 정보찾기
 ***********************************************************************************************/ 
this.fn_GetMakeMaData = function(iRow, sCol) {
	var rtnValue = "";
	if (this.ds_AcomMa.getRowCount() > 0) {
		if (iRow <= this.ds_AcomMa.getRowCount()) {
			rtnValue = this.ds_AcomMa.getColumn(iRow-1, sCol);
		}
	}
	
	return rtnValue;
}

/***********************************************************************************************
 * 15.11 [fn_MakeMaDataSet ] 관리항목 컴포넌트 데이터셋 생성 및 데이터조회
 ***********************************************************************************************/ 
this.fn_MakeMaDataSet = function(sGRCM_CD) {
	
	var dsCodm = "ds_ComMa" + sGRCM_CD;
	
	//관리항목 관련 데이터셋 정보가 없으면 - 생성
	if (this.gfn_IsNull(this.objects[dsCodm])) {
		var dsObj = new Dataset;
		dsObj.set_name(dsCodm);//데이터셋명 설정
		this.addChild(dsObj.name, dsObj);//해당 화면에 데이터셋 등록
		
		//컬럼정보 생성
		dsObj.addColumn("CODM_CD", "string");
		dsObj.addColumn("CODM_NM", "string");
	} else {
		eval("this." + dsCodm).clearData();
	}
	
	//[공통] 공통코드 설정 : 공통코드|데이터셋명|초기항목추가여부(Y/N)|추가항목
	var objCondList = [sGRCM_CD + "|" + dsCodm];
	//공통코드 설정함수 호출				   
	this.gfn_GetCommCode(this, objCondList, "");	
	
}

/***********************************************************************************************
 * 15.12 [fn_ComMaPopupBtnEvent ] 관리항목 팝업관련 이벤트
 ***********************************************************************************************/ 
this.fn_ComMaPopupBtnEvent = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{ 
	//관리항목 순번정보가 있으면
	if (!this.gfn_IsNull(obj.MaSeq)) {		
		
		var sMaSeq = obj.MaSeq;//관리항목-순번
		var sDETA_CD = obj.DETA_CD;//관리항목-팝업함수
		var sColCd = obj.ColCd;//관리항목-코드컬럼
		var sVColCd = obj.VColCd;//VIEW 관리항목-코드컬럼
		var sColNm = obj.ColNm;//관리항목-코드명컬럼
		var sCodmCd = obj.GrcmCd;  //공통코드
		var sPopuCd = obj.PopuCd; //팝업사용구분(FA033) 양쪽사용(0010), 차변만(0020), 대변만(0030)
		var sAcomCd = obj.AcomCd; // 계정코드
		var sAcomGu = obj.AcomGu; // 계정구분
		var sDecrGu = obj.DecrGu; //  차대구분
		
		var sColCdValue ="" ; // 관리항목 코드 데이타
		var sColNmValue = "" ; // 관리항목 명 데이타
		
		var sAcchDecrGu = this.ds_Detail10.getColumn(this.ds_Detail10.rowposition, "DECR_GU");  // 차대구분
		
		
		
		//관리항목 순번
		if (sMaSeq == "01") {
			this.fvCmMaPopupId01 = "MA01_" + sDETA_CD;//팝업ID
			this.fvCmMaRtnColCd01 = sColCd;
			this.fvCmMaRtnColNm01 = sColNm;
			sColCdValue = this.div_detailRight.form.div_Item.form.edt_De01Cd.value;
			sColCdValue = this.div_detailRight.form.div_Item.form.edt_VDe01Cd.value;
			sColNmValue = this.div_detailRight.form.div_Item.form.edt_De01Nm.value;
		} else if (sMaSeq == "02") {
			//trace("sDETA_CD = " + sDETA_CD+ "-======= sMaSeq=" + sMaSeq);
			this.fvCmMaPopupId02 = "MA02_" + sDETA_CD;//팝업ID
			this.fvCmMaRtnColCd02 = sColCd;
			this.fvCmMaRtnColNm02 = sColNm;
			sColCdValue = this.div_detailRight.form.div_Item.form.edt_De02Cd.value;
			sColCdValue = this.div_detailRight.form.div_Item.form.edt_VDe02Cd.value;
			sColNmValue = this.div_detailRight.form.div_Item.form.edt_De02Nm.value;
		} else if (sMaSeq == "03") {
			this.fvCmMaPopupId03 = "MA03_" + sDETA_CD;//팝업ID
			this.fvCmMaRtnColCd03 = sColCd;
			this.fvCmMaRtnColNm03 = sColNm;
			sColCdValue = this.div_detailRight.form.div_Item.form.edt_De03Cd.value;
			sColCdValue = this.div_detailRight.form.div_Item.form.edt_VDe03Cd.value;
			sColNmValue = this.div_detailRight.form.div_Item.form.edt_De03Nm.value;
		} else if (sMaSeq == "04") {
			this.fvCmMaPopupId04 = "MA04_" + sDETA_CD;//팝업ID
			this.fvCmMaRtnColCd04 = sColCd;
			this.fvCmMaRtnColNm04 = sColNm;
			sColCdValue = this.div_detailRight.form.div_Item.form.edt_De04Cd.value;
			sColCdValue = this.div_detailRight.form.div_Item.form.edt_VDe04Cd.value;
			sColNmValue = this.div_detailRight.form.div_Item.form.edt_De04Nm.value;
		} else if (sMaSeq == "05") {
			this.fvCmMaPopupId05 = "MA05_" + sDETA_CD;//팝업ID
			this.fvCmMaRtnColCd05 = sColCd;
			this.fvCmMaRtnColNm05 = sColNm;
			sColCdValue = this.div_detailRight.form.div_Item.form.edt_De05Cd.value;
			sColCdValue = this.div_detailRight.form.div_Item.form.edt_VDe05Cd.value;
			sColNmValue = this.div_detailRight.form.div_Item.form.edt_De05Nm.value;
		} else if (sMaSeq == "06") {
			this.fvCmMaPopupId06 = "MA06_" + sDETA_CD;//팝업ID
			this.fvCmMaRtnColCd06 = sColCd;
			this.fvCmMaRtnColNm06 = sColNm;
			sColCdValue = this.div_detailRight.form.div_Item.form.edt_De06Cd.value;
			sColCdValue = this.div_detailRight.form.div_Item.form.edt_VDe06Cd.value;
			sColNmValue = this.div_detailRight.form.div_Item.form.edt_De06Nm.value;
		} else if (sMaSeq == "07") {
			this.fvCmMaPopupId07 = "MA07_" + sDETA_CD;//팝업ID
			this.fvCmMaRtnColCd07 = sColCd;
			this.fvCmMaRtnColNm07 = sColNm;
			sColCdValue = this.div_detailRight.form.div_Item.form.edt_De07Cd.value;
			sColCdValue = this.div_detailRight.form.div_Item.form.edt_VDe07Cd.value;
			sColNmValue = this.div_detailRight.form.div_Item.form.edt_De07Nm.value;
		} else if (sMaSeq == "08") {
			this.fvCmMaPopupId08 = "MA08_" + sDETA_CD;//팝업ID
			this.fvCmMaRtnColCd08 = sColCd;
			this.fvCmMaRtnColNm08 = sColNm;		
			sColCdValue = this.div_detailRight.form.div_Item.form.edt_De08Cd.value;
			sColCdValue = this.div_detailRight.form.div_Item.form.edt_VDe08Cd.value;
			sColNmValue = this.div_detailRight.form.div_Item.form.edt_De08Nm.value;	
		}
		

		//var sPopuCd = obj.PopuCd; //팝업사용구분(FA033) 양쪽사용(0010), 차변만(0020), 대변만(0030)
		var sPopupId = "MA" + sMaSeq + "_" + sDETA_CD;//팝업ID
			
		//팝업함수명-계약번호
		if (sDETA_CD == "gfn_ContPop") {
			var oArg = { CnthNo:sColCdValue, PrgmId:this.fvComPrgmId};//Argument처리
			this.gfn_ContPop(sPopupId, oArg, "fn_ComMaPopupCallback");	
		//팝업함수명-거래처
		} else if (sDETA_CD == "gfn_CusmPop") {
			var oArg = { CusmNm:sColNmValue};//Argument처리
			this.gfn_CusmPop(sPopupId, oArg, "fn_ComMaPopupCallback");	
		//팝업함수명-사원
		} else if (sDETA_CD == "gfn_UserPop") {
			var oArg = { EmpmNm:sColNmValue};//Argument처리
			this.gfn_UserPop(sPopupId, oArg, "fn_ComMaPopupCallback");	
		//팝업함수명-부서
		} else if (sDETA_CD == "gfn_DeptPop") {
			//var oArg = { DepmNm:this.div_detailRight.form.div_Item.form.edt_De01Nm.value};//Argument처리
			var oArg = { DepmNm:sColNmValue};//Argument처리
			this.gfn_DeptPop(sPopupId, oArg, "fn_ComMaPopupCallback");		
		//팝업함수명-은행
		} else if (sDETA_CD == "gfn_BanmPop") {
			var oArg = { BanmNm:sColCdValue};//Argument처리
			this.gfn_BanmPop(sPopupId, oArg, "fn_ComMaPopupCallback");			
		//팝업함수명-품목코드
		} else if (sDETA_CD == "gfn_ItemPop") {
			var oArg = { ItemCd:sColCdValue};//Argument처리
			this.gfn_ItemPop(sPopupId, oArg, "fn_ComMaPopupCallback");					
		//팝업함수명-공통코드
		} else if (sDETA_CD == "gfn_CodmPop") {
			var oArg = { GrcmCd:sCodmCd, CodmCd:sColCdValue};//Argument처리
			this.gfn_CodmPop(sPopupId, oArg, "fn_ComMaPopupCallback");					
		//팝업함수명-사업장
		} else if (sDETA_CD == "gfn_SaumPop") {
			var oArg = { SaumNm:sColCdValue};//Argument처리
			this.gfn_SaumPop(sPopupId, oArg, "fn_ComMaPopupCallback");					
		} else if (sDETA_CD == "gfn_DebmPop") {				
		//팝업함수명-차입금
			var oArg = { DebmNm:sColCdValue};//Argument처리
			this.gfn_DebmPop(sPopupId, oArg, "fn_ComMaPopupCallback");					
		} else if (sDETA_CD == "gfn_BilmPop") {				
		//팝업함수명-어음
			var oArg = { BilmNo:sColCdValue , BilmGu:sAcomGu};//Argument처리
			this.gfn_BilmPop(sPopupId, oArg, "fn_ComMaPopupCallback");					
		} else if (sDETA_CD == "gfn_BilpPop") {				
		//팝업함수명-지급어음
			var oArg = { BilmNo:sColCdValue};//Argument처리
			this.gfn_BilpPop(sPopupId, oArg, "fn_ComMaPopupCallback");					
		} else if (sDETA_CD == "gfn_BilrPop") {				
		//팝업함수명-받을어음
			//var oArg = { ItemCd:this.div_detailRight.form.div_Item.form.edt_De01Cd.value};//Argument처리
			//trace("sCodmCd = "+sCodmCd)
			var oArg = { BilmNo:sColCdValue};//Argument처리
			this.gfn_BilrPop(sPopupId, oArg, "fn_ComMaPopupCallback");					
		} else if (sDETA_CD == "gfn_AcnmPop") {				
		//팝업함수명-계좌번호
			var oArg = { AcnmNo:sColCdValue};//Argument처리
			this.gfn_AcnmPop(sPopupId, oArg, "fn_ComMaPopupCallback");					
		} else if (sDETA_CD == "gfn_LoamPop") {				
		//팝업함수명-대여금
			var oArg = { LoamNm:sColCdValue};//Argument처리
			this.gfn_LoamPop(sPopupId, oArg, "fn_ComMaPopupCallback");					
		} else if (sDETA_CD == "gfn_CremPop") {				
		//팝업함수명-법인카드번호
			var oArg = { CremNo:sColCdValue};//Argument처리
			this.gfn_CremPop(sPopupId, oArg, "fn_ComMaPopupCallback");					
		} else if (sDETA_CD == "gfn_SecmPop") {				
		//팝업함수명-유가증권번호
			var oArg = { SecmNm:sColCdValue};//Argument처리
			this.gfn_SecmPop(sPopupId, oArg, "fn_ComMaPopupCallback");					
		} else if (sDETA_CD == "gfn_FiamPop") {				
		//팝업함수명-고정자산번호
			var oArg = { FiamNm:sColCdValue};//Argument처리
			this.gfn_FiamPop(sPopupId, oArg, "fn_ComMaPopupCallback");					
		} else if (sDETA_CD == "gfn_SerhPop") {				
		//팝업함수명-CS접수번호
			var oArg = { SerhNo:sColCdValue};//Argument처리
			this.gfn_SerhPop(sPopupId, oArg, "fn_ComMaPopupCallback");				
		} else if (sDETA_CD == "gfn_CbahPop") {				
		//팝업함수명-거래처계좌번호
			var oArg = { CusmNm:sColCdValue};//Argument처리
			this.gfn_CbahPop(sPopupId, oArg, "fn_ComMaPopupCallback");					
		} else if (sDETA_CD == "gfn_VatmPop") {				
		//팝업함수명-부가세코드

			var sVatmGu="";
			if(sAcomGu == "0010" && sDecrGu=="D"){
				//부가가치대급금
				sVatmGu = "0";  // 매입
			}else{
				sVatmGu = "1"; // 매출
			}
			
			var oArg = {VatmGu:sVatmGu, VatmNm:sColCdValue};//Argument처리
			this.gfn_VatmPop(sPopupId, oArg, "fn_ComMaPopupCallback");		
		} else if (sDETA_CD == "gfn_RpjhPop") {		
		//팝업함수명-연구개발코드	
			var oArg = { RpjhNo:sColCdValue, PrgmId:this.fvComPrgmId};//Argument처리
			this.gfn_RpjhPop(sPopupId, oArg, "fn_ComMaPopupCallback");		
		
		}
		
	}
}



/***********************************************************************************************
 * 15.18 [fn_ComMaComboChangedEvent ] [콤보] 관리항목 콤보변경 관련 이벤트
 ***********************************************************************************************/ 
this.fn_ComMaComboChangedEvent = function(obj:nexacro.Edit,e:nexacro.ChangeEventInfo)
{ 
	
	//코드명 정보가 있으면
	if (!this.gfn_IsNull(obj.CD_NM)) {
		this.ds_Detail10.setColumn(this.ds_Detail10.rowposition, obj.CD_NM,  obj.text);
		this.ds_Detail10.setColumn(this.ds_Detail10.rowposition, obj.VCD_CD,  obj.value);
	}
}



/***********************************************************************************************
 * 15.13 [fn_ComMaPopupCallback ] 관리항목 팝업관련 콜백함수
 ***********************************************************************************************/ 
this.fn_ComMaPopupCallback = function(strId, rtnValue)
{

	trace("=================1======================================");
	//trace("fn_ComMaPopupCallback start 1= " + strId);
	//trace("fn_ComMaPopupCallback start 2= " + this.fvCmMaPopupId01);
	//trace("fn_ComMaPopupCallback start 3= " + rtnValue);
	// pop창 콜백 id
	if (strId == this.fvCmMaPopupId01) {
	
		if (!this.gfn_IsNull(rtnValue)) {
			var arrRtnVal = eval(rtnValue);
			
			//거래처 사업자번호 없으면 거래처코드로 변경
			if (strId.substring(5, strId.length)=="gfn_CusmPop"){
				if(this.gfn_IsNull(eval("arrRtnVal." + this.fvCmMaRtnColCd01))){
					this.fvCmMaRtnColCd01 = "CUSM_CD";
				}
			}
			
			if (!this.gfn_IsNull(eval("arrRtnVal." + this.fvCmMaRtnColCd01))) {
				this.div_detailRight.form.div_Item.form.edt_VDe01Cd.set_value(eval("arrRtnVal." + this.fvCmMaRtnColCd01));
				if (strId.substring(5, strId.length)=="gfn_UserPop"){
					this.div_detailRight.form.div_Item.form.edt_De01Cd.set_value(eval("arrRtnVal." + "SYST_ID"));
				}else{
					this.div_detailRight.form.div_Item.form.edt_De01Cd.set_value(eval("arrRtnVal." + this.fvCmMaRtnColCd01));
				}
				//this.div_detailRight.form.div_Item.form.edt_De01Cd.set_value(eval("arrRtnVal." + this.fvCmMaRtnColCd01));
				this.div_detailRight.form.div_Item.form.edt_De01Nm.set_value(eval("arrRtnVal." + this.fvCmMaRtnColNm01));
			}

		}
	} else if (strId == this.fvCmMaPopupId02) {
		//trace("strId = " + strId + "  arrRtnVal. = " + this.fvCmMaRtnColCd02);
		if (!this.gfn_IsNull(rtnValue)) {
			var arrRtnVal = eval(rtnValue);
			
			//거래처 사업자번호 없으면 거래처코드로 변경
			if (strId.substring(5, strId.length)=="gfn_CusmPop"){
				if(this.gfn_IsNull(eval("arrRtnVal." + this.fvCmMaRtnColCd02))){
					this.fvCmMaRtnColCd02 = "CUSM_CD";
				}
			}
			
			//trace("strId = " + strId + " arrRtnVal. = " + this.fvCmMaRtnColCd02);
			//trace("strId = " + strId + " arrRtnVal. = " + this.fvCmMaRtnColNm02);
			if (!this.gfn_IsNull(eval("arrRtnVal." + this.fvCmMaRtnColCd02))) {
				this.div_detailRight.form.div_Item.form.edt_VDe02Cd.set_value(eval("arrRtnVal." + this.fvCmMaRtnColCd02));
				if (strId.substring(5, strId.length)=="gfn_UserPop"){
					this.div_detailRight.form.div_Item.form.edt_De02Cd.set_value(eval("arrRtnVal." + "SYST_ID"));
				}else{
					this.div_detailRight.form.div_Item.form.edt_De02Cd.set_value(eval("arrRtnVal." + this.fvCmMaRtnColCd02));
				}
				//this.div_detailRight.form.div_Item.form.edt_De02Cd.set_value(eval("arrRtnVal." + this.fvCmMaRtnColCd02));
				this.div_detailRight.form.div_Item.form.edt_De02Nm.set_value(eval("arrRtnVal." + this.fvCmMaRtnColNm02));
			}
	
		}
	} else if (strId == this.fvCmMaPopupId03) {
		if (!this.gfn_IsNull(rtnValue)) {
			var arrRtnVal = eval(rtnValue);
			
			//거래처 사업자번호 없으면 거래처코드로 변경
			if (strId.substring(5, strId.length)=="gfn_CusmPop"){
				if(this.gfn_IsNull(eval("arrRtnVal." + this.fvCmMaRtnColCd03))){
					this.fvCmMaRtnColCd03 = "CUSM_CD";
				}
			}
			
			if (!this.gfn_IsNull(eval("arrRtnVal." + this.fvCmMaRtnColCd03))) {
				this.div_detailRight.form.div_Item.form.edt_VDe03Cd.set_value(eval("arrRtnVal." + this.fvCmMaRtnColCd03));
				if (strId.substring(5, strId.length)=="gfn_UserPop"){
					this.div_detailRight.form.div_Item.form.edt_De03Cd.set_value(eval("arrRtnVal." + "SYST_ID"));
				}else{
					this.div_detailRight.form.div_Item.form.edt_De03Cd.set_value(eval("arrRtnVal." + this.fvCmMaRtnColCd03));
				}
				
				//this.div_detailRight.form.div_Item.form.edt_De03Cd.set_value(eval("arrRtnVal." + this.fvCmMaRtnColCd03));
				this.div_detailRight.form.div_Item.form.edt_De03Nm.set_value(eval("arrRtnVal." + this.fvCmMaRtnColNm03));
			}
	
		}
	} else if (strId == this.fvCmMaPopupId04) {
		if (!this.gfn_IsNull(rtnValue)) {
			var arrRtnVal = eval(rtnValue);
			
			//거래처 사업자번호 없으면 거래처코드로 변경
			if (strId.substring(5, strId.length)=="gfn_CusmPop"){
				if(this.gfn_IsNull(eval("arrRtnVal." + this.fvCmMaRtnColCd04))){
					this.fvCmMaRtnColCd04 = "CUSM_CD";
				}
			}
			
			if (!this.gfn_IsNull(eval("arrRtnVal." + this.fvCmMaRtnColCd04))) {
				this.div_detailRight.form.div_Item.form.edt_VDe04Cd.set_value(eval("arrRtnVal." + this.fvCmMaRtnColCd04));
				if (strId.substring(5, strId.length)=="gfn_UserPop"){
					this.div_detailRight.form.div_Item.form.edt_De04Cd.set_value(eval("arrRtnVal." + "SYST_ID"));
				}else{
					this.div_detailRight.form.div_Item.form.edt_De04Cd.set_value(eval("arrRtnVal." + this.fvCmMaRtnColCd04));
				}
				//this.div_detailRight.form.div_Item.form.edt_De04Cd.set_value(eval("arrRtnVal." + this.fvCmMaRtnColCd04));
				this.div_detailRight.form.div_Item.form.edt_De04Nm.set_value(eval("arrRtnVal." + this.fvCmMaRtnColNm04));
			}
	
		}
	} else if (strId == this.fvCmMaPopupId05) {
		
		if (!this.gfn_IsNull(rtnValue)) {
			var arrRtnVal = eval(rtnValue);
			
			//거래처 사업자번호 없으면 거래처코드로 변경
			if (strId.substring(5, strId.length)=="gfn_CusmPop"){
				if(this.gfn_IsNull(eval("arrRtnVal." + this.fvCmMaRtnColCd05))){
					this.fvCmMaRtnColCd05 = "CUSM_CD";
				}
			}
			
			if (!this.gfn_IsNull(eval("arrRtnVal." + this.fvCmMaRtnColCd05))) {
				this.div_detailRight.form.div_Item.form.edt_VDe05Cd.set_value(eval("arrRtnVal." + this.fvCmMaRtnColCd05));
				if (strId.substring(5, strId.length)=="gfn_UserPop"){
					this.div_detailRight.form.div_Item.form.edt_De05Cd.set_value(eval("arrRtnVal." + "SYST_ID"));
				}else{
					this.div_detailRight.form.div_Item.form.edt_De05Cd.set_value(eval("arrRtnVal." + this.fvCmMaRtnColCd05));
				}
				//this.div_detailRight.form.div_Item.form.edt_De05Cd.set_value(eval("arrRtnVal." + this.fvCmMaRtnColCd05));
				this.div_detailRight.form.div_Item.form.edt_De05Nm.set_value(eval("arrRtnVal." + this.fvCmMaRtnColNm05));
			}
	
		}
	} else if (strId == this.fvCmMaPopupId06) {
		if (!this.gfn_IsNull(rtnValue)) {
			var arrRtnVal = eval(rtnValue);
			
			//거래처 사업자번호 없으면 거래처코드로 변경
			if (strId.substring(5, strId.length)=="gfn_CusmPop"){
				if(this.gfn_IsNull(eval("arrRtnVal." + this.fvCmMaRtnColCd06))){
					this.fvCmMaRtnColCd06 = "CUSM_CD";
				}
			}
			
			if (!this.gfn_IsNull(eval("arrRtnVal." + this.fvCmMaRtnColCd06))) {
				this.div_detailRight.form.div_Item.form.edt_VDe06Cd.set_value(eval("arrRtnVal." + this.fvCmMaRtnColCd06));
				if (strId.substring(5, strId.length)=="gfn_UserPop"){
					this.div_detailRight.form.div_Item.form.edt_De06Cd.set_value(eval("arrRtnVal." + "SYST_ID"));
				}else{
					this.div_detailRight.form.div_Item.form.edt_De06Cd.set_value(eval("arrRtnVal." + this.fvCmMaRtnColCd06));
				}
				//this.div_detailRight.form.div_Item.form.edt_De06Cd.set_value(eval("arrRtnVal." + this.fvCmMaRtnColCd06));
				this.div_detailRight.form.div_Item.form.edt_De06Nm.set_value(eval("arrRtnVal." + this.fvCmMaRtnColNm06));
			}
	
		}
	} else if (strId == this.fvCmMaPopupId07) {
		if (!this.gfn_IsNull(rtnValue)) {
			var arrRtnVal = eval(rtnValue);
			
			//거래처 사업자번호 없으면 거래처코드로 변경
			if (strId.substring(5, strId.length)=="gfn_CusmPop"){
				if(this.gfn_IsNull(eval("arrRtnVal." + this.fvCmMaRtnColCd07))){
					this.fvCmMaRtnColCd07 = "CUSM_CD";
				}
			}
			
			if (!this.gfn_IsNull(eval("arrRtnVal." + this.fvCmMaRtnColCd07))) {
				this.div_detailRight.form.div_Item.form.edt_VDe07Cd.set_value(eval("arrRtnVal." + this.fvCmMaRtnColCd07));
				if (strId.substring(5, strId.length)=="gfn_UserPop"){
					this.div_detailRight.form.div_Item.form.edt_De07Cd.set_value(eval("arrRtnVal." + "SYST_ID"));
				}else{
					this.div_detailRight.form.div_Item.form.edt_De07Cd.set_value(eval("arrRtnVal." + this.fvCmMaRtnColCd07));
				}
				//this.div_detailRight.form.div_Item.form.edt_De07Cd.set_value(eval("arrRtnVal." + this.fvCmMaRtnColCd07));
				this.div_detailRight.form.div_Item.form.edt_De07Nm.set_value(eval("arrRtnVal." + this.fvCmMaRtnColNm07));
			}
	
		}
	} else if (strId == this.fvCmMaPopupId08) {
		if (!this.gfn_IsNull(rtnValue)) {
			var arrRtnVal = eval(rtnValue);
			
			//거래처 사업자번호 없으면 거래처코드로 변경
			if (strId.substring(5, strId.length)=="gfn_CusmPop"){
				if(this.gfn_IsNull(eval("arrRtnVal." + this.fvCmMaRtnColCd08))){
					this.fvCmMaRtnColCd08 = "CUSM_CD";
				}
			}
			
			if (!this.gfn_IsNull(eval("arrRtnVal." + this.fvCmMaRtnColCd08))) {
				this.div_detailRight.form.div_Item.form.edt_VDe08Cd.set_value(eval("arrRtnVal." + this.fvCmMaRtnColCd08));
				if (strId.substring(5, strId.length)=="gfn_UserPop"){
					this.div_detailRight.form.div_Item.form.edt_De08Cd.set_value(eval("arrRtnVal." + "SYST_ID"));
				}else{
					this.div_detailRight.form.div_Item.form.edt_De08Cd.set_value(eval("arrRtnVal." + this.fvCmMaRtnColCd08));
				}
				this.div_detailRight.form.div_Item.form.edt_De08Cd.set_value(eval("arrRtnVal." + this.fvCmMaRtnColCd08));
				this.div_detailRight.form.div_Item.form.edt_De08Nm.set_value(eval("arrRtnVal." + this.fvCmMaRtnColNm08));
			}
	
		}
	}
	
	//다른정보 입력
	
	var iFvFindRow;
	var iFvFindRowMaNum;
	if(strId.substring(5, strId.length)=="gfn_BilmPop" && !this.gfn_IsNull(rtnValue)){
		//받을어음, 지급어음
		
		//1.계약번호(0)
		iFvFindRow = this.ds_AcomMa.findRowExpr("MA_CD=='0'");
		if(iFvFindRow > -1){
			iFvFindRowMaNum = this.ds_AcomMa.getColumn(iFvFindRow, "MA_NUM");
			this.ds_CmMaInfo.setColumn(0, "DE"+iFvFindRowMaNum+"_CD",  nexacro.isUpper(arrRtnVal.CNTH_NO));
			this.ds_CmMaInfo.setColumn(0, "VDE"+iFvFindRowMaNum+"_CD", nexacro.isUpper(arrRtnVal.CNTH_NO));
			this.ds_CmMaInfo.setColumn(0, "DE"+iFvFindRowMaNum+"_NM", arrRtnVal.CNTH_NM);
		}
		//2.거래처(2)
		iFvFindRow = this.ds_AcomMa.findRowExpr("MA_CD=='2'");
		if(iFvFindRow > -1){
			iFvFindRowMaNum = this.ds_AcomMa.getColumn(iFvFindRow, "MA_NUM"); 
			this.ds_CmMaInfo.setColumn(0, "DE"+iFvFindRowMaNum+"_CD", arrRtnVal.CUSM_CD);
			this.ds_CmMaInfo.setColumn(0, "VDE"+iFvFindRowMaNum+"_CD", arrRtnVal.CUSM_CD);
			this.ds_CmMaInfo.setColumn(0, "DE"+iFvFindRowMaNum+"_NM", arrRtnVal.CUSM_NM);
		}
		//3. 발행일자(T)
		iFvFindRow = this.ds_AcomMa.findRowExpr("MA_CD=='T'");
		if(iFvFindRow > -1){
			iFvFindRowMaNum = this.ds_AcomMa.getColumn(iFvFindRow, "MA_NUM"); 
			this.ds_CmMaInfo.setColumn(0, "DE"+iFvFindRowMaNum+"_NM", arrRtnVal.FROM_DD);
		}
		//4. 만기일자(U)
		iFvFindRow = this.ds_AcomMa.findRowExpr("MA_CD=='U'");
		if(iFvFindRow > -1){
			iFvFindRowMaNum = this.ds_AcomMa.getColumn(iFvFindRow, "MA_NUM"); 
			this.ds_CmMaInfo.setColumn(0, "DE"+iFvFindRowMaNum+"_NM", arrRtnVal.EXPI_DD);
		}
		//5. 은행(지점)(8)
		iFvFindRow = this.ds_AcomMa.findRowExpr("MA_CD=='8'");
		if(iFvFindRow > -1){
			iFvFindRowMaNum = this.ds_AcomMa.getColumn(iFvFindRow, "MA_NUM"); 
			this.ds_CmMaInfo.setColumn(0, "DE"+iFvFindRowMaNum+"_CD", arrRtnVal.ISBK_CD);
			this.ds_CmMaInfo.setColumn(0, "VDE"+iFvFindRowMaNum+"_CD", arrRtnVal.ISBK_CD);
			this.ds_CmMaInfo.setColumn(0, "DE"+iFvFindRowMaNum+"_NM", arrRtnVal.BANM_NM);
		}
		
		//6. 사번(3)
		iFvFindRow = this.ds_AcomMa.findRowExpr("MA_CD=='3'");
		if(iFvFindRow > -1){
			iFvFindRowMaNum = this.ds_AcomMa.getColumn(iFvFindRow, "MA_NUM"); 
			this.ds_CmMaInfo.setColumn(0, "DE"+iFvFindRowMaNum+"_CD", arrRtnVal.SYST_ID);
			this.ds_CmMaInfo.setColumn(0, "VDE"+iFvFindRowMaNum+"_CD", arrRtnVal.EMPM_CD);
			this.ds_CmMaInfo.setColumn(0, "DE"+iFvFindRowMaNum+"_NM", arrRtnVal.EMPM_NM);
		}
			
		//6. 지출증빙서류
	}else if(strId.substring(5, strId.length)=="gfn_SerhPop"){
		//CS접수번호
		
			
	}else if(strId.substring(5, strId.length)=="gfn_ContPop"){
		//계약번호 
		
		//거래처관리항목 자동입력
		// 자동입력 제거 2022.06.22
		var vAcomCd = this.ds_Detail10.getColumn(this.ds_Detail10.rowposition, "ACOM_CD");
		
		if( vAcomCd.substring(0,1) =="1" ||vAcomCd.substring(0,1) =="2"){
		
			iFvFindRow = this.ds_AcomMa.findRowExpr("MA_CD=='2'");
			
			if (!this.gfn_IsNull(rtnValue)) {
				if(iFvFindRow > -1){
					iFvFindRowMaNum = this.ds_AcomMa.getColumn(iFvFindRow, "MA_NUM"); 
					this.ds_CmMaInfo.setColumn(0, "DE"+iFvFindRowMaNum+"_CD", arrRtnVal.SAUM_NO);
					this.ds_CmMaInfo.setColumn(0, "VDE"+iFvFindRowMaNum+"_CD", arrRtnVal.SAUM_NO);
					this.ds_CmMaInfo.setColumn(0, "DE"+iFvFindRowMaNum+"_NM", arrRtnVal.CUSM_NM);
				}
			}
		}
		
	}else if(strId.substring(5, strId.length)=="gfn_CbahPop"){
		//거래처계좌번호 
		
		
		//trace("gfn_CbahPop");
		
		if (!this.gfn_IsNull(rtnValue)) {
			//계좌번호 자동입력
			iFvFindRow = this.ds_AcomMa.findRowExpr("MA_CD=='A7'");
			if(iFvFindRow > -1){
				iFvFindRowMaNum = this.ds_AcomMa.getColumn(iFvFindRow, "MA_NUM"); 
				this.ds_CmMaInfo.setColumn(0, "DE"+iFvFindRowMaNum+"_CD", arrRtnVal.ACNO_GU);
				this.ds_CmMaInfo.setColumn(0, "VDE"+iFvFindRowMaNum+"_CD", arrRtnVal.ACNO_GU);
				this.ds_CmMaInfo.setColumn(0, "DE"+iFvFindRowMaNum+"_NM", arrRtnVal.ACNO_NM);
			}
			//거래처은행 자동입력
			iFvFindRow = this.ds_AcomMa.findRowExpr("MA_CD=='A8'");
			if(iFvFindRow > -1){
				iFvFindRowMaNum = this.ds_AcomMa.getColumn(iFvFindRow, "MA_NUM"); 
				this.ds_CmMaInfo.setColumn(0, "DE"+iFvFindRowMaNum+"_CD", arrRtnVal.BANM_CD);
				this.ds_CmMaInfo.setColumn(0, "VDE"+iFvFindRowMaNum+"_CD", arrRtnVal.BANM_CD);
				this.ds_CmMaInfo.setColumn(0, "DE"+iFvFindRowMaNum+"_NM", arrRtnVal.BANM_NM);
			}
			//거래처계좌번호 자동입력
			iFvFindRow = this.ds_AcomMa.findRowExpr("MA_CD=='A9'");
			if(iFvFindRow > -1){
				iFvFindRowMaNum = this.ds_AcomMa.getColumn(iFvFindRow, "MA_NUM"); 
				this.ds_CmMaInfo.setColumn(0, "DE"+iFvFindRowMaNum+"_CD", arrRtnVal.ACNM_NO);
				this.ds_CmMaInfo.setColumn(0, "VDE"+iFvFindRowMaNum+"_CD", arrRtnVal.ACNM_NO);
				this.ds_CmMaInfo.setColumn(0, "DE"+iFvFindRowMaNum+"_NM", arrRtnVal.ACEM_NM);
			}
			
			
			//거래처
			iFvFindRow = this.ds_AcomMa.findRowExpr("MA_CD=='2'");
			if(iFvFindRow > -1){
				iFvFindRowMaNum = this.ds_AcomMa.getColumn(iFvFindRow, "MA_NUM"); 
				this.ds_CmMaInfo.setColumn(0, "DE"+iFvFindRowMaNum+"_CD", arrRtnVal.SAUM_NO);
				this.ds_CmMaInfo.setColumn(0, "VDE"+iFvFindRowMaNum+"_CD", arrRtnVal.SAUM_NO);
				this.ds_CmMaInfo.setColumn(0, "DE"+iFvFindRowMaNum+"_NM", arrRtnVal.CUSM_NM); //예금주
			}
			
			
		}
	}else if(strId.substring(5, strId.length)=="gfn_CodmPop"){
		//코드popup
		
		//통화
		iFvFindRow = this.ds_AcomMa.findRowExpr("MA_CD=='X'");
		if(iFvFindRow > -1 && !this.gfn_IsNull(rtnValue)){
			//통화관리항목(SM020)
			if(arrRtnVal.GRCM_CD == "SM020"){
				//전표상에 통화에 코드값을 넣어준다.
				this.ds_Detail10.setColumn(this.ds_Detail10.rowposition, "CURR_CD", arrRtnVal.CODM_CD);
			}
		}
	}else if(strId.substring(5, strId.length)=="gfn_CusmPop"){
		trace("=======================================================");
		if (!this.gfn_IsNull(rtnValue)) {
			//계좌번호 자동입력
			iFvFindRow = this.ds_AcomMa.findRowExpr("MA_CD=='A7'");
			if(iFvFindRow > -1){
				iFvFindRowMaNum = this.ds_AcomMa.getColumn(iFvFindRow, "MA_NUM"); 
				this.ds_CmMaInfo.setColumn(0, "DE"+iFvFindRowMaNum+"_CD", arrRtnVal.ACNO_GU);
				this.ds_CmMaInfo.setColumn(0, "VDE"+iFvFindRowMaNum+"_CD", arrRtnVal.ACNO_GU);
				this.ds_CmMaInfo.setColumn(0, "DE"+iFvFindRowMaNum+"_NM", arrRtnVal.ACNO_GU_NM);
			}
			//거래처은행 자동입력
			iFvFindRow = this.ds_AcomMa.findRowExpr("MA_CD=='A8'");
			if(iFvFindRow > -1){
				iFvFindRowMaNum = this.ds_AcomMa.getColumn(iFvFindRow, "MA_NUM"); 
				this.ds_CmMaInfo.setColumn(0, "DE"+iFvFindRowMaNum+"_CD", arrRtnVal.BANM_CD);
				this.ds_CmMaInfo.setColumn(0, "VDE"+iFvFindRowMaNum+"_CD", arrRtnVal.BANM_CD);
				this.ds_CmMaInfo.setColumn(0, "DE"+iFvFindRowMaNum+"_NM", arrRtnVal.BANM_NM);
			}
			//거래처계좌번호 자동입력
			iFvFindRow = this.ds_AcomMa.findRowExpr("MA_CD=='A9'");
			if(iFvFindRow > -1){
				iFvFindRowMaNum = this.ds_AcomMa.getColumn(iFvFindRow, "MA_NUM"); 
				this.ds_CmMaInfo.setColumn(0, "DE"+iFvFindRowMaNum+"_CD", arrRtnVal.ACNM_NO);
				this.ds_CmMaInfo.setColumn(0, "VDE"+iFvFindRowMaNum+"_CD", arrRtnVal.ACNM_NO);
				this.ds_CmMaInfo.setColumn(0, "DE"+iFvFindRowMaNum+"_NM", arrRtnVal.ACEM_NM);
			}
		}
	}
	
}

/***********************************************************************************************
 * 15.14 [fn_FindBindItem ] 바인딩 Item 찾기 함수
 ***********************************************************************************************/ 
this.fn_FindBindItem  = function(id)
{
	var rtn;
	for(var iLoop=0; iLoop<this.binds.length ; iLoop++)
	{
		if( this.binds[iLoop].name == id ){
			rtn = true;
			return rtn;
		} else {
			rtn = false;
		}	
	}	
	return rtn;
}

/***********************************************************************************************
 * 15.15 [ds_CmMaInfo_oncolumnchanged ] 관리항목 데이터셋 데이터 변경 이벤트
 ***********************************************************************************************/ 
this.ds_CmMaInfo_oncolumnchanged = function(obj:nexacro.NormalDataset,e:nexacro.DSColChangeEventInfo)
{
	var iRow = this.ds_Detail10.rowposition;
	var code;
	var Vcode;
	var name;
	var macd;
	
	//trace("ds_CmMaInfo_oncolumnchanged start");
	
	if(this.ds_Detail10.getColumn(iRow, "MA" + e.columnid.substr(2, 2) + "_CD") =="f"){
		//기간인경우 상세명에 만 입력한다.
		macd = this.ds_Detail10.getColumn(iRow, "MA"+e.columnid.substr(2, 2)+"_CD");  //관리항목코드
		code = this.ds_CmMaInfo.getColumn(0, "DE"+e.columnid.substr(2, 2)+"_CD");
		//Vcode = this.ds_CmMaInfo.getColumn(0, "VDE"+e.columnid.substr(2, 2)+"_CD");
		name = this.ds_CmMaInfo.getColumn(0, "DE"+e.columnid.substr(2, 2)+"_NM");
		
		if(this.gfn_IsNull(code)){
			code = "";
		}else{
		
			if(this.gfn_IsNull(name)){
				name = "";
			}else{
				name = "-" + name;
				this.ds_Detail10.setColumn(iRow, "DE"+e.columnid.substr(2, 2)+"_NM", code + name);
				
				//대표관리항목 입력
				
// 				if(macd ==  this.ds_Detail10.getColumn(iRow, "MANA_CD") ){
// 					this.ds_Detail10.setColumn(iRow, "DETA_NM", code + name);
// 				}
			}
		}
	} else if(this.ds_Detail10.getColumn(iRow, "MA" + e.columnid.substr(2, 2) + "_CD") =="q") {
	
		
		macd = this.ds_Detail10.getColumn(iRow, "MA"+e.columnid.substr(2, 2)+"_CD");  //관리항목코드
		

		name = this.ds_CmMaInfo.getColumn(0, "DE"+e.columnid.substr(2, 2)+"_NM");
		
		if(!this.gfn_IsNull(name)){
			this.ds_Detail10.setColumn(iRow, "DE"+e.columnid.substr(2, 2)+"_NM", name.substr(0,6));
			this.ds_CmMaInfo.setColumn(0, "DE"+e.columnid.substr(2, 2)+"_NM", name.substr(0,6));
		}
			
	}else{
		macd = this.ds_Detail10.getColumn(iRow, "MA"+e.columnid.substr(2, 2)+"_CD");
		code = this.ds_CmMaInfo.getColumn(0, "DE"+e.columnid.substr(2, 2)+"_CD");
		Vcode = this.ds_CmMaInfo.getColumn(0, "VDE"+e.columnid.substr(2, 2)+"_CD");
		name = this.ds_CmMaInfo.getColumn(0, "DE"+e.columnid.substr(2, 2)+"_NM");
		
		this.ds_Detail10.setColumn(iRow, e.columnid, this.ds_CmMaInfo.getColumn(0, e.columnid));
		
		//대표관리항목 입력
// 		if(macd ==  this.ds_Detail10.getColumn(iRow, "MANA_CD") ){
// 			this.ds_Detail10.setColumn(iRow, "DETA_CD", code);
// 			this.ds_Detail10.setColumn(iRow, "DETA_NM", name);
// 		}

	}
	//trace("ds_CmMaInfo_oncolumnchanged end");
	

};

/***********************************************************************************************
 * 15.16 [fn_ComMaEditChangedEvent ] 관리항목 Edit변경 관련 이벤트
 ***********************************************************************************************/ 
this.fn_ComMaEditChangedEvent = function(obj:nexacro.Edit,e:nexacro.ChangeEventInfo)
{ 
	var sDecrGu  = obj.DecrGu;       //차대구분
	var sMacd    = obj.MaCd;         //관리항목코드
	var sReprYn  = obj.ReprYn;       //대표관리항목여부
	var sAcchDecrGu = obj.AcchDecrGu; // 전표등록의 차대구분
    var slocal = "";


	//trace("fn_ComMaEditChangedEvent sMacd = " + sMacd);

	//관리항목코드명함수 정보가 있으면
	if (!this.gfn_IsNull(obj.FUNC_NM)) {		

		var sFUNC_NM = obj.FUNC_NM;     //관리항목-코드명함수
		var oColCd = eval(obj.ColCd);   //관리항목-코드컬럼
		var oVColCd   = eval(obj.VColCd);  //관리항목-코드컬럼
		var oColNm = eval(obj.ColNm);   //관리항목-코드명컬럼
		var oGrcmCd = obj.GRCM_CD;      //관리항목-그룹코드명컬럼
		var oAcomGu = obj.ACOM_GU;      //계정구분
		var sMaSeq = obj.MaSeq;         //관리항목-순번
		var sDETA_CD = obj.DETA_CD;     //관리항목-팝업함수
		//var sDecrGu = obj.DecrGu;       //  차대구분
		
		var sPopupId = "MA" + sMaSeq + "_" + sDETA_CD;//팝업ID
		
		if(sMaSeq=="01"){
			this.fvCmMaRtnColCd01 = obj.sCD01_NM;
			this.fvCmMaRtnColNm01 = obj.sCD02_NM;
			this.div_detailRight.form.div_Item.form.edt_De01Cd.set_value(oVColCd.value);
			slocal = "this.div_detailRight.form.div_Item.form.edt_De01Cd";
			this.fvCmMaPopupId01 = "MA"+sMaSeq+"_" + sDETA_CD;//팝업ID
		}else if(sMaSeq=="02"){
			this.fvCmMaRtnColCd02 = obj.sCD01_NM;
			this.fvCmMaRtnColNm02 = obj.sCD02_NM;
			this.div_detailRight.form.div_Item.form.edt_De02Cd.set_value(oVColCd.value);
			slocal = "this.div_detailRight.form.div_Item.form.edt_De02Cd";
			this.fvCmMaPopupId02 = "MA"+sMaSeq+"_" + sDETA_CD;//팝업ID
		}else if(sMaSeq=="03"){
			this.fvCmMaRtnColCd03 = obj.sCD01_NM;
			this.fvCmMaRtnColNm03 = obj.sCD02_NM;
			this.div_detailRight.form.div_Item.form.edt_De03Cd.set_value(oVColCd.value);
			slocal = "this.div_detailRight.form.div_Item.form.edt_De03Cd";
			this.fvCmMaPopupId03 = "MA"+sMaSeq+"_" + sDETA_CD;//팝업ID
		}else if(sMaSeq=="04"){
			this.fvCmMaRtnColCd04 = obj.sCD01_NM;
			this.fvCmMaRtnColNm04 = obj.sCD02_NM;
			this.div_detailRight.form.div_Item.form.edt_De04Cd.set_value(oVColCd.value);
			slocal = "this.div_detailRight.form.div_Item.form.edt_De04Cd";
			this.fvCmMaPopupId04 = "MA"+sMaSeq+"_" + sDETA_CD;//팝업ID
		}else if(sMaSeq=="05"){
			this.fvCmMaRtnColCd05 = obj.sCD01_NM;
			this.fvCmMaRtnColNm05 = obj.sCD02_NM;
			this.div_detailRight.form.div_Item.form.edt_De05Cd.set_value(oVColCd.value);
			slocal = "this.div_detailRight.form.div_Item.form.edt_De05Cd";
			this.fvCmMaPopupId05 = "MA"+sMaSeq+"_" + sDETA_CD;//팝업ID
		}else if(sMaSeq=="06"){
			this.fvCmMaRtnColCd06 = obj.sCD01_NM;
			this.fvCmMaRtnColNm06 = obj.sCD02_NM;
			this.div_detailRight.form.div_Item.form.edt_De06Cd.set_value(oVColCd.value);
			slocal = "this.div_detailRight.form.div_Item.form.edt_De06Cd";
			this.fvCmMaPopupId06 = "MA"+sMaSeq+"_" + sDETA_CD;//팝업ID
		}else if(sMaSeq=="07"){
			this.fvCmMaRtnColCd07 = obj.sCD01_NM;
			this.fvCmMaRtnColNm07 = obj.sCD02_NM;
			this.div_detailRight.form.div_Item.form.edt_De07Cd.set_value(oVColCd.value);
			slocal = "this.div_detailRight.form.div_Item.form.edt_De07Cd";
			this.fvCmMaPopupId07 = "MA"+sMaSeq+"_" + sDETA_CD;//팝업ID
		}else if(sMaSeq=="08"){
			this.fvCmMaRtnColCd08 = obj.sCD01_NM;
			this.fvCmMaRtnColNm08 = obj.sCD02_NM;
			this.div_detailRight.form.div_Item.form.edt_De08Cd.set_value(oVColCd.value);
			slocal = "this.div_detailRight.form.div_Item.form.edt_De08Cd";
			this.fvCmMaPopupId08 = "MA"+sMaSeq+"_" + sDETA_CD;//팝업ID
		}
		
	
		
		
		if (sFUNC_NM == "gfn_GetCommAcnm") {
			//계좌번호-완료
			var args = [ "ACNM_NO^"+obj.ColCd];
			
			
			// 계좌번호 일부 넣었을경우 일부만 입력되는 문제 수정
			this.gfn_GetCommAcnm(oVColCd, oColNm, args, sPopupId, "fn_ComMaPopupCallback");//코드로 검색
		} else if (sFUNC_NM == "gfn_GetCommBanm") {
			//은행(지점)-완료
			this.gfn_GetCommBanm(oVColCd, oColNm, sPopupId, "fn_ComMaPopupCallback");//코드로 검색
		} else if (sFUNC_NM == "gfn_GetCommBilm") {
			//어음번호-완료
			this.gfn_GetCommBilm(oAcomGu, oVColCd, oColNm, "", sPopupId, "fn_ComMaPopupCallback");//코드로 검색
		} else if (sFUNC_NM == "gfn_GetCommCnth") {
			//계약번호-완료
			oColCd.set_value(oVColCd.value.toUpperCase());//계약번호는 대문자로

			var custArr = [ "SAUM_NO^this.edt_CusmCd", "CUSM_NM^this.edt_CusmNm"];
			this.gfn_GetCommCnth(oVColCd, oColNm, this.fvComPrgmId, sPopupId, "fn_ComMaPopupCallback", custArr);//코드로 검색	
			
			
			if (!this.gfn_IsNull(this.edt_CusmCd.value)){

				var vAcomCd = this.ds_Detail10.getColumn(this.ds_Detail10.rowposition, "ACOM_CD");
			
				if( vAcomCd.substring(0,1) =="1" ||vAcomCd.substring(0,1) =="2"){
				
					iFvFindRow = this.ds_AcomMa.findRowExpr("MA_CD=='2'");
				
					//if (!this.gfn_IsNull(rtnValue)) {
						if(iFvFindRow > -1){
							iFvFindRowMaNum = this.ds_AcomMa.getColumn(iFvFindRow, "MA_NUM"); 
							this.ds_CmMaInfo.setColumn(0, "DE"+iFvFindRowMaNum+"_CD", this.edt_CusmCd.value);
							this.ds_CmMaInfo.setColumn(0, "VDE"+iFvFindRowMaNum+"_CD", this.edt_CusmCd.value);
							this.ds_CmMaInfo.setColumn(0, "DE"+iFvFindRowMaNum+"_NM", this.edt_CusmNm.value);
						}
					//}
				}
			}
			
			
		} else if (sFUNC_NM == "gfn_GetCommCodm") {
		
			//공통코드-완료
			this.gfn_GetCommCodm(oGrcmCd, oVColCd, oColNm, sPopupId, "fn_ComMaPopupCallback");//코드로 검색
		
		} else if (sFUNC_NM == "gfn_GetCommCrem") {
			//법인카드번호-완료
			
			var args = [ "CREM_NO^"+obj.ColCd];
			this.gfn_GetCommCrem(oVColCd, oColNm, args, sPopupId, "fn_ComMaPopupCallback");//코드로 검색
		} else if (sFUNC_NM == "gfn_GetCommCusm") {
			//거래처-완료
			//this.gfn_GetCommCusm("C", oColCd, oColNm, sPopupId, "fn_ComMaPopupCallback");//코드로 검색
			
			
			
			//var arrArgs = ["SAUM_NO^"+slocal];
			var arrArgs = ["SAUM_NO^"+obj.ColCd];
			
			this.gfn_GetCommCusmS("CS", oVColCd, oColNm, sPopupId, "fn_ComMaPopupCallback", arrArgs);//코드로 검색
		} else if (sFUNC_NM == "gfn_GetCommDebm") {
			//차입금코드-완료
			this.gfn_GetCommDebm(oVColCd, oColNm, "", sPopupId, "fn_ComMaPopupCallback");//코드로 검색
		} else if (sFUNC_NM == "gfn_GetCommDepm") {
			//부서-완료
			this.gfn_GetCommDepm("C", oVColCd, oColNm, sPopupId, "fn_ComMaPopupCallback");//코드로 검색	
		}  else if (sFUNC_NM == "gfn_GetCommEmpm") {
			//사원-완료
			//this.gfn_GetCommEmpm("C", oVColCd, oColNm, this.div_Search.form.edt_SystId, "Empm", sPopupId, "fn_ComMaPopupCallback");//코드로 검색
			this.gfn_GetCommEmpm("C", oVColCd, oColNm, oColCd, sPopupId, "", "fn_ComMaPopupCallback");//코드로 검색
		} else if (sFUNC_NM == "gfn_GetCommFiam") {
			//고정자산번호-완료
			this.gfn_GetCommFiam(oVColCd, oColNm, "", sPopupId, "fn_ComMaPopupCallback");//코드로 검색
		} else if (sFUNC_NM == "gfn_GetCommItem") {
			//품목-완료
			this.gfn_GetCommItem(oVColCd, oColNm, "", sPopupId, "fn_ComMaPopupCallback");//코드로 검색		
		} else if (sFUNC_NM == "gfn_GetCommLoam") {
			//대여금코드-완료
			this.gfn_GetCommLoam(oVColCd, oColNm, "", sPopupId, "fn_ComMaPopupCallback");//코드로 검색
		} else if (sFUNC_NM == "gfn_GetCommSaum") {
			//사업장--완료
			this.gfn_GetCommSaum(oVColCd, oColNm, sPopupId, "fn_ComMaPopupCallback");//코드로 검색		
		} else if (sFUNC_NM == "gfn_GetCommSecm") {
			//유가증권번호-완료
			this.gfn_GetCommSecm(oVColCd, oColNm, "", sPopupId, "fn_ComMaPopupCallback");//코드로 검색
		} else if (sFUNC_NM == "gfn_GetCommSerh") {
			//CS접수번호
			this.gfn_GetCommSerh(oVColCd, oColNm, "", sPopupId, "fn_ComMaPopupCallback");//코드로 검색
		} else if (sFUNC_NM == "gfn_GetCommCbah") {
			//거래처계좌번호

			this.gfn_GetCommCbah(oVColCd, oColNm, "ACNO_GU^ACNO_NM", sPopupId, "fn_ComMaPopupCallback");//코드로 검색
		} else if (sFUNC_NM == "gfn_GetCommVatm") {
			//부가세코드
			
			var sVatmGu="";
			if(oAcomGu == "0010" && sDecrGu=="D"){
				//부가가치대급금
				sVatmGu = "0";  // 매입
			}else{
				sVatmGu = "1"; // 매출
			}
			this.gfn_GetCommVatm(oVColCd, oColNm, "", sVatmGu, sPopupId, "fn_ComMaPopupCallback");//코드로 검색
		} else if (sFUNC_NM == "gfn_GetCommRpjh") {
			//연구개발코드
			this.gfn_GetCommRpjh(oVColCd, oColNm, sPopupId, "fn_ComMaPopupCallback");//코드로 검색
		}

	}
	
	/**
	관리항목의 통화, 환율, 외화금액은
	전표상세의 화폐, 환율, 외화차변, 외화대변 금액에 값을 넣는다.
	
	*/
	var vFrAm;
	var vExchRt;
	var vMaExchRt;
	var vWonAm;
	//통화
	if(sMacd == "X"){
		
		this.ds_Detail10.setColumn(this.ds_Detail10.rowposition, "CURR_CD", e.postvalue);
		
		
	}else if(sMacd == "Y"){
		//환율
		this.ds_Detail10.setColumn(this.ds_Detail10.rowposition, "EXCH_RT", e.postvalue);
		
		
		//외화, 환율 입력시 원화금액 자동 입력
		vExchRt = nexacro.toNumber(e.postvalue);
		if(this.gfn_IsNull(vExchRt)){
			vExchRt = 0;
		}
		if(this.ds_Detail10.getColumn(this.ds_Detail10.rowposition, "DECR_GU") =="D"){
			vFrAm = nexacro.toNumber(this.ds_Detail10.getColumn(this.ds_Detail10.rowposition, "FRDB_AM"));
			if(this.gfn_IsNull(vFrAm)){
				vFrAm = 0;
			}

			if(vFrAm != 0 && vExchRt !=0 ){
				vWonAm = nexacro.round(vExchRt * vFrAm, 0);
				this.ds_Detail10.setColumn(this.ds_Detail10.rowposition, "DEBI_AM", vWonAm);
			}
		}else{
			vFrAm = nexacro.toNumber(this.ds_Detail10.getColumn(this.ds_Detail10.rowposition, "FRCR_AM"));
			if(this.gfn_IsNull(vFrAm)){
				vFrAm = 0;
			}

			if(vFrAm != 0 && vExchRt !=0 ){
				vWonAm = nexacro.round(vExchRt * vFrAm, 0);
				this.ds_Detail10.setColumn(this.ds_Detail10.rowposition, "CRED_AM", vWonAm);

			}

		}
		
	}else if(sMacd == "V"){
		//외화금액
		
		//외화, 환율 입력시 원화금액 자동 입력
		vExchRt = nexacro.toNumber(this.ds_Detail10.getColumn(this.ds_Detail10.rowposition, "EXCH_RT"));
		vFrAm = nexacro.toNumber(e.postvalue);
		
		if(this.gfn_IsNull(vFrAm)){
			vFrAm = 0;
		}
		if(this.gfn_IsNull(vExchRt)){
			vExchRt = 0;
		}
		
		if(sAcchDecrGu =="D"){
			//차변
			//trace("sAcchDecrGu = " + sAcchDecrGu + " = " + e.postvalue);
			this.ds_Detail10.setColumn(this.ds_Detail10.rowposition, "FRCR_AM", 0);
			this.ds_Detail10.setColumn(this.ds_Detail10.rowposition, "FRDB_AM", e.postvalue);
			
			if(vFrAm != 0  && (vExchRt != 0 &&  vExchRt != 1 )){
				vWonAm = nexacro.round(vExchRt * vFrAm, 0);
				this.ds_Detail10.setColumn(this.ds_Detail10.rowposition, "DEBI_AM", vWonAm);
			}
			
		}else{
			//대변
			this.ds_Detail10.setColumn(this.ds_Detail10.rowposition, "FRDB_AM", 0);
			this.ds_Detail10.setColumn(this.ds_Detail10.rowposition, "FRCR_AM", e.postvalue);
			
			
			//원화금액 자동입력
			if(vFrAm != 0  && (vExchRt != 0  && vExchRt != 1 )){
				vWonAm = nexacro.round(vExchRt * vFrAm, 0);
				this.ds_Detail10.setColumn(this.ds_Detail10.rowposition, "CRED_AM", vWonAm);
			}
		}
	}
	
	
	//trace("ds_CmMaInfo_oncolumnchanged end");
}

/***********************************************************************************************
 * 15.17 [fn_ClearAtobData ] 자동전표상세 내역 초기화
 ***********************************************************************************************/ 
this.fn_ClearAtobData = function() {

	this.ds_Detail10.clearData();
	
		//생성된 컴포넌트 삭제
	var arrComList = this.div_detailRight.form.div_Item.form.components;//Div 생성된 전체 컴폰넌트

	if (!this.gfn_IsNull(arrComList)) {

		for (var iLoop = arrComList.length-1; iLoop >= 0; iLoop--) {
			if (arrComList[iLoop].id != "sta_DetailRightBottom") {
				var rObj = this.div_detailRight.form.div_Item.removeChild(arrComList[iLoop].id);
				rObj.destroy();
				rObj = null;
			}
		}

	}
}



/***********************************************************************************************
 * 15.18 [fn_ScrnEnable ] 화면 Enable 처리
 ***********************************************************************************************/ 
this.fn_ScrnEnable = function(enable) {
   //this.grd_Detail10.set_enable(enable);
   //this.div_detailRight.set_enable(enable);
   //화면 활성화 처리
   trace("fn_ScrnEnable = " + enable);
   this.scrnEnable = enable;
	
   if (this.scrnEnable) {
	   this.grd_Detail10.set_readonly(false);
	   this.div_detailRight.set_enable(true); 
	   this.btn_banFind.set_enable(true);
	   this.div_ComGrdBtn.set_enable(true);
	   this.btn_banFind.set_visible(true);
	   this.div_ComGrdBtn.set_visible(true);
	   this.grd_Detail10.set_top(28);
   } else {
   
		
	   this.grd_Detail10.set_top(0);   
	   this.grd_Detail10.set_readonly(true);
	   this.div_detailRight.set_enable(false);   
	   this.btn_banFind.set_enable(false);
	   this.div_ComGrdBtn.set_enable(false);
	   this.btn_banFind.set_visible(false);
	   this.div_ComGrdBtn.set_visible(false);
   }

}

/***********************************************************************************************
 * 15.18 [사용금액 및 가용금액 계산] 
 ***********************************************************************************************/ 
this.fn_CalAvailAm = function()
{ 

	//반제금액 체크
	var sAntiAm = 0;
	var sAm = 0;
	var sWofhSt = "";
	
	
	sWofhSt = this.ds_Master10.getColumn(this.ds_Master10.rowposition, "WOFH_ST")
	if(this.gfn_IsNull(sWofhSt)){
		sWofhSt = "0000";
	}
	
	if(!this.gfn_IsNull(this.ds_Detail10.getColumn(iRow, "ANTI_NO"))  && sWofhSt == "0010"){
	
	
		sAm = this.ds_Detail10.getColumn(this.ds_Detail10.rowposition, "CRED_AM")
		    + this.ds_Detail10.getColumn(this.ds_Detail10.rowposition, "DEBI_AM");
			
		sAntiAm = this.ds_Detail10.getColumn(this.ds_Detail10.rowposition, "ANTI_AM");
	
		if(sAm > sAntiAm){
			var arrMsgArg = [this.gfn_AppendComma(sAntiAm, 0)];
			this.gfn_Alert("FA019", arrMsgArg);  //반제전표 잔액 [ &ITM0 ] 을 초과 할 수 없습니다.
			//자동 취소 처리한다.
			this.ds_Detail10.set_enableevent(false);
			//this.gfn_UndoColumn(this.div_DetailInput.form.tab_Detail.tpg_01.form.grd_Detail10)
			if(this.ds_Detail10.getColumn(this.ds_Detail10.rowposition, "DECR_GU") =="D"){
				this.ds_Detail10.setColumn(this.ds_Detail10.rowposition, "DEBI_AM", this.fvOrgDebiAmt);
			}else{
				this.ds_Detail10.setColumn(this.ds_Detail10.rowposition, "CRED_AM", this.fvOrgCredAmt);
			}
			this.ds_Detail10.set_enableevent(true);
		} 
	
	
	}
	
	
	
	//예산통제하는 계정인경우
	if (this.div_detailRight.form.div_Budget.form.chk_BgcmYn.value == "1") {
		this.fvBCalAvailAmt = true;//가용금액계산여부
		this.ds_Detail10.set_enableevent(false);

		var iRow = this.ds_Detail10.rowposition;
		var sDECR_GU = this.ds_Detail10.getColumn(iRow, "DECR_GU");//차대구분
		var sACOM_CD = this.ds_Detail10.getColumn(iRow, "ACOM_CD");//계정코드
		var sBUDG_MM = this.ds_Detail10.getColumn(iRow, "BUDG_MM");//편성년월	
		var sBUDP_CD = this.ds_Detail10.getColumn(iRow, "BUDP_CD");//예산부서
		
		if (this.gfn_IsNull(sBUDG_MM)) {
			sBUDG_MM = "";
		} else {
			sBUDG_MM = sBUDG_MM.substr(0,6);
		}
		//
		
		//trace("====BSGU_AM2=====" + this.div_detailRight.form.div_Budget.form.mae_RecAm.value);		
		var dRecAm = nexacro.toNumber(this.div_detailRight.form.div_Budget.form.mae_RecAm.value);//편성금액
                                           
		
		//var dUseAm = this.ds_Detail11.getColumn(0, "USED_AM");
		if (!this.gfn_IsNull(this.ds_Detail11.getColumn(0, "USED_AM"))) {
			dUseAm = nexacro.toNumber(this.ds_Detail11.getColumn(0, "USED_AM"));//DB조회 사용금액 = 집행금액_발의 + 집행금액_결의
		}else{
			dUseAm = 0;
		}
		
		//var dUseAmPre = nexacro.toNumber(this.ds_Detail11.getColumn(0, "USED_AM"));//DB조회 사용금액 = 집행금액_발의 + 집행금액_결의
		var dUseAmPre = nexacro.toNumber(dUseAm);//DB조회 사용금액 = 집행금액_발의 + 집행금액_결의
		
		var iOrgSumAmt = 0;//변경전 금액 합계
		var iChangeSumAmt = 0;//변경 금액 합계
		var dPreUseAm = 0;//기사용금액

		//var dUseAm2 = nexacro.toNumber(this.div_DetailInput.form.div_detailRight.form.div_Budget.form.mae_RegAm.value);//사용금액2
		//var dUseAm = 0;//사용금액
		var sSumCol = "";//합계할 컬럼명
		
		//차대구분-대변
		if (sDECR_GU == "C") {
			//dUseAm = this.ds_Detail10.getColumn(iRow, "CRED_AM");//사용금액-현재Row
			sSumCol = "CRED_AM";//합계할 컬럼명
		} else {
			//dUseAm = this.ds_Detail10.getColumn(iRow, "DEBI_AM");//사용금액-현재Row
			sSumCol = "DEBI_AM";//합계할 컬럼명
		}
		
		
		var dUseAmPre = nexacro.toNumber(dUseAm);//DB조회 사용금액 = 집행금액_발의 + 집행금액_결의
		
		var iOrgSumAmt = 0;//변경전 금액 합계
		var iChangeSumAmt = 0;//변경 금액 합계
		var dPreUseAm = 0;//기사용금액

		//var dUseAm2 = nexacro.toNumber(this.div_DetailInput.form.div_detailRight.form.div_Budget.form.mae_RegAm.value);//사용금액2
		//var dUseAm = 0;//사용금액
		var sSumCol = "";//합계할 컬럼명
		
		
		//차대구분-대변
		if (sDECR_GU == "C") {
			//dUseAm = this.ds_Detail10.getColumn(iRow, "CRED_AM");//사용금액-현재Row
			sSumCol = "CRED_AM";//합계할 컬럼명
		} else {
			//dUseAm = this.ds_Detail10.getColumn(iRow, "DEBI_AM");//사용금액-현재Row
			sSumCol = "DEBI_AM";//합계할 컬럼명
		}		
// 		
// 		var sDECR_GU_Chk = "";//차대구분-체크대상
// 		var sACOM_CD_Chk = "";//계정코드-체크대상
// 		var sBUDG_MM_Chk = "";//편성년월-체크대상
// 		var sBUDP_CD_Chk = 0;//예산부서-체크대상
// 		var sCrudType = "";//CRUD Type
// 		var dOrgAm = 0;//변경전 금액
// 		var dNowAm = 0;//현재 금액
// 						
// 		var dUseAmSum = this.ds_Detail10.getCaseSum("DECR_GU == '" + sDECR_GU + "' && ACOM_CD == '" + sACOM_CD + "' && BUDG_MM == '" + sBUDG_MM + "' && BUDP_CD == '" + sBUDP_CD + "'", sSumCol);//사용금액합		
// 	
// 		
// 		this.div_detailRight.form.div_Budget.form.mae_UsedAm.set_value(dUseAmPre);//기사용금액 = DB조회 사용금액 
// 		this.div_detailRight.form.div_Budget.form.mae_RegAm.set_value(dUseAmSum);//사용금액-해당 계정건
// 
// 		var dAvailAm = dRecAm - (dUseAmPre + dUseAmSum);//가용잔액 = 편성금액 - ( 기사용금액 + 사용금액)

		var sDECR_GU_Chk = "";//차대구분-체크대상
		var sACOM_CD_Chk = "";//계정코드-체크대상
		var sBUDG_MM_Chk = "";//편성년월-체크대상
		var sBUDP_CD_Chk = 0;//예산부서-체크대상
		var sCrudType = "";//CRUD Type
		var dOrgAm = 0;//변경전 금액
		var dNowAm = 0;//현재 금액
			
		for (var iLoop=0; iLoop<this.ds_Detail10.getRowCount(); iLoop++) {
			sDECR_GU_Chk = this.ds_Detail10.getColumn(iLoop, "DECR_GU");//차대구분-체크대상
			sACOM_CD_Chk = this.ds_Detail10.getColumn(iLoop, "ACOM_CD");//계정코드-체크대상
			sBUDG_MM_Chk = this.ds_Detail10.getColumn(iLoop, "BUDG_MM");//편성년월-체크대상
			sBUDP_CD_Chk = this.ds_Detail10.getColumn(iLoop, "BUDP_CD");//예산부서-체크대상
			sCrudType = this.ds_Detail10.getColumn(iLoop, "crudType");//CRUD Type
			dOrgAm = this.ds_Detail10.getOrgColumn(iLoop, sSumCol);//변경전 금액
			dNowAm = this.ds_Detail10.getColumn(iLoop, sSumCol);//현재 금액
			//trace("sCrudType====="+sCrudType);
			if (sDECR_GU == sDECR_GU_Chk && sDECR_GU == sDECR_GU_Chk && sACOM_CD == sACOM_CD_Chk && sBUDG_MM == sBUDG_MM_Chk && sBUDP_CD == sBUDP_CD_Chk) {

				if (sCrudType == "U") {
			
					iChangeSumAmt = iChangeSumAmt + (dNowAm - dOrgAm);//변경 금액 합계
				}
				
				if (sCrudType != "I") {
					iOrgSumAmt = iOrgSumAmt + dOrgAm;//변경전 금액 합계					
				}
			}
			
		}
						
		var dUseAmSum = this.ds_Detail10.getCaseSum("DECR_GU == '" + sDECR_GU + "' && ACOM_CD == '" + sACOM_CD + "' && BUDG_MM == '" + sBUDG_MM + "' && BUDP_CD == '" + sBUDP_CD + "'", sSumCol);//사용금액합		
		

		dPreUseAm = dUseAmPre; //- iOrgSumAmt;//기사용금액	
		
		
		/*
		if (iChangeSumAmt == 0) {
			dPreUseAm = dUseAmPre - iOrgSumAmt;//기사용금액		
		} else {
			dPreUseAm = dUseAmPre - (iOrgSumAmt - (iChangeSumAmt-iOrgSumAmt));//기사용금액
		}
		*/
//         trace("dUseAmPre ===================== " + dUseAmPre);
//         trace("iOrgSumAmt ===================== " + iOrgSumAmt);
// 		//trace("dPreUseAm ===================== " + dPreUseAm);
		this.div_detailRight.form.div_Budget.form.mae_UsedAm.set_value(dPreUseAm);//기사용금액 = DB조회 사용금액 - 현재계정의 변경전 금액
		this.div_detailRight.form.div_Budget.form.mae_RegAm.set_value(dUseAmSum);//사용금액-해당 계정건

		var dAvailAm = dRecAm - (dPreUseAm + dUseAmSum);//가용잔액 = 편성금액 - ( 기사용금액 + 사용금액)
	    var dGetOrgAm;
		var dGetGetAm;
		
		
		if (isNaN(dAvailAm)) {
			this.div_detailRight.form.div_Budget.form.mae_AvailAm.set_value(0);//가용잔액
		} else {
// 			if (dAvailAm < 0) {
// 				this.fvBCalAvailAmt = false;//가용금액계산여부
// 				this.ds_Detail10.set_enableevent(true);
// 				return;
// 			} else {		
// 				this.div_detailRight.form.div_Budget.form.mae_AvailAm.set_value(dAvailAm);//가용잔액
// 			}



			if (dAvailAm < 0) {
			
				this.gfn_Alert("CA012");//가용잔액이 부족합니다.
				

				if (sDECR_GU == "C") {
					
					dGetOrgAm = nexacro.toNumber(this.ds_Detail10.getOrgColumn(iRow, "CRED_AM"));
					dGetGetAm = nexacro.toNumber(this.ds_Detail10.getColumn(iRow, "CRED_AM"));

					if(dGetOrgAm != dGetGetAm){
						this.ds_Detail10.setColumn(iRow, "CRED_AM", this.ds_Detail10.getOrgColumn(iRow, "CRED_AM"));
					}else{
						this.ds_Detail10.setColumn(iRow, "CRED_AM", 0);
					}
					
					//this.div_DetailInput.form.tab_Detail.tpg_01.form.grd_Detail10.setCellPos(10);
					this.grd_Detail10.setCellPos(10);
				} else {
					//this.ds_Detail10.setColumn(iRow, "DEBI_AM", this.ds_Detail10.getOrgColumn(iRow, "DEBI_AM"));
					
					dGetOrgAm = nexacro.toNumber(this.ds_Detail10.getOrgColumn(iRow, "DEBI_AM"));
					dGetGetAm = nexacro.toNumber(this.ds_Detail10.getColumn(iRow, "DEBI_AM"));

					if(dGetOrgAm != dGetGetAm){
						this.ds_Detail10.setColumn(iRow, "DEBI_AM", this.ds_Detail10.getOrgColumn(iRow, "DEBI_AM"));
					}else{
						this.ds_Detail10.setColumn(iRow, "DEBI_AM", 0);
					}
					
					//this.div_DetailInput.form.tab_Detail.tpg_01.form.grd_Detail10.setCellPos(9);
					this.grd_Detail10.setCellPos(9);
					
				}
				this.grd_Detail10.showEditor(true);
				this.grd_Detail10.setFocus();
				//this.div_DetailInput.form.div_detailRight.form.div_Budget.form.mae_UsedAm.set_value(0);

				dUseAmSum = this.ds_Detail10.getCaseSum("DECR_GU == '" + sDECR_GU + "' && ACOM_CD == '" + sACOM_CD + "' && BUDG_MM == '" + sBUDG_MM + "'", sSumCol);//사용금액합
				dAvailAm = dRecAm - (dPreUseAm + dUseAmSum);//가용잔액 = 편성금액 - ( 사용금액1합 + 사용금액2)
				this.div_detailRight.form.div_Budget.form.mae_RecAm.set_value(dUseAmSum);//사용금액-해당 계정건
				this.div_detailRight.form.div_Budget.form.mae_AvailAm.set_value(dAvailAm);//가용잔액
				this.fvBCalAvailAmt = false;//가용금액계산여부
				this.ds_Detail10.set_enableevent(true);
				return;
			} else {		
				this.div_detailRight.form.div_Budget.form.mae_AvailAm.set_value(dAvailAm);//가용잔액
			}
			
			
		}

		if (!this.gfn_IsNull(sACOM_CD) && !this.gfn_IsNull(sBUDG_MM)) {
		
			if (this.div_detailRight.form.div_Budget.form.chk_BgcmYn.value) {	
				
				//편성금액체크
				if (isNaN(dRecAm) || (dRecAm == 0)) {

					if (this.ds_Detail10.getColumn(iRow, "crudType") == "I" || this.ds_Detail10.getColumn(iRow, "crudType") == "U") {
						//trace("해당월의 예산편성금액이 없습니다. 1")
						//this.gfn_Alert("CA011");//해당월의 예산편성금액이 없습니다.
					}
				}		
				
				
				if (isNaN(dRecAm)) {
					this.ds_Detail10.setColumn(iRow, "BGCM_AM", "0");//예산편성금액
				} else {
					this.ds_Detail10.setColumn(iRow, "BGCM_AM", dRecAm);//예산편성금액
				}			
		
			}
		}

		this.fvBCalAvailAmt = false;//가용금액계산여부
		this.ds_Detail10.set_enableevent(true);
	} else {	
		this.div_detailRight.form.div_Budget.form.mae_AvailAm.set_value(0);//가용잔액
	}
}

/***********************************************************************************************
 * 15.19. [예산통제정보 조회] - 예산부서, 편성년월 변경시
 ***********************************************************************************************/ 
this.fn_GetBudg = function()
{
	this.ds_Input.clearData();
	this.ds_Detail11.clearData();
	
	this.ds_Input.addRow();
	
	var sDEPM_CD = this.ds_Detail10.getColumn(this.ds_Detail10.rowposition, "BUDP_CD");//부서코드
	var sBUDG_MM = this.gfn_Nvl(this.ds_Detail10.getColumn(this.ds_Detail10.rowposition, "BUDG_MM"), "");//편성년월
	var sACOM_CD = this.ds_Detail10.getColumn(this.ds_Detail10.rowposition, "ACOM_CD");//계정코드
	var sCtrlCd = this.ds_Detail10.getColumn(this.ds_Detail10.rowposition, "CTRL_CD");//회계기준코드
	
	if (this.gfn_IsNull(sDEPM_CD) || this.gfn_IsNull(sBUDG_MM) || this.gfn_IsNull(sACOM_CD)) {
		return;
	}
	//회계기준코드변경
	//예산부서의 회계기준코드를 가져온다.
	
	var iFindRow = this.ds_EmPalm.findRowExpr("DEPM_CD == '"+sDEPM_CD+"'");
	
	//trace("iFindRow = " + iFindRow);
	var palmCd = this.ds_EmPalm.getColumn(iFindRow, "PALM_CD");
	var palmNm = this.ds_EmPalm.getColumn(iFindRow, "PALM_NM");
	
	if(!this.gfn_IsNull(palmCd) && !this.gfn_IsNull(sCtrlCd)){
		this.ds_Detail10.setColumn(this.ds_Detail10.rowposition, "PALM_CD", palmCd);
		this.ds_Detail10.setColumn(this.ds_Detail10.rowposition, "PALM_NM", palmNm);
	}
	
	
	
	
	
	if (!this.gfn_IsNull(sBUDG_MM)) {
		sBUDG_MM = sBUDG_MM.substr(0,6);
	}
	
	this.ds_Input.setColumn(0, "BUGS_YM", sBUDG_MM);
	this.ds_Input.setColumn(0, "DEPM_CD", sDEPM_CD);
	this.ds_Input.setColumn(0, "ACOM_CD", sACOM_CD);
	
	//[공통]서비스정보 초기화
	this.gfn_InitComService(this);
		
	//[공통]서비스정보 추가
	var svcAddObj = new Object();//[공통] 서비스 추가 파라메타 정보 Object
	svcAddObj.sSelectSql = "fa:M_FA_1000_D_SL12";
	this.gfn_AddComSearchService(this, svcAddObj);			

	//[공통]서비스 호출 변수
	var svcCallObj = new Object();//[공통] 서비스 파라메타 정보 Object
		
	svcCallObj.sTrid = "GET_BUDG";//Transaction ID 등 callback에서 넘겨 받을 String을 지정

	svcCallObj.sActionName = this.G_SV_FA;//서버에서 호출할 Action - 모듈별로 호출되는 기본 Actio이 다름 : 공통 서비스 Action 업무구분  변수 참조
	svcCallObj.sInputDaset = "ds_Input=ds_Input" //입력 데이터셋
	svcCallObj.sOutDatset = "ds_Detail11=ds_Detail11";//출력 데이터셋
	svcCallObj.sOtherArg = "";//서버로 전송할 기타 Argument 정보 문자열, 예) key=value key2=value2
	svcCallObj.sCallBackFnc = "fn_Callback";//서버에서 처리가 완료된 후 Callback 받을 Function 명
	svcCallObj.isSync = true;//동기식으로 설정할지 여부

	//[공통]서비스 호출
	this.gfn_CallComService(this, svcCallObj);
	

}

/***********************************************************************************************
 * 15.20. [계정명조회 그리드] - 콜백함수
 ***********************************************************************************************/ 
this.fn_CommAcomCallbackFunc = function()
{  
	this.setTimer(100, 200);
}

/***********************************************************************************************
 * 15.21. [계정명조회 그리드] - 콜백함수-실행함수
 ***********************************************************************************************/ 
this.fn_CommAcomCallbackRunFunc = function(dsAcomMaSetYn)
{  
	var iRow = this.ds_Detail10.rowposition;
	var sACOM_CD = this.ds_Detail10.getColumn(iRow, "ACOM_CD");//계정코드
	var sBUDG_MM = this.gfn_Nvl(this.ds_Detail10.getColumn(iRow, "BUDG_MM"), "");//편성년월
	
	
	var sCtrlCd = this.ds_Detail10.getColumn(iRow, "CTRL_CD");//회계기준코드
	var sDECR_GU = this.ds_Detail10.getColumn(iRow, "DECR_GU");//차대구분
	var sDECR_GU_CHK = this.ds_Detail10.getColumn(iRow, "DECR_GU_CHK");//차대구분-계정
	var sAntiYn =  this.ds_Detail10.getColumn(iRow, "ANTI_YN");//반제전표계정YN

	if(this.ds_Detail10.getColumn(this.ds_Detail10.rowposition, "DEBI_AM")==0 && this.ds_Detail10.getColumn(this.ds_Detail10.rowposition, "CRED_AM")==0){
		this.ds_Detail10.set_enableevent(false);
		if(this.gfn_IsNull(sDECR_GU_CHK) || sDECR_GU_CHK==""){
			this.ds_Detail10.setColumn(this.ds_Detail10.rowposition, "DECR_GU", "D");
		}else{
			this.ds_Detail10.setColumn(this.ds_Detail10.rowposition, "DECR_GU", sDECR_GU_CHK);
		}
		this.ds_Detail10.set_enableevent(true);
	}
				
// 	this.ds_Detail10.setColumn(this.ds_Detail10.rowposition, "CURR_CD", "0090");
// 	this.ds_Detail10.setColumn(this.ds_Detail10.rowposition, "EXCH_RT", 0);
// 	this.ds_Detail10.setColumn(this.ds_Detail10.rowposition, "FRDB_AM", 0);
// 	this.ds_Detail10.setColumn(this.ds_Detail10.rowposition, "FRCR_AM", 0);
	
	/*
		반제계정인경우 
		반제계정의 차대구분과 전표의 차대구분이 일치해야 함
		불일치시 등록 못함
	*/
	//trace("sAntiYn = " + sAntiYn);
	/*
	if(sAntiYn == "1" ){
		if(sDECR_GU != sDECR_GU_CHK){
			//trace("sDECR_GU_CHK = " + sDECR_GU_CHK);
			//trace("sDECR_GU = " + sDECR_GU);
			var sDEcrGuNm = "";
			if(sDECR_GU == "D"){
				sDEcrGuNm = "대변";
			}else{
				sDEcrGuNm = "차변";
			}
			
			//trace("sDEcrGuNm = " + sDEcrGuNm);
			var arrMsgArg = [sDEcrGuNm];
			this.gfn_Alert("FA020", arrMsgArg); //반제계정은 [ &ITM0 ] 만 가능합니다. 
			
			this.ds_Detail10.setColumn(this.ds_Detail10.rowposition, "ACOM_CD", "");
			this.ds_Detail10.setColumn(this.ds_Detail10.rowposition, "ACOM_NM", "");
			this.ds_Detail10.setColumn(this.ds_Detail10.rowposition, "DECR_GU_CHK", "");//차대구분	
			//this.ds_Detail10.setColumn(this.ds_Detail10.rowposition, "DECR_GU", "C");//차대구분					
			this.ds_Detail10.setColumn(this.ds_Detail10.rowposition, "CTRL_CD", "");//전표손익제어
			
			return;
		}
	}
	*/
	
	
	//발의자의 손익코드
	//var iFindRow = this.ds_EmPalm.findRowExpr("SYST_ID == '"+this.gfn_GetSessionValue("SYST_ID")+"'");
	var iFindRow = this.ds_EmPalm.findRowExpr("DEPM_CD == '"+this.ds_Detail10.getColumn(this.ds_Detail10.rowposition, "BUDP_CD")+"'");
	
	//trace("iFindRow = " + iFindRow);
	var palmCd = this.ds_EmPalm.getColumn(iFindRow, "PALM_CD");
	var palmNm = this.ds_EmPalm.getColumn(iFindRow, "PALM_NM");
	//trace("palmCd = " + palmCd);
	//trace("palmNm = " + palmNm);
	//trace("sCtrlCd = " + sCtrlCd);
	
	//회계기준코드 자동입력
	//계정의 전표손익제어 의 값이 있는경우만 자동으로 가져온다.
	if(!this.gfn_IsNull(palmCd) && !this.gfn_IsNull(sCtrlCd)){
		//trace("sCtrlCd = " + sCtrlCd);
		this.ds_Detail10.setColumn(iRow, "PALM_CD", palmCd);
		this.ds_Detail10.setColumn(iRow, "PALM_NM", palmNm);
	}
	
	
	if (!this.gfn_IsNull(sACOM_CD) && !this.gfn_IsNull(sBUDG_MM)) {
		//[예산통제 계정] 체크
		var paramObj= new Object();//[공통] 예산통제체크 파라메타 정보 Object
		paramObj.BGCM_YY = sBUDG_MM.substr(0, 4);//편성년도
		paramObj.ACOM_CD = sACOM_CD;//계정코드
		var bCheckBgcm = this.gfn_CheckBgcm(paramObj);//예산편성계정여부 체크

		//예산통제계정
		if (bCheckBgcm) {
	
			var sDECR_GU = this.ds_Detail10.getColumn(iRow, "DECR_GU");//차대구분
			var sDECR_GU_CHK = this.ds_Detail10.getColumn(iRow, "DECR_GU_CHK");//차대구분-계정

			//선택한것과 계정코드의 차대구분이 같을 경우
			if ((sDECR_GU == "D" && sDECR_GU_CHK == "D") || (sDECR_GU == "C" && sDECR_GU_CHK == "C")) {
				this.div_detailRight.form.div_Budget.form.chk_BgcmYn.set_value("1");
				this.ds_Detail10.setColumn(iRow, "BGCM_YN", "Y");//예산통제여부
			} else {
				this.div_detailRight.form.div_Budget.form.chk_BgcmYn.set_value("0");
				this.ds_Detail10.setColumn(iRow, "BGCM_YN", "N");//예산통제여부
				bCheckBgcm = false;
			}
			
		} else {
			this.div_detailRight.form.div_Budget.form.chk_BgcmYn.set_value("0");
			this.ds_Detail10.setColumn(iRow, "BGCM_YN", "N");//예산통제여부
		}
	}

	//관리항목 조회
	//trace("set 1");
	//this.fn_dsAcomMa(this.ds_Detail10.getColumn(iRow, "ACOM_CD"), "SET", bCheckBgcm);		
	
		//관리항목 조회	
	if(this.dsAcomMaSetYn == ""){
		// 행복사일 경우 기존 데이터를 가져온다.
		this.fn_dsAcomMa(this.ds_Detail10.getColumn(iRow, "ACOM_CD"), "", bCheckBgcm);	
		this.dsAcomMaSetYn = "SET";
	}else{
		//행복사 외 나머지
		this.fn_dsAcomMa(this.ds_Detail10.getColumn(iRow, "ACOM_CD"), "SET", bCheckBgcm);
	}
	
	var ctrlCd = this.ds_Detail10.getColumn(iRow, "CTRL_CD");
	if(!this.gfn_IsNull(ctrlCd)){
		//전표손익제어
		if(ctrlCd == "0010" || ctrlCd == "0040" || ctrlCd == "0045" || ctrlCd == "0050"){
			//제조, 판매, 관리, 연구
			
			
		}
	}
	
}


/***********************************************************************************************
 * 15.23. 타이머 설정 - 비동기시 설정 때문에
 ***********************************************************************************************/ 
this.cmmFaAtob_ontimer = function(obj:nexacro.Form,e:nexacro.TimerEventInfo)
{
	//계정코드 팝업콜백함수 인경우
	if (e.timerid == 100) {
		this.fn_CommAcomCallbackRunFunc();//계정팝업 후처리 함수
		this.killTimer(100);

	}
};


/***********************************************************************************************
 * 15.24. 관리항목 자동 입력 (사번, 부서, 예산부서)
 argument 
 1) row = ds_Detail.rowposition
 2) maCd = ds_Detail의 관리항목컬럼
 3) maCdValue = 관리항목코드
 4) deCd = 관리항목 상세코드
 5) deNm = 관리항목명
 ***********************************************************************************************/ 
this.fn_ItemAutoInput = function(row, maCd, maCdValue, deCd, deNm)
{

	if(maCdValue=="3"){
		//사원
		//this.ds_Detail10.setColumn(row, "SYST_ID", this.gfn_GetSessionValue("SYST_ID"));//발의자ID
		this.ds_Detail10.setColumn(row, "V"+deCd, this.gfn_GetSessionValue("USEM_ID"));//발의자사번	
		this.ds_Detail10.setColumn(row, deCd, this.gfn_GetSessionValue("SYST_ID"));//발의자사번	
		this.ds_Detail10.setColumn(row, deNm, this.gfn_GetSessionValue("USEM_NM"));//발의자명	
	}else if(maCdValue=="4" || maCdValue=="B5"){
		//부서(4), 계약부서(B5)
		this.ds_Detail10.setColumn(row, deCd, this.gfn_GetSessionValue("DEPM_CD"));//발의부서코드	
		this.ds_Detail10.setColumn(row, "V"+deCd, this.gfn_GetSessionValue("DEPM_CD"));//발의부서코드	
		this.ds_Detail10.setColumn(row, deNm, this.gfn_GetSessionValue("DEPM_NM"));//발의부서명
	}else if(maCdValue=="B2"){
		this.ds_Detail10.setColumn(row, deNm, "0");//	법인세
	}
	
	
};


/***********************************************************************************************
 * 15.25. 차대구분에 따리 필수체크 표시한다.
 ***********************************************************************************************/ 
this.fn_DecrGuCssclass = function(decrGu){
	if(decrGu =="D"){
		//차변
		this.grd_Detail10.setCellProperty("head", 9, "cssclass", "essential");
		this.grd_Detail10.setCellProperty("head", 10, "cssclass", "");
	}else{
		//대변
		this.grd_Detail10.setCellProperty("head", 9, "cssclass", "");
		this.grd_Detail10.setCellProperty("head", 10, "cssclass", "essential");
	}
}

this.ds_Detail10_cancolumnchange = function(obj:nexacro.NormalDataset,e:nexacro.DSColChangeEventInfo)
{
		if (e.columnid == "DECR_GU"){
		
		// D: 차변 일 경우 대변 금액을 지우고
		// C: 대변 일 경우 차변 금액을 지운자.
		
		
		//차대굽분에 따라 필수 체크 표시
		this.fn_DecrGuCssclass(e.newvalue);
		
// 		if(e.newvalue =="D"){
// 			//차변
// 			this.tab_Detail.tpg_01.form.grd_Detail10.setCellProperty("head", 9, "cssclass", "essential");
// 			this.tab_Detail.tpg_01.form.grd_Detail10.setCellProperty("head", 10, "cssclass", "");
// 		}else{
// 		    //대변
// 			this.tab_Detail.tpg_01.form.grd_Detail10.setCellProperty("head", 9, "cssclass", "");
// 			this.tab_Detail.tpg_01.form.grd_Detail10.setCellProperty("head", 10, "cssclass", "essential");
// 		}
	}
};




/***********************************************************************************************
 * 15.26. 반제전표찾기
 ***********************************************************************************************/ 
this.div_DetailInput_btn_banFind_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
   var sPopupId = "S_BANJE_CD_01";//팝업ID
   trace("this.fvComPrgmId = " + this.fvComPrgmId);
   var oArg = {PrgmId:this.fvComPrgmId
              , CusmCd:this.ds_Master10.getColumn(0, "PACS_CD")//.edt_PacsCd.value
			  , CusmNm:this.ds_Master10.getColumn(0, "PACS_NM")
              , AcomCd:this.ds_Detail10.getColumn(this.ds_Detail10.rowposition, "ACOM_CD")
			  , AcomNm:this.ds_Detail10.getColumn(this.ds_Detail10.rowposition, "ACOM_NM")
			  };//Argument처리
   this.gfn_BanjePop(sPopupId, oArg);  	
  	
};



/***********************************************************************************************
 * 15.26. 자동전표내용 ds_Master10 변경여부 체크
 ***********************************************************************************************/ 
this.fn_CheckAtobMasterUpdate = function() {

	if (this.gfn_DsIsUpdated(this.ds_Master10)) {
		return true;
	} else {
		return false;
	}
}

/***********************************************************************************************
 * 15.26. 자동전표내용 ds_Detail10 변경여부 체크
 ***********************************************************************************************/ 
this.fn_CheckAtobUpdate = function() {

	if (this.gfn_DsIsUpdated(this.ds_Detail10)) {
		return true;
	} else {
		return false;
	}
}
/***********************************************************************************************
 * 15.27. 자동전표 변경내용 데이터셋에 담아서 리턴해줌
 ***********************************************************************************************/ 
this.fn_CopyAtobUpdateMs = function(oDs) {

	if (this.gfn_DsIsUpdated(this.ds_Master10)) {
	
		oDs.clearData();
		
		var iAddRow = -1;
		
		//trace("=======this.ds_Master10 oDs.row= " + oDs.getRowCount());
		
		var sCrudType = "";
		for (var iLoop = 0; iLoop <this.ds_Master10.getRowCount(); iLoop++) {
		
			sCrudType =  this.ds_Master10.getColumn(iLoop, "crudType");
			//trace("=======this.ds_Master10 iLoop = " + iLoop);
			//trace("=======this.ds_Master10 this.ds_Master10.getRowCount() = " + this.ds_Master10.getRowCount());
			//trace("=======this.ds_Master10 this.ds_Master10.getRowCount() crudType= " + sCrudType);
			//trace("=======this.ds_Master10 this.ds_Master10.getRowCount() ACCH_AM= " + this.ds_Master10.getColumn(iLoop, "ACCH_AM"));
			if (sCrudType == "U" || sCrudType == "I") {
			
			
				//trace("=======this.ds_Master10 1= " + this.ds_Master10.getColumn(0, "crudType"));
				//trace("=======this.ds_Master10 1= " + this.ds_Master10.getColumn(0, "ACCH_AM"));
				//trace("=======this.ds_Master10 1= " + oDs.get_id());
				
				iAddRow = oDs.addRow();
				
				//trace("=======this.ds_Master10 1 iAddRow= " + iAddRow);
				
				
				//trace("=======this.ds_Master10 2= " + this.ds_Master10.getColumn(0, "crudType"));
				//trace("=======this.ds_Master10 2= " + this.ds_Master10.getColumn(0, "ACCH_AM"));
				
				oDs.copyRow(iAddRow, this.ds_Master10, iLoop);
			}
		}		
	}

}
/***********************************************************************************************
 * 15.27. 자동전표 변경내용 데이터셋에 담아서 리턴해줌
 ***********************************************************************************************/ 
this.fn_CopyAtobUpdateDs = function(oDs) {

	if (this.gfn_DsIsUpdated(this.ds_Detail10)) {
	
	
	
		//VDEXX_CD와 DEXX_CD 값이 다를 경우 데이터 UPDATE
		for (var iLoop=1; iLoop<9; iLoop++) {
			findRow = this.ds_Detail10.findRowExpr("DE0"+iLoop+"_CD != VDE0"+iLoop+"_CD");
			
				
			while (findRow > -1){
				this.ds_Detail10.setColumn(findRow, "DE0"+iLoop+"_CD", this.ds_Detail10.getColumn(findRow, "VDE0"+iLoop+"_CD"));
				
				findRow = this.ds_Detail10.findRowExpr("DE0"+iLoop+"_CD != VDE0"+iLoop+"_CD");
			}
		} 
	
	
	
	
		oDs.clearData();
		
		var iAddRow = 0;
		var sCrudType ="";
		for (var iLoop = 0; iLoop <this.ds_Detail10.getRowCount(); iLoop++) {
			sCrudType = this.ds_Detail10.getColumn(iLoop, "crudType");
			if (sCrudType == "U" || sCrudType == "I" || sCrudType == "D") {
				iAddRow = oDs.addRow();
				this.ds_Detail10.setColumn(iLoop, "SORT_NO", iLoop);
				this.ds_Detail10.setColumn(iLoop, "crudType", sCrudType);
				
// 				//trace(=======this.ds_Detail10 ds_Master10ACUM_CD = " + this.ds_Master10.getColumn(0, "ACUM_CD"));
// 				//trace(=======this.ds_Detail10 ACUM_CD = " +iLoop + " " + this.ds_Detail10.getColumn(iLoop, "ACUM_CD"));
				
				oDs.copyRow(iAddRow, this.ds_Detail10, iLoop);
			}
			
			
			
		}
		
		
		
	}

}

/***********************************************************************************************
 * 15.26. 자동전표내용 변경여부 체크
 ***********************************************************************************************/ 
this.fn_AtobReset = function() {

	this.ds_Detail10.reset();
	
	if (this.ds_Detail10.getCaseCount("crudType == 'U'") > 0
	   || this.ds_Detail10.getCaseCount("crudType == 'I'") > 0) {
		for (var iLoop = 0; iLoop<this.ds_Detail10.getRowCount(); iLoop++) {
			this.ds_Detail10.setColumn(iLoop, "crudType", "");
		}
	}

}

/***********************************************************************************************
 * 15.27. 자동전표 저장
   -------------------------------------------------------------------
   checkYn = true 일경우
   crudType 값의 I, U 값에 따라 체크 아닌 무조건 체크를 한다.
   ---------------------------------------------------------------------
 ***********************************************************************************************/ 
this.fn_AtobVaildSave = function(checkYn) {

	trace("fn_AtobVaildSave================");

	//[저장] Validation 설정
	var arrArgs = ["REMK_NM^NULL" /*적요*/
			      ]; 
				  
	var sCheckGroupTitle = "자동전표상세";//체크그룹 타이틀
				
	
	//Grid Vaild 체크
	if (!this.gfn_CheckGridValid(this.grd_Detail10, arrArgs, sCheckGroupTitle) ) {
	 
		return false;
	}
	
	//차/대금액 체크
	//dataset.getCaseSum("crudType != 'D'", "DEBI_AM") 
	var dDEBI_AM = nexacro.toNumber(this.ds_Detail10.getCaseSum("crudType != 'D'", "DEBI_AM"));//차변금액
	var dCRED_AM = nexacro.toNumber(this.ds_Detail10.getCaseSum("crudType != 'D'", "CRED_AM"));//대변금액


	//this.ds_Master10.setColumn(this.ds_Master10.rowposition, "ACCH_AM", dDEBI_AM);
	

	if (dDEBI_AM != dCRED_AM) {
		this.gfn_Alert("FA010");//차변/대변 금액이 일치하지 않습니다.
		return false;
	}
	
	
	this.fn_AcchAmt();
	
	
	
	//관리항목 체크
	var dedtCd = "";
	var vdedtCd = "";
	
	var findRow = -1;
	
	for (var iLoop=1; iLoop<9; iLoop++) {
		findRow = this.ds_Detail10.findRowExpr("DE0"+iLoop+"_CD != VDE0"+iLoop+"_CD && MA0"+iLoop+"_CD != '3'");
		
		trace("findRow = " + findRow);
		
		while (findRow > -1){
			this.ds_Detail10.setColumn(findRow, "DE0"+iLoop+"_CD", this.ds_Detail10.getColumn(findRow, "VDE0"+iLoop+"_CD"));
			
			findRow = this.ds_Detail10.findRowExpr("DE0"+iLoop+"_CD != VDE0"+iLoop+"_CD && MA0"+iLoop+"_CD != '3'");
		}
	} 
	
	
	//관리항목 필수항목 체크
	var crudType = "";
	var iFindRow = 0;
	var sMA01_YN = "";//01관리항목 필수여부
	var sMA02_YN = "";//02관리항목 필수여부
	var sMA03_YN = "";//03관리항목 필수여부
	var sMA04_YN = "";//04관리항목 필수여부
	var sMA05_YN = "";//05관리항목 필수여부
	var sMA06_YN = "";//06관리항목 필수여부
	var sMA07_YN = "";//07관리항목 필수여부
	var sMA08_YN = "";//08관리항목 필수여부
	var sCheckValue = "";//체크항목값
	var sACOM_NM = "";//계정명
	
	for (var iLoop=0; iLoop<this.ds_Detail10.getRowCount(); iLoop++) {
	
		/*
		checkYn 이 true 일 경우 값의 변경유무에 따라 체크가 아니 체크를 한다.
		*/
		if(checkYn){
			crudType = "U";
		}else{
			crudType = this.ds_Detail10.getColumn(iLoop, "crudType");		
		}
		
		//신규, 수정건인경우
		if (crudType == "I" || crudType == "U" ) {
			sMA01_YN = this.ds_Detail10.getColumn(iLoop, "MA01_YN");//01관리항목 필수여부
			sMA02_YN = this.ds_Detail10.getColumn(iLoop, "MA02_YN");//02관리항목 필수여부
			sMA03_YN = this.ds_Detail10.getColumn(iLoop, "MA03_YN");//03관리항목 필수여부
			sMA04_YN = this.ds_Detail10.getColumn(iLoop, "MA04_YN");//04관리항목 필수여부
			sMA05_YN = this.ds_Detail10.getColumn(iLoop, "MA05_YN");//05관리항목 필수여부
			sMA06_YN = this.ds_Detail10.getColumn(iLoop, "MA06_YN");//06관리항목 필수여부
			sMA07_YN = this.ds_Detail10.getColumn(iLoop, "MA07_YN");//07관리항목 필수여부
			sMA08_YN = this.ds_Detail10.getColumn(iLoop, "MA08_YN");//08관리항목 필수여부
			sACOM_NM = this.ds_Detail10.getColumn(iLoop, "ACOM_NM");//계정명
						
			//01관리항목이 필수인경우
			if (sMA01_YN == "1") {
				sCheckValue = this.ds_Detail10.getColumn(iLoop, "DE01_NM");//체크항목값
				if (this.gfn_IsNull(sCheckValue)) {
					this.ds_Detail10.set_rowposition(iLoop);
					var arrMsgArg = [sACOM_NM, this.div_detailRight.form.div_Item.form.sta_Ma01.text];
					this.gfn_Alert("FA009", arrMsgArg);//[ &ITM0 ] 계정의 관리항목 &ITM1 (은/는) 필수입력 항목입니다. 						
					return false;
				}					
			}
			
			//02관리항목이 필수인경우
			if (sMA02_YN == "1") {
				sCheckValue = this.ds_Detail10.getColumn(iLoop, "DE02_NM");//체크항목값
				if (this.gfn_IsNull(sCheckValue)) {
					this.ds_Detail10.set_rowposition(iLoop);
					var arrMsgArg = [sACOM_NM, this.div_detailRight.form.div_Item.form.sta_Ma02.text];
					this.gfn_Alert("FA009", arrMsgArg);//[ &ITM0 ] 계정의 관리항목 &ITM1 (은/는) 필수입력 항목입니다. 							
					return false;
				}					
			}		
			
			//03관리항목이 필수인경우
			if (sMA03_YN == "1") {
				sCheckValue = this.ds_Detail10.getColumn(iLoop, "DE03_NM");//체크항목값

				if (this.gfn_IsNull(sCheckValue)) {
					this.ds_Detail10.set_rowposition(iLoop);
					var arrMsgArg = [sACOM_NM, this.div_detailRight.form.div_Item.form.sta_Ma03.text];
					this.gfn_Alert("FA009", arrMsgArg);//[ &ITM0 ] 계정의 관리항목 &ITM1 (은/는) 필수입력 항목입니다. 							
					return false;
				}					
			}
			
			//04관리항목이 필수인경우
			if (sMA04_YN == "1") {
				sCheckValue = this.ds_Detail10.getColumn(iLoop, "DE04_NM");//체크항목값
				if (this.gfn_IsNull(sCheckValue)) {
					this.ds_Detail10.set_rowposition(iLoop);
					var arrMsgArg = [sACOM_NM, this.div_detailRight.form.div_Item.form.sta_Ma04.text];
					this.gfn_Alert("FA009", arrMsgArg);//[ &ITM0 ] 계정의 관리항목 &ITM1 (은/는) 필수입력 항목입니다. 							
					return false;
				}					
			}	
			
			//05관리항목이 필수인경우
			if (sMA05_YN == "1") {
				sCheckValue = this.ds_Detail10.getColumn(iLoop, "DE05_NM");//체크항목값
				if (this.gfn_IsNull(sCheckValue)) {
					this.ds_Detail10.set_rowposition(iLoop);
					var arrMsgArg = [sACOM_NM, this.div_detailRight.form.div_Item.form.sta_Ma05.text];
					this.gfn_Alert("FA009", arrMsgArg);//[ &ITM0 ] 계정의 관리항목 &ITM1 (은/는) 필수입력 항목입니다. 							
					return false;
				}					
			}
			
			//06관리항목이 필수인경우
			if (sMA06_YN == "1") {
				sCheckValue = this.ds_Detail10.getColumn(iLoop, "DE06_NM");//체크항목값
				if (this.gfn_IsNull(sCheckValue)) {
					this.ds_Detail10.set_rowposition(iLoop);
					var arrMsgArg = [sACOM_NM, this.div_detailRight.form.div_Item.form.sta_Ma06.text];
					this.gfn_Alert("FA009", arrMsgArg);//[ &ITM0 ] 계정의 관리항목 &ITM1 (은/는) 필수입력 항목입니다. 							
					return false;
				}					
			}	
			
			//07관리항목이 필수인경우
			if (sMA07_YN == "1") {
				sCheckValue = this.ds_Detail10.getColumn(iLoop, "DE07_NM");//체크항목값
				if (this.gfn_IsNull(sCheckValue)) {
					this.ds_Detail10.set_rowposition(iLoop);
					var arrMsgArg = [sACOM_NM, this.div_detailRight.form.div_Item.form.sta_Ma07.text];
					this.gfn_Alert("FA009", arrMsgArg);//[ &ITM0 ] 계정의 관리항목 &ITM1 (은/는) 필수입력 항목입니다. 							
					return false;
				}					
			}
			
			//08관리항목이 필수인경우
			if (sMA08_YN == "1") {
				sCheckValue = this.ds_Detail10.getColumn(iLoop, "DE08_NM");//체크항목값
				if (this.gfn_IsNull(sCheckValue)) {
					this.ds_Detail10.set_rowposition(iLoop);
					var arrMsgArg = [sACOM_NM, this.div_detailRight.form.div_Item.form.sta_Ma08.text];
					this.gfn_Alert("FA009", arrMsgArg);//[ &ITM0 ] 계정의 관리항목 &ITM1 (은/는) 필수입력 항목입니다. 							
					return false;
				}					
			}				
			
		}
		
	}
	
	
	//예산통제정보 체크
	this.ds_Detail12.clearData();
	
	var sBGCM_YN = "";//예산통제여부
	var sBUDG_MM= "";//편성년월
	var sBUDP_CD = "";//예산부서코드
	var sACOM_CD = "";//계정코드
	var sACOM_NM = "";//계정명
	var sDECR_GU = "";//차대구분
	var sNUMB_SE = ""; //순번
	var sSumCol = "";//합계대상컬럼
	var iFindRow = 0;
	var iAddRow = 0;
	var dUseAmSum = 0;//사용금액합계	
	var dsDOrgAm = 0; //변동금액	
	
	
	
	//예산통제대상 계정취합
	for (var iLoop=0; iLoop<this.ds_Detail10.getRowCount(); iLoop++) {
		sBGCM_YN = this.ds_Detail10.getColumn(iLoop, "BGCM_YN");//예산통제여부
		sBUDG_MM = this.ds_Detail10.getColumn(iLoop, "BUDG_MM");//편성년월
		sBUDP_CD = this.ds_Detail10.getColumn(iLoop, "BUDP_CD");//예산부서코드
		sACOM_CD = this.ds_Detail10.getColumn(iLoop, "ACOM_CD");//계정코드
		sACOM_NM = this.ds_Detail10.getColumn(iLoop, "ACOM_NM");//계정명
		sDECR_GU = this.ds_Detail10.getColumn(iLoop, "DECR_GU");//차대구분
		sNUMB_SE = this.ds_Detail10.getColumn(iLoop, "NUMB_SE");//
		//trace("=============6-12=============");
		//예산통제계정인경우
		if (sBGCM_YN == "Y") {
			iFindRow = this.ds_Detail12.findRowExpr("BUGS_YM == '" + sBUDG_MM + "' && DEPM_CD == '" + sBUDP_CD + "' && ACOM_CD == '" + sACOM_CD + "'");
			//trace("=============6-13=============");
			if (iFindRow < 0) {
				iAddRow = this.ds_Detail12.addRow();
				this.ds_Detail12.setColumn(iAddRow, "BUGS_YM", sBUDG_MM);//편성년월
				this.ds_Detail12.setColumn(iAddRow, "DEPM_CD", sBUDP_CD);//예산부서코드
				this.ds_Detail12.setColumn(iAddRow, "ACOM_CD", sACOM_CD);//계정코드
				this.ds_Detail12.setColumn(iAddRow, "ACOM_NM", sACOM_NM);//계정명
				//trace("=============6-14=============");
				//차대구분-차변
				if (sDECR_GU == "D") {
					sSumCol = "DEBI_AM";//합계대상컬럼
				} else {
					sSumCol = "CRED_AM";//합계대상컬럼
				}
				//trace("=============6-15=============");
				dUseAmSum = this.ds_Detail10.getCaseSum("DECR_GU == '" + sDECR_GU + "' && ACOM_CD == '" + sACOM_CD + "' && BUDG_MM == '" + sBUDG_MM + "' && BUDP_CD == '" + sBUDP_CD + "'", sSumCol);//사용금액합
				this.ds_Detail12.setColumn(iAddRow, "USED_AM", dUseAmSum);//사용금액합계
			}
			
		}
	}
	
	
	
	
	if (this.ds_Detail12.getRowCount() > 0) {

		for (var iLoop=0; iLoop<this.ds_Detail12.getRowCount(); iLoop++) {
			this.ds_Input.clearData();
			this.ds_Detail11.clearData();
			
			sBUDG_MM = this.ds_Detail12.getColumn(iLoop, "BUGS_YM");//편성년월
			sBUDP_CD = this.ds_Detail12.getColumn(iLoop, "DEPM_CD");//예산부서코드
			sACOM_CD = this.ds_Detail12.getColumn(iLoop, "ACOM_CD");//계정코드			
			sACOM_NM = this.ds_Detail12.getColumn(iLoop, "ACOM_NM");//계정명
			dUseAmSum = nexacro.toNumber(this.ds_Detail12.getColumn(iLoop, "USED_AM"));//사용금액합계			
			//trace("=============6-17=============");
			this.ds_Input.addRow();

			this.ds_Input.setColumn(0, "BUGS_YM", sBUDG_MM);
			this.ds_Input.setColumn(0, "DEPM_CD", sBUDP_CD);
			this.ds_Input.setColumn(0, "ACOM_CD", sACOM_CD);
			
			//[공통]서비스정보 초기화
			this.gfn_InitComService(this);
				
			//[공통]서비스정보 추가
			var svcAddObj = new Object();//[공통] 서비스 추가 파라메타 정보 Object
			svcAddObj.sSelectSql = "fa:M_FA_1000_D_SL12";
			this.gfn_AddComSearchService(this, svcAddObj);			

			//[공통]서비스 호출 변수
			var svcCallObj = new Object();//[공통] 서비스 파라메타 정보 Object
				//trace("=============6-18=============");
			svcCallObj.sTrid = "CHK_BUDG";//Transaction ID 등 callback에서 넘겨 받을 String을 지정
			svcCallObj.sActionName = this.G_SV_FA;//서버에서 호출할 Action - 모듈별로 호출되는 기본 Actio이 다름 : 공통 서비스 Action 업무구분  변수 참조
			svcCallObj.sInputDaset = "ds_Input=ds_Input" //입력 데이터셋
			svcCallObj.sOutDatset = "ds_Detail11=ds_Detail11";//출력 데이터셋
			svcCallObj.sOtherArg = "";//서버로 전송할 기타 Argument 정보 문자열, 예) key=value key2=value2
			svcCallObj.sCallBackFnc = "fn_Callback";//서버에서 처리가 완료된 후 Callback 받을 Function 명
			svcCallObj.isSync = true;//동기식으로 설정할지 여부

			//[공통]서비스 호출
			this.gfn_CallComService(this, svcCallObj);	
			
			if (this.ds_Detail11.getRowCount() > 0) {
			//trace("=============6-19=============");
				var dRecAm = nexacro.toNumber(this.ds_Detail11.getColumn(0, "BGMM_AM"));//편성금액			
				var dUseAm2 = nexacro.toNumber(this.ds_Detail11.getColumn(0, "USED_AM"));//사용금액2	
				
				
				dsDOrgAm = 0;
				for (var iDLoop=0; iDLoop<this.ds_Detail10.getRowCount(); iDLoop++) {
				
						sCrudType = this.ds_Detail10.getColumn(iDLoop, "crudType");//CRUD Type
						if (sCrudType == "U" && this.ds_Detail10.getColumn(iDLoop, "ACOM_CD") == sACOM_CD){
							dsDOrgAm = dsDOrgAm + this.ds_Detail10.getOrgColumn(iDLoop, "DEBI_AM");//변경전 금액				
						}
						//trace("dsDOrgAm  == " + dsDOrgAm);
			
			
				}				
				
				
				
				
				//var dAvailAm = dRecAm - (dUseAmSum + dUseAm2);//가용잔액 = 편성금액 - ( 사용금액1합 + 사용금액2)
				var dAvailAm = dRecAm - (dUseAmSum  - dsDOrgAm) ;//가용잔액 = 편성금액 - ( 사용금액1합 + 사용금액2)
				
				// 사용금액이 - 인경우
				if (dUseAm2 < 0){
					dAvailAm = dAvailAm + (dUseAm2)*-1
				}
				
				
				var iChkRow = this.ds_Detail10.findRowExpr("ACOM_CD == '" + sACOM_CD + "'");
				
				
				if (isNaN(dAvailAm) || dAvailAm < 0) {
					var arrMsgArg = [sACOM_NM, sBUDG_MM];
					this.gfn_Alert("CA014", arrMsgArg);//[&ITM0] 계정의 [&ITM1] 편성년월의 가용잔액이 부족합니다.
					this.ds_Detail10.set_rowposition(-1);
					this.ds_Detail10.set_rowposition(iChkRow);					
					return false;
				} 
				//trace("=============6-20=============");
			} else {
				var arrMsgArg = [sACOM_NM, sBUDG_MM];
				this.gfn_Alert("CA013", arrMsgArg);//[&ITM0] 계정의 [&ITM1] 편성년월의 예산편성정보가 없습니다.
				return false;
			}
		//trace("=============6-21=============");
		}
	}
	
	
	
	return true;

}


/***********************************************************************************************
 * 15.28. 자동전표내용 유무 체크용
 ***********************************************************************************************/ 
this.fn_AtobRowCount = function() {
	return this.ds_Detail10.getRowCount();
}

/***********************************************************************************************
 * 15.29. 해당업무의 프로그램ID 설정
 ***********************************************************************************************/ 
this.fn_SetPrgmId = function(sPrgmId) {
	this.fvComPrgmId = sPrgmId;//[필수]프로그램ID-메인화면기준, 팝업일경우 해당 메인화면의 프로그램ID
}

/***********************************************************************************************
 * 15.30. 관리항목 년월
 ***********************************************************************************************/ 
 this.cal_ondropdown = function(obj:nexacro.Calendar,e:nexacro.EventInfo)
{
	this.gfn_CallYmCalendar(this, "this.div_detailRight.form.div_Item.form."+obj.Id, "fn_YmCallBack");	
};


/***********************************************************************************************
 * 15.30. 체크
 ***********************************************************************************************/ 
this.dataCheck = function()
{
	// 차대 금액 비교
	var dDEBI_AM = nexacro.toNumber(this.ds_Detail10.getCaseSum("crudType != 'D'", "DEBI_AM"));//차변금액
 	var dCRED_AM = nexacro.toNumber(this.ds_Detail10.getCaseSum("crudType != 'D'", "CRED_AM"));//대변금액
	
	if (dDEBI_AM != dCRED_AM) {
		this.gfn_Alert("FA010");//차변/대변 금액이 일치하지 않습니다.
		return false;
	}
	return true;
};

/***********************************************************************************************
 * 15.27. 복사 관리항목
 ***********************************************************************************************/ 

 this.f_ItemCopy = function(iLoop)
{

		
		var sMa01Cd = "";
		var sMa02Cd = "";
		var sMa08Cd = "";
		var sMa04Cd = "";
		var sMa05Cd = "";
		var sMa06Cd = "";
		var sMa07Cd = "";
		var sMa08Cd = "";
		var sItemRow = -1;
		var sCopyYn = "";
		var sCommCD = this.ds_Master10.getColumn(this.ds_Master10.rowposition, "COMM_CD");
		var sItemGu = "";
		
		
		//for (var iLoop=0; iLoop<this.ds_Detail10.getRowCount(); iLoop++) {
	
	
	
	
			//관리항목 세팅
			this.ds_Detail10.set_rowposition(iLoop);
			//trace("iLoop = " + iLoop);
			
			//trace("==============================" + this.ds_ItemList.rowcount);
			//trace("==============================" + this.ds_ItemList.getRowCount());
			
			
            sMa01Cd = this.ds_Detail10.getColumn(iLoop, "MA01_CD");
            sMa02Cd = this.ds_Detail10.getColumn(iLoop, "MA02_CD");
            sMa03Cd = this.ds_Detail10.getColumn(iLoop, "MA03_CD");
            sMa04Cd = this.ds_Detail10.getColumn(iLoop, "MA04_CD");
            sMa05Cd = this.ds_Detail10.getColumn(iLoop, "MA05_CD");
            sMa06Cd = this.ds_Detail10.getColumn(iLoop, "MA06_CD");
            sMa07Cd = this.ds_Detail10.getColumn(iLoop, "MA07_CD");
            sMa08Cd = this.ds_Detail10.getColumn(iLoop, "MA08_CD");
			
			
			//관리항목 1
			if(!this.gfn_IsNull(sMa01Cd) && sMa01Cd !="" && sMa01Cd != "*"){ 
			
				sItemRow = this.ds_ItemList.findRowExpr("COMM_CD == '"+sCommCD+"' && ITEM_CD == '"+ sMa01Cd +"'");	
				//trace("관리항목 1 -"+iLoop+" sMa01Cd = "+sMa01Cd+ "  sItemRow = " + sItemRow);
				if(sItemRow > -1){
					sCopyYn = this.ds_ItemList.getColumn(sItemRow, "COPY_YN");
					//trace("관리항목 1 -"+iLoop+" sCopyYn = " + sCopyYn);
					if(sCopyYn == "0" || this.gfn_IsNull(sCopyYn)){
						//trace("관리항목 1 -"+iLoop+" sCopyYn = " + sCopyYn);
						this.ds_Detail10.setColumn(iLoop, "DE01_CD", "");
						this.ds_Detail10.setColumn(iLoop, "DE01_NM", "");
						this.ds_Detail10.setColumn(iLoop, "VDE01_CD", "");
						this.ds_Detail10.setColumn(iLoop, "VDE01_NM", "");
						
						this.ds_CmMaInfo.setColumn(0, "DE01_CD", "");
						this.ds_CmMaInfo.setColumn(0, "DE01_NM", "");
						this.ds_CmMaInfo.setColumn(0, "VDE01_CD", "");
						this.ds_CmMaInfo.setColumn(0, "VDE01_NM", "");
					if( sMa01Cd == "X" ){
							//통화
							this.ds_Detail10.setColumn(iLoop, "CURR_CD", "0090");
						}else if( sMa01Cd =="Y"){
							//환율 
							this.ds_Detail10.setColumn(iLoop, "EXCH_RT", "1");
						}else if( sMa01Cd =="V"){
							//외화금액
							this.ds_Detail10.setColumn(iLoop, "FRDB_AM", "0");
							this.ds_Detail10.setColumn(iLoop, "FRCR_AM", "0");
						}
						
					}else{
					
						//trace("sMa01Cd = " + sMa01Cd);
						if( sMa01Cd =="X" ){
							//통화
							this.ds_Detail10.setColumn(iLoop, "CURR_CD", this.ds_Detail10.getColumn(iLoop, "DE01_CD"));
						}else if(sMa01Cd =="Y"){
							//환율
							this.ds_Detail10.setColumn(iLoop, "EXCH_RT", this.ds_Detail10.getColumn(iLoop, "DE01_NM"));
						}else if(sMa01Cd =="V"){
							//외화금액
							if(this.ds_Detail10.getColumn(iLoop, "DECR_GU") == "D"){
								this.ds_Detail10.setColumn(iLoop, "FRDB_AM", this.ds_Detail10.getColumn(iLoop, "DE01_NM"));
							}else{
								this.ds_Detail10.setColumn(iLoop, "FRCR_AM", this.ds_Detail10.getColumn(iLoop, "DE01_NM"));
							}
						}
					}
					
					sItemGu = this.ds_ItemList.getColumn(sItemRow, "ITEM_GU");
					//trace("sItemGu 01 " + sItemGu);
					
					//관리항목이 combo, popup 이 아닌경우 dexx_cd, vdexx_cd  값은 지운다.
					if(sItemGu !="0020" && sItemGu !="0080" && sItemGu !="0090"){
						
						this.ds_Detail10.setColumn(iLoop, "DE01_CD", "");
						this.ds_Detail10.setColumn(iLoop, "VDE01_CD", "");
						
						this.ds_CmMaInfo.setColumn(0, "DE01_CD", "");
						this.ds_CmMaInfo.setColumn(0, "VDE01_CD", "");
					}
				}
			}
			//관리항목 2
			if(!this.gfn_IsNull(sMa02Cd) && sMa02Cd !="" && sMa02Cd != "*"){ 
				sItemRow = this.ds_ItemList.findRowExpr("COMM_CD == '"+sCommCD+"' && ITEM_CD == '"+ sMa02Cd +"'");
				//trace("관리항목 2 -"+iLoop+" sMa02Cd = "+sMa02Cd+ "  sItemRow = " + sItemRow);
				if(sItemRow > -1){
					sCopyYn = this.ds_ItemList.getColumn(sItemRow, "COPY_YN");
					//trace("관리항목 2 -"+iLoop+"sCopyYn = " + sCopyYn);
					if(sCopyYn == "0" || this.gfn_IsNull(sCopyYn)){
						//trace("관리항목 2 -"+iLoop+"sCopyYn = " + sCopyYn);
						this.ds_Detail10.setColumn(iLoop, "DE02_CD", "");
						this.ds_Detail10.setColumn(iLoop, "DE02_NM", "");
						this.ds_Detail10.setColumn(iLoop, "VDE02_CD", "");
						this.ds_Detail10.setColumn(iLoop, "VDE02_NM", "");
						
						this.ds_CmMaInfo.setColumn(0, "DE02_CD", "");
						this.ds_CmMaInfo.setColumn(0, "DE02_NM", "");
						this.ds_CmMaInfo.setColumn(0, "VDE02_CD", "");
						this.ds_CmMaInfo.setColumn(0, "VDE02_NM", "");
					
						if( sMa02Cd == "X" ){
							//통화
							this.ds_Detail10.setColumn(iLoop, "CURR_CD", "0090");
						}else if( sMa02Cd =="Y"){
							//환율 
							this.ds_Detail10.setColumn(iLoop, "EXCH_RT", "1");
						}else if( sMa02Cd =="V"){
							//외화금액
							this.ds_Detail10.setColumn(iLoop, "FRDB_AM", "0");
							this.ds_Detail10.setColumn(iLoop, "FRCR_AM", "0");
						}
						
					}else{
					
						//trace("sMa02Cd = " + sMa02Cd);
						if( sMa02Cd =="X" ){
							//통화
							this.ds_Detail10.setColumn(iLoop, "CURR_CD", this.ds_Detail10.getColumn(iLoop, "DE02_CD"));
						}else if(sMa02Cd =="Y"){
							//환율
							this.ds_Detail10.setColumn(iLoop, "EXCH_RT", this.ds_Detail10.getColumn(iLoop, "DE02_NM"));
						}else if(sMa02Cd =="V"){
							//외화금액
							//trace("DE02_NM = " +  this.ds_Detail10.getColumn(iLoop, "DE02_NM"));
							if(this.ds_Detail10.getColumn(iLoop, "DECR_GU") == "D"){
								this.ds_Detail10.setColumn(iLoop, "FRDB_AM", this.ds_Detail10.getColumn(iLoop, "DE02_NM"));
							}else{
								this.ds_Detail10.setColumn(iLoop, "FRCR_AM", this.ds_Detail10.getColumn(iLoop, "DE02_NM"));
							}
						}
					}
					
					sItemGu = this.ds_ItemList.getColumn(sItemRow, "ITEM_GU");
					//trace("sItemGu 02 " + sItemGu);
					
					//관리항목이 combo, popup 이 아닌경우 dexx_cd, vdexx_cd  값은 지운다.
					if(sItemGu !="0020" && sItemGu !="0080" && sItemGu !="0090"){
						
						this.ds_Detail10.setColumn(iLoop, "DE02_CD", "");
						this.ds_Detail10.setColumn(iLoop, "VDE02_CD", "");
						
						this.ds_CmMaInfo.setColumn(0, "DE02_CD", "");
						this.ds_CmMaInfo.setColumn(0, "VDE02_CD", "");
					}
				}
			}		
			//관리항목 3
			if(!this.gfn_IsNull(sMa03Cd) && sMa03Cd !="" && sMa03Cd != "*"){ 
				sItemRow = this.ds_ItemList.findRowExpr("COMM_CD == '"+sCommCD+"' && ITEM_CD == '"+ sMa03Cd +"'");
				//trace("관리항목 3 -"+iLoop+" sMa03Cd = "+sMa03Cd+ "  sItemRow = " + sItemRow);			
				if(sItemRow > -1){
					sCopyYn = this.ds_ItemList.getColumn(sItemRow, "COPY_YN");
					//trace("관리항목 3 -"+iLoop+"sCopyYn = " + sCopyYn);
					if(sCopyYn == "0" || this.gfn_IsNull(sCopyYn)){
						//trace("관리항목 3 -"+iLoop+"sCopyYn = " + sCopyYn);
						this.ds_Detail10.setColumn(iLoop, "DE03_CD", "");
						this.ds_Detail10.setColumn(iLoop, "DE03_NM", "");
						this.ds_Detail10.setColumn(iLoop, "VDE03_CD", "");
						this.ds_Detail10.setColumn(iLoop, "VDE03_NM", "");
						
						this.ds_CmMaInfo.setColumn(0, "DE03_CD", "");
						this.ds_CmMaInfo.setColumn(0, "DE03_NM", "");
						this.ds_CmMaInfo.setColumn(0, "VDE03_CD", "");
						this.ds_CmMaInfo.setColumn(0, "VDE03_NM", "");
						
						if( sMa03Cd == "X" ){
							//통화
							this.ds_Detail10.setColumn(iLoop, "CURR_CD", "0090");
						}else if( sMa03Cd =="Y"){
							//환율 
							this.ds_Detail10.setColumn(iLoop, "EXCH_RT", "1");
						}else if( sMa03Cd =="V"){
							//외화금액
							this.ds_Detail10.setColumn(iLoop, "FRDB_AM", "0");
							this.ds_Detail10.setColumn(iLoop, "FRCR_AM", "0");
						}
					}else{
					
						//trace("sMa03Cd = " + sMa03Cd);
						if( sMa03Cd =="X" ){
							//통화
							//trace("DE03_CD = " +  this.ds_Detail10.getColumn(iLoop, "DE03_CD"));
							this.ds_Detail10.setColumn(iLoop, "CURR_CD", this.ds_Detail10.getColumn(iLoop, "DE03_CD"));
						}else if(sMa03Cd =="Y"){
							//환율
							this.ds_Detail10.setColumn(iLoop, "EXCH_RT", this.ds_Detail10.getColumn(iLoop, "DE03_NM"));
						}else if(sMa03Cd =="V"){
							//외화금액
							if(this.ds_Detail10.getColumn(iLoop, "DECR_GU") == "D"){
								this.ds_Detail10.setColumn(iLoop, "FRDB_AM", this.ds_Detail10.getColumn(iLoop, "DE03_NM"));
							}else{
								this.ds_Detail10.setColumn(iLoop, "FRCR_AM", this.ds_Detail10.getColumn(iLoop, "DE03_NM"));
							}
						}
					}
					
					sItemGu = this.ds_ItemList.getColumn(sItemRow, "ITEM_GU");
					//trace("sItemGu 03 " + sItemGu);
					
					//관리항목이 combo, popup 이 아닌경우 dexx_cd, vdexx_cd  값은 지운다.
					if(sItemGu !="0020" && sItemGu !="0080" && sItemGu !="0090"){
						
						this.ds_Detail10.setColumn(iLoop, "DE03_CD", "");
						this.ds_Detail10.setColumn(iLoop, "VDE03_CD", "");
						
						this.ds_CmMaInfo.setColumn(0, "DE03_CD", "");
						this.ds_CmMaInfo.setColumn(0, "VDE03_CD", "");
					}
				}
			}	
			//관리항목 4
			if(!this.gfn_IsNull(sMa04Cd) && sMa04Cd !="" && sMa04Cd != "*"){ 
				sItemRow = this.ds_ItemList.findRowExpr("COMM_CD == '"+sCommCD+"' && ITEM_CD == '"+ sMa04Cd +"'");	
				//trace("관리항목 4 -"+iLoop+" sMa04Cd = "+sMa04Cd+ "  sItemRow = " + sItemRow);
				if(sItemRow > -1){
					sCopyYn = this.ds_ItemList.getColumn(sItemRow, "COPY_YN");
					//trace("관리항목 4 -"+iLoop+"sCopyYn = " + sCopyYn);
					if(sCopyYn == "0" || this.gfn_IsNull(sCopyYn)){
						//trace("관리항목 4 -"+iLoop+"sCopyYn = " + sCopyYn);
						this.ds_Detail10.setColumn(iLoop, "DE04_CD", "");
						this.ds_Detail10.setColumn(iLoop, "DE04_NM", "");
						this.ds_Detail10.setColumn(iLoop, "VDE04_CD", "");
						this.ds_Detail10.setColumn(iLoop, "VDE04_NM", "");
						
						this.ds_CmMaInfo.setColumn(0, "DE04_CD", "");
						this.ds_CmMaInfo.setColumn(0, "DE04_NM", "");
						this.ds_CmMaInfo.setColumn(0, "VDE04_CD", "");
						this.ds_CmMaInfo.setColumn(0, "VDE04_NM", "");
					
						
						if( sMa04Cd == "X" ){
							//통화
							this.ds_Detail10.setColumn(iLoop, "CURR_CD", "0090");
						}else if( sMa04Cd =="Y"){
							//환율 
							this.ds_Detail10.setColumn(iLoop, "EXCH_RT", "1");
						}else if( sMa04Cd =="V"){
							//외화금액
							this.ds_Detail10.setColumn(iLoop, "FRDB_AM", "0");
							this.ds_Detail10.setColumn(iLoop, "FRCR_AM", "0");
						}
					}else{
					
						//trace("sMa04Cd = " + sMa04Cd);
						if( sMa04Cd =="X" ){
							//통화
							this.ds_Detail10.setColumn(iLoop, "CURR_CD", this.ds_Detail10.getColumn(iLoop, "DE04_CD"));
						}else if(sMa04Cd =="Y"){
							//환율
							//trace("DE04_NM = " +  this.ds_Detail10.getColumn(iLoop, "DE04_NM"));
							this.ds_Detail10.setColumn(iLoop, "EXCH_RT", this.ds_Detail10.getColumn(iLoop, "DE04_NM"));
						}else if(sMa04Cd =="V"){
							//외화금액
							if(this.ds_Detail10.getColumn(iLoop, "DECR_GU") == "D"){
								this.ds_Detail10.setColumn(iLoop, "FRDB_AM", this.ds_Detail10.getColumn(iLoop, "DE04_NM"));
							}else{
								this.ds_Detail10.setColumn(iLoop, "FRCR_AM", this.ds_Detail10.getColumn(iLoop, "DE04_NM"));
							}
						}
					}
					
					sItemGu = this.ds_ItemList.getColumn(sItemRow, "ITEM_GU");
					//trace("sItemGu 04 " + sItemGu);
					
					//관리항목이 combo, popup 이 아닌경우 dexx_cd, vdexx_cd  값은 지운다.
					if(sItemGu !="0020" && sItemGu !="0080" && sItemGu !="0090"){
						
						this.ds_Detail10.setColumn(iLoop, "DE04_CD", "");
						this.ds_Detail10.setColumn(iLoop, "VDE04_CD", "");
						
						this.ds_CmMaInfo.setColumn(0, "DE04_CD", "");
						this.ds_CmMaInfo.setColumn(0, "VDE04_CD", "");
					}
				}
			}
			//관리항목 5
			if(!this.gfn_IsNull(sMa05Cd) && sMa05Cd !="" && sMa05Cd != "*"){ 
				sItemRow = this.ds_ItemList.findRowExpr("COMM_CD == '"+sCommCD+"' && ITEM_CD == '"+ sMa05Cd +"'");
				//trace("관리항목 5 -"+iLoop+" sMa05Cd = "+sMa05Cd+ "  sItemRow = " + sItemRow);
				if(sItemRow > -1){
					sCopyYn = this.ds_ItemList.getColumn(sItemRow, "COPY_YN");
					//trace("관리항목 5-"+iLoop+" sCopyYn = " + sCopyYn);
					if(sCopyYn == "0" || this.gfn_IsNull(sCopyYn)){
						//trace("관리항목 5 -"+iLoop+"sCopyYn = " + sCopyYn);
						this.ds_Detail10.setColumn(iLoop, "DE05_CD", "");
						this.ds_Detail10.setColumn(iLoop, "DE05_NM", "");
						this.ds_Detail10.setColumn(iLoop, "VDE05_CD", "");
						this.ds_Detail10.setColumn(iLoop, "VDE05_NM", "");
						
						this.ds_CmMaInfo.setColumn(0, "DE05_CD", "");
						this.ds_CmMaInfo.setColumn(0, "DE05_NM", "");
						this.ds_CmMaInfo.setColumn(0, "VDE05_CD", "");
						this.ds_CmMaInfo.setColumn(0, "VDE05_NM", "");
					
						
						
						if( sMa05Cd == "X" ){
							//통화
							this.ds_Detail10.setColumn(iLoop, "CURR_CD", "0090");
						}else if( sMa05Cd =="Y"){
							//환율 
							this.ds_Detail10.setColumn(iLoop, "EXCH_RT", "1");
						}else if( sMa05Cd =="V"){
							//외화금액
							this.ds_Detail10.setColumn(iLoop, "FRDB_AM", "0");
							this.ds_Detail10.setColumn(iLoop, "FRCR_AM", "0");
						}
					}else{
					
						if( sMa05Cd =="X" ){
							//통화
							this.ds_Detail10.setColumn(iLoop, "CURR_CD", this.ds_Detail10.getColumn(iLoop, "DE05_CD"));
						}else if(sMa05Cd =="Y"){
							//환율
							this.ds_Detail10.setColumn(iLoop, "EXCH_RT", this.ds_Detail10.getColumn(iLoop, "DE05_NM"));
						}else if(sMa05Cd =="V"){
							//외화금액
							if(this.ds_Detail10.getColumn(iLoop, "DECR_GU") == "D"){
								this.ds_Detail10.setColumn(iLoop, "FRDB_AM", this.ds_Detail10.getColumn(iLoop, "DE05_NM"));
							}else{
								this.ds_Detail10.setColumn(iLoop, "FRCR_AM", this.ds_Detail10.getColumn(iLoop, "DE05_NM"));
							}
						}
					}
					
					sItemGu = this.ds_ItemList.getColumn(sItemRow, "ITEM_GU");
					//trace("sItemGu 05 " + sItemGu);
					
					//관리항목이 combo, popup 이 아닌경우 dexx_cd, vdexx_cd  값은 지운다.
					if(sItemGu !="0020" && sItemGu !="0080" && sItemGu !="0090"){
						
						this.ds_Detail10.setColumn(iLoop, "DE05_CD", "");
						this.ds_Detail10.setColumn(iLoop, "VDE05_CD", "");
						
						this.ds_CmMaInfo.setColumn(0, "DE05_CD", "");
						this.ds_CmMaInfo.setColumn(0, "VDE05_CD", "");
					}
				}
			}
			//관리항목 6
			if(!this.gfn_IsNull(sMa06Cd) && sMa06Cd !="" && sMa06Cd != "*"){ 
				sItemRow = this.ds_ItemList.findRowExpr("COMM_CD == '"+sCommCD+"' && ITEM_CD == '"+ sMa06Cd +"'");		
				//trace("관리항목 6 -"+iLoop+" sMa06Cd = "+sMa06Cd+ "  sItemRow = " + sItemRow);
				if(sItemRow > -1){
					sCopyYn = this.ds_ItemList.getColumn(sItemRow, "COPY_YN");
					//trace("관리항목 6-"+iLoop+" sCopyYn = " + sCopyYn);
					if(sCopyYn == "0" || this.gfn_IsNull(sCopyYn)){
						//trace("관리항목 6 -"+iLoop+"sCopyYn = " + sCopyYn);
						this.ds_Detail10.setColumn(iLoop, "DE06_CD", "");
						this.ds_Detail10.setColumn(iLoop, "DE06_NM", "");
						this.ds_Detail10.setColumn(iLoop, "VDE06_CD", "");
						this.ds_Detail10.setColumn(iLoop, "VDE06_NM", "");
						
						this.ds_CmMaInfo.setColumn(0, "DE06_CD", "");
						this.ds_CmMaInfo.setColumn(0, "DE06_NM", "");
						this.ds_CmMaInfo.setColumn(0, "VDE06_CD", "");
						this.ds_CmMaInfo.setColumn(0, "VDE06_NM", "");
					
						if( sMa06Cd == "X" ){
							//통화
							this.ds_Detail10.setColumn(iLoop, "CURR_CD", "0090");
						}else if( sMa06Cd =="Y"){
							//환율 
							this.ds_Detail10.setColumn(iLoop, "EXCH_RT", "1");
						}else if( sMa06Cd =="V"){
							//외화금액
							this.ds_Detail10.setColumn(iLoop, "FRDB_AM", "0");
							this.ds_Detail10.setColumn(iLoop, "FRCR_AM", "0");
						}
					}else{
					
						if( sMa06Cd =="X" ){
							//통화
							this.ds_Detail10.setColumn(iLoop, "CURR_CD", this.ds_Detail10.getColumn(iLoop, "DE06_CD"));
						}else if(sMa06Cd =="Y"){
							//환율
							this.ds_Detail10.setColumn(iLoop, "EXCH_RT", this.ds_Detail10.getColumn(iLoop, "DE06_NM"));
						}else if(sMa06Cd =="V"){
							//외화금액
							if(this.ds_Detail10.getColumn(iLoop, "DECR_GU") == "D"){
								this.ds_Detail10.setColumn(iLoop, "FRDB_AM", this.ds_Detail10.getColumn(iLoop, "DE06_NM"));
							}else{
								this.ds_Detail10.setColumn(iLoop, "FRCR_AM", this.ds_Detail10.getColumn(iLoop, "DE06_NM"));
							}
						}
					}
					
					sItemGu = this.ds_ItemList.getColumn(sItemRow, "ITEM_GU");
					//trace("sItemGu 06 " + sItemGu);
					
					//관리항목이 combo, popup 이 아닌경우 dexx_cd, vdexx_cd  값은 지운다.
					if(sItemGu !="0020" && sItemGu !="0080" && sItemGu !="0090"){
						
						this.ds_Detail10.setColumn(iLoop, "DE06_CD", "");
						this.ds_Detail10.setColumn(iLoop, "VDE06_CD", "");
						
						this.ds_CmMaInfo.setColumn(0, "DE06_CD", "");
						this.ds_CmMaInfo.setColumn(0, "VDE06_CD", "");
					}
				}
			}
			//관리항목 7
			if(!this.gfn_IsNull(sMa07Cd) && sMa07Cd !="" && sMa07Cd != "*"){ 
				sItemRow = this.ds_ItemList.findRowExpr("COMM_CD == '"+sCommCD+"' && ITEM_CD == '"+ sMa07Cd +"'");	
				//trace("관리항목 7 -"+iLoop+" sMa07Cd = "+sMa07Cd+ "  sItemRow = " + sItemRow);
				if(sItemRow > -1){
					sCopyYn = this.ds_ItemList.getColumn(sItemRow, "COPY_YN");
					//trace("관리항목 7-"+iLoop+" sCopyYn = " + sCopyYn);
					if(sCopyYn == "0" || this.gfn_IsNull(sCopyYn)){
						//trace("관리항목 7 -"+iLoop+"sCopyYn = " + sCopyYn);
						this.ds_Detail10.setColumn(iLoop, "DE07_CD", "");
						this.ds_Detail10.setColumn(iLoop, "DE07_NM", "");
						this.ds_Detail10.setColumn(iLoop, "VDE07_CD", "");
						this.ds_Detail10.setColumn(iLoop, "VDE07_NM", "");
						
						this.ds_CmMaInfo.setColumn(0, "DE07_CD", "");
						this.ds_CmMaInfo.setColumn(0, "DE07_NM", "");
						this.ds_CmMaInfo.setColumn(0, "VDE07_CD", "");
						this.ds_CmMaInfo.setColumn(0, "VDE07_NM", "");
						
						if( sMa07Cd == "X" ){
							//통화
							this.ds_Detail10.setColumn(iLoop, "CURR_CD", "0090");
						}else if( sMa07Cd =="Y"){
							//환율 
							this.ds_Detail10.setColumn(iLoop, "EXCH_RT", "1");
						}else if( sMa07Cd =="V"){
							//외화금액
							this.ds_Detail10.setColumn(iLoop, "FRDB_AM", "0");
							this.ds_Detail10.setColumn(iLoop, "FRCR_AM", "0");
						}
					}else{
					
						if( sMa07Cd =="X" ){
							//통화
							this.ds_Detail10.setColumn(iLoop, "CURR_CD", this.ds_Detail10.getColumn(iLoop, "DE07_CD"));
						}else if(sMa07Cd =="Y"){
							//환율
							this.ds_Detail10.setColumn(iLoop, "EXCH_RT", this.ds_Detail10.getColumn(iLoop, "DE07_NM"));
						}else if(sMa07Cd =="V"){
							//외화금액
							if(this.ds_Detail10.getColumn(iLoop, "DECR_GU") == "D"){
								this.ds_Detail10.setColumn(iLoop, "FRDB_AM", this.ds_Detail10.getColumn(iLoop, "DE07_NM"));
							}else{
								this.ds_Detail10.setColumn(iLoop, "FRCR_AM", this.ds_Detail10.getColumn(iLoop, "DE07_NM"));
							}
						}
					} 
					
					sItemGu = this.ds_ItemList.getColumn(sItemRow, "ITEM_GU");
					//trace("sItemGu 07 " + sItemGu);
					
					//관리항목이 combo, popup 이 아닌경우 dexx_cd, vdexx_cd  값은 지운다.
					if(sItemGu !="0020" && sItemGu !="0080" && sItemGu !="0090"){
						
						this.ds_Detail10.setColumn(iLoop, "DE07_CD", "");
						this.ds_Detail10.setColumn(iLoop, "VDE07_CD", "");
						
						this.ds_CmMaInfo.setColumn(0, "DE07_CD", "");
						this.ds_CmMaInfo.setColumn(0, "VDE07_CD", "");
					}
				}
			}
			//관리항목 8
			if(!this.gfn_IsNull(sMa08Cd) && sMa08Cd !="" && sMa08Cd != "*"){ 
				sItemRow = this.ds_ItemList.findRowExpr("COMM_CD == '"+sCommCD+"' && ITEM_CD == '"+ sMa08Cd +"'");	
				//trace("관리항목 8 -"+iLoop+" sMa08Cd = "+sMa08Cd+ "  sItemRow = " + sItemRow);	
				if(sItemRow > -1){
					sCopyYn = this.ds_ItemList.getColumn(sItemRow, "COPY_YN");
					//trace("관리항목 8-"+iLoop+" sCopyYn = " + sCopyYn);
					if(sCopyYn == "0" || this.gfn_IsNull(sCopyYn)){
						//trace("관리항목 8 -"+iLoop+"sCopyYn = " + sCopyYn);
						this.ds_Detail10.setColumn(iLoop, "DE08_CD", "");
						this.ds_Detail10.setColumn(iLoop, "DE08_NM", "");
						this.ds_Detail10.setColumn(iLoop, "VDE08_CD", "");
						this.ds_Detail10.setColumn(iLoop, "VDE08_NM", "");
						
						this.ds_CmMaInfo.setColumn(0, "DE08_CD", "");
						this.ds_CmMaInfo.setColumn(0, "DE08_NM", "");
						this.ds_CmMaInfo.setColumn(0, "VDE08_CD", "");
						this.ds_CmMaInfo.setColumn(0, "VDE08_NM", "");
					
						
						if( sMa08Cd == "X" ){
							//통화
							this.ds_Detail10.setColumn(iLoop, "CURR_CD", "0090");
						}else if( sMa08Cd =="Y"){
							//환율 
							this.ds_Detail10.setColumn(iLoop, "EXCH_RT", "1");
						}else if( sMa08Cd =="V"){
							//외화금액
							this.ds_Detail10.setColumn(iLoop, "FRDB_AM", "0");
							this.ds_Detail10.setColumn(iLoop, "FRCR_AM", "0");
						}
						
						
					}else{
					
						if( sMa08Cd =="X" ){
							//통화
							this.ds_Detail10.setColumn(iLoop, "CURR_CD", this.ds_Detail10.getColumn(iLoop, "DE08_CD"));
						}else if(sMa08Cd =="Y"){
							//환율
							this.ds_Detail10.setColumn(iLoop, "EXCH_RT", this.ds_Detail10.getColumn(iLoop, "DE08_NM"));
						}else if(sMa08Cd =="V"){
							//외화금액
							if(this.ds_Detail10.getColumn(iLoop, "DECR_GU") == "D"){
								this.ds_Detail10.setColumn(iLoop, "FRDB_AM", this.ds_Detail10.getColumn(iLoop, "DE08_NM"));
							}else{
								this.ds_Detail10.setColumn(iLoop, "FRCR_AM", this.ds_Detail10.getColumn(iLoop, "DE08_NM"));
							}
						}
					}
					
					sItemGu = this.ds_ItemList.getColumn(sItemRow, "ITEM_GU");
					//trace("sItemGu 08 " + sItemGu);
					
					//관리항목이 combo, popup 이 아닌경우 dexx_cd, vdexx_cd  값은 지운다.
					if(sItemGu !="0020" && sItemGu !="0080" && sItemGu !="0090"){
						
						this.ds_Detail10.setColumn(iLoop, "DE08_CD", "");
						this.ds_Detail10.setColumn(iLoop, "VDE08_CD", "");
						
						this.ds_CmMaInfo.setColumn(0, "DE08_CD", "");
						this.ds_CmMaInfo.setColumn(0, "VDE08_CD", "");
					}
				}
			}
		//}

};


/***********************************************************************************************
 * 15.27. 관리항목 자동입력
  1. 부가세금액
 ***********************************************************************************************/ 
this.fn_maAutoInput  = function(row, chgCol)
{
	var nRow = -1;
	var maNum = "";
	var deCrGu = "";
	var deCrGuChk = "";
	var vatAm = 0;
	
	
	// 차대변금액 변경시
	if(chgCol =="DEBI_AM" || chgCol=="CRED_AM"){
		
		//부가세금액
		deCrGu = this.ds_Detail10.getColumn(row, "DECR_GU");
		deCrGuChk = this.ds_Detail10.getColumn(row, "DECR_GU_CHK");
		if(deCrGu == deCrGuChk){
		
			var nRow = this.ds_AcomMa.findRowExpr("MA_CD=='C3'");
			if(nRow > -1){
				maNum = this.ds_AcomMa.getColumn(nRow, "MA_NUM");
				
				if(chgCol == "DEBI_AM"){
					vatAm = this.ds_Detail10.getColumn(row, "DEBI_AM");
				}else{
					vatAm = this.ds_Detail10.getColumn(row, "CRED_AM");
				}
				
				//trace("vatAm===" + vatAm);
				
				if(this.gfn_IsNull(vatAm)){
					vatAm = 0;
				}
				
				this.ds_CmMaInfo.setColumn(0, "DE"+maNum+"_NM", vatAm);
				this.ds_Detail10.setColumn(row, "DE"+maNum+"_NM", vatAm);
				this.ds_CmMaInfo.setColumn(0, "VDE"+maNum+"_NM", vatAm);
				this.ds_Detail10.setColumn(row, "VDE"+maNum+"_NM", vatAm);
			}
			
		}
	}
}

/***********************************************************************************************
 * 15.31. 예산부서변경
 ***********************************************************************************************/ 
this.fn_budpChange  = function(depmCd, depmNm)
{
		for (var iLoop=0; iLoop<this.ds_Detail10.getRowCount(); iLoop++) {
			this.ds_Detail10.set_rowposition(iLoop);
			this.ds_Detail10.setColumn(iLoop, "BUDP_CD", depmCd);
			this.ds_Detail10.setColumn(iLoop, "BUDP_NM", depmNm);
		}
		this.ds_Detail10.set_rowposition(0);
}

/***********************************************************************************************
 * 15.31. 예산월변경
 ***********************************************************************************************/ 
this.fn_budbMmChange  = function(budgMm)
{
		for (var iLoop=0; iLoop<this.ds_Detail10.getRowCount(); iLoop++) {
			this.ds_Detail10.set_rowposition(iLoop);
			this.ds_Detail10.setColumn(iLoop, "BUDG_MM", budgMm);
		}
		this.ds_Detail10.set_rowposition(0);
}


]]></Script>
    <Bind>
      <BindItem id="item0" compid="div_detailRight.form.edt_TemhNo00_00" propid="value" datasetid="ds_Master10" columnid="TEMH_NO"/>
      <BindItem id="item1" compid="div_detailRight.form.edt_TemhNo00_01" propid="value" datasetid="ds_Master10" columnid="TEMH_NO"/>
      <BindItem id="item2" compid="div_detailRight.form.edt_TemhNo00_01_00" propid="value" datasetid="ds_Master10" columnid="TEMH_NO"/>
      <BindItem id="item3" compid="div_detailRight.form.edt_TemhNo00_01_01" propid="value" datasetid="ds_Master10" columnid="TEMH_NO"/>
      <BindItem id="item4" compid="div_detailRight.form.edt_TemhNo00_01_02" propid="value" datasetid="ds_Master10" columnid="TEMH_NO"/>
      <BindItem id="item5" compid="div_detailRight.form.edt_TemhNo00_01_03" propid="value" datasetid="ds_Master10" columnid="TEMH_NO"/>
      <BindItem id="item8" compid="div_detailRight.form.div_Budget.form.edt_BudgetAcomCd" propid="value" datasetid="ds_Detail10" columnid="ACOM_NM"/>
      <BindItem id="item9" compid="div_detailRight.form.div_Budget.form.mae_RecAm" propid="value" datasetid="ds_Detail11" columnid="BGSU_AM"/>
      <BindItem id="item10" compid="div_detailRight.form.div_Budget.form.mae_AvailAm" propid="value" datasetid="ds_Master10" columnid=""/>
      <BindItem id="item11" compid="div_detailRight.form.div_Budget.form.mae_UsedAm" propid="value" datasetid="ds_Master10" columnid=""/>
    </Bind>
  </Form>
</FDL>
