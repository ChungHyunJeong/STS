<?xml version="1.0" encoding="utf-8"?>
<FDL version="2.1">
  <Form id="M_MM_5110" width="1442" height="695" titletext="품목/파트너사별입고현황" onload="fn_FormOnload" onclose="fn_FormClose">
    <Layouts>
      <Layout height="695" width="1442">
        <Div id="div_Search" taborder="0" left="14" top="12" height="66" cssclass="div_WF_Search" formscrollbartype="none none" right="14" text="">
          <Layouts>
            <Layout>
              <Static id="Static00" taborder="0" text="입고년월" left="16" top="6" width="80" height="24" cssclass="sta_WF_SLabel" DomainID="S00002"/>
              <Div id="div_ComGridSearch" taborder="1" top="34" height="30" width="328" url="cmm::cmmGridSearch.xfdl" async="false" left="1096"/>
              <Static id="Static01" taborder="2" text="계약번호" left="376" top="6" width="80" height="24" cssclass="sta_WF_SLabel"/>
              <MaskEdit id="mae_CnthNo" taborder="3" left="456" top="6" width="90" height="24" type="string" format="@@@@@@@@@" trimtype="both" onchanged="div_Search_mae_CnthNo_onchanged" onkillfocus="div_Search_mae_CnthNo_onkillfocus" onsetfocus="div_Search_mae_CnthNo_onsetfocus"/>
              <Edit id="edt_CnthNm" taborder="4" left="548" top="6" width="130" height="24" enable="false" tabstop="true"/>
              <Button id="btn_CnthNo" taborder="5" left="680" top="6" width="24" height="24" cssclass="btn_WF_SmallSearch" tabstop="false" onclick="div_Search_btn_CnthNo_onclick" cursor="pointer"/>
              <Static id="sta_CustCd" taborder="6" text="파트너사" left="736" top="6" width="80" height="24" cssclass="sta_WF_SLabel"/>
              <Edit id="edt_CusmCd" taborder="7" left="815" top="6" width="90" height="24" onchanged="div_Search_edt_CusmCd_onchanged" inputtype="digit,alpha" inputmode="upper" maxlength="10"/>
              <Edit id="edt_CusmNm" taborder="8" left="907" top="6" width="130" height="24" enable="true" onchanged="div_Search_edt_CusmNm_onchanged" maxlength="30"/>
              <Button id="btn_CusmCd" taborder="9" left="1039" top="6" width="24" height="24" cssclass="btn_WF_SmallSearch" tabstop="false" onclick="div_Search_btn_CusmCd_onclick" text="" cursor="pointer"/>
              <Static id="sta_Itlm" taborder="10" text="대분류" left="16" top="34" width="80" height="24" cssclass="sta_WF_SLabel"/>
              <Combo id="cbo_ItlmCd" taborder="11" left="96" top="34" height="24" codecolumn="CODM_CD" datacolumn="CODM_NM" width="248" onitemchanged="div_Search_cbo_ItlmCd_onitemchanged" text=""/>
              <Static id="sta_Itmm" taborder="12" text="중분류" left="376" top="34" width="80" height="24" cssclass="sta_WF_SLabel" visible="true"/>
              <Combo id="cbo_ItmmCd" taborder="13" left="456" top="34" height="24" codecolumn="CODM_CD" datacolumn="CODM_NM" width="248" visible="true" onitemchanged="div_Search_cbo_ItmmCd_onitemchanged"/>
              <Static id="sta_ItemCd" taborder="14" text="품목코드" left="736" top="34" width="80" height="24" cssclass="sta_WF_SLabel"/>
              <Edit id="edt_ItemCd" taborder="15" left="815" top="34" width="90" height="24" onchanged="div_Search_edt_ItemCd_onchanged" maxlength="30"/>
              <Edit id="edt_ItemNm" taborder="16" left="907" top="34" width="130" height="24" enable="true" maxlength="30"/>
              <Button id="btn_ItemCd" taborder="17" left="1039" top="34" width="24" height="24" cssclass="btn_WF_SmallSearch" tabstop="false" onclick="div_Search_btn_ItemCd_onclick" cursor="pointer"/>
              <Calendar id="cal_FromDd" taborder="18" left="96" top="6" width="110" height="24" dateformat="yyyy-MM" cssclass="essential" editformat="yyyy-MM" popuptype="none" ondropdown="div_Search_cal_FromDd_ondropdown"/>
              <Static id="Static03" taborder="19" text="~" left="211" top="5" width="20" height="26" cssclass="sta_WF_Dash"/>
              <Calendar id="cal_ClosDd" taborder="20" left="234" top="6" width="110" height="24" dateformat="yyyy-MM" cssclass="essential" editformat="yyyy-MM" ondropdown="div_Search_cal_ClosDd_ondropdown" popuptype="none"/>
            </Layout>
          </Layouts>
        </Div>
        <Div id="div_MasterView" taborder="1" left="14" top="90" right="14" bottom="5">
          <Layouts>
            <Layout>
              <Tab id="tab_Master" taborder="0" tabindex="0" left="0" top="0" bottom="0" cssclass="tab_WF_MasterList" right="0" onchanged="div_MasterView_tab_Master_onchanged">
                <Tabpages>
                  <Tabpage id="tpg_01" text="품목코드별" enable="true">
                    <Layouts>
                      <Layout>
                        <Grid id="grd_Master10" taborder="0" left="0" top="2" autofittype="none" right="0" bottom="0" cellsizingtype="col" autoenter="select" binddataset="ds_Master11" oncellclick="div_MasterView_tab_Master_tpg_01_grd_Master10_oncellclick" selecttype="multiarea">
                          <Formats>
                            <Format id="default">
                              <Columns>
                                <Column size="35" band="left"/>
                                <Column size="80"/>
                                <Column size="100"/>
                                <Column size="100"/>
                                <Column size="90"/>
                                <Column size="250"/>
                                <Column size="140"/>
                                <Column size="120"/>
                                <Column size="50"/>
                                <Column size="80"/>
                                <Column size="100"/>
                                <Column size="100"/>
                              </Columns>
                              <Rows>
                                <Row size="24" band="head"/>
                                <Row size="26" band="head"/>
                                <Row size="24"/>
                                <Row size="24" band="summ"/>
                              </Rows>
                              <Band id="head">
                                <Cell rowspan="2" text="No."/>
                                <Cell col="1" rowspan="2" text="상세보기"/>
                                <Cell col="2" colspan="7" text="품목정보"/>
                                <Cell col="9" colspan="3" text="입고합계"/>
                                <Cell row="1" col="2" text="대분류"/>
                                <Cell row="1" col="3" text="중분류"/>
                                <Cell row="1" col="4" text="품목코드"/>
                                <Cell row="1" col="5" text="품목명"/>
                                <Cell row="1" col="6" text="규격"/>
                                <Cell row="1" col="7" text="Maker"/>
                                <Cell row="1" col="8" text="단위"/>
                                <Cell row="1" col="9" text="입고수량"/>
                                <Cell row="1" col="10" text="입고금액"/>
                                <Cell row="1" col="11" text="평균단가"/>
                              </Band>
                              <Band id="body">
                                <Cell expr="currow + 1" textAlign="center"/>
                                <Cell col="1" textAlign="center" displaytype="buttoncontrol" text="상세보기"/>
                                <Cell col="2" text="bind:ITLM_NM" textAlign="left" displaytype="normal"/>
                                <Cell col="3" text="bind:ITMM_NM" textAlign="left" displaytype="normal"/>
                                <Cell col="4" displaytype="normal" textAlign="center" text="bind:ITEM_CD"/>
                                <Cell col="5" displaytype="normal" textAlign="left" text="bind:ITEM_NM"/>
                                <Cell col="6" displaytype="normal" textAlign="left" text="bind:SPEC_NM"/>
                                <Cell col="7" text="bind:NATM_CD" textAlign="center"/>
                                <Cell col="8" displaytype="normal" textAlign="center" text="bind:UNIT_CD"/>
                                <Cell col="9" maskeditformat="###,###,###,##0.00" textAlign="right" displaytype="mask" text="bind:PCWB_QT_SUM"/>
                                <Cell col="10" maskeditformat="###,###,###,##0" textAlign="right" displaytype="mask" text="bind:WONE_AM_SUM"/>
                                <Cell col="11" displaytype="mask" textAlign="right" maskeditformat="###,###,###,##0"/>
                              </Band>
                              <Band id="summary">
                                <Cell/>
                                <Cell col="1" text="합계" textAlign="center"/>
                                <Cell col="2"/>
                                <Cell col="3"/>
                                <Cell col="4"/>
                                <Cell col="5"/>
                                <Cell col="6" textAlign="center"/>
                                <Cell col="7"/>
                                <Cell col="8"/>
                                <Cell col="9" maskeditformat="###,###,###,##0.00" displaytype="mask" expr="dataset.getSum(&quot;PCWB_QT_SUM&quot;)"/>
                                <Cell col="10" expr="dataset.getSum(&quot;WONE_AM_SUM&quot;)"/>
                                <Cell col="11"/>
                              </Band>
                            </Format>
                          </Formats>
                        </Grid>
                      </Layout>
                    </Layouts>
                  </Tabpage>
                  <Tabpage id="tpg_02" text="파트너사별">
                    <Layouts>
                      <Layout>
                        <Grid id="grd_Master20" taborder="0" left="0" top="2" autofittype="none" right="0" bottom="0" cellsizingtype="col" autoenter="select" binddataset="ds_Master21" oncellclick="div_MasterView_tab_Master_tpg_02_grd_Master20_oncellclick" selecttype="multiarea">
                          <Formats>
                            <Format id="default">
                              <Columns>
                                <Column size="35" band="left"/>
                                <Column size="80"/>
                                <Column size="80"/>
                                <Column size="150"/>
                                <Column size="90"/>
                                <Column size="80"/>
                                <Column size="100"/>
                              </Columns>
                              <Rows>
                                <Row size="24" band="head"/>
                                <Row size="26" band="head"/>
                                <Row size="24"/>
                                <Row size="24" band="summ"/>
                              </Rows>
                              <Band id="head">
                                <Cell rowspan="2" text="No."/>
                                <Cell col="1" rowspan="2" text="상세보기"/>
                                <Cell col="2" colspan="3" text="파트너사정보"/>
                                <Cell col="5" colspan="2" text="입고합계"/>
                                <Cell row="1" col="2" text="파트너사코드"/>
                                <Cell row="1" col="3" text="파트너사명"/>
                                <Cell row="1" col="4" text="사업자번호"/>
                                <Cell row="1" col="5" text="입고수량"/>
                                <Cell row="1" col="6" text="입고금액"/>
                              </Band>
                              <Band id="body">
                                <Cell expr="currow + 1" textAlign="center"/>
                                <Cell col="1" textAlign="center" displaytype="buttoncontrol" text="상세보기"/>
                                <Cell col="2" text="bind:CUSM_CD" textAlign="center"/>
                                <Cell col="3" text="bind:CUSM_NM"/>
                                <Cell col="4" displaytype="mask" textAlign="center" text="bind:SAUM_NO" maskeditformat="@@@-@@-@@@@@" maskedittype="string"/>
                                <Cell col="5" text="bind:PCWB_QT" maskeditformat="###,###,###,##0" textAlign="right" displaytype="mask"/>
                                <Cell col="6" text="bind:WONE_AM" maskeditformat="###,###,###,##0" textAlign="right" displaytype="mask"/>
                              </Band>
                              <Band id="summary">
                                <Cell/>
                                <Cell col="1" text="합계" textAlign="center"/>
                                <Cell col="2"/>
                                <Cell col="3"/>
                                <Cell col="4"/>
                                <Cell col="5"/>
                                <Cell col="6"/>
                              </Band>
                            </Format>
                          </Formats>
                        </Grid>
                      </Layout>
                    </Layouts>
                  </Tabpage>
                  <Tabpage id="tpg_03" text="입고금액별">
                    <Layouts>
                      <Layout>
                        <Grid id="grd_Master30" taborder="0" left="0" top="2" autofittype="none" right="0" bottom="0" cellsizingtype="col" autoenter="select" binddataset="ds_Master30" selecttype="multiarea" oncellclick="div_MasterView_tab_Master_tpg_03_grd_Master30_oncellclick">
                          <Formats>
                            <Format id="default">
                              <Columns>
                                <Column size="35" band="left"/>
                                <Column size="80"/>
                                <Column size="80"/>
                                <Column size="150"/>
                                <Column size="100"/>
                                <Column size="100"/>
                              </Columns>
                              <Rows>
                                <Row size="24" band="head"/>
                                <Row size="26" band="head"/>
                                <Row size="24"/>
                                <Row size="24" band="summ"/>
                              </Rows>
                              <Band id="head">
                                <Cell rowspan="2" text="No."/>
                                <Cell col="1" rowspan="2" text="상세보기"/>
                                <Cell col="2" colspan="3" text="파트너사정보"/>
                                <Cell col="5" rowspan="2" text="입고금액"/>
                                <Cell row="1" col="2" text="파트너사코드"/>
                                <Cell row="1" col="3" text="파트너사명"/>
                                <Cell row="1" col="4" text="사업자번호"/>
                              </Band>
                              <Band id="body">
                                <Cell expr="currow+1" textAlign="center"/>
                                <Cell col="1" textAlign="center" displaytype="buttoncontrol" text="상세보기"/>
                                <Cell col="2" textAlign="center" text="bind:CUSM_CD"/>
                                <Cell col="3" textAlign="left" text="bind:CUSM_NM"/>
                                <Cell col="4" text="bind:SAUM_NO" textAlign="center" displaytype="mask" maskeditformat="@@@-@@-@@@@@" maskedittype="string"/>
                                <Cell col="5" textAlign="right" displaytype="number" text="bind:WONE_AM" maskeditformat="#,##0.##"/>
                              </Band>
                              <Band id="summary">
                                <Cell/>
                                <Cell col="1"/>
                                <Cell col="2"/>
                                <Cell col="3"/>
                                <Cell col="4"/>
                                <Cell col="5" expr="dataset.getSum(&quot;WONE_AM&quot;)" displaytype="mask" maskeditformat="#,##0.##"/>
                              </Band>
                            </Format>
                          </Formats>
                        </Grid>
                      </Layout>
                    </Layouts>
                  </Tabpage>
                </Tabpages>
              </Tab>
            </Layout>
          </Layouts>
        </Div>
        <Button id="btn_DivMoveMi" taborder="2" top="78" height="10" width="40" visible="true" onclick="btn_DivMoveMi_onclick" cssclass="bt_TF_FoldA" left="700" cursor="pointer"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_Input">
        <ColumnInfo>
          <Column id="FROM_DD" type="STRING" size="256" description="조회시작일자"/>
          <Column id="CLOS_DD" type="STRING" size="256" description="조회종료일자"/>
          <Column id="CNTH_NO" type="STRING" size="256"/>
          <Column id="CUSM_CD" type="STRING" size="256" description="거래처코드"/>
          <Column id="ITLM_CD" type="STRING" size="256"/>
          <Column id="ITMM_CD" type="STRING" size="256"/>
          <Column id="ITEM_CD" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_RdItlmSch">
        <ColumnInfo>
          <Column id="COMM_CD" type="STRING" size="256"/>
          <Column id="ITLM_CD" type="STRING" size="256"/>
          <Column id="ITLM_NM" type="STRING" size="256"/>
          <Column id="BUSM_CD" type="STRING" size="256"/>
          <Column id="PROD_GU" type="STRING" size="256"/>
          <Column id="CDAT_YN" type="STRING" size="256"/>
          <Column id="ITLM_YN" type="STRING" size="256"/>
          <Column id="SORT_NO" type="STRING" size="256"/>
          <Column id="USED_YN" type="STRING" size="256"/>
          <Column id="REMK_NM" type="STRING" size="256"/>
          <Column id="REGI_ID" type="STRING" size="256"/>
          <Column id="REGI_NM" type="STRING" size="256"/>
          <Column id="REGI_DT" type="STRING" size="256"/>
          <Column id="MODI_ID" type="STRING" size="256"/>
          <Column id="MODI_NM" type="STRING" size="256"/>
          <Column id="MODI_DT" type="STRING" size="256"/>
          <Column id="DELE_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_RdItmmSch">
        <ColumnInfo>
          <Column id="COMM_CD" type="STRING" size="256"/>
          <Column id="ITLM_CD" type="STRING" size="256"/>
          <Column id="ITMM_CD" type="STRING" size="256"/>
          <Column id="ITMM_NM" type="STRING" size="256"/>
          <Column id="ACOM_CD" type="STRING" size="256"/>
          <Column id="CDAT_YN" type="STRING" size="256"/>
          <Column id="NMAT_YN" type="STRING" size="256"/>
          <Column id="NMAT_NM" type="STRING" size="256"/>
          <Column id="ITEM_DN" type="STRING" size="256"/>
          <Column id="SORT_NO" type="STRING" size="256"/>
          <Column id="USED_YN" type="STRING" size="256"/>
          <Column id="REMK_NM" type="STRING" size="256"/>
          <Column id="REGI_ID" type="STRING" size="256"/>
          <Column id="REGI_NM" type="STRING" size="256"/>
          <Column id="REGI_DT" type="STRING" size="256"/>
          <Column id="MODI_ID" type="STRING" size="256"/>
          <Column id="MODI_NM" type="STRING" size="256"/>
          <Column id="MODI_DT" type="STRING" size="256"/>
          <Column id="DELE_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_Master20">
        <ColumnInfo>
          <Column id="COMM_CD" type="STRING" size="256"/>
          <Column id="PCWH_DD" type="STRING" size="256"/>
          <Column id="CUSM_CD" type="STRING" size="256"/>
          <Column id="CUSM_NM" type="STRING" size="256"/>
          <Column id="SAUM_NO" type="STRING" size="256"/>
          <Column id="BUYH_DD" type="STRING" size="256"/>
          <Column id="PCWB_QT" type="BIGDECIMAL" size="256"/>
          <Column id="WONE_AM" type="BIGDECIMAL" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_Master10">
        <ColumnInfo>
          <Column id="ITLM_CD" type="STRING" size="256"/>
          <Column id="ITLM_NM" type="STRING" size="256"/>
          <Column id="ITMM_CD" type="STRING" size="256"/>
          <Column id="ITMM_NM" type="STRING" size="256"/>
          <Column id="ITEM_CD" type="STRING" size="256"/>
          <Column id="ITEM_NM" type="STRING" size="256"/>
          <Column id="SPEC_NM" type="STRING" size="256"/>
          <Column id="SP03_CD" type="STRING" size="256"/>
          <Column id="UNIT_CD" type="STRING" size="256"/>
          <Column id="BUYH_DD" type="STRING" size="256"/>
          <Column id="PCWB_QT" type="STRING" size="256"/>
          <Column id="WONE_AM" type="STRING" size="256"/>
          <Column id="WONE_PR" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_Master11">
        <ColumnInfo>
          <Column id="ITLM_CD" type="STRING" size="256"/>
          <Column id="ITLM_NM" type="STRING" size="256"/>
          <Column id="ITMM_CD" type="STRING" size="256"/>
          <Column id="ITMM_NM" type="STRING" size="256"/>
          <Column id="ITEM_CD" type="STRING" size="256"/>
          <Column id="ITEM_NM" type="STRING" size="256"/>
          <Column id="SPEC_NM" type="STRING" size="256"/>
          <Column id="SP03_CD" type="STRING" size="256"/>
          <Column id="UNIT_CD" type="STRING" size="256"/>
          <Column id="PCWB_QT_SUM" type="BIGDECIMAL" size="256"/>
          <Column id="WONE_AM_SUM" type="STRING" size="256"/>
          <Column id="WONE_PR" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_Master21">
        <ColumnInfo>
          <Column id="COMM_CD" type="STRING" size="256"/>
          <Column id="PCWH_DD" type="STRING" size="256"/>
          <Column id="CUSM_CD" type="STRING" size="256"/>
          <Column id="CUSM_NM" type="STRING" size="256"/>
          <Column id="SAUM_NO" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_Master30">
        <ColumnInfo>
          <Column id="COMM_CD" type="STRING" size="256"/>
          <Column id="PCWH_DD" type="STRING" size="256"/>
          <Column id="CUSM_CD" type="STRING" size="256"/>
          <Column id="CUSM_NM" type="STRING" size="256"/>
          <Column id="SAUM_NO" type="STRING" size="256"/>
          <Column id="BUYH_DD" type="STRING" size="256"/>
          <Column id="PCWB_QT" type="BIGDECIMAL" size="256"/>
          <Column id="WONE_AM" type="BIGDECIMAL" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Script type="xscript5.1"><![CDATA[/**
*  @화면ID   : M_MM_5120
*  @화면설명 : 품목_파트너사별입고현황
*  @시스템명 : (MM) 시스템
*  @작성자   : 임재원
*  @작성일   : 2022.02.03
*  @Desction    
******************* 소스 수정 이력 ************************************************************
*  일자          		수정자                비고
*************************************************************************************************
*  2022.02.03     	    임재원 	           최초 생성 
*************************************************************************************************
*/  

/***********************************************************************************************
 * 0. 폼로드
 ***********************************************************************************************/
/***********************************************************************************************
 * 00.01. Form Include 선언
 ***********************************************************************************************/
//include "comLib::CommonUtil.xjs";//공통함수

/***********************************************************************************************
 * 00.02. Form 변수 선언
 ***********************************************************************************************/
//this.fvComPrgmId = "M_MM_5120";//[필수]프로그램ID-화면로드시 메뉴정보 기준으로 재설정됨.
this.fvComPrgmId = "";//[필수]프로그램ID-메인화면기준, 팝업일경우 해당 메인화면의 프로그램ID

/***********************************************************************************************
 * 00.03. Form Onload 이벤트
 ***********************************************************************************************/
this.fn_FormOnload = function (obj:Form, e:LoadEventInfo)
{
	this.fn_FormComInit();//[공통] 화면로드시 초기 설정 함수
	this.fn_FormBizInit();//[업무] 화면로드시 초기 설정 함수 
}

/***********************************************************************************************
 * 00.04. Form [공통] 초기설정 함수 - 필수
 ***********************************************************************************************/
this.fn_FormComInit = function() 
{
	this.gfn_CommFormOnLoad(this);//[공통] 화면로드시 처리 함수(다국어등)
	this.fvComPrgmId = this.gfn_CommLoadFormPrgmId(this);//[필수]프로그램ID-메인화면기준, 팝업일경우 해당 메인화면의 프로그램ID

	this.gfn_SetGrid(this.div_MasterView.form.tab_Master.tpg_01.form.grd_Master10);//[공통]그리드 이벤트 설정 - 품목코드별
	this.gfn_SetGrid(this.div_MasterView.form.tab_Master.tpg_02.form.grd_Master20);//[공통]그리드 이벤트 설정 - 파트너사별
	this.gfn_SetGrid(this.div_MasterView.form.tab_Master.tpg_03.form.grd_Master30);//[공통]그리드 이벤트 설정 - 입고금액별
	
	
}



/***********************************************************************************************
 * 00.05. Form [업무] 초기설정 함수
 ***********************************************************************************************/
this.fn_FormBizInit = function() 
{ 
	//[공통] 날짜정보 설정
	this.gfn_SetCommFromToDate(this.fvComPrgmId, "MS", this.div_Search.form.cal_FromDd, this.div_Search.form.cal_ClosDd);//조회조건영역	
	
	//[공통] 공통코드 설정 : 공통코드|데이터셋명|초기항목추가여부(Y/N)|추가항목
	var objCondList = [//"QM010|ds_Qm010" //대분류
	                  //,"QM020|ds_Qm020" //중분류

					  ];

   //공통코드 설정함수 호출				   
	this.gfn_GetCommCode(this, objCondList, "");
	
	//콤보 인덱스 설정
	this.div_Search.form.cbo_ItlmCd.set_index(0);
	this.div_Search.form.cbo_ItmmCd.set_index(0);
	
	//[업무] 일반콤보조회
	//this.fn_ComboSearch();

	//[공통-Pivot] 그리드 검색/Pivot 설정	
	this.div_Search.form.div_ComGridSearch.form.fn_SetCmmGridProc(this, this.div_MasterView.form.tab_Master);
	
}

/***********************************************************************************************
 * 00.07. Form OnClose 이벤트
 ***********************************************************************************************/
this.fn_FormClose = function(obj:nexacro.Form,e:nexacro.CloseEventInfo)
{
	return true;
};

/***********************************************************************************************
 * 1. 조회 영역
 ***********************************************************************************************/
/***********************************************************************************************
 * 01.01. [공통버튼] 조회 버튼 클릭 이벤트
 ***********************************************************************************************/
this.fn_ComBtnSearch = function()
{ 

	//조회전 유효성 체크
	if (!this.fn_VaildSearch()) return;	

	//[업무] 데이터셋 설정 - 데이터셋 초기화, 조회조건 설정
	
// 	var nTabIdx = this.div_MasterView.form.tab_Master.tabindex;
// 	
// 	if(nTabIdx == 0){		
// 		this.ds_Master10.clearData();
// 		this.ds_Master11.clearData();
// 		this.fn_SetGridFormatItem();//품목코드별 그리드설정		
// 	}else if(nTabIdx == 1){	
// 		this.ds_Master20.clearData();
// 		this.ds_Master21.clearData();
// 		this.fn_SetGridFormatPart();//파트너사별 그리드설정	
// 	}
	this.ds_Input.clearData();

	//[업무] 조회조건 입력
	this.ds_Input.addRow();
	this.ds_Input.setColumn(0, "FROM_DD", this.div_Search.form.cal_FromDd.value.substr(0,6) + "01"); //
	this.ds_Input.setColumn(0, "CLOS_DD", this.div_Search.form.cal_ClosDd.value.substr(0,6) + "01"); //
	this.ds_Input.setColumn(0, "CNTH_NO", this.div_Search.form.mae_CnthNo.value);             // 계약번호
	this.ds_Input.setColumn(0, "CUSM_CD", this.div_Search.form.edt_CusmCd.value);             // 거래처(파트너사)
	this.ds_Input.setColumn(0, "ITLM_CD", this.div_Search.form.cbo_ItlmCd.value);             // 대분류
	this.ds_Input.setColumn(0, "ITMM_CD", this.div_Search.form.cbo_ItmmCd.value);             // 중분류
	this.ds_Input.setColumn(0, "ITEM_CD", this.div_Search.form.edt_ItemCd.value);             // 품목코드
	
	this.ds_Input.setColumn(0, "PRGM_ID", "M_MM_5120");//프로그램ID

	//[공통]서비스정보 초기화
	this.gfn_InitComService(this);
	
	var selectedTabIdx = this.div_MasterView.form.tab_Master.tabindex;
	var sSqlId = "";
	var sOutDatset = "";

	if (selectedTabIdx == 0) {
		sSqlId = "mm:M_MM_5120_M_SL10";
		sOutDatset = "ds_Master10=ds_Master10";
		this.ds_Master10.clearData();
		this.ds_Master11.clearData();
		this.fn_SetGridFormatItem();//품목코드별 그리드설정
		
	} else if (selectedTabIdx == 1) {
		sSqlId = "mm:M_MM_5120_M_SL20";
		sOutDatset = "ds_Master20=ds_Master20";
		this.ds_Master20.clearData();
		this.ds_Master21.clearData();
		this.fn_SetGridFormatPart();//파트너사별 그리드설정	
		
	} else if (selectedTabIdx == 2) {
		sSqlId = "mm:M_MM_5120_M_SL30";
		sOutDatset = "ds_Master30=ds_Master30";
		this.ds_Master30.clearData();
	}
	
	//[공통]서비스정보 추가
	var svcAddObj = new Object();//[공통] 서비스 추가 파라메타 정보 Object
	svcAddObj.sSelectSql = sSqlId;
	this.gfn_AddComSearchService(this, svcAddObj);	
	
	//[공통]서비스 호출 변수
	var svcCallObj = new Object();//[공통] 서비스 파라메타 정보 Object
	svcCallObj.sTrid = "MST_SEARCH";//Transaction ID 등 callback에서 넘겨 받을 String을 지정
	svcCallObj.sActionName = this.G_SV_MM;//서버에서 호출할 Action - 모듈별로 호출되는 기본 Actio이 다름 : 공통 서비스 Action 업무구분  변수 참조
	svcCallObj.sInputDaset = "ds_Input=ds_Input" //입력 데이터셋
    svcCallObj.sOutDatset = sOutDatset;//출력 데이터셋
	svcCallObj.sOtherArg = "";//서버로 전송할 기타 Argument 정보 문자열, 예) key=value key2=value2
	svcCallObj.sCallBackFnc = "fn_Callback";//서버에서 처리가 완료된 후 Callback 받을 Function 명
	svcCallObj.sComBtnDst = "SEARCH";//공통버튼구분-조회버튼
//	svcCallObj.sPrgmId = this.fvFormId;//프로그램ID  fvComPrgmId
    svcCallObj.sPrgmId = this.fvComPrgmId;//프로그램ID  
	//[공통]서비스 호출
	this.gfn_CallComService(this, svcCallObj);	
}

/***********************************************************************************************
 * 01.02. [Vaildation] 조회 필수값 체크
 ***********************************************************************************************/
this.fn_VaildSearch = function()
{
	if (!this.gfn_CheckFromToDate(this.fvComPrgmId, this.div_Search.form.cal_FromDd, this.div_Search.form.cal_ClosDd)) return false;//조회기간 범위 체크
	//조회조건 필수입력값 있으면 체크
	
	return true;
}

/***********************************************************************************************
 * 01.03. [공통] 조회조건 클릭/변경 이벤트
 ***********************************************************************************************/
/*---------------------------------------------------------------------------------------------
 *    [조회영역-년월달력] dropdown 이벤트
  ---------------------------------------------------------------------------------------------*/
 this.div_Search_cal_FromDd_ondropdown = function(obj:nexacro.Calendar,e:nexacro.EventInfo)
{
	this.gfn_CallYmCalendar(this, "this.div_Search.form.cal_FromDd", "fn_YmCallBack");	
};

this.div_Search_cal_ClosDd_ondropdown = function(obj:nexacro.Calendar,e:nexacro.EventInfo)
{
	this.gfn_CallYmCalendar(this, "this.div_Search.form.cal_ClosDd", "fn_YmCallBack");		
};

/***********************************************************************************************
 *    01. [부서]
 ***********************************************************************************************/
/*---------------------------------------------------------------------------------------------
 *    [조회영역-Button] 부서 버튼 클릭 이벤트
  ---------------------------------------------------------------------------------------------*/
this.div_Search_btn_DepmCd_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	var sPopupId = "S_DEPM_CD_01";//팝업ID - 부서코드
	var oArg = {PrgmId:this.fvComPrgmId, AuthYn:"Y", DepmNm:this.div_Search.form.edt_DepmNm.value };//Argument처리
	this.gfn_DeptPop(sPopupId, oArg);
};

/*---------------------------------------------------------------------------------------------
 *    [조회영역-Edit] 부서코드 변경 이벤트
  ---------------------------------------------------------------------------------------------*/
this.div_Search_edt_DepmCd_onchanged = function(obj:nexacro.Edit,e:nexacro.ChangeEventInfo)
{
	var sPopupId = "S_DEPM_CD_01";//팝업ID - 부서코드
	this.gfn_GetCommAuDepm(this.fvComPrgmId,"C", this.div_Search.form.edt_DepmCd, this.div_Search.form.edt_DepmNm, sPopupId);//코드로 검색
};

/*---------------------------------------------------------------------------------------------
 *    [조회영역-Edit] 부서명 변경 이벤트
  ---------------------------------------------------------------------------------------------*/
this.div_Search_edt_DepmNm_onchanged = function(obj:nexacro.Edit,e:nexacro.ChangeEventInfo)
{
	var sPopupId = "S_DEPM_CD_01";//팝업ID - 부서코드
	this.gfn_GetCommAuDepm(this.fvComPrgmId,"N", this.div_Search.form.edt_DepmCd, this.div_Search.form.edt_DepmNm, sPopupId);//코드명으로 검색
};

/***********************************************************************************************
 *    02. [사용자]
 ***********************************************************************************************/
/*---------------------------------------------------------------------------------------------
 *    [조회영역-Button] 사용자 버튼 클릭 이벤트
  ---------------------------------------------------------------------------------------------*/
this.div_Search_btn_SystId_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	var sPopupId = "S_SYST_ID_01";//팝업ID - 사용자정보
	var oArg = {PrgmId:this.fvComPrgmId, AuthYn:"Y", EmpmNm:this.div_Search.form.edt_EmpmNm.value};//Argument처리
	this.gfn_UserPop(sPopupId, oArg);		
};

/*---------------------------------------------------------------------------------------------
 *    [조회영역-Edit] 사원코드 변경 이벤트
  ---------------------------------------------------------------------------------------------*/
this.div_Search_edt_EmpmCd_onchanged = function(obj:nexacro.Edit,e:nexacro.ChangeEventInfo)
{
	var sPopupId = "S_SYST_ID_01";//팝업ID - 사원코드
	this.gfn_GetCommAuEmpm(this.fvComPrgmId,"C", this.div_Search.form.edt_EmpmCd, this.div_Search.form.edt_EmpmNm, this.div_Search.form.edt_SystId, sPopupId, "", "", false);//코드로 검색-권한체크용
};

/*---------------------------------------------------------------------------------------------
 *    [조회영역-Edit] 사원명 변경 이벤트
  ---------------------------------------------------------------------------------------------*/
this.div_Search_edt_EmpmNm_onchanged = function(obj:nexacro.Edit,e:nexacro.ChangeEventInfo)
{
	var sPopupId = "S_SYST_ID_01";//팝업ID - 사원코드
	this.gfn_GetCommAuEmpm(this.fvComPrgmId,"N", this.div_Search.form.edt_EmpmCd, this.div_Search.form.edt_EmpmNm, this.div_Search.form.edt_SystId, sPopupId, "", "", false);//코드명으로 검색-권한체크용
};

/***********************************************************************************************
 *    03. [계약번호]
 ***********************************************************************************************/
/*---------------------------------------------------------------------------------------------
 *    [조회영역-Button] 계약번호 버튼 클릭 이벤트
  ---------------------------------------------------------------------------------------------*/
this.div_Search_btn_CnthNo_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	var sPopupId = "S_CNTH_NO_01";//팝업ID - 계약정보
	var oArg = { CnthNo:this.div_Search.form.mae_CnthNo.value, PrgmId:this.fvComPrgmId};//Argument처리
	this.gfn_ContPop(sPopupId, oArg);		
};

/*---------------------------------------------------------------------------------------------
 *    [조회영역-Edit] 계약번호 변경 이벤트
  ---------------------------------------------------------------------------------------------*/
this.div_Search_mae_CnthNo_onchanged = function(obj:nexacro.MaskEdit,e:nexacro.ChangeEventInfo)
{
	this.gfn_GetCommCnth(this.div_Search.form.mae_CnthNo, this.div_Search.form.edt_CnthNm);//코드로 검색			
};

/*---------------------------------------------------------------------------------------------
 *    [조회영역-Edit] 계약번호 Killfocus 이벤트
  ---------------------------------------------------------------------------------------------*/
this.div_Search_mae_CnthNo_onkillfocus = function(obj:nexacro.MaskEdit,e:nexacro.KillFocusEventInfo)
{ 
	this.gfn_SetCnthNoMaskFormat(obj);//계약번호 동적 마스킹 처리
};

/*---------------------------------------------------------------------------------------------
 *    [조회영역-Edit] 계약번호 SetFocus 이벤트
  ---------------------------------------------------------------------------------------------*/
this.div_Search_mae_CnthNo_onsetfocus = function(obj:nexacro.MaskEdit,e:nexacro.SetFocusEventInfo)
{
	obj.set_format("@@@@@@@@@");
};

/***********************************************************************************************
 *    04. [프로젝트]
 ***********************************************************************************************/
/*---------------------------------------------------------------------------------------------
 *    [조회영역-Button] 프로젝트 버튼 클릭 이벤트
  ---------------------------------------------------------------------------------------------*/

/*---------------------------------------------------------------------------------------------
 *    [조회영역-Edit] 프로젝트 변경 이벤트
  ---------------------------------------------------------------------------------------------*/

/***********************************************************************************************
 *    05. [거래처]
 ***********************************************************************************************/
/*---------------------------------------------------------------------------------------------
 *    [조회영역-Button] 거래처 버튼 클릭 이벤트
  ---------------------------------------------------------------------------------------------*/
this.div_Search_btn_CusmCd_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	var sPopupId = "S_CUSM_CD_01";//팝업ID - 거래처정보
	var sCusmNm = "";//거래처명
	var sCusmTp = "H";//업체유형 - C : 고객사, H : 협력사, E - 기타, A - 전체선택
	var oArg = { CusmNm:sCusmNm, CusmTp:sCusmTp};//Argument처리
	this.gfn_CusmPop(sPopupId, oArg);//거래처팝업 호출 	

};

/*---------------------------------------------------------------------------------------------
 *    [조회영역-Edit] 거래처코드 변경 이벤트
  ---------------------------------------------------------------------------------------------*/
this.div_Search_edt_CusmCd_onchanged = function(obj:nexacro.Edit,e:nexacro.ChangeEventInfo)
{
	var sPopupId = "S_CUSM_CD_01";//팝업ID - 거래처정보
	this.gfn_GetCommCusm("C", this.div_Search.form.edt_CusmCd, this.div_Search.form.edt_CusmNm, sPopupId, "", "", "H");//코드로 검색
};

/*---------------------------------------------------------------------------------------------
 *    [조회영역-Edit] 거래처명 변경 이벤트
  ---------------------------------------------------------------------------------------------*/
this.div_Search_edt_CusmNm_onchanged = function(obj:nexacro.Edit,e:nexacro.ChangeEventInfo)
{
	var sPopupId = "S_CUSM_CD_01";//팝업ID - 거래처정보
	this.gfn_GetCommCusm("N", this.div_Search.form.edt_CusmCd, this.div_Search.form.edt_CusmNm, sPopupId, "", "", "H");//코드명으로 검색
};

/***********************************************************************************************
 *    06. [사업장]
 ***********************************************************************************************/
/*---------------------------------------------------------------------------------------------
 *    [조회영역-Button] 사업장 버튼 클릭 이벤트
  ---------------------------------------------------------------------------------------------*/

/*---------------------------------------------------------------------------------------------
 *    [조회영역-Edit] 사업장 변경 이벤트
  ---------------------------------------------------------------------------------------------*/
  
/***********************************************************************************************
 *    07. [W/O]
 ***********************************************************************************************/
/*---------------------------------------------------------------------------------------------
 *    [조회영역-Button] W/O 버튼 클릭 이벤트
  ---------------------------------------------------------------------------------------------*/

/*---------------------------------------------------------------------------------------------
 *    [조회영역-Edit] W/O 변경 이벤트
  ---------------------------------------------------------------------------------------------*/  

/***********************************************************************************************
 *    08. [품목코드]
 ***********************************************************************************************/
/*---------------------------------------------------------------------------------------------
 *    [조회영역-팝업버튼] 품목코드 버튼 클릭 이벤트
  ---------------------------------------------------------------------------------------------*/
    
this.div_Search_btn_ItemCd_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{	
	var sPopupId = "B_ITEM_CD_01";//팝업ID - 품목정보
	var oArg = { paramCode:"", paramNm:"" };//Argument처리
	this.gfn_ItemPop(sPopupId, oArg);

};

/*---------------------------------------------------------------------------------------------
 *    [조회영역-Edit] 품목코드 변경 이벤트
  ---------------------------------------------------------------------------------------------*/  
this.div_Search_edt_ItemCd_onchanged = function(obj:nexacro.Edit,e:nexacro.ChangeEventInfo)
{
	this.gfn_GetCommItem(this.div_Search.form.edt_ItemCd, this.div_Search.form.edt_ItemNm);//코드로 검색		
};

/***********************************************************************************************
 *    09. [계정코드]
 ***********************************************************************************************/
/*---------------------------------------------------------------------------------------------
 *    [조회영역-Button] 계정코드 버튼 클릭 이벤트
  ---------------------------------------------------------------------------------------------*/

/*---------------------------------------------------------------------------------------------
 *    [조회영역-Edit] 계정코드 변경 이벤트
  ---------------------------------------------------------------------------------------------*/  


/***********************************************************************************************
 * 2. 입력
 ***********************************************************************************************/
  /***********************************************************************************************
 * 02.MG0.08. [Master 셀클릭 이벤트] 
 ***********************************************************************************************/
this.div_MasterView_tab_Master_tpg_01_grd_Master10_oncellclick = function(obj:nexacro.Grid,e:nexacro.GridClickEventInfo)
{
  this.gfn_SetGridSelectRowColor(obj, e.row);//선택한 Row BackgroundColor 설정
// 	//비고
// 	if (e.col == 6) {		
// 		if (!this.gfn_IsNull(this.ds_Master10.getColumn(this.ds_Master10.rowposition, "REMK_NM"))) {
// 			var sPopupId = "B_REMK_01";//팝업ID - 비고상세
// 			var sTitle = "매입계획현황 비고";//팝업 타이틀
// 			var oArg = {  Remk:this.ds_Master10.getColumn(this.ds_Master10.rowposition, "REMK_NM")};//Argument처리
// 			this.gfn_RemkPop(sPopupId, sTitle, oArg);			
// 	   }
// 	}
};

this.div_MasterView_tab_Master_tpg_02_grd_Master20_oncellclick = function(obj:nexacro.Grid,e:nexacro.GridClickEventInfo)
 {
	this.gfn_SetGridSelectRowColor(obj, e.row);//선택한 Row BackgroundColor 설정
//     if (e.col == 11) {		
// 		if (!this.gfn_IsNull(this.ds_Master20.getColumn(this.ds_Master20.rowposition, "REMK_NM"))) {
// 			var sPopupId = "B_REMK_02";//팝업ID - 비고상세
// 			var sTitle = "발주별매입계획현황 비고";//팝업 타이틀
// 			var oArg = {  Remk:this.ds_Master20.getColumn(this.ds_Master20.rowposition, "REMK_NM")};//Argument처리
// 			this.gfn_RemkPop(sPopupId, sTitle, oArg);		
// 		}
// 	}
};

this.div_MasterView_tab_Master_tpg_03_grd_Master30_oncellclick = function(obj:nexacro.Grid,e:nexacro.GridClickEventInfo)
{
	this.gfn_SetGridSelectRowColor(obj, e.row);//선택한 Row BackgroundColor 설정
};

/***********************************************************************************************
 * 02.01. [공통버튼] 입력 버튼 클릭 이벤트
 ***********************************************************************************************/ 
this.fn_ComBtnAdd = function()
{
}

/***********************************************************************************************
 * 3. 복사
 ***********************************************************************************************/
/***********************************************************************************************
 * 03.01. [공통버튼] 복사 버튼 클릭 이벤트
 ***********************************************************************************************/ 
this.fn_ComBtnCopy = function()
{ 
}

/***********************************************************************************************
 * 4. 취소
 ***********************************************************************************************/
/***********************************************************************************************
 * 04.01. [공통버튼] 취소 버튼 클릭 이벤트
 ***********************************************************************************************/ 
this.fn_ComBtnCancel = function()
{ 
}

/***********************************************************************************************
 * 5. 저장
 ***********************************************************************************************/
/***********************************************************************************************
 * 05.01. [공통버튼] 저장 버튼 클릭 이벤트
 ***********************************************************************************************/ 
this.fn_ComBtnSave = function()
{ 
}

/***********************************************************************************************
 * 05.02. [Vaildation] Master 저장 필수값 체크 - 입력항목 
 ***********************************************************************************************/ 
this.fn_VaildMasterSave = function()
{
	return true;
}
 
/***********************************************************************************************
 * 6. 삭제
 ***********************************************************************************************/
/***********************************************************************************************
 * 06.01. [공통버튼] 삭제 버튼 클릭 이벤트
 ***********************************************************************************************/  
this.fn_ComBtnDelete = function()
{ 
}

/***********************************************************************************************
 * 7. 엑셀
 ***********************************************************************************************/
/***********************************************************************************************
 * 07.01. [공통버튼] 엑셀저장 버튼 클릭 이벤트
 ***********************************************************************************************/  
this.fn_ComBtnExcel = function()
{ 
	//출력 그리드 정보 설정
	var objGridList = ["this.div_MasterView.form.tab_Master.tpg_01.form.grd_Master10|" + this.div_MasterView.form.tab_Master.tpg_01.text
	                 , "this.div_MasterView.form.tab_Master.tpg_02.form.grd_Master20|" + this.div_MasterView.form.tab_Master.tpg_02.text
					 , "this.div_MasterView.form.tab_Master.tpg_03.form.grd_Master30|" + this.div_MasterView.form.tab_Master.tpg_03.text
	                  ];
	 
	var sFileName = "품목/파트너사별입고현황";//출력파일명
	this.gfn_ExcelExport(this, objGridList, sFileName);
}

/***********************************************************************************************
 * 8. 인쇄
 ***********************************************************************************************/
/***********************************************************************************************
 * 08.01. [공통버튼] 인쇄 버튼 클릭 이벤트
 ***********************************************************************************************/  
this.fn_ComBtnPrint = function()
{ 
}

/***********************************************************************************************
 * 9. 결재요청
 ***********************************************************************************************/
/***********************************************************************************************
 * 09.01. [공통버튼] 결재요청 버튼 클릭 이벤트
 ***********************************************************************************************/  
this.fn_ComBtnDecide = function()
{ 
}

/***********************************************************************************************
 * 10. 결재현황
 ***********************************************************************************************/
/***********************************************************************************************
 * 10.01. [공통버튼] 결재현황 버튼 클릭 이벤트
 ***********************************************************************************************/  
this.fn_ComBtnProcess = function()
{ 
}

/***********************************************************************************************
 * 11. 재기안
 ***********************************************************************************************/
/***********************************************************************************************
 * 11.01. [공통버튼] 재기안 버튼 클릭 이벤트
 ***********************************************************************************************/ 
this.fn_ComBtnRecide = function()
{ 
}

/***********************************************************************************************
 * 12. 닫기
 ***********************************************************************************************/
/***********************************************************************************************
 * 12.01. [공통버튼] 닫기 버튼 클릭 이벤트
 ***********************************************************************************************/ 
this.fn_ComBtnClose = function()
{ 
	return true;
}

/***********************************************************************************************
 * 13. [CallBack] 함수
 ***********************************************************************************************/
/***********************************************************************************************
 * 13.01. [서비스] CallBack 함수 처리
 ***********************************************************************************************/ 
this.fn_Callback = function(sSvcId, nErrorCode, sErrorMsg)
{
	if(nErrorCode != 0)
	{
		return;
	}	
	switch(sSvcId)
	{
		case "MST_SEARCH": //조회		
			if (this.ds_Master10.getRowCount() > 0) {

				//[공통]그리드NoData Text 초기화 설정
				this.gfn_InitGridNoDataText(this.div_MasterView.form.tab_Master.tpg_01.form.grd_Master10);
				
			} else {
				
				//[공통]그리드NoData Text설정
				this.gfn_SetGridNoDataText(this.div_MasterView.form.tab_Master.tpg_01.form.grd_Master10);
		
			}		
			
			var nTabIdx = this.div_MasterView.form.tab_Master.tabindex;
	
			if(nTabIdx == 0){	
				//Pivot 데이터셋 설정
				this.fn_SetPivotItemData();
			} else if(nTabIdx == 1) {	
				//Pivot 데이터셋 설정
				this.fn_SetPivotPartData();			
			}
			
			break;
// 		case "COMBO_SEARCH": //콤보조회		
// 			if (this.ds_FaSaum.getRowCount() > 0) {
// 				this.ds_FaSaum.insertRow();
// 				this.ds_FaSaum.setColumn(0, "SAUM_NM", "ALL");
// 				this.div_Search.form.cbo_SaumCd.set_index(0);
// 			}
// 			break;
	}			

};

/***********************************************************************************************
 * 13.02. [팝업] CallBack 함수 처리
          strId : 팝업호출시 지정한 팝업ID
	      rtnValue : 팝업창에서 close시 지정한 반환값
          주의 : Open(popuptype=modeless)창은 팝업콜백을 지원하지 않음
 ***********************************************************************************************/ 
this.fn_PopupCallback = function(strId, rtnValue)
{
	//[조회영역]
	//계약번호
	if (strId == "S_CNTH_NO_01") {
		if (!this.gfn_IsNull(rtnValue)) {
			var arrRtnVal = eval(rtnValue);
			
			if (!this.gfn_IsNull(arrRtnVal.CNTH_NO)) {
				this.div_Search.form.mae_CnthNo.set_value(arrRtnVal.CNTH_NO);
				this.div_Search.form.edt_CnthNm.set_value(arrRtnVal.CNTH_NM);
			}	
		}
	//거래처
	} else if (strId == "S_CUSM_CD_01") {
		if (!this.gfn_IsNull(rtnValue)) {
			var arrRtnVal = eval(rtnValue);
			
			if (!this.gfn_IsNull(arrRtnVal.CUSM_CD)) {
				this.div_Search.form.edt_CusmCd.set_value(arrRtnVal.CUSM_CD);
				this.div_Search.form.edt_CusmNm.set_value(arrRtnVal.CUSM_NM);
			}
		}	 else {
			this.div_Search.form.edt_CusmCd.set_value("");
			this.div_Search.form.edt_CusmNm.set_value("");
		}	
	//영업부서
	} else if (strId == "S_DEPM_CD_01") {
		if (!this.gfn_IsNull(rtnValue)) {
			var arrRtnVal = eval(rtnValue);
			
			if (!this.gfn_IsNull(arrRtnVal.DEPM_CD)) {
				this.div_Search.form.edt_DepmCd.set_value(arrRtnVal.DEPM_CD);
				this.div_Search.form.edt_DepmNm.set_value(arrRtnVal.DEPM_NM);
			}
		} else {
				this.div_Search.form.edt_DepmCd.set_value("");
				this.div_Search.form.edt_DepmNm.set_value("");
		}
	//영업자
	} else if (strId == "S_SYST_ID_01") {
		if (!this.gfn_IsNull(rtnValue)) {
			var arrRtnVal = eval(rtnValue);	
			
			if (!this.gfn_IsNull(arrRtnVal.EMPM_CD)) {
				this.div_Search.form.edt_EmpmCd.set_value(arrRtnVal.EMPM_CD);
				this.div_Search.form.edt_EmpmNm.set_value(arrRtnVal.EMPM_NM);
				this.div_Search.form.edt_SystId.set_value(arrRtnVal.SYST_ID);
			} 
		} else {
				this.div_Search.form.edt_EmpmCd.set_value("");
				this.div_Search.form.edt_EmpmNm.set_value("");
				this.div_Search.form.edt_SystId.set_value("");
		}	
	//품목코드	
	} else if (strId == "B_ITEM_CD_01") {
		if (!this.gfn_IsNull(rtnValue)) {
			var arrRtnVal = eval(rtnValue);	
						
			if (!this.gfn_IsNull(arrRtnVal.ITEM_CD)) {
				this.div_Search.form.edt_ItemCd.set_value(arrRtnVal.ITEM_CD);
				this.div_Search.form.edt_ItemNm.set_value(arrRtnVal.ITEM_NM);
			}
		}else {
				this.div_Search.form.edt_ItemCd.set_value("");
				this.div_Search.form.edt_ItemNm.set_value("");		
		}
// 	} else if (strId == "B_ITEM_CD_02") {
// 		if (!this.gfn_IsNull(rtnValue)) {
// 			trace(">>>>>>>>>>>>" + rtnValue);
// 			var arrRtnVal = eval(rtnValue);							
// 			if (!this.gfn_IsNull(arrRtnVal.ITEM_CD)) {
// 				this.ds_Master10.setColumn(this.ds_Master10.rowposition, "ITEM_CD", arrRtnVal.ITEM_CD);
// 				this.ds_Master10.setColumn(this.ds_Master10.rowposition, "ITEM_NM", arrRtnVal.ITEM_NM);
// 				this.ds_Master10.setColumn(this.ds_Master10.rowposition, "SPEC_NM", arrRtnVal.SPEC_NM);
// 				this.ds_Master10.setColumn(this.ds_Master10.rowposition, "UNIT_CD", arrRtnVal.UNIT_CD);
// 				this.ds_Master10.setColumn(this.ds_Master10.rowposition, "ITLM_CD", arrRtnVal.ITLM_CD);
// 				this.ds_Master10.setColumn(this.ds_Master10.rowposition, "ITMM_CD", arrRtnVal.ITMM_CD);
// 			}
// 		}else{
// 				this.ds_Master10.setColumn(this.ds_Master10.rowposition, "ITEM_CD", "");
// 				this.ds_Master10.setColumn(this.ds_Master10.rowposition, "ITEM_NM", "");
// 				this.ds_Master10.setColumn(this.ds_Master10.rowposition, "SPEC_NM", "");
// 				this.ds_Master10.setColumn(this.ds_Master10.rowposition, "UNIT_CD", "");
// 				this.ds_Master10.setColumn(this.ds_Master10.rowposition, "ITLM_CD", "");
// 				this.ds_Master10.setColumn(this.ds_Master10.rowposition, "ITMM_CD", "");
// 		}
	}	

};
 
/***********************************************************************************************
 * 13.03. [메세지] CallBack 함수 처리
 ***********************************************************************************************/  
this.fn_MsgCallback = function (strId, strVal)
{
}; 
 
/***********************************************************************************************
 * 14. [화면 사이즈] 조정 버튼 이벤트
 ***********************************************************************************************/
/***********************************************************************************************
 * 14.01. [조회영역-▲] 화면 사이즈조정 버튼 이벤트
 ***********************************************************************************************/ 
this.btn_DivMoveMi_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	//[공통] 버튼 변수
	var btnObj = new Object();//[공통] 버튼 변수 정보 Object
	btnObj.DivSearch = "this.div_Search";//조회영역 Div
	btnObj.DivMstLeft = "this.div_MasterView";//Master영역 Left Div : Master영역이 하나인경우에는 Left에 설정
	btnObj.DivMstRight = "";//Master영역 Right Div
	btnObj.DivDetail = "";//Detail영역 Div
	btnObj.MstLeft = 14;//Master영역 Div Left
	btnObj.MstTop = 90;//Master영역 Div Top
	btnObj.MstHeight = "";//Master영역 Div Height : Height가 없는경우 ""로 입력
	btnObj.MoveBtnDtl = "";//Detail영역 Move 버튼 : 없으면 ""로 입력
	this.gfn_MoveSeBtn(obj, btnObj);//Master영역 접고/펼치기 버튼 이벤트
};

/***********************************************************************************************
 * 14.02. Tab변경 이벤트
 ***********************************************************************************************/ 
// this.div_MasterView_tab_Master_onchanged = function(obj:nexacro.Tab,e:nexacro.TabIndexChangeEventInfo)
// {
// 	//[공통-Pivot] Tab변경시 그리드 Pivot 관련 함수 호출
// 	this.div_ComGridProc.form.chk_PivotYn_onclick();
// };

/***********************************************************************************************
 * 15. [사용자정의 함수]
 ***********************************************************************************************/
/***********************************************************************************************
 * 15.01. 품목코드별 그리드 설정
 ***********************************************************************************************/ 
this.fn_SetGridFormatItem = function() {
	//데이터셋 설정
	var sFromMonth = this.div_Search.form.cal_FromDd.value.substr(0,6) + "01";
	var sClosMonth = this.div_Search.form.cal_ClosDd.value.substr(0,6) + "01";
	var sMonth = "";

	var iDiff = this.gfn_GetDiffMonth(sFromMonth, sClosMonth);//월차이

	this.ds_Master11.clear();
	
	this.ds_Master11.addColumn("ITLM_CD", "string");
	this.ds_Master11.addColumn("ITLM_NM", "string");
	this.ds_Master11.addColumn("ITMM_CD", "string");
	this.ds_Master11.addColumn("ITMM_NM", "string");
	this.ds_Master11.addColumn("ITEM_CD", "string");
	this.ds_Master11.addColumn("ITEM_NM", "string");
	this.ds_Master11.addColumn("SPEC_NM", "string");
	this.ds_Master11.addColumn("SP03_CD", "string");
	this.ds_Master11.addColumn("UNIT_CD", "string");
	this.ds_Master11.addColumn("PCWB_QT_SUM", "BIGDECIMAL");
	this.ds_Master11.addColumn("WONE_AM_SUM", "BIGDECIMAL");
	this.ds_Master11.addColumn("WONE_PR", "BIGDECIMAL");
	
	var sSumQt = "";//입고수량합계컬럼
	var sSumAm = "";//입고금액합계컬럼

	if (iDiff > 0) {
		for (var iLoop=0; iLoop <= iDiff; iLoop++) {
			sMonth = this.gfn_AddMonth(sFromMonth, iLoop);
			sMonth = sMonth.toString();
			this.ds_Master11.addColumn("S" + sMonth.substr(0,6) + "_QT", "BIGDECIMAL");
			this.ds_Master11.addColumn("S" + sMonth.substr(0,6) + "_AM", "BIGDECIMAL");
			
			if (this.gfn_IsNull(sSumQt)) {
				sSumQt = "S" + sMonth.substr(0,6) + "_QT";//입고수량합계컬럼
				sSumAm = "S" + sMonth.substr(0,6) + "_AM";//입고금액합계컬럼
			} else {
				sSumQt = sSumQt + "+S" + sMonth.substr(0,6) + "_QT";//입고수량합계컬럼
				sSumAm = sSumAm + "+S" + sMonth.substr(0,6) + "_AM";//입고금액합계컬럼			
			}
		}
	} else {
		sMonth = sFromMonth.substr(0,6);
		this.ds_Master11.addColumn("S" + sMonth + "_QT", "BIGDECIMAL");
		this.ds_Master11.addColumn("S" + sMonth + "_AM", "BIGDECIMAL");
		sSumQt = "S" + sMonth + "_QT";//입고수량합계컬럼
		sSumAm = "S" + sMonth + "_AM";//입고금액합계컬럼
	}	
	
	//그리드 설정
	//그리드 고정컬럼 설정
	var sTotFormats       = '';//전체 Foramts
	var sFormatHead       =  '<Formats>';//Formats - Head
	    sFormatHead      += '<Format id="default">';
	var sFormatColumns    = '<Columns>';//Formats - Colums - 변동
	    sFormatColumns   += '<Column size="35" band="left"/>';
		sFormatColumns   += '<Column size="80"/>';
		sFormatColumns   += '<Column size="100"/>';
		sFormatColumns   += '<Column size="100"/>';
		sFormatColumns   += '<Column size="100"/>';
		sFormatColumns   += '<Column size="250"/>';
		sFormatColumns   += '<Column size="140"/>';
		sFormatColumns   += '<Column size="80"/>';
		sFormatColumns   += '<Column size="50"/>';
		sFormatColumns   += '<Column size="80"/>';
		sFormatColumns   += '<Column size="110"/>';
		sFormatColumns   += '<Column size="110"/>';
		
	var sFormatColumnsEnd = '</Columns>';//Formats - Colums End
	
	var sFormatRows       = '<Rows>';//Rows
        sFormatRows      += '<Row size="24" band="head"/>';
        sFormatRows      += '<Row size="26" band="head"/>';
        sFormatRows      += '<Row size="24"/>';
        sFormatRows      += '<Row size="24" band="summ"/>';
        sFormatRows      += '</Rows>';	
		
	var sBandHead         = '<Band id="head">';//Band Head
	var sBandHeadCol      = '<Cell rowspan="2" text="No."/>';//Band Head Col - 변동
	    sBandHeadCol     += '<Cell col="1" rowspan="2" text="상세보기"/>';	
		sBandHeadCol     += '<Cell col="2" colspan="7" text="품목정보"/>';
		sBandHeadCol     += '<Cell col="9" colspan="3" text="입고합계"/>';
		
	var sBandHeadRow      = '<Cell row="1" col="2" text="대분류"/>';//Band Head Row - 변동
	    sBandHeadRow     += '<Cell row="1" col="3" text="중분류"/>';
		sBandHeadRow     += '<Cell row="1" col="4" text="품목코드"/>';
		sBandHeadRow     += '<Cell row="1" col="5" text="품목명"/>';
		sBandHeadRow     += '<Cell row="1" col="6" text="규격"/>';
		sBandHeadRow     += '<Cell row="1" col="7" text="Maker"/>';
		sBandHeadRow     += '<Cell row="1" col="8" text="단위"/>';
		sBandHeadRow     += '<Cell row="1" col="9" text="입고수량"/>';
		sBandHeadRow     += '<Cell row="1" col="10" text="입고금액"/>';
		sBandHeadRow     += '<Cell row="1" col="11" text="평균단가"/>';
		
	var sBandHeadEnd      = '</Band>';//Band Head End
	
	var sBandBody         = '<Band id="body">';//Band Body - 변동
	    sBandBody        += '<Cell expr="currow + 1" textAlign="center"/>';
		sBandBody        += '<Cell col="1" textAlign="center" displaytype="buttoncontrol" text="상세보기"/>';
		sBandBody        += '<Cell col="2" text="bind:ITLM_NM" textAlign="left"/>';
		sBandBody        += '<Cell col="3" text="bind:ITMM_NM" textAlign="left"/>';
		sBandBody        += '<Cell col="4" displaytype="normal" textAlign="left" text="bind:ITEM_CD"/>';
		sBandBody        += '<Cell col="5" displaytype="normal" textAlign="left" text="bind:ITEM_NM"/>';
		sBandBody        += '<Cell col="6" displaytype="normal" textAlign="left" text="bind:SPEC_NM"/>';
		sBandBody        += '<Cell col="7" text="bind:SP03_CD" textAlign="left"/>';
		sBandBody        += '<Cell col="8" displaytype="normal" textAlign="center" text="bind:UNIT_CD"/>';
		//sBandBody        += '<Cell col="9" text="bind:PCWB_QT_SUM" maskeditformat="###,###,###,##0.#0" textAlign="right" displaytype="mask"/>';
		sBandBody        += '<Cell col="9" expr="' + sSumQt + '" maskeditformat="###,###,###,##0.#0" textAlign="right" displaytype="mask"/>';
		//sBandBody        += '<Cell col="10" text="bind:WONE_AM_SUM" maskeditformat="###,###,###,##0" textAlign="right" displaytype="mask"/>';
		sBandBody        += '<Cell col="10" expr="' + sSumAm + '" maskeditformat="###,###,###,##0" textAlign="right" displaytype="mask"/>';
		//sBandBody        += '<Cell col="11" text="bind:WONE_PR" displaytype="mask" textAlign="right" maskeditformat="###,###,###,##0"/>';
		sBandBody        += '<Cell col="11" expr="nexacro.round((' + sSumAm + ')/(' + sSumQt + '),2)" displaytype="mask" textAlign="right" maskeditformat="###,###,###,##0.#0"/>';
	
	var sBandBodyEnd      = '</Band>';//Band Body End
	
	var sBandSummary      = '<Band id="summary">';//Band Summary - 변동	
	    sBandSummary     += '<Cell/>';
		sBandSummary     += '<Cell col="1" text="합계" textAlign="center"/>';
		sBandSummary     += '<Cell col="2"/>';
		sBandSummary     += '<Cell col="3"/>';
		sBandSummary     += '<Cell col="4"/>';
		sBandSummary     += '<Cell col="5"/>';
		sBandSummary     += '<Cell col="6" textAlign="center"/>';
		sBandSummary     += '<Cell col="7"/>';
		sBandSummary     += '<Cell col="8"/>';
		sBandSummary     += '<Cell col="9"/>';
		sBandSummary     += '<Cell col="10"/>';
		sBandSummary     += '<Cell col="11"/>';


		sBandSummary     += '<Cell col="9" expr="dataset.getSum(&quot;' + sSumQt  + '&quot;)" displaytype="mask" textAlign="right" maskeditformat="###,###,###,##0.#0"/>';
		sBandSummary     += '<Cell col="10" expr="dataset.getSum(&quot;' + sSumAm  + '&quot;)" displaytype="mask" textAlign="right" maskeditformat="###,###,###,##0"/>';
			
			
	var sBandSummaryEnd   = '</Band>';//Band Body End
	
	var sFormatEnd        = '</Format>';//Formats - End
	    sFormatEnd       += '</Formats>';
				
		//동적그리드 컬럼설정
		//From~To 월 차이가 0보다 큰경우
		if (iDiff > 0) {
			var sChkMonth = "";
			var iMonth = 12;//월컬럼번호
			var iQt = 12;//입고수량컬럼번호
			var iAm = 13;//입고금액컬럼번호

			for (var iLoop=0; iLoop <= iDiff; iLoop++) {
				sMonth = this.gfn_AddMonth(sFromMonth, iLoop);
				sMonth = sMonth.toString();
				sChkMonth = sMonth.substr(0,6);
				sChkMonth = sChkMonth.toString();
				
				sFormatColumns   += '<Column size="80"/>';
				sFormatColumns   += '<Column size="100"/>';

				if (iLoop > 0) {
					iMonth = iMonth + 2;
					iQt = iQt + 2;
					iAm = iAm + 2;
				}
				
				sBandHeadCol     += '<Cell col="' + iMonth + '" colspan="2" text="' + sChkMonth.substr(0,4) + '/' + sChkMonth.substr(4,2) + '"/>';

				sBandHeadRow     += '<Cell row="1" col="' + iQt + '" text="입고수량"/>';
				sBandHeadRow     += '<Cell row="1" col="' + iAm + '" text="입고금액"/>';

				sBandBody        += '<Cell col="' + iQt + '" text="bind:S' + sChkMonth + '_QT' + '" maskeditformat="###,###,###,##0.#0" textAlign="right" displaytype="mask"/>';
				sBandBody        += '<Cell col="' + iAm + '" text="bind:S' + sChkMonth + '_AM' + '" maskeditformat="###,###,###,##0" textAlign="right" displaytype="mask"/>';

				sBandSummary     += '<Cell col="' + iQt + '" expr="dataset.getSum(&quot;S' + sChkMonth + '_QT' + '&quot;)" displaytype="mask" textAlign="right" maskeditformat="###,###,###,##0.#0"/>';
				sBandSummary     += '<Cell col="' + iAm + '" expr="dataset.getSum(&quot;S' + sChkMonth + '_AM' + '&quot;)" displaytype="mask" textAlign="right" maskeditformat="###,###,###,##0"/>';				
			}
		} else {
			sMonth = sFromMonth.substr(0,6);
			sFormatColumns   += '<Column size="80"/>';
			sFormatColumns   += '<Column size="110"/>';

			sBandHeadCol     += '<Cell col="12" colspan="2" text="' + sMonth.substr(0,4) + '/' + sMonth.substr(4,2) + '"/>';

			sBandHeadRow     += '<Cell row="1" col="12" text="입고수량"/>';
			sBandHeadRow     += '<Cell row="1" col="13" text="입고금액"/>';

			sBandBody        += '<Cell col="12" text="bind:S' + sMonth + '_QT' + '" maskeditformat="###,###,###,##0.#0" textAlign="right" displaytype="mask"/>';
			sBandBody        += '<Cell col="13" text="bind:S' + sMonth + '_AM' + '" maskeditformat="###,###,###,##0" textAlign="right" displaytype="mask"/>';

			sBandSummary     += '<Cell col="12" expr="dataset.getSum(&quot;S' + sMonth + '_QT' + '&quot;)" displaytype="mask" textAlign="right" maskeditformat="###,###,###,##0.#0"/>';
			sBandSummary     += '<Cell col="13" expr="dataset.getSum(&quot;S' + sMonth + '_AM' + '&quot;)" displaytype="mask" textAlign="right" maskeditformat="###,###,###,##0"/>';
		}		
		
		sTotFormats = sFormatHead + sFormatColumns + sFormatColumnsEnd + sFormatRows + sBandHead + sBandHeadCol + sBandHeadRow + sBandHeadEnd + sBandBody + sBandBodyEnd + sBandSummary + sBandSummaryEnd + sFormatEnd;//전체 Foramts		

	this.div_MasterView.form.tab_Master.tpg_01.form.grd_Master10.set_formats("")	
	this.div_MasterView.form.tab_Master.tpg_01.form.grd_Master10.set_formats(sTotFormats);

}

/***********************************************************************************************
 * 15.02. 파트너사별 그리드 설정
 ***********************************************************************************************/ 
this.fn_SetGridFormatPart = function() {
	//데이터셋 설정
	var sFromMonth = this.div_Search.form.cal_FromDd.value.substr(0,6) + "01";
	var sClosMonth = this.div_Search.form.cal_ClosDd.value.substr(0,6) + "01";
	var sMonth = "";

	var iDiff = this.gfn_GetDiffMonth(sFromMonth, sClosMonth);//월차이

	this.ds_Master21.clear();
	
	this.ds_Master21.addColumn("CUSM_CD", "string");
	this.ds_Master21.addColumn("CUSM_NM", "string");
	this.ds_Master21.addColumn("SAUM_NO", "string");
	
	var sSumQt = "";//입고수량합계컬럼
	var sSumAm = "";//입고금액합계컬럼

	if (iDiff > 0) {
		for (var iLoop=0; iLoop <= iDiff; iLoop++) {
			sMonth = this.gfn_AddMonth(sFromMonth, iLoop);
			sMonth = sMonth.toString();
			this.ds_Master21.addColumn("S" + sMonth.substr(0,6) + "_QT", "BIGDECIMAL");
			this.ds_Master21.addColumn("S" + sMonth.substr(0,6) + "_AM", "BIGDECIMAL");
			
			if (this.gfn_IsNull(sSumQt)) {
				sSumQt = "S" + sMonth.substr(0,6) + "_QT";//입고수량합계컬럼
				sSumAm = "S" + sMonth.substr(0,6) + "_AM";//입고금액합계컬럼
			} else {
				sSumQt = sSumQt + "+S" + sMonth.substr(0,6) + "_QT";//입고수량합계컬럼
				sSumAm = sSumAm + "+S" + sMonth.substr(0,6) + "_AM";//입고금액합계컬럼			
			}
		}
	} else {
		sMonth = sFromMonth.substr(0,6);
		this.ds_Master21.addColumn("S" + sMonth + "_QT", "BIGDECIMAL");
		this.ds_Master21.addColumn("S" + sMonth + "_AM", "BIGDECIMAL");
		sSumQt = "S" + sMonth + "_QT";//입고수량합계컬럼
		sSumAm = "S" + sMonth + "_AM";//입고금액합계컬럼
	}	
	
	//그리드 설정
	//그리드 고정컬럼 설정
	var sTotFormats       = '';//전체 Foramts
	var sFormatHead       =  '<Formats>';//Formats - Head
	    sFormatHead      += '<Format id="default">';
	var sFormatColumns    = '<Columns>';//Formats - Colums - 변동
	    sFormatColumns   += '<Column size="35" band="left"/>';
		sFormatColumns   += '<Column size="80"/>';
		sFormatColumns   += '<Column size="80"/>';
		sFormatColumns   += '<Column size="150"/>';
		sFormatColumns   += '<Column size="90"/>';
		sFormatColumns   += '<Column size="80"/>';
		sFormatColumns   += '<Column size="110"/>';
		
	var sFormatColumnsEnd = '</Columns>';//Formats - Colums End
	
	var sFormatRows       = '<Rows>';//Rows
        sFormatRows      += '<Row size="24" band="head"/>';
        sFormatRows      += '<Row size="26" band="head"/>';
        sFormatRows      += '<Row size="24"/>';
        sFormatRows      += '<Row size="24" band="summ"/>';
        sFormatRows      += '</Rows>';	
		
	var sBandHead         = '<Band id="head">';//Band Head
	var sBandHeadCol      = '<Cell rowspan="2" text="No."/>';//Band Head Col - 변동
	    sBandHeadCol     += '<Cell col="1" rowspan="2" text="상세보기"/>';	
		sBandHeadCol     += '<Cell col="2" colspan="3" text="파트너사정보"/>';
		sBandHeadCol     += '<Cell col="5" colspan="2" text="입고합계"/>';
		
	var sBandHeadRow      = '<Cell row="1" col="2" text="파트너사코드"/>';//Band Head Row - 변동
	    sBandHeadRow     += '<Cell row="1" col="3" text="파트너사명"/>';
		sBandHeadRow     += '<Cell row="1" col="4" text="사업자번호"/>';
		sBandHeadRow     += '<Cell row="1" col="5" text="입고수량"/>';
		sBandHeadRow     += '<Cell row="1" col="6" text="입고금액"/>';
		
	var sBandHeadEnd      = '</Band>';//Band Head End
	
	var sBandBody         = '<Band id="body">';//Band Body - 변동
	    sBandBody        += '<Cell expr="currow + 1" textAlign="center"/>';
		sBandBody        += '<Cell col="1" textAlign="center" displaytype="buttoncontrol" text="상세보기"/>';
		sBandBody        += '<Cell col="2" text="bind:CUSM_CD" textAlign="center"/>';
		sBandBody        += '<Cell col="3" text="bind:CUSM_NM"/>';
		sBandBody        += '<Cell col="4" displaytype="mask" textAlign="center" text="bind:SAUM_NO" maskeditformat="@@@-@@-@@@@@" maskedittype="string"/>';
		sBandBody        += '<Cell col="5" expr="' + sSumQt + '" maskeditformat="###,###,###,##0.#0" textAlign="right" displaytype="mask"/>';
		sBandBody        += '<Cell col="6" expr="' + sSumAm + '" maskeditformat="###,###,###,##0" textAlign="right" displaytype="mask"/>';

	var sBandBodyEnd      = '</Band>';//Band Body End
	
	var sBandSummary      = '<Band id="summary">';//Band Summary - 변동	
	    sBandSummary     += '<Cell/>';
		sBandSummary     += '<Cell col="1" text="합계" textAlign="center"/>';
		sBandSummary     += '<Cell col="2"/>';
		sBandSummary     += '<Cell col="3"/>';
		sBandSummary     += '<Cell col="4"/>';

   
		sBandSummary     += '<Cell col="5" expr="dataset.getSum(&quot;' + sSumQt + '&quot;)" displaytype="mask" textAlign="right" maskeditformat="###,###,###,##0.#0"/>';
		sBandSummary     += '<Cell col="6" expr="dataset.getSum(&quot;' + sSumAm + '&quot;)" displaytype="mask" textAlign="right" maskeditformat="###,###,###,##0"/>';

	var sBandSummaryEnd   = '</Band>';//Band Body End
	
	var sFormatEnd        = '</Format>';//Formats - End
	    sFormatEnd       += '</Formats>';
				
		//동적그리드 컬럼설정
		//From~To 월 차이가 0보다 큰경우
		if (iDiff > 0) {
			var sChkMonth = "";
			var iMonth = 7;//월컬럼번호
			var iQt = 7;//입고수량컬럼번호
			var iAm = 8;//입고금액컬럼번호

			for (var iLoop=0; iLoop <= iDiff; iLoop++) {
				sMonth = this.gfn_AddMonth(sFromMonth, iLoop);
				sMonth = sMonth.toString();
				sChkMonth = sMonth.substr(0,6);
				sChkMonth = sChkMonth.toString();
				
				sFormatColumns   += '<Column size="80"/>';
				sFormatColumns   += '<Column size="100"/>';

				if (iLoop > 0) {
					iMonth = iMonth + 2;
					iQt = iQt + 2;
					iAm = iAm + 2;
				}
				
				sBandHeadCol     += '<Cell col="' + iMonth + '" colspan="2" text="' + sChkMonth.substr(0,4) + '/' + sChkMonth.substr(4,2) + '"/>';

				sBandHeadRow     += '<Cell row="1" col="' + iQt + '" text="입고수량"/>';
				sBandHeadRow     += '<Cell row="1" col="' + iAm + '" text="입고금액"/>';

				sBandBody        += '<Cell col="' + iQt + '" text="bind:S' + sChkMonth + '_QT' + '" maskeditformat="###,###,###,##0.#0" textAlign="right" displaytype="mask"/>';
				sBandBody        += '<Cell col="' + iAm + '" text="bind:S' + sChkMonth + '_AM' + '" maskeditformat="###,###,###,##0" textAlign="right" displaytype="mask"/>';

				sBandSummary     += '<Cell col="' + iQt + '" expr="dataset.getSum(&quot;S' + sChkMonth + '_QT' + '&quot;)" displaytype="mask" textAlign="right" maskeditformat="###,###,###,##0.#0"/>';
				sBandSummary     += '<Cell col="' + iAm + '" expr="dataset.getSum(&quot;S' + sChkMonth + '_AM' + '&quot;)" displaytype="mask" textAlign="right" maskeditformat="###,###,###,##0"/>';				
			}
		} else {
			sMonth = sFromMonth.substr(0,6);
			sFormatColumns   += '<Column size="80"/>';
			sFormatColumns   += '<Column size="110"/>';

			sBandHeadCol     += '<Cell col="7" colspan="2" text="' + sMonth.substr(0,4) + '/' + sMonth.substr(4,2) + '"/>';

			sBandHeadRow     += '<Cell row="1" col="7" text="입고수량"/>';
			sBandHeadRow     += '<Cell row="1" col="8" text="입고금액"/>';

			sBandBody        += '<Cell col="7" text="bind:S' + sMonth + '_QT' + '" maskeditformat="###,###,###,##0.#0" textAlign="right" displaytype="mask"/>';
			sBandBody        += '<Cell col="8" text="bind:S' + sMonth + '_AM' + '" maskeditformat="###,###,###,##0" textAlign="right" displaytype="mask"/>';

			sBandSummary     += '<Cell col="7" expr="dataset.getSum(&quot;S' + sMonth + '_QT' + '&quot;)" displaytype="mask" textAlign="right" maskeditformat="###,###,###,##0.#0"/>';
			sBandSummary     += '<Cell col="8" expr="dataset.getSum(&quot;S' + sMonth + '_AM' + '&quot;)" displaytype="mask" textAlign="right" maskeditformat="###,###,###,##0"/>';
		}		
		
		sTotFormats = sFormatHead + sFormatColumns + sFormatColumnsEnd + sFormatRows + sBandHead + sBandHeadCol + sBandHeadRow + sBandHeadEnd + sBandBody + sBandBodyEnd + sBandSummary + sBandSummaryEnd + sFormatEnd;//전체 Foramts		

	this.div_MasterView.form.tab_Master.tpg_02.form.grd_Master20.set_formats("")	
	this.div_MasterView.form.tab_Master.tpg_02.form.grd_Master20.set_formats(sTotFormats);

}

/***********************************************************************************************
 * 15.03. 품목코드별 데이터 설정
 ***********************************************************************************************/ 
this.fn_SetPivotItemData = function()
{
	var sITLM_CD = "";//대분류
	var sITMM_CD = "";//중분류
	var sITLM_NM = "";//대분류명
	var sITMM_NM = "";//중분류명
	var sITEM_CD = "";//품목코드
	var sITEM_NM = "";//품목명
	var sSPEC_NM = "";//규격
	var sSP03_CD = "";//Maker
	var sUNIT_CD = "";//단위	
	var sBUYH_DD = "";//매입년월
	var iPCWB_QT = 0;//입고수량
	var iWONE_AM = 0;//입고금액
	var iFindRow = 0;
	var iAddRow = 0;
	var sFromMonth = this.div_Search.form.cal_FromDd.value.substr(0,6) + "01";
	var sClosMonth = this.div_Search.form.cal_ClosDd.value.substr(0,6) + "01";
	var sMonth = "";
	var iDiff = this.gfn_GetDiffMonth(sFromMonth, sClosMonth);//월차이	
	var arrMonth = new Array();
	
	//초기값 설정
	if (iDiff > 0) {
		for (var iLoop=0; iLoop <= iDiff; iLoop++) {
			sMonth = this.gfn_AddMonth(sFromMonth, iLoop);
			sMonth = sMonth.toString();			
			arrMonth.push(sMonth.substr(0,6));
		}
	} else {
		sMonth = sFromMonth.substr(0,6);
		arrMonth.push(sMonth);
	}		
	
	this.ds_Master11.clearData();
	
	this.ds_Master11.set_enableevent(false);
	
	for (var iLoop=0; iLoop<this.ds_Master10.getRowCount(); iLoop++) {
	    sITLM_CD = this.ds_Master10.getColumn(iLoop, "ITLM_CD");//대분류
	    sITLM_NM = this.ds_Master10.getColumn(iLoop, "ITLM_NM");//대분류
	    sITMM_CD = this.ds_Master10.getColumn(iLoop, "ITMM_CD");//중분류
	    sITMM_NM = this.ds_Master10.getColumn(iLoop, "ITMM_NM");//중분류
	    sITEM_CD = this.ds_Master10.getColumn(iLoop, "ITEM_CD");//품목코드
	    sITEM_NM = this.ds_Master10.getColumn(iLoop, "ITEM_NM");//품목명
	    sSPEC_NM = this.ds_Master10.getColumn(iLoop, "SPEC_NM");//규격
	    sSP03_CD = this.ds_Master10.getColumn(iLoop, "SP03_CD");//Maker
	    sUNIT_CD = this.ds_Master10.getColumn(iLoop, "UNIT_CD");//단위	
	    sBUYH_DD = this.ds_Master10.getColumn(iLoop, "PCWH_DD");//매입년월
		sBUYH_DD = sBUYH_DD + "";
	    iPCWB_QT = this.ds_Master10.getColumn(iLoop, "PCWB_QT");//입고수량
	    iWONE_AM = this.ds_Master10.getColumn(iLoop, "WONE_AM");//입고금액		
		
		
		//trace("sITLM_NM = " + sITLM_NM + " " + sITLM_CD + " "  + iLoop);
		
		//if (this.ds_Master11.getCaseCount("ITLM_CD == '" + sITLM_CD + "' && " + "ITMM_CD == '" + sITMM_CD + "' && " + "ITEM_CD == '" + sITEM_CD + "'") < 1) {
		if (this.ds_Master11.getCaseCount("ITEM_CD == '" + sITEM_CD + "'") < 1) {
			iAddRow = this.ds_Master11.addRow();
			this.ds_Master11.setColumn(iAddRow, "ITLM_CD", sITLM_CD);
			this.ds_Master11.setColumn(iAddRow, "ITLM_NM", sITLM_NM);
			this.ds_Master11.setColumn(iAddRow, "ITMM_CD", sITMM_CD);
			this.ds_Master11.setColumn(iAddRow, "ITMM_NM", sITMM_NM);
			this.ds_Master11.setColumn(iAddRow, "ITEM_CD", sITEM_CD);
			this.ds_Master11.setColumn(iAddRow, "ITEM_NM", sITEM_NM);
			this.ds_Master11.setColumn(iAddRow, "SPEC_NM", sSPEC_NM);
			this.ds_Master11.setColumn(iAddRow, "SP03_CD", sSP03_CD);
			this.ds_Master11.setColumn(iAddRow, "UNIT_CD", sUNIT_CD);
			
			//trace("sITLM_NM = " + sITLM_NM + " " + sITLM_CD + " "  + iLoop);
			
			
			//초기값설정
			for (var jLoop=0; jLoop<arrMonth.length; jLoop++) {
				this.ds_Master11.setColumn(iAddRow, "S" + arrMonth[jLoop] + "_QT", 0);
				this.ds_Master11.setColumn(iAddRow, "S" + arrMonth[jLoop] + "_AM", 0);			
			}
			
			this.ds_Master11.setColumn(iAddRow, "S" + sBUYH_DD + "_QT", iPCWB_QT);
			this.ds_Master11.setColumn(iAddRow, "S" + sBUYH_DD + "_AM", iWONE_AM);
		}
		
		//iFindRow = this.ds_Master11.findRowExpr("ITLM_CD == '" + sITLM_CD + "' && " + "ITMM_CD == '" + sITMM_CD + "' && " + "ITEM_CD == '" + sITEM_CD + 
		iFindRow = this.ds_Master11.findRowExpr("ITEM_CD == '" + sITEM_CD + "'");
		
		this.ds_Master11.setColumn(iFindRow, "S" + sBUYH_DD + "_QT", iPCWB_QT);
		this.ds_Master11.setColumn(iFindRow, "S" + sBUYH_DD + "_AM", iWONE_AM);
	}
	
	this.ds_Master11.set_enableevent(true);
	this.ds_Master11.set_rowposition(0);
}


/***********************************************************************************************
 * 15.04. 파트너사별 데이터 설정
 ***********************************************************************************************/ 
this.fn_SetPivotPartData = function()
{
	var sCUSM_CD = "";//파트너사코드
	var sCUSM_NM = "";//파트너사명
	var sSAUM_NO = "";//사업자번호
	var sBUYH_DD = "";//매입년월
	var iPCWB_QT = 0;//입고수량
	var iWONE_AM = 0;//입고금액
	var iFindRow = 0;
	var iAddRow = 0;
	var sFromMonth = this.div_Search.form.cal_FromDd.value.substr(0,6) + "01";
	var sClosMonth = this.div_Search.form.cal_ClosDd.value.substr(0,6) + "01";
	var sMonth = "";
	var iDiff = this.gfn_GetDiffMonth(sFromMonth, sClosMonth);//월차이	
	var arrMonth = new Array();
	
	//초기값 설정
	if (iDiff > 0) {
		for (var iLoop=0; iLoop <= iDiff; iLoop++) {
			sMonth = this.gfn_AddMonth(sFromMonth, iLoop);
			sMonth = sMonth.toString();			
			arrMonth.push(sMonth.substr(0,6));
		}
	} else {
		sMonth = sFromMonth.substr(0,6);
		arrMonth.push(sMonth);
	}		
	
	this.ds_Master21.clearData();
	
	this.ds_Master21.set_enableevent(false);
	
	for (var iLoop=0; iLoop<this.ds_Master20.getRowCount(); iLoop++) {
	    sCUSM_CD = this.ds_Master20.getColumn(iLoop, "CUSM_CD");//파트너사코드
	    sCUSM_NM = this.ds_Master20.getColumn(iLoop, "CUSM_NM");//파트너사명
	    sSAUM_NO = this.ds_Master20.getColumn(iLoop, "SAUM_NO");//사업자번호
	    sBUYH_DD = this.ds_Master20.getColumn(iLoop, "PCWH_DD");//매입년월
		sBUYH_DD = sBUYH_DD + "";
	    iPCWB_QT = this.ds_Master20.getColumn(iLoop, "PCWB_QT");//입고수량
	    iWONE_AM = this.ds_Master20.getColumn(iLoop, "WONE_AM");//입고금액		
		
		if (this.ds_Master21.getCaseCount("CUSM_CD == '" + sCUSM_CD + "'") < 1) {
			iAddRow = this.ds_Master21.addRow();
			this.ds_Master21.setColumn(iAddRow, "CUSM_CD", sCUSM_CD);
			this.ds_Master21.setColumn(iAddRow, "CUSM_NM", sCUSM_NM);
			this.ds_Master21.setColumn(iAddRow, "SAUM_NO", sSAUM_NO);
			
			//초기값설정
			for (var jLoop=0; jLoop<arrMonth.length; jLoop++) {
				this.ds_Master21.setColumn(iAddRow, "S" + arrMonth[jLoop] + "_QT", 0);
				this.ds_Master21.setColumn(iAddRow, "S" + arrMonth[jLoop] + "_AM", 0);			
			}
			
			this.ds_Master21.setColumn(iAddRow, "S" + sBUYH_DD + "_QT", iPCWB_QT);
			this.ds_Master21.setColumn(iAddRow, "S" + sBUYH_DD + "_AM", iWONE_AM);
		}
		
		iFindRow = this.ds_Master21.findRowExpr("CUSM_CD == '" + sCUSM_CD + "'");
		
		this.ds_Master21.setColumn(iFindRow, "S" + sBUYH_DD + "_QT", iPCWB_QT);
		this.ds_Master21.setColumn(iFindRow, "S" + sBUYH_DD + "_AM", iWONE_AM);
	}
	
	this.ds_Master21.set_enableevent(true);
	this.ds_Master21.set_rowposition(0);
}
]]></Script>
  </Form>
</FDL>
